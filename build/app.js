(()=>{"use strict";var e,t,s,n={8511:(e,t,s)=>{const n=window.wp.element;var a=s(790),i=s(9571);const o=window.wp.i18n;class r extends n.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){var e;return this.state.hasError?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-h-screen wpqt-items-center wpqt-justify-center wpqt-text-center wpqt-text-lg",children:[(0,o.__)("Something went wrong. Please refresh the page.","quicktasker"),(0,a.jsx)("br",{}),null===(e=this.state.error)||void 0===e?void 0:e.message]}):this.props.children}}const c=r;function l({children:e,description:t=null,icon:s=null}){return(0,a.jsx)("div",{className:"wpqt-mb-6 wpqt-inline-grid wpqt-grid-cols-[auto_auto] wpqt-items-center wpqt-gap-2",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{children:[e,s&&(0,a.jsx)("span",{className:"wpqt-ml-1 wpqt-align-middle",children:s})]}),t&&(0,a.jsx)("div",{children:t})]})})}const d=window.wp.apiFetch;var u=s.n(d);function p(){return{"Content-Type":"application/json","X-WPQT-API-Nonce":window.wpqt.apiNonce}}function h(e,t,s){const n=new URLSearchParams({typeId:e,type:t,isPrivate:s.toString()}).toString();return u()({path:`/wpqt/v1/comments?${n}`,method:"GET",headers:p()})}function w(e,t,s,n){return u()({path:"/wpqt/v1/comments",data:{comment:n,typeId:e,type:t,isPrivate:s},method:"POST",headers:p()})}function v(e,t){const s=new URLSearchParams({typeId:e,type:t});return u()({path:`/wpqt/v1/logs?${s.toString()}`,method:"GET",headers:p()})}function x(e,t){return u()({path:`/wpqt/v1/users/${e}/tasks`,method:"DELETE",data:{task_id:t},headers:p()})}const f="SET_LOADING",q="SET_PIPELINE",m="ADD_TASK",g="ADD_STAGE",k="DELETE_STAGE",j="EDIT_TASK",_="EDIT_STAGE",y="ADD_PIPELINE",b="EDIT_PIPELINE",C="SET_PRIMARY",S="SET_PIPELINES",O="ADD_USER_TO_TASK",T="REMOVE_USER_FROM_TASK",N="CHANGE_TASK_DONE_STATUS",A="REMOVE_PIPELINE",E="REMOVE_ACTIVE_PIPELINE",P="OPEN_EDIT_TASK_MODAL",D="CLOSE_TASK_MODAL",I="OPEN_NEW_STAGE_MODAL",R="CLOSE_STAGE_MODAL",U="OPEN_STAGE_EDIT_MODAL",L="OPEN_NEW_PIPELINE_MODAL",F="OPEN_EDIT_PIPELINE_MODAL",M="CLOSE_PIPELINE_EDIT_MODAL",z="CLOSE_USER_MODAL",$="OPEN_EDIT_USER_MODAL",V="ADD_ASSIGNED_USER_TO_EDITING_TASK",H="REMOVE_ASSIGNED_USER_FROM_EDITING_TASK",B="CHANGE_USER_SETTINGS_MODAL_OPEN",G="SET_ARCHIVE_TASKS",K="SET_ARCHIVE_SEARCH_VALUE",W="SET_ARCHIVE_FILTERED_PIPELINE",Q="REMOVE_ARCHIVED_TASK",Y="ADD_ASSIGNED_USER_TO_ARCHIVED_TASK",X="REMOVE_ASSINGED_USER_FROM_ARCHIVED_TASK",J="CHANGE_ARCHIVED_TASK_DONE_STATUS",Z="EDIT_ARCHIVED_TASK",ee="CHANGE_ARCHIVE_TASK_DONE_FILTER",te="SET_USERS",se="ADD_USER",ne="SET_USERS_SEARCH_VALUE",ae="EDIT_USER",ie="DELETE_USER",oe="CHANGE_USER_STATUS",re="RESET_PASSWORD",ce="INIT_APP_STATE",le="SET_CUSTOM_USER_PAGE_STYLES",de="SET_FULL_PAGE_LOADING",ue="SET_USER_SESSIONS_SEARCH_VALUE",pe="SET_USER_SESSIONS",he="CHANGE_USER_SESSION_STATUS",we="DELETE_USER_SESSION",ve="SET_USER_TASKS",xe="SET_USER_TASKS_SEARCH_VALUE",fe="REMOVE_USER_TASK",qe="EDIT_USER_TASK",me="SET_USER_TASKS_FILTERED_PIPELINE",ge="ADD_ASSIGNED_USER_TO_USER_TASK",ke="REMOVE_ASSIGNED_USER_FROM_USER_TASK",je="CHANGE_USER_TASK_DONE_STATUS",_e="SET_CUSTOM_FIELDS",ye="ADD_CUSTOM_FIELD",be="DELETE_CUSTOM_FIELD",Ce="SET_CUSTOM_FIELD_LOADING",Se="SET_CUSTOM_FIELD_INITIAL_DATA",Oe=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active,has_password:"1"===e.has_password}),Te=e=>Object.assign(Object.assign({},e),{task_order:Number(e.task_order),free_for_all:"1"===e.free_for_all,is_archived:"1"===e.is_archived,is_done:"1"===e.is_done,assigned_users:e.assigned_users?e.assigned_users.map((e=>Object.assign({},Oe(e)))):[]}),Ne=(e,t)=>{var s,n,a,i,o;switch(t.type){case G:{const s=t.payload;return Object.assign(Object.assign({},e),{archivedTasks:s.map(Te)})}case K:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveSearchValue:s})}case W:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveFilteredPipelineId:s})}case Q:{const n=(null!==(s=e.archivedTasks)&&void 0!==s?s:[]).filter((e=>e.id!==t.payload));return Object.assign(Object.assign({},e),{archivedTasks:n})}case Y:{const{taskId:s,user:a}=t.payload,i=(null!==(n=e.archivedTasks)&&void 0!==n?n:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:[a,...e.assigned_users]}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case X:{const{taskId:s,user:n}=t.payload,i=(null!==(a=e.archivedTasks)&&void 0!==a?a:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:e.assigned_users.filter((e=>e.id!==n.id))}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case J:{const{taskId:s,done:n}=t.payload,a=(null!==(i=e.archivedTasks)&&void 0!==i?i:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{archivedTasks:a})}case Z:{const s=t.payload,n=(null!==(o=e.archivedTasks)&&void 0!==o?o:[]).map((e=>e.id===s.id?Te(s):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case ee:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskDoneFilter:s})}default:return e}};var Ae,Ee,Pe,De;!function(e){e.Task="task",e.User="user"}(Ae||(Ae={})),function(e){e.System="system",e.Admin="admin",e.WPQTUser="quicktasker_user"}(Ee||(Ee={})),function(e){e.All="all",e.Completed="completed",e.NotCompleted="not completed"}(Pe||(Pe={})),function(e){e.Admin="administrator",e.Other="other"}(De||(De={}));const Ie=(e,t)=>{if(t.type===de){const s=t.payload;return Object.assign(Object.assign({},e),{fullPageLoading:s})}return e},Re={fullPageLoading:!1},Ue=(0,n.createContext)({state:Re,loadingDispatch:()=>{}}),Le=({children:e})=>{const[t,s]=(0,n.useReducer)(Ie,Re);return(0,a.jsx)(Ue.Provider,{value:{state:t,loadingDispatch:s},children:e})};const Fe={archivedTasks:null,archiveLoading:!1,archiveSearchValue:"",archiveFilteredPipelineId:"",archiveTaskDoneFilter:Pe.All},Me=(0,n.createContext)({state:Fe,archiveDispatch:()=>{}}),ze=({children:e})=>{const[t,s]=(0,n.useReducer)(Ne,Fe),{loadingDispatch:r}=(0,n.useContext)(Ue);(0,n.useEffect)((()=>{c()}),[]);const c=()=>{return e=void 0,t=void 0,a=function*(){try{r({type:de,payload:!0});const{data:e}=yield u()({path:"/wpqt/v1/tasks/archived",method:"GET",headers:p()});s({type:G,payload:e})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch archived tasks","quicktasker"))}finally{r({type:de,payload:!1})}},new((n=void 0)||(n=Promise))((function(s,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}));var e,t,n,a};return(0,a.jsx)(Me.Provider,{value:{state:t,archiveDispatch:s},children:e})};var $e=s(6061);function Ve({width:e="80",height:t="80",className:s=""}){return(0,a.jsx)($e.BM,{visible:!0,height:t,width:e,color:"#1d4ed8",secondaryColor:"#2563eb",ariaLabel:"oval-loading",wrapperStyle:{},wrapperClass:s})}function He(){return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-flex-col wpqt-items-center wpqt-justify-center",children:(0,a.jsx)(Ve,{})})}function Be({className:e,ovalSize:t}){const s=t?{width:t,height:t}:{};return(0,a.jsx)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center ${e}`,children:(0,a.jsx)(Ve,Object.assign({},s))})}function Ge({children:e}){const{state:{fullPageLoading:t}}=(0,n.useContext)(Ue);return(0,a.jsx)("div",{className:"wpqt-pr-4",children:t?(0,a.jsx)(He,{}):e})}var Ke=s(2912);const We=e=>Object.assign(Object.assign({},e),{allow_only_last_stage_task_done:"1"===e.allow_only_last_stage_task_done}),Qe=e=>Object.assign(Object.assign({},e),{stage_order:Number(e.stage_order),tasks:(e.tasks||[]).map((e=>Object.assign({},Te(e))))}),Ye=(e,t)=>{var s;switch(t.type){case S:{const s=t.payload,n=e=>Object.assign({},Qe(e)),a=e=>{var t;return Object.assign(Object.assign({},e),{stages:null===(t=e.stages)||void 0===t?void 0:t.map(n),settings:e.settings?We(e.settings):void 0,is_primary:"1"===e.is_primary})};return Object.assign(Object.assign({},e),{pipelines:s.map(a)})}case y:{const n=t.payload,a=e=>Object.assign({},Qe(e)),i=Object.assign(Object.assign({},n),{stages:null===(s=n.stages)||void 0===s?void 0:s.map(a),settings:n.settings?We(n.settings):void 0,is_primary:!1});return Object.assign(Object.assign({},e),{pipelines:[...e.pipelines,i]})}case C:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>Object.assign(Object.assign({},e),{is_primary:e.id===s})))})}case b:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>e.id===s.id?s:e))})}case A:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.filter((e=>e.id!==s))})}default:return e}},Xe={pipelines:[]},Je=(0,n.createContext)({state:Xe,pipelinesDispatch:()=>{}}),Ze=({children:e})=>{const[t,s]=(0,n.useReducer)(Ye,Xe);return(0,n.useEffect)((()=>{const e=window.wpqt.initialPipelines;s({type:S,payload:e})}),[]),(0,a.jsx)(Je.Provider,{value:{state:t,pipelinesDispatch:s},children:e})};var et=s(3482);function tt({options:e,selectedOptionValue:t,onSelectionChange:s,allSelector:n=!0,className:i=""}){return(0,a.jsxs)(et.l,{value:t,onChange:e=>{const t=e.target.value;s(t)},className:`!wpqt-rounded-lg !wpqt-border !wpqt-border-solid !wpqt-border-qtBorder !wpqt-px-2 !wpqt-pr-6 !wpqt-py-1 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`,children:[n&&(0,a.jsx)("option",{value:"",children:"All boards"}),e.map((e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value)))]})}function st({selectedOptionValue:e,selectionChange:t,extraOptions:s=[]}){const{state:{pipelines:i}}=(0,n.useContext)(Je),o=(0,n.useMemo)((()=>i.map((e=>({value:e.id,label:e.name})))),[i]);return(0,a.jsx)(tt,{options:[...o,...s],selectedOptionValue:e,onSelectionChange:t})}function nt({children:e,title:t,childrenClassName:s="",titleClassName:n=""}){return(0,a.jsxs)("div",{className:"wpqt-mb-8",children:[(0,a.jsx)("div",{className:`wpqt-mb-2 wpqt-text-base ${n}`,children:t}),(0,a.jsx)("div",{className:`wpqt-flex wpqt-gap-2 wpqt-items-center ${s}`,children:e})]})}function at(){const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s},archiveDispatch:i}=(0,n.useContext)(Me);return(0,a.jsxs)(nt,{title:(0,o.__)("Archive filtering","quicktasker"),children:[(0,a.jsx)(Ke.p,{type:"text",value:e,onChange:e=>{i({type:K,payload:e.target.value})}}),(0,a.jsx)(st,{selectedOptionValue:t,selectionChange:e=>{i({type:W,payload:e})},extraOptions:[{value:"DELETED",label:(0,o.__)("DELETED","quicktasker")}]}),(0,a.jsx)(tt,{allSelector:!1,selectedOptionValue:s,options:[{label:(0,o.__)("All status","quicktasker"),value:Pe.All},{label:(0,o.__)("Completed","quicktasker"),value:Pe.Completed},{label:(0,o.__)("Not completed","quicktasker"),value:Pe.NotCompleted}],onSelectionChange:e=>{const t=(e=>{switch(e){case Pe.All:return Pe.All;case Pe.Completed:return Pe.Completed;case Pe.NotCompleted:return Pe.NotCompleted;default:throw new Error(`Invalid selection: ${e}`)}})(e);i({type:ee,payload:t})}})]})}var it=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const ot=()=>({deleteTask:(e,t)=>it(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}`,method:"DELETE",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task deleted","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a task","quicktasker"))}})),archiveTask:(e,t)=>it(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task archived","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to archive a task","quicktasker"))}})),restoreArchivedTask:(e,t)=>it(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive-restore`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task restored","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore a task","quicktasker"))}})),removeTaskFromUser:(e,t,s)=>it(void 0,void 0,void 0,(function*(){try{yield x(e,t),s&&s(),i.oR.success((0,o.__)("Task has been unassigned","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Task unassignment failed. Try again","quicktasker"))}})),changeTaskDoneStatus:(e,t,s)=>it(void 0,void 0,void 0,(function*(){try{const n=t?(0,o.__)("Task marked as completed","quicktasker"):(0,o.__)("Task marked as incomplete","quicktasker");yield function(e,t){return u()({path:`/wpqt/v1/tasks/${e}/done`,method:"PATCH",data:{done:t},headers:p()})}(e,t),s&&s(t),i.oR.success(n)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change task status","quicktasker"))}}))}),rt=(e,t)=>{var s,n,a,i,o,r,c,l,d;switch(t.type){case f:return Object.assign(Object.assign({},e),{loading:t.payload});case q:{const s=t.payload,n=(s.stages||[]).map((e=>Object.assign({},Qe(e)))),a=s.settings?We(s.settings):void 0;return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},s),{stages:n,settings:a,is_primary:"1"===s.is_primary})})}case"MOVE_TASK":{if(!e.activePipeline||!e.activePipeline.stages)return e;const s=((e,t,s)=>{const n=[...e],a=n.find((e=>e.id===t.droppableId)),i=n.find((e=>e.id===s.droppableId));if((null==a?void 0:a.tasks)&&(null==i?void 0:i.tasks)){const[e]=a.tasks.splice(t.index,1);i.tasks.splice(s.index,0,e)}return n})(e.activePipeline.stages,t.payload.source,t.payload.destination);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:s})})}case"REORDER_TASK":{const{source:a,destination:i}=t.payload,o=i.droppableId,r=i.index;if(!e.activePipeline)return e;const c=null===(s=e.activePipeline.stages)||void 0===s?void 0:s.find((e=>e.id===o));if(!c||!c.tasks)return e;const l=((e,t,s)=>{const n=[...e],[a]=n.splice(t,1);return n.splice(s,0,a),n})(c.tasks,a.index,r),d=null===(n=e.activePipeline.stages)||void 0===n?void 0:n.map((e=>e.id===o?Object.assign(Object.assign({},e),{tasks:l}):e));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:d})})}case m:{const s=Te(t.payload);return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(a=e.activePipeline.stages)||void 0===a?void 0:a.map((e=>e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:[...e.tasks||[],s]}):e))})}):e}case j:{const s=Te(t.payload);if(!e.activePipeline)return e;const n=null===(i=e.activePipeline.stages)||void 0===i?void 0:i.map((e=>{var t;return e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s.id?s:e))}):e}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case g:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:[...e.activePipeline.stages||[],s]})}):e}case _:{const s=t.payload;if(!e.activePipeline)return e;const n=e=>e.id===s.id?Object.assign(Object.assign({},e),{name:s.name,description:s.description}):e,a=null===(o=e.activePipeline.stages)||void 0===o?void 0:o.map(n);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case k:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(r=e.activePipeline.stages)||void 0===r?void 0:r.filter((e=>e.id!==s))})}):e}case O:{const{taskId:s,user:n}=t.payload;if(!e.activePipeline)return e;const a=null===(c=e.activePipeline.stages)||void 0===c?void 0:c.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:[n,...e.assigned_users||[]]}):e));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case T:{const{taskId:s,userId:n}=t.payload;if(!e.activePipeline)return e;const a=null===(l=e.activePipeline.stages)||void 0===l?void 0:l.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{var t;return e.id===s?Object.assign(Object.assign({},e),{assigned_users:null===(t=e.assigned_users)||void 0===t?void 0:t.filter((e=>e.id!==n))}):e}));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case b:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{name:s.name,description:s.description,is_primary:"1"===s.is_primary})}):e}case N:{const{taskId:s,done:n}=t.payload;if(!e.activePipeline)return e;const a=null===(d=e.activePipeline.stages)||void 0===d?void 0:d.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case E:return Object.assign(Object.assign({},e),{activePipeline:null});default:return e}};const ct={loading:!1,activePipeline:null},lt=(0,n.createContext)({state:ct,dispatch:()=>{},fetchAndSetPipelineData:()=>Promise.resolve()}),dt=({children:e})=>{const[t,s]=(0,n.useReducer)(rt,ct),{loadingDispatch:r}=(0,n.useContext)(Ue);(0,n.useEffect)((()=>{const e=window.wpqt.initialActivePipelineId;e&&l(e,!0)}),[]);const c=(e,t)=>{t?r({type:de,payload:e}):s({type:f,payload:e})},l=(e,...t)=>{return n=void 0,a=[e,...t],l=function*(e,t=!1){try{c(!0,t);const{data:{pipeline:n}}=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,headers:p()})}(e);s({type:q,payload:n})}catch(e){console.error(e),i.oR.error((0,o.__)("Unable to load the board. Please try again later.","quicktasker"))}finally{c(!1,t)}},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,i)}o((l=l.apply(n,a||[])).next())}));var n,a,r,l};return(0,a.jsx)(lt.Provider,{value:{state:t,dispatch:s,fetchAndSetPipelineData:l},children:e})},ut=()=>Object.assign({},ht),pt=(e,t)=>{var s,n,a,i;switch(t.type){case P:{const{taskToEdit:s,taskModalSettings:n}=t.payload;return Object.assign(Object.assign({},e),{taskModalOpen:!0,taskToEdit:s,targetStageId:s.stage_id,taskModalSettings:Object.assign(Object.assign({},e.taskModalSettings),n)})}case D:return ut();case V:{const a=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:[a,...null!==(n=null===(s=e.taskToEdit)||void 0===s?void 0:s.assigned_users)&&void 0!==n?n:[]]})})}case H:{const s=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:(null!==(i=null===(a=e.taskToEdit)||void 0===a?void 0:a.assigned_users)&&void 0!==i?i:[]).filter((e=>e.id!==s.id))})})}case I:{const{targetPipelineId:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,targetPipelineId:s})}case U:{const{stageToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,stageToEdit:s})}case R:return ut();case L:return Object.assign(Object.assign({},e),{newPipelineModalOpen:!0});case F:{const{pipelineToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{pipelineModalOpen:!0,pipelineToEdit:s})}case M:return ut();case"OPEN_ARCHIVE_TASK_MODAL":{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskModalOpen:!0,archiveModalTask:s})}case"CLOSE_ARCHIVE_TASK_MODAL":return ut();case"OPEN_NEW_USER_MODAL":return Object.assign(Object.assign({},e),{userModalOpen:!0});case $:{const s=t.payload;return Object.assign(Object.assign({},e),{userModalOpen:!0,userToEdit:s})}case z:return ut();case B:return t.payload?Object.assign(Object.assign({},e),{userSettingsModalOpen:!0}):ut();case"CHANGE_TASK_DONE_STATUS":{const{done:s}=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{is_done:s})})}default:return e}},ht={taskModalOpen:!1,targetStageId:"",taskToEdit:null,taskModalSettings:{allowToMarkTaskAsDone:!0},stageModalOpen:!1,stageToEdit:null,targetPipelineId:"",pipelineModalOpen:!1,newPipelineModalOpen:!1,pipelineToEdit:null,archiveTaskModalOpen:!1,archiveModalTask:null,userModalOpen:!1,userToEdit:null,userSettingsModalOpen:!1},wt=(0,n.createContext)({state:ht,modalDispatch:()=>{}}),vt=({children:e})=>{const[t,s]=(0,n.useReducer)(pt,ht);return(0,a.jsx)(wt.Provider,{value:{state:t,modalDispatch:s},children:e})},xt=(e,t)=>{switch(t.type){case te:{const s=t.payload.map(Oe);return Object.assign(Object.assign({},e),{users:s})}case se:{const s=t.payload,n=Oe(s);return Object.assign(Object.assign({},e),{users:[...e.users,n]})}case ae:{const s=t.payload,n=Oe(s),a=e.users.map((e=>e.id===n.id?n:e));return Object.assign(Object.assign({},e),{users:a})}case oe:{const{isActive:s,userId:n}=t.payload,a=e.users.map((e=>e.id===n?Object.assign(Object.assign({},e),{is_active:s}):e));return Object.assign(Object.assign({},e),{users:a})}case re:{const s=t.payload,n=e.users.map((e=>e.id===s?Object.assign(Object.assign({},e),{has_password:!1}):e));return Object.assign(Object.assign({},e),{users:n})}case ie:{const s=t.payload,n=e.users.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{users:n})}case ne:{const s=t.payload;return Object.assign(Object.assign({},e),{usersSearchValue:s})}default:return e}};var ft=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const qt={users:[],usersSearchValue:""},mt=(0,n.createContext)({state:qt,userDispatch:()=>{},updateUsers:()=>ft(void 0,void 0,void 0,(function*(){}))}),gt=({children:e})=>{const[t,s]=(0,n.useReducer)(xt,qt);return(0,n.useEffect)((()=>{const e=window.wpqt.initialUsers;s({type:te,payload:e})}),[]),(0,a.jsx)(mt.Provider,{value:{state:t,userDispatch:s,updateUsers:()=>ft(void 0,void 0,void 0,(function*(){try{const e=yield u()({path:"/wpqt/v1/users",method:"GET",headers:p()});s({type:te,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch users","quicktasker"))}}))},children:e})};var kt;!function(e){e.ACTIVE_PIPELINE="ACTIVE_PIPELINE",e.PIPELINES="PIPELINES",e.USER="USER"}(kt||(kt={}));const jt=e=>{const[t,s]=(0,n.useState)(!1),a=(0,n.useRef)(null),{modalDispatch:i}=(0,n.useContext)(wt),{dispatch:o}=(0,n.useContext)(lt),{pipelinesDispatch:r}=(0,n.useContext)(Je),{userDispatch:c}=(0,n.useContext)(mt),l=()=>{i({type:e}),d()},d=()=>{a.current&&a.current.clearContent()};return{modalSaving:t,setModalSaving:s,modalContentRef:a,closeModal:l,handleSuccess:(e,t,n)=>{let a;switch(n){case kt.PIPELINES:a=r;break;case kt.ACTIVE_PIPELINE:a=o;break;case kt.USER:a=c;break;default:a=o}s(!1),a({type:e,payload:t}),l()},handleError:e=>{s(!1),console.error(e)}}};var _t,yt=s(2922),bt=s(6053),Ct=s(9828),St=s(540),Ot=s(4576),Tt=s(3223),Nt=s(7008);function At({id:e}){return(0,a.jsx)(Nt.m_,{id:e,className:"wpqt-bg-red-600",children:(0,a.jsx)("span",{children:"Tooltip content"})})}function Et({icon:e,text:t,onClick:s=()=>{},className:n,tooltipId:i,tooltipText:o,loading:r=!1}){const c=o&&i,l=c?{"data-tooltip-id":i,"data-tooltip-content":o,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-main-border wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-bg-gray-100 wpqt-p-2 hover:wpqt-bg-white ${n}`,onClick:s,children:[e,t&&(0,a.jsx)("span",{className:"wpqt-whitespace-nowrap "+(r?"wpqt-invisible":""),children:t}),r&&(0,a.jsx)(Ve,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-y-center wpqt-transform-x-center"}),c&&(0,a.jsx)(At,{id:i})]}))}function Pt({modalOpen:e,closeModal:t,children:s,size:n="sm"}){return(0,a.jsxs)(yt.lG,{open:e,as:"div",className:"wpqt-relative wpqt-z-9999 focus:wpqt-outline-none",onClose:t,children:[(0,a.jsx)(yt.Xi,{className:"wpqt-fixed wpqt-inset-0 wpqt-bg-black/40"}),(0,a.jsx)("div",{className:"wpqt-fixed wpqt-inset-0 wpqt-z-10 wpqt-w-screen wpqt-overflow-y-auto",children:(0,a.jsx)("div",{className:"wpqt-mt-[8vh] wpqt-flex wpqt-justify-center",children:(0,a.jsxs)(yt.Lj,{transition:!0,className:`data-[closed]:wpqt-transform-[wpqt-scale(95%)] wpqt-relative wpqt-mt-[20px] wpqt-w-4/5 ${{sm:"wpqt-max-w-sm",md:"wpqt-max-w-lg",lg:"wpqt-max-w-4xl",xl:"wpqt-max-w-6xl"}[n]} wpqt-rounded-xl wpqt-bg-white wpqt-p-8 wpqt-backdrop-blur-2xl wpqt-duration-300 wpqt-ease-out data-[closed]:wpqt-opacity-0`,children:[(0,a.jsx)("div",{className:"wpqt-group wpqt-absolute wpqt-right-[-20px] wpqt-top-[-20px] wpqt-flex wpqt-h-[40px] wpqt-w-[40px] wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-rounded-full wpqt-border wpqt-border-solid wpqt-bg-white wpqt-text-qtBorder",onClick:t,children:(0,a.jsx)(Ot.A,{className:"wpqt-icon-blue group-hover:wpqt-icon-red wpqt-size-5"})}),s]})})})]})}function Dt({children:e}){return(0,a.jsx)(yt.L3,{as:"div",className:"wpqt-text-base/7 wpqt-font-medium wpqt-text-black",children:e})}function It({children:e}){return(0,a.jsx)(bt.L,{children:e})}function Rt({label:e,children:t,tooltipId:s,tooltipText:n}){const i=s&&n,o=i?{"data-tooltip-id":s,"data-tooltip-content":n,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info","data-tooltip-place":"top-end"}:{};return(0,a.jsxs)(Ct.D,{className:"wpqt-mb-3",children:[(0,a.jsx)(St.JU,Object.assign({className:"wpqt-mb-2 wpqt-block wpqt-text-sm/6 wpqt-font-medium"},o,{children:e})),t,i&&(0,a.jsx)(At,{id:s})]})}function Ut({onSave:e,saveBtnText:t,loading:s=!1}){return(0,a.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-justify-end",children:(0,a.jsx)(Et,{text:t,loading:s,icon:(0,a.jsx)(Tt.RZ0,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:e})})}!function(e){e.BUTTON="button",e.SUBMIT="submit",e.RESET="reset"}(_t||(_t={}));var Lt=s(1489),Ft=s(8448),Mt=s(8176),zt=s(1052);function $t(){const[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)(!1),[i,o]=(0,n.useState)(!1);return{loading1:e,loading2:s,setLoading1:t,setLoading2:a,loading3:i,setLoading3:o}}const Vt=(e,t)=>{switch(t.type){case"SET_SITE_URL":{const s=t.payload;return Object.assign(Object.assign({},e),{siteURL:s})}case ce:{const{siteURL:s,publicUserPageId:n,timezone:a,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r}=t.payload;return Object.assign(Object.assign({},e),{siteURL:s,publicUserPageId:n,timezone:a,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r})}case le:{const s=t.payload;return Object.assign(Object.assign({},e),{userPageCustomStyles:s})}default:return e}},Ht={siteURL:"",pluginURL:"",publicUserPageId:"",is_customFields:!1,timezone:"",isUserAllowedToDelete:!1,userPageCustomStyles:""},Bt=(0,n.createContext)({state:Ht,appDispatch:()=>{}}),Gt=({children:e})=>{const[t,s]=(0,n.useReducer)(Vt,Ht);return(0,n.useEffect)((()=>{const e=window.wpqt.siteURL,t=window.wpqt.publicUserPageId,n=window.wpqt.timezone,a="1"===window.wpqt.isUserAllowedToDelete,i=window.wpqt.userPageCustomStyles,o=window.wpqt.pluginURL;s({type:ce,payload:{siteURL:e,publicUserPageId:t,timezone:n,isUserAllowedToDelete:a,userPageCustomStyles:i,pluginURL:o}})}),[]),(0,a.jsx)(Bt.Provider,{value:{state:t,appDispatch:s},children:e})};var Kt,Wt,Qt;!function(e){e.Text="text",e.Select="select",e.Checkbox="checkbox",e.Radio="radio",e.Datetime="datetime",e.File="file"}(Kt||(Kt={})),function(e){e.User="user",e.Pipeline="pipeline",e.Users="users",e.Task="task"}(Wt||(Wt={})),function(e){e.TEXT="text",e.PASSWORD="password"}(Qt||(Qt={}));const Yt=(0,n.forwardRef)((({value:e,onChange:t,isAutoFocus:s,className:n="",wrapperClassName:i="",disabled:o=!1,type:r=Qt.TEXT,loading:c=!1},l)=>(0,a.jsxs)("div",{className:`wpqt-inline-block wpqt-relative wpqt-mb-3 ${i}`,children:[(0,a.jsx)(Ke.p,{ref:l,autoFocus:s,className:`wpqt-block wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${n}`,value:e,disabled:o,onChange:e=>t(e.target.value),type:r}),c&&(0,a.jsx)(Ve,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"})]})));var Xt=s(1062),Jt=s(4164);function Zt({value:e,onChange:t,rowsCount:s=3,className:n}){return(0,a.jsx)(Xt.T,{className:(0,Jt.$)("wpqt-border-1 wpqt-mb-3 wpqt-block wpqt-resize-none wpqt-rounded-lg wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6",`focus:wpqt-shadow-none focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${n}`),rows:s,value:e,onChange:e=>t(e.target.value)})}var es=s(303);function ts({checked:e,handleChange:t}){return(0,a.jsx)(es.A,{onChange:t,checked:e,uncheckedIcon:!1,checkedIcon:!1,height:20,width:44})}const ss=(e,t)=>{switch(t.type){case Ce:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case Se:{const{entityId:s,entityType:n}=t.payload;return Object.assign(Object.assign({},e),{entityId:s,entityType:n})}case _e:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:s})}case ye:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:[...e.customFields,s]})}case be:{const s=t.payload,n=e.customFields.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{customFields:n})}default:return e}};const ns={customFields:[],loading:!0,entityId:"",entityType:null},as=(0,n.createContext)({state:ns,customFieldsDispatch:()=>{},fetchCustomFields:()=>{}}),is=({children:e,entityId:t,entityType:s})=>{const[r,c]=(0,n.useReducer)(ss,ns);(0,n.useEffect)((()=>{l()}),[]),(0,n.useEffect)((()=>{c({type:Se,payload:{entityType:s,entityId:t}})}),[s,t]);const l=()=>{return e=void 0,n=void 0,r=function*(){try{c({type:Ce,payload:!0});const e=yield function(e,t){const s=new URLSearchParams({entityId:e,entityType:t});return u()({path:`/wpqt/v1/custom-fields?${s.toString()}`,method:"GET",headers:p()})}(t,s);c({type:_e,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch custom fields","quicktasker"))}finally{c({type:Ce,payload:!1})}},new((a=void 0)||(a=Promise))((function(t,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}));var e,n,a,r};return(0,a.jsx)(as.Provider,{value:{state:r,customFieldsDispatch:c,fetchCustomFields:l},children:e})};var os=s(9197),rs=s(2767),cs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ls(){return{addCustomField:(e,t,s,n,a,r)=>cs(this,void 0,void 0,(function*(){try{const i=yield function(e,t,s,n,a){return u()({path:"/wpqt/v1/custom-fields",method:"POST",data:{entityId:e,entityType:t,type:s,name:n,description:a},headers:p()})}(e,t,s,n,a);r&&r(i.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add a custom field","quicktasker"))}})),markCustomFieldAsDeleted:(e,t)=>cs(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/custom-fields/${e}`,method:"DELETE",headers:p()})}(e),t&&t()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to mark custom field as deleted","quicktasker"))}})),updateCustomFieldValue:(e,t,s,n,a)=>cs(this,void 0,void 0,(function*(){try{yield function(e,t,s,n){return u()({path:`/wpqt/v1/custom-fields/${e}/value`,method:"PATCH",data:{value:t,entityId:String(s),entityType:n},headers:p()})}(e,t,s,n),a&&a()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to update custom field value","quicktasker"))}}))}}var ds=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function us({description:e}){const[t,s]=(0,n.useState)(""),[i,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(Kt.Text),{addCustomField:p}=ls(),{state:{entityId:h,entityType:w},customFieldsDispatch:v}=(0,n.useContext)(as),[x,f]=(0,n.useState)(!1),q=[{value:Kt.Text,label:"Text"},{value:Kt.Checkbox,label:"Checkbox"}];return(0,a.jsxs)("div",{className:"wpqt-mb-6 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)("h2",{children:(0,o.__)("Custom Fields","quicktasker")}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:e}),c&&(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Name","quicktasker")}),(0,a.jsx)(Yt,{value:t,onChange:s})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Description","quicktasker")}),(0,a.jsx)(Zt,{value:i,onChange:r})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Type","quicktasker")}),(0,a.jsx)(tt,{selectedOptionValue:d,options:q,onSelectionChange:e=>{u(e)},allSelector:!1})]})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,a.jsx)(Et,{text:c?(0,o.__)("Cancel","quicktasker"):(0,o.__)("Add new custom field","quicktasker"),onClick:()=>l(!c),icon:c?(0,a.jsx)(os.A,{className:"wpqt-icon-red wpqt-size-5"}):(0,a.jsx)(rs.A,{className:"wpqt-icon-green wpqt-size-5"})}),c&&(0,a.jsx)(Et,{text:(0,o.__)("Add","quicktasker"),onClick:()=>ds(this,void 0,void 0,(function*(){h&&w?(f(!0),yield p(h,w,d,t,i,(e=>{v({type:ye,payload:e}),s(""),r(""),u(Kt.Text),l(!1)})),f(!1)):console.error("Entity ID or Entity Type is missing")})),loading:x,icon:(0,a.jsx)(rs.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]})}var ps=s(72),hs=s(2601),ws=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function vs({data:e,onSave:t,locationOfCustomFields:s,onDelete:i,actionLoading:r}){const{state:{isUserAllowedToDelete:c}}=(0,n.useContext)(Bt),l=e.entity_type===s,d=s===Wt.Task||s===Wt.User,u=e.entity_type===Wt.Pipeline?"board":e.entity_type;return r?(0,a.jsx)(Be,{ovalSize:"24"}):(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-gap-2",children:[d&&(0,a.jsx)(Et,{onClick:t,icon:(0,a.jsx)(hs.A,{className:"wpqt-icon-green wpqt-size-4"}),tooltipId:`custom-field-${e.id}-update`,tooltipText:(0,o.__)("Edit custom field value","quicktasker")}),c&&(0,a.jsx)(Et,Object.assign({onClick:()=>ws(this,void 0,void 0,(function*(){l&&i()})),className:l?"":"!wpqt-cursor-not-allowed",icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-4"})},!l&&{tooltipId:`custom-field-${e.id}-delete`,tooltipText:(0,o.sprintf)((0,o.__)("This custom field is inherited from %s settings and can't be deleted here","quicktasker"),u)}))]})}var xs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function fs({data:e}){const[t,s]=(0,n.useState)(""),{state:{entityType:i,entityId:o},customFieldsDispatch:r}=(0,n.useContext)(as),{updateCustomFieldValue:c,markCustomFieldAsDeleted:l}=ls(),[d,u]=(0,n.useState)(!1);let p;switch((0,n.useEffect)((()=>{e.value&&s(e.value)}),[e.value]),e.type){case Kt.Text:p=(0,a.jsx)(qs,{data:e,value:t,onChange:s});break;case Kt.Checkbox:p=(0,a.jsx)(ms,{data:e,value:t,onChange:s})}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{}),p,(0,a.jsx)(vs,{data:e,locationOfCustomFields:i,onSave:()=>xs(this,void 0,void 0,(function*(){i===Wt.User||i===Wt.Task?(u(!0),yield c(e.id,t,o,i),u(!1)):console.error("Invalid entity type for saving custom field value")})),onDelete:()=>xs(this,void 0,void 0,(function*(){u(!0),yield l(e.id,(()=>{r({type:be,payload:e.id})})),u(!1)})),actionLoading:d})]})}function qs({data:e,value:t,onChange:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center",children:[(0,a.jsx)(gs,{name:e.name,description:e.description}),(0,a.jsx)(Yt,{value:t,onChange:s})]})}function ms({data:e,value:t,onChange:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)(gs,{name:e.name,description:e.description}),(0,a.jsx)("input",{type:"checkbox",checked:"true"===t,className:"!wpqt-block",onChange:e=>s(e.target.checked?"true":"false")})]})}function gs({name:e,description:t=""}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-mb-1 wpqt-text-base wpqt-font-semibold",children:e}),t&&(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-italic",children:t})]})}function ks(){const{state:{loading:e,customFields:t}}=(0,n.useContext)(as),[s,i]=(0,n.useState)(!1);return e?(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Ve,{width:"36",height:"36"})}):t&&0===t.length?(0,a.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No related custom fields created","quicktasker")}):s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-my-6 wpqt-grid wpqt-grid-cols-[100px_1fr_100px] wpqt-items-center wpqt-gap-3",children:t.map((e=>(0,a.jsx)(fs,{data:e},e.id)))}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Et,{text:(0,o.__)("Close","quicktasker"),onClick:()=>i(!1),icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-5"})})})]}):(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Et,{text:(0,o.__)("Show custom fields","quicktasker"),onClick:()=>i(!0),icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-blue wpqt-size-5"})})})}function js(){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center wpqt-h-full",children:[(0,a.jsx)("h2",{className:"wpqt-font-semibold",children:(0,o.__)("Custom fields")}),(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-4",children:(0,o.__)("Premium feature to create and manage custom data fields. Allows to add extra data to tasks and users.")}),(0,a.jsx)("div",{className:"wpqt-text-blue-500 wpqt-font-semibold",children:(0,a.jsx)("a",{href:"https://payhip.com/b/84TLC",target:"_blank",rel:"noreferrer",children:(0,o.__)("Get the premium version","quicktasker")})})]})}const _s={[Wt.User]:(0,o.__)("Add custom fields to this user only.","quicktasker"),[Wt.Users]:(0,o.__)("Add custom fields to all users. If you want to add custom fields to a specific user, please go to that user settings.","quicktasker"),[Wt.Pipeline]:(0,o.__)("Add custom fields to all tasks in this board.","quicktasker"),[Wt.Task]:(0,o.__)("Add custom fields to this task only. If you want to add custom fields to all tasks in this board, please go to board settings.","quicktasker")},ys={[Wt.User]:(0,o.__)("Add custom fields to this user only.","quicktasker"),[Wt.Users]:(0,o.__)("Add custom fields to all users. If you want to add custom fields to a specific user, please go to that user settings.","quicktasker"),[Wt.Pipeline]:(0,o.__)("Add custom fields to all tasks in this board.","quicktasker"),[Wt.Task]:(0,o.__)("Custom fields applied to this task, including both task-specific and board-level fields.","quicktasker")},bs={[Wt.User]:(0,o.__)("User custom fields","quicktasker"),[Wt.Users]:(0,o.__)("Users custom fields","quicktasker"),[Wt.Pipeline]:(0,o.__)("Board custom fields","quicktasker"),[Wt.Task]:(0,o.__)("Task custom fields","quicktasker")};function Cs({entityId:e,entityType:t}){const{state:{is_customFields:s}}=(0,n.useContext)(Bt),i=_s[t],o=bs[t],r=ys[t];return(0,a.jsx)(a.Fragment,{children:s?(0,a.jsx)("div",{children:(0,a.jsxs)(is,{entityId:e,entityType:t,children:[(0,a.jsx)(us,{description:i}),(0,a.jsx)("h2",{className:"wpqt-text-center",children:o}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:r}),(0,a.jsx)(ks,{})]})}):(0,a.jsx)(js,{})})}var Ss=s(2792),Os=s(6797),Ts=s(4403),Ns=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function As({task:e,onUserAdd:t,onUserDelete:s}){const{state:{users:r}}=(0,n.useContext)(mt),{dispatch:c}=(0,n.useContext)(lt),[l,d]=(0,n.useState)(!1),h=r.filter((t=>{var s;return!(null!==(s=e.assigned_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))}));return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,a.jsx)(Es,{sectionTitle:(0,o.__)("Assigned users","quicktasker"),users:e.assigned_users,onItemSelect:t=>Ns(this,void 0,void 0,(function*(){try{d(!0),yield x(t.id,e.id),c({type:T,payload:{taskId:e.id,userId:t.id}}),s(t)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to remove user","quicktasker"))}finally{d(!1)}})),ActionIcon:Os.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No users assigned","quicktasker")}),(0,a.jsx)(Es,{sectionTitle:(0,o.__)("Assign a user","quicktasker"),users:h,onItemSelect:s=>Ns(this,void 0,void 0,(function*(){try{d(!0),yield(n=s.id,a=e.id,u()({path:`/wpqt/v1/users/${n}/tasks`,method:"POST",data:{task_id:a},headers:p()})),c({type:O,payload:{taskId:e.id,user:s}}),t(s)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to assign user","quicktasker"))}finally{d(!1)}var n,a})),actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No users available to assign","quicktasker")}),l&&(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Ve,{width:"30",height:"30"})})]})}function Es({sectionTitle:e,onItemSelect:t=()=>{},users:s=[],ActionIcon:n=Ts.A,actionIconClasses:i,noUsersText:o}){return(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-text-lg",children:e}),s.map((e=>(0,a.jsxs)("div",{onClick:s=>{s.stopPropagation(),t(e)},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-px-2 wpqt-py-1 hover:wpqt-bg-gray-100",children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,a.jsx)("div",{children:e.name}),(0,a.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,a.jsx)(n,{className:`wpqt-ml-auto wpqt-size-5 ${i}`})]},e.id))),0===s.length&&(0,a.jsx)("div",{children:o})]})}var Ps=s(2185);function Ds({children:e,menuBtn:t,menuBtnClasses:s="",anchor:n="bottom end"}){return(0,a.jsxs)(Ps.W1,{children:[(0,a.jsx)(Ps.IU,{as:"div",className:`wpqt-cursor-pointer ${s}`,onClick:e=>e.stopPropagation(),children:({active:e})=>(0,a.jsx)(a.Fragment,{children:t({active:e})})}),(0,a.jsx)(Ps.c,{anchor:n,transition:!0,className:"wpqt-z-20 wpqt-origin-top wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-white wpqt-p-4 wpqt-transition wpqt-duration-200 wpqt-ease-out data-[closed]:wpqt-scale-95 data-[closed]:wpqt-opacity-0",children:e})]})}function Is({isActive:e,IconComponent:t}){return(0,a.jsx)(t,{className:"wpqt-size-6 wpqt-text-gray-400 hover:wpqt-text-qtBlueHover "+(e?"wpqt-text-qtBlueHover":"")})}function Rs({text:e,onClick:t,icon:s,className:n,disabled:i=!1,id:o="",tooltipText:r="",loading:c=!1}){const l=""!==r&&""!==o?{"data-tooltip-id":o,"data-tooltip-content":r,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsx)(Ps.Dr,{children:(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-relative ${i?"wpqt-cursor-not-allowed wpqt-line-through":"wpqt-cursor-pointer hover:wpqt-underline"} ${n}`,onClick:e=>{!i&&t&&t(e)},children:[s,(0,a.jsx)("span",{className:c?"wpqt-invisible":"",children:e}),c&&(0,a.jsx)(Ve,{width:"16",height:"16",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-y-center wpqt-transform-x-center"}),(0,a.jsx)(At,{id:o})]}))})}function Us({task:e,onUserAdd:t=()=>{},onUserDelete:s=()=>{},menuBtnClasses:n=""}){const i=e.assigned_users&&e.assigned_users.length>0;return(0,a.jsx)(Ds,{menuBtnClasses:`wpqt-inline-flex ${n}`,anchor:"bottom start",menuBtn:()=>(0,a.jsxs)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:[(0,a.jsx)(Ss.A,{className:`wpqt-mr-1 wpqt-size-5 ${i?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`}),e.assigned_users&&(0,a.jsx)("div",{children:e.assigned_users.map(((t,s)=>(0,a.jsxs)("span",{children:[t.name,s<e.assigned_users.length-1&&", "]},t.id)))})]}),children:(0,a.jsx)(As,{task:e,onUserAdd:t,onUserDelete:s})})}var Ls=s(1848);function Fs({tabs:e,tabsContent:t,tabClassName:s="",tabListClassName:n=""}){return(0,a.jsxs)(Ls.fu,{children:[(0,a.jsx)(Ls.wb,{className:`wpqt-mb-6 wpqt-flex wpqt-border-0 wpqt-border-b wpqt-border-solid wpqt-border-b-gray-300 ${n}`,children:e.map((e=>(0,a.jsx)(Ms,{className:s,children:e},e)))}),(0,a.jsx)(Ls.T2,{children:t.map(((e,t)=>(0,a.jsx)(zs,{children:e},t)))})]})}function Ms({children:e,className:t}){return(0,a.jsx)(Ls.oz,{as:"div",className:`wpqt-flex-1 wpqt-cursor-pointer wpqt-p-1 wpqt-pb-[10px] wpqt-text-center wpqt-text-lg data-[selected]:wpqt-border-b-2 data-[selected]:wpqt-border-l-0 data-[selected]:wpqt-border-r-0 data-[selected]:wpqt-border-t-0 data-[selected]:wpqt-border-solid data-[selected]:wpqt-border-b-blue-500 ${t}`,children:e})}function zs({children:e}){return(0,a.jsx)(Ls.Kp,{children:e})}var $s=s(4353),Vs=s.n($s),Hs=s(8569),Bs=s.n(Hs),Gs=s(3826),Ks=s.n(Gs);Vs().extend(Ks()),Vs().extend(Bs());const Ws=()=>{const{state:{timezone:e}}=(0,n.useContext)(Bt);return{convertToWPTimezone:t=>((e,t)=>{try{return Vs().utc(e).tz(t).format("MMMM D, YYYY HH:mm")}catch(t){return console.error("Error: ",t),e+" (UTC)"}})(t,e)}},Qs=({log:e})=>{const{convertToWPTimezone:t}=Ws();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,a.jsx)("div",{className:"wpqt-text-center",children:e.created_by===Ee.Admin?(0,o.__)("Admin","quicktasker"):(0,o.__)("QuickTasker","quicktasker")})]}),(0,a.jsx)("div",{children:e.text}),(0,a.jsx)("div",{children:t(e.created_at)})]})};var Ys=s(3338),Xs=s(3211),Js=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Zs({typeId:e,fetchData:t,renderItem:s,noDataMessage:i,explanation:o,onAdd:r=()=>Js(this,void 0,void 0,(function*(){})),enableAdd:c=!1}){const[l,d]=(0,n.useState)(null),[u,p]=(0,n.useState)(""),[h,w]=(0,n.useState)(!0),[v,x]=(0,n.useState)(!1);(0,n.useEffect)((()=>{f()}),[e]);const f=()=>Js(this,void 0,void 0,(function*(){w(!0);const e=yield t();e&&d(e),w(!1)}));return null===l?(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Ve,{width:"30",height:"30"})}):(0,a.jsxs)("div",{children:[o&&(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center wpqt-font-semibold",children:o}),0===l.length&&(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center",children:i}),l.length>0&&(0,a.jsx)("div",{className:"wpqt-mb-[28px] wpqt-mt-[56px] wpqt-logs-grid",children:l.map((e=>s(e)))}),(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-justify-center",children:(0,a.jsx)(en,{isLoading:h,refreshComemnts:f})}),c&&(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsxs)("div",{className:"wpqt-w-2/3",children:[(0,a.jsx)(Zt,{rowsCount:3,value:u,onChange:e=>p(e),className:"wpqt-mb-4 wpqt-w-full"}),(0,a.jsx)(Et,{text:"Add comment",loading:v,onClick:()=>Js(this,void 0,void 0,(function*(){x(!0);const e=yield r(u);e&&(d((t=>t?[...t,e]:[e])),p("")),x(!1)})),className:"wpqt-float-right",icon:(0,a.jsx)(Ys.A,{className:"wpqt-icon-blue wpqt-size-5"})})]})})]})}function en({isLoading:e,refreshComemnts:t}){return(0,a.jsx)(a.Fragment,{children:e?(0,a.jsx)(Ve,{width:"32",height:"32"}):(0,a.jsx)(Xs.A,{className:"wpqt-icon-blue wpqt-size-8 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:t})})}function tn({item:e}){const{convertToWPTimezone:t}=Ws();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,a.jsx)("div",{className:"wpqt-text-center",children:e.is_admin_comment?(0,o.__)("Admin","quicktasker"):(0,o.__)("QuickTasker","quicktasker")})]}),(0,a.jsx)("div",{children:e.text}),(0,a.jsx)("div",{children:t(e.created_at)})]})}var sn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function nn({taskId:e}){return(0,a.jsx)(Zs,{typeId:e,fetchData:()=>sn(this,void 0,void 0,(function*(){try{return(yield v(e,Ae.Task)).data}catch(e){console.error(e),i.oR.error("Failed to get log")}})),renderItem:e=>(0,a.jsx)(Qs,{log:e}),noDataMessage:"No logs available",explanation:"Logs can be seen only by WordPress users (with required permissions)"})}var an=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function on(){return{addComment:(e,t,s,n)=>an(this,void 0,void 0,(function*(){try{const a=yield w(e,t,s,n);return i.oR.success((0,o.__)("Comment added","quicktasker")),a.data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add comment","quicktasker"))}}))}}const rn=e=>Object.assign(Object.assign({},e),{is_admin_comment:"1"===e.is_admin_comment});var cn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ln({taskId:e}){const{addComment:t}=on();return(0,a.jsx)(Zs,{typeId:e,fetchData:()=>cn(this,void 0,void 0,(function*(){try{return(yield h(e,Ae.Task,!0)).data.map(rn)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>cn(this,void 0,void 0,(function*(){const n=yield t(e,Ae.Task,!0,s);if(n)return rn(n)})),renderItem:e=>(0,a.jsx)(tn,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed only by WordPress users (with required permissions).",enableAdd:!0})}var dn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function un({taskId:e}){const{addComment:t}=on();return(0,a.jsx)(Zs,{typeId:e,fetchData:()=>dn(this,void 0,void 0,(function*(){try{return(yield h(e,Ae.Task,!1)).data.map(rn)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>dn(this,void 0,void 0,(function*(){const n=yield t(e,Ae.Task,!1,s);if(n)return rn(n)})),renderItem:e=>(0,a.jsx)(tn,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed by WordPress users (with required permissions) and QuickTasker users who have been assigned to the task.",enableAdd:!0})}function pn({task:e}){return(0,a.jsx)(Fs,{tabs:["Private comments","Public comments","Logs"],tabsContent:[(0,a.jsx)(ln,{taskId:e.id},1),(0,a.jsx)(un,{taskId:e.id},2),(0,a.jsx)(nn,{taskId:e.id},3)]})}var hn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const wn=(0,n.forwardRef)((({taskModalSaving:e,editTask:t,deleteTask:s},i)=>{const{state:{taskToEdit:r,taskModalSettings:c},modalDispatch:l}=(0,n.useContext)(wt),{state:{isUserAllowedToDelete:d}}=(0,n.useContext)(Bt),{state:{activePipeline:u},fetchAndSetPipelineData:p}=(0,n.useContext)(lt),{archiveDispatch:h}=(0,n.useContext)(Me),[w,v]=(0,n.useState)(""),[x,f]=(0,n.useState)(""),[q,m]=(0,n.useState)(!1),{archiveTask:g,restoreArchivedTask:k}=ot(),{loading1:j,setLoading1:_,loading2:y,setLoading2:b}=$t(),C=null==r?void 0:r.is_archived,S=null!==(null==r?void 0:r.pipeline_name);(0,n.useEffect)((()=>{r&&(v(r.name),f(r.description),m(r.free_for_all))}),[r]);const O=()=>{v(""),f("")};return(0,n.useImperativeHandle)(i,(()=>({clearContent:O}))),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,a.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsxs)(It,{children:[(0,a.jsx)(Rt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Yt,{isAutoFocus:!0,value:w,onChange:e=>v(e)})}),(0,a.jsx)(Rt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Zt,{rowsCount:3,value:x,onChange:e=>f(e)})}),(0,a.jsx)(Rt,{label:(0,o.__)("Assigned users","quicktasker"),children:(0,a.jsx)(Us,{task:r,onUserAdd:e=>{l({type:V,payload:e})},onUserDelete:e=>{l({type:H,payload:e})}})}),(0,a.jsx)(Rt,{label:(0,o.__)("Free for all task","quicktasker"),tooltipId:`free-for-all-${r.id}-tooltip`,tooltipText:(0,o.__)("When enabled, all QuickTasker users have the ability to self-assign or unassign this task.","quicktasker"),children:(0,a.jsx)(ts,{checked:q,handleChange:m})}),c.allowToMarkTaskAsDone&&(0,a.jsx)(vn,{taskId:r.id,isCompleted:r.is_done})]}),(0,a.jsx)("div",{children:(0,a.jsx)(Cs,{entityId:r.id,entityType:Wt.Task})})]}),(0,a.jsx)("div",{className:"wpqt-mt-7 md:wpqt-pr-3",children:(0,a.jsx)(pn,{task:r})})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[C&&S&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Lt.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Restore task","quicktasker"),onClick:()=>{k(r.id,(()=>{l({type:D}),h({type:Q,payload:r.id})}))}}),!C&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("Archive task","quicktasker"),loading:y,onClick:()=>{b(!0),g(r.id,(()=>{l({type:D}),p(u.id),b(!1)}))}}),d&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete task","quicktasker"),loading:j,onClick:()=>hn(void 0,void 0,void 0,(function*(){_(!0),yield s(r),l({type:D}),_(!1)}))})]})]}),(0,a.jsx)(Ut,{onSave:()=>{r&&t(Object.assign(Object.assign({},r),{name:w,description:x,free_for_all:q}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));function vn({isCompleted:e,taskId:t}){const{modalDispatch:s}=(0,n.useContext)(wt),{dispatch:i}=(0,n.useContext)(lt),[r,c]=(0,n.useState)(!1),{changeTaskDoneStatus:l}=ot();return(0,a.jsx)(Rt,{label:e?(0,o.__)("Task completed","quicktasker"):(0,o.__)("Task not completed","quicktasker"),children:r?(0,a.jsx)(Ve,{width:"24",height:"24"}):(0,a.jsx)(zt.A,{onClick:()=>hn(this,void 0,void 0,(function*(){c(!0),yield l(t,!e,(e=>{s({type:N,payload:{done:e}}),i({type:N,payload:{taskId:t,done:e}})})),c(!1)})),className:`wpqt-size-6 ${e?"wpqt-icon-green":"wpqt-text-gray-300"} wpqt-cursor-pointer`})})}var xn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function fn({editTaskCallback:e,deleteTaskCallback:t}){const{state:{taskModalOpen:s}}=(0,n.useContext)(wt),{deleteTask:i}=ot(),{modalSaving:o,setModalSaving:r,modalContentRef:c,closeModal:l,handleSuccess:d,handleError:h}=jt(D);return(0,a.jsx)(Pt,{modalOpen:s,closeModal:l,size:"xl",children:(0,a.jsx)(wn,{ref:c,editTask:t=>xn(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e){return u()({path:`/wpqt/v1/tasks/${e.id}`,method:"PATCH",data:{id:e.id,name:e.name,description:e.description,freeForAll:e.free_for_all},headers:p()})}(t);d(j,s.data,kt.ACTIVE_PIPELINE),e&&e(s.data)}catch(e){h(e)}})),deleteTask:e=>xn(this,void 0,void 0,(function*(){i(e.id,(()=>{t&&t(e)}))})),taskModalSaving:o})})}function qn({text:e=(0,o.__)("No results found","quicktasker")}){return(0,a.jsx)("div",{className:"wpqt-font-semibold",children:e})}const mn=()=>{const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s}}=(0,n.useContext)(Me);return{filterArchive:n=>{const a=n.name.toLowerCase().includes(e.toLowerCase())||n.description&&n.description.toLowerCase().includes(e.toLowerCase()),i=!t||("DELETED"===t?null===n.pipeline_name:n.pipeline_id===t),o=s===Pe.All||s===Pe.Completed&&n.is_done||s===Pe.NotCompleted&&!n.is_done;return a&&i&&o}}};var gn=s(3033);function kn({className:e,onClick:t,title:s,description:n,children:i,dropdown:o}){const r=void 0!==o;return(0,a.jsxs)("div",{className:(0,Jt.$)("wpqt-relative wpqt-flex wpqt-flex-col wpqt-rounded wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-4",r&&"wpqt-pr-[24px]",e),onClick:t,children:[(0,a.jsxs)("div",{className:"wpqt-mb-3",children:[(0,a.jsx)("div",{className:"wpqt-text-lg",children:s}),n&&(0,a.jsx)("div",{className:"wpqt-italic wpqt-text-gray-500",children:n})]}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-h-full",children:i}),r&&(0,a.jsx)("div",{className:"wpqt-absolute wpqt-right-2 wpqt-top-1 wpqt-z-10",children:o})]})}function jn({label:e,value:t,valueClassName:s="",valueLink:n,icon:i,onClick:o=()=>{},className:r="",labelClassName:c=""}){return(0,a.jsxs)("div",{className:`wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center ${r}`,onClick:o,children:[i&&i,(0,a.jsx)("div",{className:c,children:t?`${e}:`:e}),(0,a.jsx)("div",{className:`${s}`,children:n?(0,a.jsx)("a",{href:n,target:"_blank",className:"wpqt-text-qtTextBlue wpqt-no-underline",rel:"noreferrer",onClick:e=>e.stopPropagation(),children:t}):t})]})}var _n=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function yn({task:e,onDoneStatusChange:t,className:s=""}){const{changeTaskDoneStatus:i}=ot(),[o,r]=(0,n.useState)(!1),c=e.is_done,l=s=>_n(this,void 0,void 0,(function*(){r(!0),yield i(e.id,s,(s=>{t(e.id,s)})),r(!1)}));return o?(0,a.jsx)(Be,{ovalSize:"24",className:"wpqt-mt-auto"}):(0,a.jsx)("div",{className:`wpqt-flex wpqt-justify-center wpqt-mt-auto ${s}`,children:c?(0,a.jsx)(zt.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,a.jsx)(zt.A,{className:"wpqt-size-6 wpqt-text-gray-300",onClick:e=>{e.stopPropagation(),l(!0)}})})}var bn=s(6436),Cn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Sn({task:e}){const{state:{isUserAllowedToDelete:t}}=(0,n.useContext)(Bt),{archiveDispatch:s}=(0,n.useContext)(Me),{deleteTask:i,restoreArchivedTask:o}=ot(),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),u=null!==e.pipeline_name;return(0,a.jsxs)(Ds,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:bn.A}),children:[(0,a.jsx)(Rs,{text:"View task",icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-blue wpqt-size-4"})}),(0,a.jsx)(Rs,{text:"Restore task",loading:r,icon:(0,a.jsx)(Lt.A,{className:"wpqt-icon-green wpqt-size-4"}),disabled:!u,id:`restore-task-${e.id}-dropdown-item`,tooltipText:"Task cannot be restored because the board has been deleted.",onClick:t=>Cn(this,void 0,void 0,(function*(){t.stopPropagation(),c(!0),yield o(e.id,(()=>{s({type:Q,payload:e.id})})),c(!1)}))}),t&&(0,a.jsx)(Rs,{text:"Delete",loading:l,icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Cn(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield i(e.id,(()=>{s({type:Q,payload:e.id})})),d(!1)})),className:"!wpqt-mb-0"})]})}function On({task:e}){const{modalDispatch:t}=(0,n.useContext)(wt),{archiveDispatch:s}=(0,n.useContext)(Me);return(0,a.jsxs)(kn,{title:e.name,description:e.description,dropdown:(0,a.jsx)(Sn,{task:e}),className:"wpqt-cursor-pointer",onClick:()=>{t({type:P,payload:{taskToEdit:e}})},children:[(0,a.jsx)(jn,{label:(0,o.__)("Board","quicktasker"),value:e.pipeline_name?e.pipeline_name:(0,o.__)("Board is deleted!","quicktasker"),icon:(0,a.jsx)(gn.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(Us,{menuBtnClasses:"wpqt-self-start",task:e,onUserAdd:t=>{s({type:Y,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{s({type:X,payload:{taskId:e.id,user:t}})}}),(0,a.jsx)(yn,{task:e,onDoneStatusChange:(e,t)=>{s({type:J,payload:{taskId:e,done:t}})}})]})}function Tn(){var e;const{state:{archivedTasks:t=[]}}=(0,n.useContext)(Me),{filterArchive:s}=mn(),i=null!==(e=null==t?void 0:t.filter(s))&&void 0!==e?e:[];return t&&0===t.length?(0,a.jsx)(qn,{text:(0,o.__)("No tasks archived","quicktasker")}):i&&0===i.length?(0,a.jsx)(qn,{}):(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"wpqt-card-grid",children:i.map((e=>(0,a.jsx)(On,{task:e},e.id)))})})}function Nn(){const{state:{archivedTasks:e},archiveDispatch:t}=(0,n.useContext)(Me);return e?(0,a.jsxs)("div",{children:[(0,a.jsx)(at,{}),(0,a.jsx)(Tn,{}),(0,a.jsx)(fn,{editTaskCallback:e=>{t({type:Z,payload:e})},deleteTaskCallback:e=>{t({type:Q,payload:e.id})}})]}):(0,a.jsx)(Be,{className:"wpqt-h-[200px]"})}function An(){return(0,a.jsx)(ze,{children:(0,a.jsxs)(Ge,{children:[(0,a.jsx)(l,{description:(0,o.__)("Archived tasks management page.","quicktasker"),children:(0,o.__)("Archive","quicktasker")}),(0,a.jsx)(Nn,{})]})})}const En=()=>{const{state:{pluginURL:e}}=(0,n.useContext)(Bt);return(0,a.jsxs)(Ge,{children:[(0,a.jsx)(l,{description:(0,o.__)("Reading material about QuickTasker features and usage.","quicktasker"),children:(0,o.__)("Guide","quicktasker")}),(0,a.jsx)("div",{children:(0,a.jsx)("a",{target:"_blank",rel:"noreferrer",href:e+"help/index.html",children:(0,o.__)("View Guide","quicktasker")})})]})};var Pn=s(4175);const Dn=({filterSettings:e,setFilterSettings:t})=>{const{state:{pipelines:s}}=(0,n.useContext)(Je),[i,r]=(0,n.useState)(e);return(0,a.jsxs)(nt,{title:(0,o.__)("Logs filtering","quicktasker"),children:[(0,a.jsx)(tt,{allSelector:!1,selectedOptionValue:i.type,options:[{label:(0,o.__)("All types","quicktasker"),value:Rn.All},{label:(0,o.__)("Board","quicktasker"),value:Rn.Pipeline},{label:(0,o.__)("Stage","quicktasker"),value:Rn.Stage},{label:(0,o.__)("Task","quicktasker"),value:Rn.Task}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{type:e,typeId:""}))}}),i.type===Rn.Pipeline&&(0,a.jsx)(tt,{allSelector:!0,selectedOptionValue:i.typeId,options:s.map((e=>({label:e.name,value:e.id}))),onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{typeId:e}))}}),(0,a.jsx)(tt,{allSelector:!1,selectedOptionValue:i.createdBy,options:[{label:(0,o.__)("Everyone","quicktasker"),value:Un.All},{label:(0,o.__)("Admin","quicktasker"),value:Un.Admin},{label:"QuickTasker",value:Un.Quicktasker}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{createdBy:e}))}}),(0,a.jsx)(tt,{allSelector:!1,selectedOptionValue:i.numberOfLogs,options:[{label:(0,o.__)("Show 100","quicktasker"),value:Fn.Hundred},{label:(0,o.__)("Show 200","quicktasker"),value:Fn.TwoHundred},{label:"Show 500",value:Fn.FiveHundred},{label:"Show all",value:Fn.All}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{numberOfLogs:e}))}}),(0,a.jsx)(tt,{allSelector:!1,selectedOptionValue:i.order,options:[{label:(0,o.__)("ASC","quicktasker"),value:Ln.Asc},{label:(0,o.__)("DESC","quicktasker"),value:Ln.Desc}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{order:e}))}}),(0,a.jsx)(Et,{text:(0,o.__)("Apply filter","quicktasker"),icon:(0,a.jsx)(Pn.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:()=>t(i)})]})},In=({logs:e,loading:t})=>t?(0,a.jsx)(Be,{ovalSize:"64",className:"wpqt-mt-12"}):(0,a.jsx)("div",{className:"wpqt-logs-grid",children:e.map((e=>(0,a.jsx)(Qs,{log:e},e.id)))});var Rn,Un,Ln,Fn,Mn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};!function(e){e.Pipeline="pipeline",e.Stage="stage",e.Task="task",e.All="all"}(Rn||(Rn={})),function(e){e.Admin="admin",e.Quicktasker="quicktasker_user",e.All="all"}(Un||(Un={})),function(e){e.Asc="asc",e.Desc="desc"}(Ln||(Ln={})),function(e){e.Hundred="100",e.TwoHundred="200",e.FiveHundred="500",e.All="all"}(Fn||(Fn={}));const zn=()=>{const[e,t]=(0,n.useState)([]),[s,o]=(0,n.useState)({numberOfLogs:Fn.Hundred,type:Rn.All,typeId:"",createdBy:Un.All,order:Ln.Desc}),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!0);(0,n.useEffect)((()=>{l&&(h(),d(!1))}),[s,l]);const h=()=>Mn(void 0,void 0,void 0,(function*(){try{c(!0);const e=Object.assign({},s);e.numberOfLogs===Fn.All&&delete e.numberOfLogs,e.type===Rn.All&&delete e.type,""===e.typeId&&delete e.typeId,e.createdBy===Un.All&&delete e.createdBy;const n=yield function(e){const t=new URLSearchParams(Object.entries(e).reduce(((e,[t,s])=>(e[t]=String(s),e)),{}));return u()({path:`/wpqt/v1/global-logs?${t.toString()}`,method:"GET",headers:p()})}(e);t(n.data)}catch(e){console.error(e),i.oR.error("Failed to fetch logs")}finally{c(!1)}}));return(0,a.jsxs)("div",{children:[(0,a.jsx)(Dn,{filterSettings:s,setFilterSettings:e=>Mn(void 0,void 0,void 0,(function*(){o(e),d(!0)}))}),(0,a.jsx)(In,{logs:e,loading:r})]})},$n=()=>(0,a.jsxs)(Ge,{children:[(0,a.jsx)(l,{description:(0,o.__)("The logs page where you can see all logs and filter them.","quicktasker"),children:(0,o.__)("Logs","quicktasker")}),(0,a.jsx)(zn,{})]});var Vn=s(6708);function Hn({overviewFilter:e,onCreationDateChange:t,onDoneDateChange:s}){const n=e=>e instanceof Date?Vs()(e).format("YYYY-MM-DD"):"";return(0,a.jsx)("div",{children:(0,a.jsxs)(nt,{title:(0,o.__)("Statistics filtering","quicktasker"),titleClassName:"wpqt-text-center",childrenClassName:"wpqt-gap-6 wpqt-justify-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task creation date","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("(Filter tasks that have creation date equal or bigger than)","quicktasker")})]}),(0,a.jsx)(Vn.A,{onChange:e=>{const s=n(e);t(s)},value:e.taskCreationDate,format:"y-MM-dd",id:"taskCreationDate"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task done date","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("(Filter tasks that have done date equal or smaller than)","quicktasker")})]}),(0,a.jsx)(Vn.A,{onChange:e=>{const t=n(e);s(t)},value:e.taskDoneDate,format:"y-MM-dd",id:"taskCreationDate"})]})]})})}var Bn=s(2298);function Gn(e){const t=e.slice(1).some((e=>e[1]>0));return e.length>1&&t}function Kn({text:e}){return(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-items-center wpqt-h-[400px] wpqt-w-[500px] wpqt-font-semibold",children:e})}function Wn({pipelineOverviewData:e,options:t,width:s}){var n,i;const r=[["Archived tasks","Task Count"],["Archived tasks",parseInt(null!==(n=null==e?void 0:e.archivedTasksCount)&&void 0!==n?n:"0")||0],["Not archived tasks",parseInt(null!==(i=null==e?void 0:e.notArchivedTasksCount)&&void 0!==i?i:"0")||0]];return Gn(r)?(0,a.jsx)(Bn.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Archived tasks"}),width:s,height:"400px"}):(0,a.jsx)(Kn,{text:(0,o.__)("Not enough data to display archived tasks chart","quicktasker")})}function Qn({pipelineOverviewData:e,options:t,width:s}){var n;const i=[["Stage","Task Count"],...null!==(n=null==e?void 0:e.stages.map((e=>[e.name,parseInt(e.tasksCount)||0])))&&void 0!==n?n:[]];return Gn(i)?(0,a.jsx)(Bn.t1,{chartType:"PieChart",data:i,options:Object.assign(Object.assign({},t),{title:"Task distribution by stages"}),width:s,height:"400px"}):(0,a.jsx)(Kn,{text:(0,o.__)("Not enough data to display task distribution by stages chart","quicktasker")})}function Yn({pipelineOverviewData:e,options:t,width:s}){var n,i;const r=[["Task status","Task Count"],["Done",parseInt(null!==(n=null==e?void 0:e.doneTasksCount)&&void 0!==n?n:"0")||0],["Not Done",parseInt(null!==(i=null==e?void 0:e.notDoneTasksCount)&&void 0!==i?i:"0")||0]];return Gn(r)?(0,a.jsx)(Bn.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Task status"}),width:s,height:"400px"}):(0,a.jsx)(Kn,{text:(0,o.__)("Not enough data to display task status chart","quicktasker")})}var Xn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Jn={legend:{position:"left",alignment:"center",textStyle:{color:"#233238",fontSize:14}}};function Zn({pipeline:e,overviewFilter:t}){const[s,i]=(0,n.useState)(null),[o,r]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{(()=>{Xn(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e,t){const s=new URLSearchParams({taskStartDate:t.taskCreationDate||"",taskDoneDate:t.taskDoneDate||"",taskAssignees:t.taskAssignees.join(",")});return u()({path:`/wpqt/v1/pipelines/${e}/overview?${s.toString()}`,method:"GET",headers:p()})}(e.id,t);i(s.data)}catch(e){console.error(e)}finally{r(!1)}}))})()}),[e.id,t]),o||!s?(0,a.jsx)(Be,{ovalSize:"48"}):(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-wrap wpqt-justify-center xl:wpqt-justify-start",children:[(0,a.jsx)(Qn,{pipelineOverviewData:s,options:Jn,width:"500px"}),(0,a.jsx)(Yn,{pipelineOverviewData:s,options:Jn,width:"500px"}),(0,a.jsx)(Wn,{pipelineOverviewData:s,options:Jn,width:"500px"})]})}function ea({pipeline:e}){const[t,s]=(0,n.useState)({taskCreationDate:null,taskDoneDate:null,taskAssignees:[]});return(0,a.jsxs)("div",{children:[(0,a.jsx)(Hn,{overviewFilter:t,onCreationDateChange:e=>{s(Object.assign(Object.assign({},t),{taskCreationDate:e}))},onDoneDateChange:e=>{s(Object.assign(Object.assign({},t),{taskDoneDate:e}))}}),(0,a.jsx)(Zn,{pipeline:e,overviewFilter:t})]})}function ta(){const{state:{pipelines:e}}=(0,n.useContext)(Je),t=e.map((e=>e.name)),s=e.map((e=>(0,a.jsx)(ea,{pipeline:e},e.id)));return(0,a.jsxs)(Ge,{children:[(0,a.jsx)(l,{description:(0,o.__)("Get overview of the tasks.","quicktasker"),children:(0,o.__)("Overview","quicktasker")}),(0,a.jsx)(Fs,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}const sa=(0,n.forwardRef)((({addPipeline:e,modalSaving:t},s)=>{const[i,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(""),d=()=>{r(""),l("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:d}))),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(It,{children:[(0,a.jsx)(Rt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Yt,{isAutoFocus:!0,value:i,onChange:e=>r(e)})}),(0,a.jsx)(Rt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Zt,{rowsCount:3,value:c,onChange:e=>l(e)})})]}),(0,a.jsx)(Ut,{onSave:()=>{e(i,c)},loading:t,saveBtnText:(0,o.__)("Add board","quicktasker")})]})}));function na(){const{state:{newPipelineModalOpen:e}}=(0,n.useContext)(wt),{fetchAndSetPipelineData:t}=(0,n.useContext)(lt),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=jt(M);return(0,a.jsx)(Pt,{modalOpen:e,closeModal:r,children:(0,a.jsx)(sa,{ref:o,addPipeline:(e,s)=>{return n=this,a=void 0,r=function*(){try{i(!0);const o=yield(n=e,a=s,u()({path:"/wpqt/v1/pipelines",method:"POST",data:{name:n,description:a},headers:p()}));c(y,o.data,kt.PIPELINES),t(o.data.id)}catch(e){l(e)}var n,a},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{c(r.next(e))}catch(e){t(e)}}function i(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,i)}c((r=r.apply(n,a||[])).next())}));var n,a,o,r},modalSaving:s,setModalSaving:i})})}function aa(){return{deletePipeline:(e,t)=>{return s=this,n=void 0,r=function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,method:"DELETE",headers:p()})}(e);t&&t(s.data.deletedPipelineId,s.data.pipelineIdToLoad)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete board","quicktasker"))}},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{c(r.next(e))}catch(e){t(e)}}function o(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(i,o)}c((r=r.apply(s,n||[])).next())}));var s,n,a,r}}}const ia=(0,n.forwardRef)((({editPipeline:e,modalSaving:t},s)=>{const{state:{pipelineToEdit:r},modalDispatch:c}=(0,n.useContext)(wt),{fetchAndSetPipelineData:l,dispatch:d}=(0,n.useContext)(lt),{pipelinesDispatch:u}=(0,n.useContext)(Je),{deletePipeline:p}=aa(),[h,w]=(0,n.useState)(""),[v,x]=(0,n.useState)(""),{loading1:f,setLoading1:q}=$t();(0,n.useEffect)((()=>{r&&(w(r.name),x(r.description||""))}),[r]);const m=()=>{w(""),x("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:m}))),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsx)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:(0,a.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsxs)(It,{children:[(0,a.jsx)(Rt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Yt,{isAutoFocus:!0,value:h,onChange:e=>w(e)})}),(0,a.jsx)(Rt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Zt,{rowsCount:3,value:v,onChange:e=>x(e)})})]}),(0,a.jsx)(Cs,{entityId:r.id,entityType:Wt.Pipeline})]})}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:(0,a.jsx)(Et,{icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:f,text:(0,o.__)("Delete board","quicktasker"),onClick:()=>{r&&(q(!0),p(r.id,((e,t)=>{c({type:M}),q(!1),i.oR.success((0,o.__)("Board deleted","quicktasker")),u({type:A,payload:e}),null!==t?(u({type:C,payload:t}),l(t)):d({type:E})})))}})})]}),(0,a.jsx)(Ut,{onSave:()=>{r&&e(Object.assign(Object.assign({},r),{name:h,description:v}))},loading:t,saveBtnText:(0,o.__)("Save","quicktasker")})]}):null}));function oa(){const{state:{pipelineModalOpen:e}}=(0,n.useContext)(wt),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r,handleError:c}=jt(M);return(0,a.jsx)(Pt,{modalOpen:e,closeModal:o,size:"xl",children:(0,a.jsx)(ia,{ref:i,editPipeline:e=>{return t=this,n=void 0,i=function*(){try{s(!0);const t=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description,is_primary:e.is_primary},headers:p()})}(e);r(b,t.data,kt.ACTIVE_PIPELINE)}catch(e){c(e)}},new((a=void 0)||(a=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,n||[])).next())}));var t,n,a,i},modalSaving:t,setModalSaving:s})})}var ra=s(9919);const ca=(0,n.forwardRef)((({editStage:e,addStage:t,stageModalSaving:s},i)=>{const{state:{stageToEdit:r}}=(0,n.useContext)(wt),[c,l]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),p=!!r;(0,n.useEffect)((()=>{r&&(l(r.name),u(r.description))}),[r]);const h=()=>{l(""),u("")};return(0,n.useImperativeHandle)(i,(()=>({clearContent:h}))),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Dt,{children:p?(0,o.__)("Edit Stage","quicktasker"):(0,o.__)("Add Stage","quicktasker")}),(0,a.jsxs)(It,{children:[(0,a.jsx)(Rt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Yt,{isAutoFocus:!0,value:c,onChange:e=>l(e)})}),(0,a.jsx)(Rt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Zt,{rowsCount:3,value:d,onChange:e=>u(e)})})]}),(0,a.jsx)(Ut,{onSave:()=>{p?e(Object.assign(Object.assign({},r),{name:c,description:d})):t(c,d)},loading:s,saveBtnText:p?(0,o.__)("Save","quicktasker"):(0,o.__)("Add stage","quicktasker")})]})}));var la=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function da(){const{state:{stageModalOpen:e,targetPipelineId:t}}=(0,n.useContext)(wt),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=jt(R);return(0,a.jsx)(Pt,{modalOpen:e,closeModal:r,children:(0,a.jsx)(ca,{ref:o,editStage:e=>la(this,void 0,void 0,(function*(){try{i(!0);const t=yield function(e){return u()({path:`/wpqt/v1/stages/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description},headers:p()})}(e);c(_,t.data,kt.ACTIVE_PIPELINE)}catch(e){l(e)}})),addStage:(e,s)=>la(this,void 0,void 0,(function*(){try{i(!0);const r=yield(n=t,a=e,o=s,u()({path:"/wpqt/v1/stages",method:"POST",data:{pipelineId:n,name:a,description:o},headers:p()}));c(g,Object.assign(Object.assign({},r.data),{tasks:[]}),kt.ACTIVE_PIPELINE)}catch(e){l(e)}var n,a,o})),stageModalSaving:s,stageTaskModalSaving:i})})}function ua({pipelineId:e,stagesLength:t=0}){const{modalDispatch:s}=(0,n.useContext)(wt),i=()=>{return t=this,n=void 0,i=function*(){s({type:I,payload:{targetPipelineId:e}})},new((a=void 0)||(a=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,n||[])).next())}));var t,n,a,i};return 0===t?(0,a.jsx)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-w-full wpqt-items-center wpqt-justify-center",children:(0,a.jsxs)("div",{className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-gap-y-1 wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,a.jsx)(rs.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,a.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add first stage","quicktasker")})]})}):(0,a.jsxs)("div",{className:"wpqt-main-border wpqt-mb-3 wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-self-start wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,a.jsx)(rs.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,a.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add stage","quicktasker")})]})}function pa(){const{modalDispatch:e}=(0,n.useContext)(wt);return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-items-center wpqt-justify-center",children:(0,a.jsxs)("div",{onClick:()=>{return t=this,s=void 0,a=function*(){e({type:L})},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:[(0,a.jsx)(rs.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer"}),(0,a.jsx)("span",{children:(0,o.__)("Add your first Board","quicktasker")})]})})}var ha=s(12),wa=s(5575),va=s(6304),xa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function fa({stage:e}){var t,s,r,c;const{dispatch:l,state:{activePipeline:d},fetchAndSetPipelineData:h}=(0,n.useContext)(lt),{modalDispatch:w}=(0,n.useContext)(wt),{state:{isUserAllowedToDelete:v}}=(0,n.useContext)(Bt),[x,f]=(0,n.useState)(!1),[q,m]=(0,n.useState)(!1),[g,j]=(0,n.useState)(!1),_=null!==(s=null===(t=null==d?void 0:d.stages)||void 0===t?void 0:t.length)&&void 0!==s?s:0,y=null!==(c=null===(r=e.tasks)||void 0===r?void 0:r.length)&&void 0!==c?c:0,b=+e.stage_order,C=b>0&&b<_,S=b!==_-1,O=t=>xa(this,void 0,void 0,(function*(){try{f(!0),yield function(e,t){return u()({path:`/wpqt/v1/stages/${e}/move`,method:"PATCH",data:{direction:t},headers:p()})}(e.id,t),yield h(d.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a stage","quicktasker"))}finally{f(!1)}}));return(0,a.jsxs)(Ds,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:ha.A}),children:[C&&(0,a.jsx)(Rs,{text:(0,o.__)("Move left","quicktasker"),loading:x,icon:(0,a.jsx)(wa.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>O("left")}),S&&(0,a.jsx)(Rs,{text:(0,o.__)("Move right","quicktasker"),loading:x,icon:(0,a.jsx)(va.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>O("right")}),(0,a.jsx)(Rs,{text:(0,o.__)("Edit stage","quicktasker"),icon:(0,a.jsx)(hs.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:()=>{w({type:U,payload:{stageToEdit:e}})}}),(0,a.jsx)(Rs,{text:(0,o.__)("Archive all stage tasks","quicktasker"),icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-blue wpqt-size-4"}),loading:q,onClick:()=>xa(this,void 0,void 0,(function*(){try{m(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}/archive-tasks`,method:"PATCH",headers:p()})),yield h(d.id),i.oR.success((0,o.sprintf)((0,o.__)("Archived all %s tasks","quicktasker"),e.name))}catch(t){console.error(t),i.oR.error((0,o.sprintf)((0,o.__)("Failed to archive stage %s tasks","quicktasker"),e.name))}finally{m(!1)}var t})),disabled:0===y,id:`item-dropdown-${e.id}-archive`,tooltipText:0===y?(0,o.__)("No tasks to archive on the stage","quicktasker"):void 0}),v&&(0,a.jsx)(Rs,{text:(0,o.__)("Delete stage","quicktasker"),icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:g,onClick:()=>xa(this,void 0,void 0,(function*(){try{j(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}`,method:"DELETE",data:{stageId:t},headers:p()})),l({type:k,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a stage","quicktasker"))}finally{j(!1)}var t})),disabled:y>0,className:"!wpqt-mb-0",id:`item-dropdown-${e.id}`,tooltipText:(0,o.__)("Stage can be deleted when there are no tasks on it","quicktasker")})]})}var qa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ma({stageId:e}){const[t,s]=(0,n.useState)(""),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),h=(0,n.useRef)(null),w=(0,n.useRef)(null),{state:{activePipeline:v},dispatch:x}=(0,n.useContext)(lt);(0,n.useEffect)((()=>{const e=e=>{"Enter"===e.key&&document.activeElement===w.current&&f()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),(0,n.useEffect)((()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&q()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,n.useEffect)((()=>{var e;r&&(null===(e=w.current)||void 0===e||e.focus())}),[r]);const f=()=>qa(this,void 0,void 0,(function*(){if(t)try{d(!0);const s=yield function(e,t,s){return u()({path:"/wpqt/v1/tasks",method:"POST",data:{stageId:e,name:s,pipelineId:t},headers:p()})}(e,v.id,t);x({type:m,payload:s.data}),q()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create task","quicktasker"))}finally{d(!1)}else i.oR.error((0,o.__)("Task name is required","quicktasker"))})),q=()=>{c(!1),s("")};return(0,a.jsx)("div",{ref:h,className:"wpqt-sticky wpqt-bottom-0 wpqt-z-10 wpqt-order-1 wpqt-mt-2 wpqt-flex wpqt-justify-center wpqt-bg-gray-100 wpqt-py-2",children:r?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,a.jsx)(Yt,{ref:w,value:t,onChange:e=>s(e),wrapperClassName:"!wpqt-mb-0",className:"!wpqt-mb-0"}),l?(0,a.jsx)(Ve,{width:"24",height:"24"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(os.A,{className:"wpqt-icon-red wpqt-size-6 wpqt-cursor-pointer",onClick:q}),(0,a.jsx)(rs.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer",onClick:f})]})]}):(0,a.jsxs)("div",{onClick:()=>c(!0),className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-p-2 hover:wpqt-bg-white",children:[(0,o.__)("Add task","quicktasker"),(0,a.jsx)(rs.A,{className:"wpqt-size-6 wpqt-text-green-600"})]})})}var ga=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ka({task:e}){const{modalDispatch:t}=(0,n.useContext)(wt),{state:{activePipeline:s},fetchAndSetPipelineData:i}=(0,n.useContext)(lt),{state:{isUserAllowedToDelete:r}}=(0,n.useContext)(Bt),{deleteTask:c,archiveTask:l}=ot(),[d,u]=(0,n.useState)(!1);return(0,a.jsxs)(Ds,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:bn.A}),children:[(0,a.jsx)(Rs,{text:(0,o.__)("Archive task","quicktasker"),icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),l(e.id,(()=>{i(s.id)}))}}),(0,a.jsx)(Rs,{text:(0,o.__)("Edit task","quicktasker"),icon:(0,a.jsx)(hs.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:P,payload:{taskToEdit:e}})}}),r&&(0,a.jsx)(Rs,{text:(0,o.__)("Delete task","quicktasker"),icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:d,onClick:t=>ga(this,void 0,void 0,(function*(){t.stopPropagation(),u(!0),yield c(e.id,(()=>{i(s.id)})),u(!1)})),className:"!wpqt-mb-0"})]})}var ja=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function _a({task:e,index:t,onLastStage:s}){const{modalDispatch:i}=(0,n.useContext)(wt),{state:{activePipeline:o}}=(0,n.useContext)(lt),r=!(null==o?void 0:o.settings).allow_only_last_stage_task_done||s,c=()=>{i({type:P,payload:{taskToEdit:e,taskModalSettings:{allowToMarkTaskAsDone:r}}})};return(0,a.jsx)(ra.sx,{draggableId:e.id,index:t,children:t=>(0,a.jsxs)("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:"wpqt-relative wpqt-mx-4 wpqt-mb-2 wpqt-flex !wpqt-cursor-pointer wpqt-flex-col wpqt-gap-1 wpqt-rounded wpqt-border wpqt-border-gray-200 wpqt-bg-white wpqt-p-3 wpqt-shadow hover:wpqt-shadow-md",onClick:c,children:[(0,a.jsx)("div",{className:"wpqt-absolute wpqt-right-[12px] wpqt-top-[12px]",children:(0,a.jsx)(ka,{task:e})}),(0,a.jsx)("div",{className:"wpqt-text-base",children:e.name}),e.description&&(0,a.jsx)("div",{className:"wpqt-text-sm wpqt-italic",children:e.description}),(0,a.jsx)("div",{className:"wpqt-mt-2",children:(0,a.jsx)(Us,{task:e})}),(0,a.jsx)(ya,{task:e,allowToMarkTaskAsDone:r})]}))},e.id)}function ya({task:e,allowToMarkTaskAsDone:t}){const{dispatch:s}=(0,n.useContext)(lt),{changeTaskDoneStatus:i}=ot(),[o,r]=(0,n.useState)(!1),c=e.is_done,l=t=>ja(this,void 0,void 0,(function*(){r(!0),yield i(e.id,t,(t=>{s({type:N,payload:{taskId:e.id,done:t}})})),r(!1)}));return t?o?(0,a.jsx)(Be,{ovalSize:"24"}):(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:c?(0,a.jsx)(zt.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,a.jsx)(zt.A,{className:"wpqt-size-6 wpqt-icon-gray",onClick:e=>{e.stopPropagation(),l(!0)}})}):null}function ba({tasks:e}){const t=e.length;return(0,a.jsx)("span",{className:"wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-1 wpqt-text-xs",children:t})}function Ca({stage:e,isLastStage:t}){return(0,a.jsxs)("div",{"data-stage-id":e.id,className:"wpqt-relative wpqt-mb-3 wpqt-flex wpqt-max-h-full wpqt-w-[360px] wpqt-flex-none wpqt-flex-col wpqt-overflow-hidden wpqt-rounded-md wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-gray-100",children:[(0,a.jsxs)("div",{className:"wpqt-mb-4 wpqt-flex wpqt-flex-wrap wpqt-items-center wpqt-gap-1 wpqt-px-4 wpqt-pt-3",children:[(0,a.jsxs)("div",{className:"wpqt-mr-auto wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-text-base wpqt-leading-none",children:[e.name," ",(0,a.jsx)(ba,{tasks:e.tasks})]}),(0,a.jsx)(fa,{stage:e}),e.description&&(0,a.jsx)("div",{className:"wpqt-w-full wpqt-flex-shrink-0 wpqt-flex-grow-0 wpqt-text-sm",children:e.description})]}),(0,a.jsx)(ra.gL,{droppableId:e.id,children:s=>{var n;return(0,a.jsxs)("div",{ref:s.innerRef,className:"wpqt-flex wpqt-h-full wpqt-flex-col wpqt-overflow-y-auto wpqt-overflow-x-hidden",children:[null===(n=e.tasks)||void 0===n?void 0:n.map(((e,s)=>(0,a.jsx)(_a,{task:e,index:s,onLastStage:t},e.id))),s.placeholder,(0,a.jsx)(ma,{stageId:e.id})]})}})]})}const Sa=()=>{var e,t;const{state:{activePipeline:s},dispatch:r,fetchAndSetPipelineData:c}=(0,n.useContext)(lt);(0,n.useEffect)((()=>{const e=setInterval((()=>{s&&c(s.id)}),3e4);return()=>clearInterval(e)}),[s]);const l=(e,t)=>{e.droppableId===t.droppableId?r({type:"REORDER_TASK",payload:{source:e,destination:t}}):r({type:"MOVE_TASK",payload:{source:e,destination:t}})},d=(0,n.useCallback)((e=>{return t=void 0,s=void 0,a=function*(){const{source:t,destination:s,draggableId:n}=e;if(s){l(t,s);try{yield(a=n,r=s.droppableId,c=s.index,u()({path:`/wpqt/v1/tasks/${a}/move`,method:"PATCH",data:{stageId:r,order:c},headers:p()}))}catch(e){console.error(e),l(s,t),i.oR.error((0,o.__)("Failed to move a task","quicktasker"))}var a,r,c}},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a}),[s]);return s?(0,a.jsxs)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-gap-[24px] wpqt-overflow-x-auto wpqt-overflow-y-hidden",children:[(0,a.jsx)(ra.JY,{onDragEnd:d,children:null===(e=s.stages)||void 0===e?void 0:e.map(((e,t)=>{const n=t===s.stages.length-1;return(0,a.jsx)(Ca,{stage:e,isLastStage:n},e.id)}))}),(0,a.jsx)(ua,{pipelineId:s.id,stagesLength:null===(t=s.stages)||void 0===t?void 0:t.length}),(0,a.jsx)(fn,{deleteTaskCallback:()=>{s&&c(s.id)}}),(0,a.jsx)(da,{})]}):(0,a.jsx)(pa,{})};var Oa=s(247),Ta=s(1203),Na=s(2496),Aa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ea(){const{state:{activePipeline:e},fetchAndSetPipelineData:t}=(0,n.useContext)(lt),{state:{pipelines:s},pipelinesDispatch:r}=(0,n.useContext)(Je),{modalDispatch:c}=(0,n.useContext)(wt),l=e=>Aa(this,void 0,void 0,(function*(){try{yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/set-primary`,method:"PATCH",headers:p()})),r({type:C,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to set primary board","quicktasker"))}var t}));return(0,a.jsxs)(Ds,{menuBtnClasses:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1 wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-3",menuBtn:({active:t})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-leading-none",children:null==e?void 0:e.name}),(0,a.jsx)(Ta.A,{className:"wpqt-size-4 "+(t?"wpqt-text-qtBlueHover":"")})]}),children:[(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center wpqt-font-bold",children:(0,o.__)("Change board","quicktasker")}),s.map((s=>{const n=s.is_primary,i=(null==e?void 0:e.id)===s.id;return(0,a.jsx)(Ps.Dr,{children:(0,a.jsxs)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-gap-2",children:[(0,a.jsx)("div",{className:(0,Jt.$)("wpqt-cursor-pointer wpqt-text-center",{"wpqt-font-bold":i}),onClick:()=>t(s.id),children:s.name}),(0,a.jsx)("div",{className:"wpqt-ml-auto",children:n?(0,a.jsx)(Na.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-blue-500"}):(0,a.jsx)(Oa.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-gray-400",onClick:e=>{e.stopPropagation(),l(s)}})})]})},s.id)})),(0,a.jsx)(Ps.Dr,{children:(0,a.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:(0,a.jsx)(Et,{text:(0,o.__)("Add new board","quicktasker"),onClick:()=>Aa(this,void 0,void 0,(function*(){c({type:L})})),icon:(0,a.jsx)(rs.A,{className:"wpqt-size-6 wpqt-icon-green"}),className:"wpqt-bg-white hover:!wpqt-bg-gray-100"})})},"new-pipeline")]})}function Pa(){const{state:{activePipeline:e,loading:t},fetchAndSetPipelineData:s}=(0,n.useContext)(lt),{modalDispatch:i}=(0,n.useContext)(wt);return e?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-py-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,a.jsx)("div",{className:"wpqt-text-lg",children:e.name}),(0,a.jsx)(ha.A,{className:"wpqt-text-gray-400 wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{e&&i({type:F,payload:{pipelineToEdit:e}})}})]}),e.description&&(0,a.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,a.jsxs)("div",{className:"wpqt-ml-auto wpqt-flex wpqt-items-center wpqt-gap-3",children:[t?(0,a.jsx)(Ve,{width:"24",height:"24"}):(0,a.jsx)(Xs.A,{className:"wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>s(e.id)}),(0,a.jsx)(Ea,{})]})]}):null}const Da=()=>(0,a.jsx)(dt,{children:(0,a.jsxs)(Ge,{children:[(0,a.jsx)(Pa,{}),(0,a.jsx)(Sa,{}),(0,a.jsx)(na,{}),(0,a.jsx)(oa,{})]})});var Ia=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ra(){return{saveCustomUserPageStyles:(e,t)=>Ia(this,void 0,void 0,(function*(){try{const n=yield(s=e,u()({path:"/wpqt/v1/settings/user-page-custom-styles",method:"PATCH",data:{styles:s},headers:p()}));t&&t(n.data),i.oR.success((0,o.__)("Custom user page styles saved successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to save custom user page styles","quicktasker"))}var s})),saveTaskCompletionDoneSetting:(e,t,s)=>Ia(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/pipelines/${e}/settings/task-completion-done-restriction`,method:"PATCH",data:{allow_task_completion_only_on_last_stage:t},headers:p()})}(e,t),s&&s(t)}catch(e){s&&s(!t),console.error(e),i.oR.error((0,o.__)("Failed to save setting","quicktasker"))}}))}}const Ua=({children:e,title:t,description:s})=>(0,a.jsxs)("div",{className:"wpqt-mb-3",children:[(0,a.jsx)("h3",{children:t}),(0,a.jsx)("p",{children:s}),e]});const La=()=>{const{state:{userPageCustomStyles:e},appDispatch:t}=(0,n.useContext)(Bt),[s,i]=(0,n.useState)(""),[r,c]=(0,n.useState)(!1),{saveCustomUserPageStyles:l}=Ra();return(0,n.useEffect)((()=>{i(e)}),[e]),(0,a.jsxs)(Ua,{title:(0,o.__)("Custom style","quicktasker"),description:(0,o.__)("Add custom CSS rules for QuickTasker user page.","quicktasker"),children:[(0,a.jsx)(Zt,{value:s,onChange:i}),(0,a.jsx)(Et,{text:(0,o.__)("Save","quicktasker"),loading:r,onClick:()=>{return e=void 0,n=void 0,i=function*(){c(!0),yield l(s,(e=>{t({type:le,payload:e})})),c(!1)},new((a=void 0)||(a=Promise))((function(t,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(e,n||[])).next())}));var e,n,a,i},icon:(0,a.jsx)(Tt.RZ0,{className:"wpqt-icon-blue wpqt-size-4"})})]})};var Fa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ma({allow_only_last_stage_task_done:e,pipelineId:t}){const[s,i]=(0,n.useState)(e),[r,c]=(0,n.useState)(!1),{saveTaskCompletionDoneSetting:l}=Ra();return(0,a.jsx)(Ua,{title:(0,o.__)("Restrict Task Completion","quicktasker"),description:(0,o.__)("Allow to mark task as done only on board last stage. By default, task can be marked as done on any stage. Will apply also to QuickTasker page","quicktasker"),children:(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,a.jsx)(ts,{checked:s,handleChange:e=>Fa(this,void 0,void 0,(function*(){i(e),c(!0),yield l(t,e,(e=>{i(e)})),c(!1)}))}),r&&(0,a.jsx)(Ve,{width:"20",height:"20"})]})})}var za=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function $a({pipeline:e}){const[t,s]=(0,n.useState)(!0),[i,o]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(()=>{za(this,void 0,void 0,(function*(){try{s(!0);const n=yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/settings`,method:"GET",headers:p()}));o(We(n.data))}catch(e){console.error(e)}finally{s(!1)}var t}))})()}),[]),t?(0,a.jsx)(Be,{}):i?(0,a.jsx)("div",{children:(0,a.jsx)(Ma,{pipelineId:e.id,allow_only_last_stage_task_done:i.allow_only_last_stage_task_done})}):null}function Va(){const{state:{pipelines:e}}=(0,n.useContext)(Je),t=e.map((e=>e.name)),s=e.map((e=>(0,a.jsx)($a,{pipeline:e},e.id)));return(0,a.jsx)("div",{children:(0,a.jsx)(Fs,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})})}const Ha=()=>(0,a.jsxs)(Ge,{children:[(0,a.jsx)(l,{description:(0,o.__)("Manage settings, preferences, and configurations.","quicktasker"),children:(0,o.__)("Settings","quicktasker")}),(0,a.jsx)(La,{}),(0,a.jsx)(Va,{})]});var Ba=s(8932),Ga=s(1548),Ka=s(1266),Wa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Qa(){return{createUser:(e,t,s)=>Wa(this,void 0,void 0,(function*(){try{const r=yield(n=e,a=t,u()({path:"/wpqt/v1/users",method:"POST",data:{name:n,description:a},headers:p()}));s&&s(r.data),i.oR.success((0,o.__)("User created successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User creation failed. Please try again","quicktasker"))}var n,a})),editUser:(e,t)=>Wa(this,void 0,void 0,(function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/users/${e.id}`,method:"PATCH",data:{user:e},headers:p()})}(e);t&&t(s.data),i.oR.success((0,o.__)("User edited successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User edit failed. Please try again","quicktasker"))}})),changeUserStatus:(e,t,s)=>Wa(this,void 0,void 0,(function*(){try{const n=yield function(e,t){return u()({path:`/wpqt/v1/users/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e,t);s&&s(n.data),i.oR.success((0,o.__)("User status changed successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change user status. Please try again","quicktasker"))}})),deleteUser:(e,t)=>Wa(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}`,method:"DELETE",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User deleted successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete user. Please try again","quicktasker"))}})),resetUserPassword:(e,t)=>Wa(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}/password-reset`,method:"PATCH",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User password reset successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to reset user password. Please try again","quicktasker"))}}))}}var Ya=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Xa({data:e,changeStatus:t,changeSetUpStatus:s,changePasswordStatus:i}){const{changeUserStatus:r,deleteUser:c,resetUserPassword:l}=Qa(),{userDispatch:d}=(0,n.useContext)(mt),{loading1:u,setLoading1:p,loading2:h,setLoading2:w,loading3:v,setLoading3:x}=$t(),f=e.is_active,q=e.has_password;return(0,a.jsxs)("div",{className:"wpqt-mt-5 wpqt-flex wpqt-gap-2",children:[(0,a.jsx)(Et,{icon:(0,a.jsx)(Ba.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${e.id}/tasks`}}),!f&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ga.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:h,onClick:()=>Ya(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!0,(e=>{d({type:ae,payload:Object.assign({},e)}),t(!0)})),w(!1)}))}),f&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ga.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:h,onClick:()=>Ya(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!1,(e=>{d({type:ae,payload:Object.assign({},e)}),t(!1)})),w(!1)}))}),q&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ka.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:u,text:(0,o.__)("Reset password","quicktasker"),onClick:()=>Ya(this,void 0,void 0,(function*(){p(!0),yield l(e.id,(()=>{s(!1),i(!1)})),p(!1)}))}),(0,a.jsx)(Et,{icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:v,text:(0,o.__)("Delete user","quicktasker"),onClick:()=>Ya(this,void 0,void 0,(function*(){x(!0),yield c(e.id,(e=>{d({type:ie,payload:e}),window.location.hash="#/users"})),x(!1)}))})]})}var Ja=s(8624),Za=s(3997),ei=s(5028);function ti(){const{state:{siteURL:e,publicUserPageId:t}}=(0,n.useContext)(Bt);return{userPage:e+`/wpqt?page=${t}&page_id=wpqt`}}function si({data:e}){const{userPage:t}=ti(),{convertToWPTimezone:s}=Ws(),n=e.is_active,i=t+"&code="+e.page_hash;return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,a.jsx)(ni,{label:(0,o.__)("Name","quicktasker"),value:e.name,icon:(0,a.jsx)(Ja.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(ni,{label:(0,o.__)("Created at","quicktasker"),value:s(e.created_at),icon:(0,a.jsx)(Za.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(ni,{label:(0,o.__)("Assigned tasks count","quicktasker"),value:e.assigned_tasks_count,icon:(0,a.jsx)(Ba.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(ni,{label:(0,o.__)("Setup completed","quicktasker"),value:e.setup_completed?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,a.jsx)(ei.A,{className:"wpqt-size-5 wpqt-text-yellow-600"})}),(0,a.jsx)(ni,{label:(0,o.__)("Is active","quicktasker"),value:n?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,a.jsx)(Ga.A,{className:"wpqt-size-5 "+(n?"wpqt-icon-green":"wpqt-icon-red")})}),(0,a.jsx)(ni,{label:(0,o.__)("User Page","quicktasker"),value:(0,a.jsx)("a",{href:i,rel:"noreferrer",target:"_blank",children:i}),icon:(0,a.jsx)(ps.A,{className:"wpqt-size-5 wpqt-icon-blue"})})]})}function ni({label:e,value:t,icon:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[s,(0,a.jsxs)("span",{className:"wpqt-font-semibold",children:[e,": "]}),(0,a.jsx)("span",{children:t})]})}var ai=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ii({userId:e}){const{loadingDispatch:t}=(0,n.useContext)(Ue),[s,r]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(()=>{ai(this,void 0,void 0,(function*(){try{t({type:de,payload:!0});const n=yield function(e){return u()({path:`/wpqt/v1/users/${e}/extended`,method:"GET",headers:p()})}(e);r((s=n.data,Object.assign(Object.assign({},s),{is_active:"1"===s.is_active})))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to get user data. Please try again","quicktasker"))}finally{t({type:de,payload:!1})}var s}))})()}),[]),(0,a.jsx)(Ge,{children:s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l,{description:(0,o.__)("User details","quicktasker"),children:s.name}),(0,a.jsx)(si,{data:s}),(0,a.jsx)(Xa,{data:s,changeStatus:e=>ai(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{is_active:e}):t))})),changeSetUpStatus:e=>ai(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{setup_completed:e}):t))})),changePasswordStatus:e=>ai(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{has_password:e}):t))}))})]})})}const oi=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active}),ri=(e,t)=>{var s;switch(t.type){case ue:return Object.assign(Object.assign({},e),{sessionsSearchValue:null!==(s=t.payload)&&void 0!==s?s:""});case pe:{const s=t.payload.map(oi);return Object.assign(Object.assign({},e),{userSessions:s})}case he:{const{sessionId:s,status:n}=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_active:n}):e))})}case we:{const s=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.filter((e=>e.id!==s))})}default:return e}};var ci=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const li={loading:!0,sessionsSearchValue:"",userSessions:[]},di=(0,n.createContext)({state:li,usersSessionDispatch:()=>{},loadUserSessions:()=>ci(void 0,void 0,void 0,(function*(){}))}),ui=({children:e})=>{const[t,s]=(0,n.useReducer)(ri,li),{loadingDispatch:r}=(0,n.useContext)(Ue);(0,n.useEffect)((()=>{c()}),[]);const c=()=>ci(void 0,void 0,void 0,(function*(){try{r({type:de,payload:!0});const e=yield u()({path:"/wpqt/v1/users/sessions",method:"GET",headers:p()});s({type:pe,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user sessions","quicktasker"))}finally{r({type:de,payload:!1})}}));return(0,a.jsx)(di.Provider,{value:{state:t,usersSessionDispatch:s,loadUserSessions:c},children:e})};function pi(){const{state:{sessionsSearchValue:e},usersSessionDispatch:t}=(0,n.useContext)(di);return(0,a.jsx)(nt,{title:(0,o.__)("Session filtering","quicktasker"),children:(0,a.jsx)(Yt,{value:e,onChange:e=>{t({type:ue,payload:e})}})})}const hi=()=>{const{state:{sessionsSearchValue:e}}=(0,n.useContext)(di);return{filterSessions:t=>t.user_name.toLowerCase().includes(e.toLowerCase())||t.user_description&&t.user_description.toLowerCase().includes(e.toLowerCase())}};var wi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function vi({session:e}){const{usersSessionDispatch:t}=(0,n.useContext)(di),{state:{isUserAllowedToDelete:s}}=(0,n.useContext)(Bt),{convertToWPTimezone:r}=Ws(),c=e.is_active,l=s=>wi(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/users/sessions/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e.id,s),t({type:he,payload:{sessionId:e.id,status:s}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change session status","quicktasker"))}}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:e.user_name}),(0,a.jsx)("div",{className:"wpqt-italic",children:e.user_description})]}),(0,a.jsx)("div",{children:r(e.created_at_utc)}),(0,a.jsx)("div",{children:r(e.expires_at_utc)}),(0,a.jsx)("div",{className:c?"wpqt-text-qtTextGreen":"wpqt-text-qtTextRed",children:c?(0,o.__)("On","quicktasker"):(0,o.__)("Off","quicktasker")}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-4",children:[c?(0,a.jsx)(Ga.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!1),title:(0,o.__)("Turn session off","quicktasker")}):(0,a.jsx)(Ga.A,{className:"wpqt-icon-green wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!0),title:(0,o.__)("Turn session on","quicktasker")}),s&&(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",title:(0,o.__)("Delete session","quicktasker"),onClick:()=>wi(this,void 0,void 0,(function*(){try{yield(s=e.id,u()({path:`/wpqt/v1/users/sessions/${s}`,method:"DELETE",headers:p()})),t({type:we,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete session","quicktasker"))}var s}))})]})]})}function xi(){const{state:{userSessions:e}}=(0,n.useContext)(di),{filterSessions:t}=hi();return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-4 wpqt-grid wpqt-grid-cols-5 wpqt-font-bold",children:[(0,a.jsx)("div",{children:(0,o.__)("Session owner","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Created at","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Expires at","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Status","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Actions","quicktasker")})]}),(0,a.jsx)("div",{className:"wpqt-grid wpqt-grid-cols-5 wpqt-items-center wpqt-gap-y-4",children:e.filter(t).map((e=>(0,a.jsx)(vi,{session:e},e.id)))})]})}function fi(){return(0,a.jsx)(ui,{children:(0,a.jsxs)(Ge,{children:[(0,a.jsx)(l,{children:(0,o.__)("Quicktasker sessions","quicktasker")}),(0,a.jsx)(pi,{}),(0,a.jsx)(xi,{})]})})}function qi(){const{state:{usersSearchValue:e},userDispatch:t}=(0,n.useContext)(mt);return(0,a.jsx)(nt,{title:(0,o.__)("User filtering","quicktasker"),children:(0,a.jsx)(Ke.p,{type:"text",value:e,onChange:e=>{t({type:ne,payload:e.target.value})}})})}var mi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function gi({userId:e}){return(0,a.jsx)(Zs,{typeId:e,fetchData:()=>mi(this,void 0,void 0,(function*(){try{return(yield v(e,Ae.User)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load log","quicktasker"))}})),renderItem:e=>(0,a.jsx)(Qs,{log:e}),noDataMessage:(0,o.__)("No logs available","quicktasker"),explanation:(0,o.__)("Logs can be seen only by WordPress users (with required permissions)","quicktasker")})}var ki=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ji({userId:e}){return(0,a.jsx)(Zs,{typeId:e,fetchData:()=>ki(this,void 0,void 0,(function*(){try{return(yield h(e,Ae.User,!0)).data.map(rn)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load private comments","quicktasker"))}})),onAdd:t=>ki(this,void 0,void 0,(function*(){try{const s=yield w(e,Ae.User,!0,t);return rn(s.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add private comment","quicktasker"))}})),renderItem:e=>(0,a.jsx)(tn,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed only by WordPress users (with required permissions).","quicktasker"),enableAdd:!0})}var _i=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function yi({userId:e}){const{addComment:t}=on();return(0,a.jsx)(Zs,{typeId:e,fetchData:()=>_i(this,void 0,void 0,(function*(){try{return(yield h(e,Ae.User,!1)).data.map(rn)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load comments","quicktasker"))}})),onAdd:s=>_i(this,void 0,void 0,(function*(){const n=yield t(e,Ae.User,!1,s);if(n)return rn(n)})),renderItem:e=>(0,a.jsx)(tn,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed by WordPress users (with required permissions) and current QuickTasker user (in user page).","quicktasker"),enableAdd:!0})}function bi({user:e}){const t=[(0,o.__)("Private comments","quicktasker"),(0,o.__)("Public comments","quicktasker"),(0,o.__)("Logs","quicktasker")];return(0,a.jsx)(Fs,{tabs:t,tabsContent:[(0,a.jsx)(ji,{userId:e.id},1),(0,a.jsx)(yi,{userId:e.id},2),(0,a.jsx)(gi,{userId:e.id},3)]})}var Ci=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Si=(0,n.forwardRef)((function({modalSaving:e,editUser:t},s){const{state:{userToEdit:i},modalDispatch:r}=(0,n.useContext)(wt),{state:{isUserAllowedToDelete:c}}=(0,n.useContext)(Bt),[l,d]=(0,n.useState)(""),[u,p]=(0,n.useState)(""),[h,w]=(0,n.useState)(!1),[v,x]=(0,n.useState)(!1),{changeUserStatus:f,deleteUser:q,resetUserPassword:m}=Qa(),{userDispatch:g}=(0,n.useContext)(mt),{loading1:k,setLoading1:j,loading2:_,setLoading2:y,loading3:b,setLoading3:C}=$t();(0,n.useEffect)((()=>{i&&(d(i.name),p(i.description),w(i.is_active),x(i.has_password))}),[i]);const S=()=>{d(""),p("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:S}))),i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-3 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsx)("div",{children:(0,a.jsxs)(It,{children:[(0,a.jsx)(Rt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Yt,{isAutoFocus:!0,value:l,onChange:e=>d(e)})}),(0,a.jsx)(Rt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Zt,{rowsCount:3,value:u,onChange:e=>p(e)})})]})}),(0,a.jsx)(Cs,{entityId:i.id,entityType:Wt.User})]}),(0,a.jsx)("div",{className:"wpqt-mt-7",children:(0,a.jsx)(bi,{user:i})})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,a.jsx)(Et,{icon:(0,a.jsx)(Ja.A,{className:"wpqt-icon-blue wpqt-size-4"}),text:(0,o.__)("User details","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}`,r({type:z})}}),(0,a.jsx)(Et,{icon:(0,a.jsx)(Ba.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}/tasks`,r({type:z})}}),v&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ka.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Reset password","quicktasker"),loading:k,onClick:()=>Ci(this,void 0,void 0,(function*(){j(!0),yield m(i.id,(()=>{g({type:re,payload:i.id}),x(!1)})),j(!1)}))}),!h&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ga.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:_,onClick:()=>Ci(this,void 0,void 0,(function*(){y(!0),yield f(i.id,!0,(e=>{g({type:ae,payload:Object.assign({},e)}),w(!0)})),y(!1)}))}),h&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ga.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:_,onClick:()=>Ci(this,void 0,void 0,(function*(){y(!0),yield f(i.id,!1,(e=>{g({type:ae,payload:Object.assign({},e)}),w(!1)})),y(!1)}))}),c&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete user","quicktasker"),loading:b,onClick:()=>Ci(this,void 0,void 0,(function*(){C(!0),yield q(i.id,(e=>{g({type:ie,payload:e}),r({type:z})})),C(!1)}))})]})]}),(0,a.jsx)(Ut,{onSave:()=>{i&&t(Object.assign(Object.assign({},i),{name:l,description:u}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));var Oi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ti(){const{state:{userModalOpen:e}}=(0,n.useContext)(wt),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r}=jt(z),{editUser:c}=Qa();return(0,a.jsx)(Pt,{modalOpen:e,closeModal:o,size:"xl",children:(0,a.jsx)(Si,{ref:i,modalSaving:t,editUser:e=>Oi(this,void 0,void 0,(function*(){s(!0),yield c(e,(e=>{r(ae,e,kt.USER)})),s(!1)}))})})}function Ni(){const{state:{userSettingsModalOpen:e},modalDispatch:t}=(0,n.useContext)(wt);return(0,a.jsx)(Pt,{modalOpen:e,closeModal:()=>t({type:B,payload:!1}),size:"lg",children:(0,a.jsx)("div",{children:(0,a.jsx)(Cs,{entityId:"null",entityType:Wt.Users})})})}var Ai=s(8316),Ei=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Pi(){const[e,t]=(0,n.useState)(!1),[s,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(""),{userDispatch:d}=(0,n.useContext)(mt),{createUser:u}=Qa(),p=()=>{r(""),l(""),t(!1)};return(0,a.jsx)("div",{className:"wpqt-mb-6",children:e?(0,a.jsxs)("div",{className:"wpqt-w-1/4",children:[(0,a.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User name","quicktasker")}),(0,a.jsx)(Yt,{value:s,onChange:r,className:"wpqt-w-full"}),(0,a.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User description","quicktasker")}),(0,a.jsx)(Zt,{value:c,onChange:l,className:"wpqt-w-full"}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,a.jsx)(Et,{text:(0,o.__)("Cancel","quicktasker"),onClick:p,icon:(0,a.jsx)(Ot.A,{className:"wpqt-icon-red wpqt-size-5"})}),(0,a.jsx)(Et,{text:(0,o.__)("Add","quicktasker"),onClick:()=>Ei(this,void 0,void 0,(function*(){s?yield u(s,c,(e=>{d({type:se,payload:e}),p()})):i.oR.error("User name is required")})),icon:(0,a.jsx)(Ai.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]}):(0,a.jsx)(Et,{text:(0,o.__)("Add QuickTasker","quicktasker"),onClick:()=>t(!0),icon:(0,a.jsx)(Ai.A,{className:"wpqt-icon-green wpqt-size-5"})})})}const Di=()=>{const{state:{usersSearchValue:e}}=(0,n.useContext)(mt);return{filterUsers:t=>t.name.toLowerCase().includes(e.toLowerCase())||t.description&&t.description.toLowerCase().includes(e.toLowerCase())}};var Ii=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ri({user:e}){const{modalDispatch:t}=(0,n.useContext)(wt),{userDispatch:s}=(0,n.useContext)(mt),{changeUserStatus:i,deleteUser:r,resetUserPassword:c}=Qa(),[l,d]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),[h,w]=(0,n.useState)(!1),v=e.is_active,x=t=>Ii(this,void 0,void 0,(function*(){w(!0),yield i(e.id,t,(()=>{s({type:oe,payload:{userId:e.id,isActive:t}})})),w(!1)}));return(0,a.jsxs)(Ds,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:bn.A}),children:[(0,a.jsx)(Rs,{text:(0,o.__)("User details","quicktasker"),icon:(0,a.jsx)(Ja.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,a.jsx)(Rs,{text:(0,o.__)("User tasks","quicktasker"),icon:(0,a.jsx)(Ba.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}/tasks`}}),(0,a.jsx)(Rs,{text:(0,o.__)("Edit user","quicktasker"),icon:(0,a.jsx)(hs.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:$,payload:e})}}),e.has_password&&(0,a.jsx)(Rs,{text:(0,o.__)("Reset password","quicktasker"),loading:l,icon:(0,a.jsx)(Ka.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Ii(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield c(e.id,(()=>{s({type:re,payload:e.id})})),d(!1)}))}),v&&(0,a.jsx)(Rs,{text:(0,o.__)("Disable user","quicktasker"),loading:h,icon:(0,a.jsx)(Ga.A,{className:"wpqt-icon-red wpqt-size-4"}),className:"!wpqt-mb-0",onClick:e=>{e.stopPropagation(),x(!1)}}),!v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Rs,{text:(0,o.__)("Activate user","quicktasker"),loading:h,icon:(0,a.jsx)(Ga.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:e=>{e.stopPropagation(),x(!0)}}),(0,a.jsx)(Rs,{text:(0,o.__)("Delete user","quicktasker"),loading:u,icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Ii(this,void 0,void 0,(function*(){t.stopPropagation(),p(!0),yield r(e.id,(e=>{s({type:ie,payload:e})})),p(!1)}))})]})]})}function Ui({user:e}){const{userPage:t}=ti(),{modalDispatch:s}=(0,n.useContext)(wt),i=e.is_active,r=t+"&code="+e.page_hash;return(0,a.jsxs)(kn,{title:e.name,description:e.description,dropdown:(0,a.jsx)(Ri,{user:e}),onClick:()=>{s({type:$,payload:e})},className:"wpqt-cursor-pointer",children:[(0,a.jsx)(jn,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("Open user page","quicktasker"),icon:(0,a.jsx)(ps.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:e=>{e.stopPropagation(),window.open(r,"_blank")}}),(0,a.jsx)(jn,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("View user details","quicktasker"),icon:(0,a.jsx)(ps.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,a.jsx)(jn,{label:(0,o.__)("Status","quicktasker"),value:i?(0,o.__)("Active","quicktasker"):(0,o.__)("Disabled","quicktasker"),valueClassName:i?"wpqt-text-qtTextGreen wpqt-font-bold":"wpqt-text-qtTextRed wpqt-font-bold",icon:(0,a.jsx)(Ga.A,{className:"wpqt-size-5 "+(i?"wpqt-icon-green":"wpqt-icon-red")})})]})}function Li(){const{state:{users:e}}=(0,n.useContext)(mt),{filterUsers:t}=Di(),s=e.filter(t);return e&&0===e.length?(0,a.jsx)(qn,{text:(0,o.__)("No users found","quicktasker")}):s&&0===s.length?(0,a.jsx)(qn,{}):(0,a.jsx)("div",{className:"wpqt-card-grid",children:s.map((e=>(0,a.jsx)(Ui,{user:e},e.id)))})}function Fi(){return(0,a.jsxs)("div",{children:[(0,a.jsx)(Pi,{}),(0,a.jsx)(qi,{}),(0,a.jsx)(Li,{}),(0,a.jsx)(Ni,{}),(0,a.jsx)(Ti,{})]})}var Mi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};var zi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function $i({user:e}){const[t,s]=(0,n.useState)({quicktasker_admin_role:"quicktasker_admin_role"in e.allcaps,quicktasker_admin_role_allow_delete:"quicktasker_admin_role_allow_delete"in e.allcaps,quicktasker_admin_role_manage_users:"quicktasker_admin_role_manage_users"in e.allcaps}),[i,r]=(0,n.useState)(!1),{updateWPUserCapabilities:c}=function(){return{updateWPUserCapabilities:(e,t,s,n)=>Mi(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/wp-users/${e}/capabilities`,method:"PATCH",data:{quicktasker_admin_role:t.quicktasker_admin_role,quicktasker_admin_role_allow_delete:t.quicktasker_admin_role_allow_delete,quicktasker_admin_role_manage_users:t.quicktasker_admin_role_manage_users},headers:p()})}(e,t),s&&s()}catch(e){n&&n(e)}}))}}(),l=(n,a)=>zi(this,void 0,void 0,(function*(){if(i)return;r(!0);const o=Object.assign({},t),l=Object.assign(Object.assign({},t),{[a]:n});s(l),yield c(e.id,l,(()=>{}),(()=>{s(o)})),r(!1)}));return(0,a.jsxs)(kn,{title:e.name,description:e.description,children:[(0,a.jsx)(jn,{label:(0,o.__)("Role","quicktasker"),value:Array.isArray(e.roles)?e.roles.join(", "):""}),(0,a.jsx)(jn,{label:(0,o.__)("Email","quicktasker"),value:e.email}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to admin areas","quicktasker")}),(0,a.jsx)(ts,{checked:t.quicktasker_admin_role,handleChange:e=>{l(e,"quicktasker_admin_role")}})]}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Allow to delete resources","quicktasker")}),(0,a.jsx)(ts,{checked:t.quicktasker_admin_role_allow_delete,handleChange:e=>{l(e,"quicktasker_admin_role_allow_delete")}})]}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to users page","quicktasker")}),(0,a.jsx)(ts,{checked:t.quicktasker_admin_role_manage_users,handleChange:e=>{l(e,"quicktasker_admin_role_manage_users")}})]}),i&&(0,a.jsx)(Be,{ovalSize:"24"})]})}var Vi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Hi(){const[e,t]=(0,n.useState)(null),[s,i]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{(()=>{Vi(this,void 0,void 0,(function*(){try{i(!0);const s=yield(e=De.Other,u()({path:`/wpqt/v1/wp-users?type=${encodeURIComponent(e)}`,method:"GET",headers:p()}));t(s.data)}catch(e){console.error(e)}finally{i(!1)}var e}))})()}),[]),s||!e?(0,a.jsx)(Be,{ovalSize:"48"}):(0,a.jsx)("div",{className:"wpqt-card-grid",children:e.map((e=>(0,a.jsx)($i,{user:e},e.id)))})}function Bi(){const{updateUsers:e}=(0,n.useContext)(mt),{loadingDispatch:t}=(0,n.useContext)(Ue),{modalDispatch:s}=(0,n.useContext)(wt),i=[(0,a.jsx)(Fi,{},0),(0,a.jsx)(Hi,{},1)];return(0,n.useEffect)((()=>{(()=>{var s,n,a,i;s=this,n=void 0,i=function*(){t({type:de,payload:!0}),yield e(),t({type:de,payload:!1})},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function r(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(s,n||[])).next())}))})()}),[]),(0,a.jsxs)(Ge,{children:[(0,a.jsx)(l,{description:(0,o.__)("Manage QuickTaskers and WordPress users. This plugin supports three types of users: WordPress admins, other WordPress users, and QuickTaskers. WordPress admins have full access to all admin areas. Other WordPress users do not have any access by default but can be granted if needed. QuickTaskers are separate users who do not have admin access but can manage tasks through a mobile-friendly webpage.","quicktasker"),icon:(0,a.jsx)(ha.A,{className:"wpqt-icon-gray wpqt-size-7 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{s({type:B,payload:!0})}}),children:(0,o.__)("Users","quicktasker")}),(0,a.jsx)(Fs,{tabs:["QuickTaskers","WordPress users"],tabsContent:i,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}const Gi=(e,t)=>{switch(t.type){case ve:{const s=t.payload.map(Te);return Object.assign(Object.assign({},e),{tasks:s})}case fe:{const s=t.payload;return Object.assign(Object.assign({},e),{tasks:e.tasks.filter((e=>e.id!==s))})}case qe:{const s=t.payload,n=e.tasks.map((e=>e.id===s.id?Te(s):e));return Object.assign(Object.assign({},e),{tasks:n})}case xe:{const s=t.payload;return Object.assign(Object.assign({},e),{searchValue:s})}case me:{const s=t.payload;return Object.assign(Object.assign({},e),{filteredPipelineId:s})}case ge:{const{taskId:s,user:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:[n,...e.assigned_users]}):e));return Object.assign(Object.assign({},e),{tasks:a})}case ke:{const{taskId:s,user:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:e.assigned_users.filter((e=>e.id!==n.id))}):e));return Object.assign(Object.assign({},e),{tasks:a})}case je:{const{taskId:s,done:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{tasks:a})}default:return e}};var Ki=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Wi={tasks:[],searchValue:"",filteredPipelineId:""},Qi=(0,n.createContext)({state:Wi,userTasksDispatch:()=>{},fetchAndSetUserTasks:()=>Ki(void 0,void 0,void 0,(function*(){}))}),Yi=({children:e,userId:t})=>{const[s,r]=(0,n.useReducer)(Gi,Wi),{loadingDispatch:c}=(0,n.useContext)(Ue);(0,n.useEffect)((()=>{l()}),[]);const l=()=>Ki(void 0,void 0,void 0,(function*(){try{c({type:de,payload:!0});const e=yield function(e){return u()({path:`/wpqt/v1/users/${e}/tasks`,method:"GET",headers:p()})}(t);r({type:ve,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user tasks","quicktasker"))}finally{c({type:de,payload:!1})}}));return(0,a.jsx)(Qi.Provider,{value:{state:s,userTasksDispatch:r,fetchAndSetUserTasks:l},children:e})};function Xi(){const{state:{searchValue:e,filteredPipelineId:t},userTasksDispatch:s}=(0,n.useContext)(Qi);return(0,a.jsxs)(nt,{title:(0,o.__)("Filter tasks","quicktasker"),children:[(0,a.jsx)(Yt,{value:e,onChange:e=>{s({type:xe,payload:e})},className:"!wpqt-mb-0"}),(0,a.jsx)(st,{selectedOptionValue:t,selectionChange:e=>{s({type:me,payload:e})}})]})}var Ji=s(7028),Zi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function eo({taskId:e,onUnAssignTask:t}){const[s,i]=(0,n.useState)(!1);return(0,a.jsx)(Ds,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:bn.A}),children:(0,a.jsx)(Rs,{text:(0,o.__)("Unassign from task","quicktasker"),loading:s,icon:(0,a.jsx)(Ji.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:s=>Zi(this,void 0,void 0,(function*(){s.stopPropagation(),i(!0),yield t(e),i(!1)})),className:"!wpqt-mb-0"})})}const to=()=>{const{state:{searchValue:e,filteredPipelineId:t}}=(0,n.useContext)(Qi);return{filterTasks:s=>{const n=s.name&&s.name.toLowerCase().includes(e.toLowerCase())||s.description&&s.description.toLowerCase().includes(e.toLowerCase()),a=!t||s.pipeline_id===t;return n&&a}}};var so=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function no({userId:e}){var t;const{filterTasks:s}=to(),{modalDispatch:i}=(0,n.useContext)(wt),{state:{tasks:r},userTasksDispatch:c}=(0,n.useContext)(Qi),{removeTaskFromUser:l}=ot(),d=null!==(t=null==r?void 0:r.filter(s))&&void 0!==t?t:[],u=t=>so(this,void 0,void 0,(function*(){yield l(e,t,(()=>{c({type:fe,payload:t})}))}));return r&&0===r.length?(0,a.jsx)(qn,{text:(0,o.__)("User has no tasks","quicktasker")}):d&&0===d.length?(0,a.jsx)(qn,{}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-card-grid",children:d.map((e=>(0,a.jsxs)(kn,{className:"wpqt-cursor-pointer",title:e.name,description:e.description,dropdown:(0,a.jsx)(eo,{taskId:e.id,onUnAssignTask:u}),onClick:()=>{i({type:P,payload:{taskToEdit:e}})},children:[(0,a.jsx)(Us,{task:e,onUserAdd:t=>{c({type:ge,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{c({type:ke,payload:{taskId:e.id,user:t}})}}),(0,a.jsx)(yn,{task:e,onDoneStatusChange:(e,t)=>{c({type:je,payload:{taskId:e,done:t}})}})]},e.id)))}),(0,a.jsx)(fn,{editTaskCallback:e=>{c({type:qe,payload:e})}})]})}function ao({userId:e}){return(0,a.jsx)(Yi,{userId:e,children:(0,a.jsxs)(Ge,{children:[(0,a.jsx)(l,{description:(0,o.__)("Tasks assigned to user","quicktasker"),children:(0,o.__)("User tasks","quicktasker")}),(0,a.jsx)(Xi,{}),(0,a.jsx)(no,{userId:e})]})})}const io=()=>{const{page:e,hash:t}=oo();if("wp-quick-tasks"===e){const e=t.match(/^#\/users\/(\d+)\/tasks$/);if(e){const t=e[1];return(0,a.jsx)(ao,{userId:t})}const s=t.match(/^#\/users\/(\d+)$/);if(s){const e=s[1];return(0,a.jsx)(ii,{userId:e})}switch(t){case"#/users":return(0,a.jsx)(Bi,{});case"#/overview":return(0,a.jsx)(ta,{});case"#/archive":return(0,a.jsx)(An,{});case"#/user-sessions":return(0,a.jsx)(fi,{});case"#/logs":return(0,a.jsx)($n,{});case"#/settings":return(0,a.jsx)(Ha,{});case"#/guide":return(0,a.jsx)(En,{});default:return(0,a.jsx)(Da,{})}}},oo=()=>({page:new URLSearchParams(window.location.search).get("page"),hash:window.location.hash}),ro=function(){const e=(()=>{const[e,t]=(0,n.useState)(io());return(0,n.useEffect)((()=>{const e=()=>{t(io()),(()=>{const{page:e,hash:t}=oo();if("wp-quick-tasks"!==e)return;const s=document.querySelectorAll("#toplevel_page_wp-quick-tasks .wp-submenu li");s.forEach((e=>e.classList.remove("wpqt-current")));const n={"#/users":"#/users","#/overview":"#/overview","#/archive":"#/archive","#/user-sessions":"#/user-sessions","#/logs":"#/logs","#/settings":"#/settings","#/guide":"#/guide",default:""};let a=n.default;void 0!==n[t]?a=n[t]:/^#\/users(\/\d+)?(\/tasks)?$/.test(t)&&(a="#/users"),s.forEach((e=>{const t=e.querySelector("a");t&&t.getAttribute("href")&&t.getAttribute("href")===`admin.php?page=wp-quick-tasks${a}`&&e.classList.add("wpqt-current")}))})()};return e(),window.addEventListener("popstate",e),window.addEventListener("hashchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("hashchange",e)}}),[]),e})();return(0,a.jsx)(c,{children:(0,a.jsx)(Gt,{children:(0,a.jsx)(gt,{children:(0,a.jsx)(vt,{children:(0,a.jsx)(Ze,{children:(0,a.jsxs)(Le,{children:[e,(0,a.jsx)(i.N9,{position:"bottom-right"})]})})})})})})};(0,n.render)((0,a.jsx)(ro,{}),document.getElementById("wpqt-app"))},1609:e=>{e.exports=window.React},5795:e=>{e.exports=window.ReactDOM},790:e=>{e.exports=window.ReactJSXRuntime}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var s=a[e]={exports:{}};return n[e].call(s.exports,s,s.exports,i),s.exports}i.m=n,e=[],i.O=(t,s,n,a)=>{if(!s){var o=1/0;for(d=0;d<e.length;d++){for(var[s,n,a]=e[d],r=!0,c=0;c<s.length;c++)(!1&a||o>=a)&&Object.keys(i.O).every((e=>i.O[e](s[c])))?s.splice(c--,1):(r=!1,a<o&&(o=a));if(r){e.splice(d--,1);var l=n();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[s,n,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);i.r(a);var o={};t=t||[null,s({}),s([]),s(s)];for(var r=2&n&&e;"object"==typeof r&&!~t.indexOf(r);r=s(r))Object.getOwnPropertyNames(r).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(a,o),a},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=524,(()=>{var e={524:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var n,a,[o,r,c]=s,l=0;if(o.some((t=>0!==e[t]))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(c)var d=c(i)}for(t&&t(s);l<o.length;l++)a=o[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(d)},s=globalThis.webpackChunkquicktasker=globalThis.webpackChunkquicktasker||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.nc=void 0;var o=i.O(void 0,[96],(()=>i(8511)));o=i.O(o)})();