(()=>{"use strict";var e,t,s,a={1969:(e,t,s)=>{const a=window.wp.element;var n=s(790),i=s(9571);const o=window.wp.i18n;class r extends a.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){var e;return this.state.hasError?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-h-screen wpqt-items-center wpqt-justify-center wpqt-text-center wpqt-text-lg",children:[(0,o.__)("Something went wrong. Please refresh the page.","quicktasker"),(0,n.jsx)("br",{}),null===(e=this.state.error)||void 0===e?void 0:e.message]}):this.props.children}}const c=r;var l=s(12);function d({children:e,description:t=null,icon:s=null}){return(0,n.jsx)("div",{className:"wpqt-mb-6 wpqt-inline-grid wpqt-grid-cols-[auto_auto] wpqt-items-center wpqt-gap-2",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{children:[e,s&&(0,n.jsx)("span",{className:"wpqt-ml-1 wpqt-align-middle",children:s})]}),t&&(0,n.jsx)("div",{children:t})]})})}var u=s(7908);const p="SET_LOADING",h="SET_PIPELINE",m="MOVE_TASK",w="ADD_TASK",f="ADD_STAGE",k="DELETE_STAGE",q="EDIT_TASK",_="EDIT_STAGE",x="ADD_PIPELINE",g="EDIT_PIPELINE",v="SET_PRIMARY",j="SET_PIPELINES",b="ADD_USER_TO_TASK",y="REMOVE_USER_FROM_TASK",E="CHANGE_TASK_DONE_STATUS",T="REMOVE_PIPELINE",S="REMOVE_ACTIVE_PIPELINE",A="REMOVE_TASK",O="TOGGLE_VIEW",N="ADD_LABEL_TO_TASK",C="REMOVE_LABEL_FROM_TASK",I="EDIT_PIPELINE_LABEL",D="REMOVE_PIPELINE_LABEL",P="SET_TASK_FOCUS_COLOR",R="SET_STAGE_FILTER",L="SET_USER_FILTER",M="SET_TASK_VIEW_SEARCH_TEXT",U="OPEN_EDIT_TASK_MODAL",F="CLOSE_TASK_MODAL",K="OPEN_NEW_STAGE_MODAL",$="CLOSE_STAGE_MODAL",z="OPEN_STAGE_EDIT_MODAL",G="OPEN_NEW_PIPELINE_MODAL",V="OPEN_EDIT_PIPELINE_MODAL",B="CLOSE_PIPELINE_EDIT_MODAL",H="CLOSE_USER_MODAL",W="OPEN_EDIT_USER_MODAL",Q="ADD_ASSIGNED_USER_TO_EDITING_TASK",Y="REMOVE_ASSIGNED_USER_FROM_EDITING_TASK",J="CHANGE_USER_SETTINGS_MODAL_OPEN",X="OPEN_MOVE_TASK_MODAL",Z="CLOSE_MOVE_TASK_MODAL",ee="OPEN_TASK_COLOR_MODAL",te="CLOSE_TASK_COLOR_MODAL",se="OPEN_TASK_EXPORT_MODAL",ae="CLOSE_TASK_EXPORT_MODAL",ne="CHANGE_TASK_EXPORT_MODAL_METHOD",ie="OPEN_PIPELINE_IMPORT_MODAL",oe="CLOSE_PIPELINE_IMPORT_MODAL",re="OPEN_AUTOMATION_CREATOR_MODAL",ce="CLOSE_AUTOMATION_CREATOR_MODAL",le="OPEN_AUTOMATIONS_MODAL",de="CLOSE_AUTOMATIONS_MODAL",ue="ARCHIVE_SETTINGS_MODAL_OPEN",pe="OPEN_TASK_RESTORE_MODAL",he="CLOSE_TASK_RESTORE_MODAL",me="SET_CUSTOM_FIELD_CREATOR_MODAL_OPEN",we="SET_CUSTOM_FIELD_RECOVERY_MODAL_OPEN",fe="SET_WEBHOOK_CREATION_MODAL_OPEN",ke="SET_WEBHOOKS_MODAL_OPEN",qe="OPEN_WEBHOOKS_LOGS_MODAL",_e="CLOSE_WEBHOOKS_LOGS_MODAL",xe="SET_ARCHIVE_TASKS",ge="SET_ARCHIVE_SEARCH_VALUE",ve="SET_ARCHIVE_FILTERED_PIPELINE",je="REMOVE_ARCHIVED_TASK",be="REMOVE_ARCHIVED_TASKS",ye="ADD_ASSIGNED_USER_TO_ARCHIVED_TASK",Ee="REMOVE_ASSINGED_USER_FROM_ARCHIVED_TASK",Te="CHANGE_ARCHIVED_TASK_DONE_STATUS",Se="EDIT_ARCHIVED_TASK",Ae="CHANGE_ARCHIVE_TASK_DONE_FILTER",Oe="ADD_LABEL_ARCHIVED_TASK",Ne="REMOVE_LABEL_ARCHIVED_TASK",Ce="CHANGE_ARCHIVED_TASKS_LIMIT_FILTER",Ie="SET_ARCHIVE_LOADING",De="SET_ARCHIVE_FILTER_ORDER",Pe="SET_USERS",Re="SET_WP_USERS",Le="ADD_USER",Me="SET_USERS_SEARCH_VALUE",Ue="EDIT_USER",Fe="DELETE_USER",Ke="CHANGE_USER_STATUS",$e="RESET_PASSWORD",ze="INIT_APP_STATE",Ge="SET_CUSTOM_USER_PAGE_STYLES",Ve="SET_FULL_PAGE_LOADING",Be="SET_USER_SESSIONS_SEARCH_VALUE",He="SET_USER_SESSIONS",We="CHANGE_USER_SESSION_STATUS",Qe="DELETE_USER_SESSION",Ye="SET_USER_TASKS",Je="SET_USER_TASKS_SEARCH_VALUE",Xe="REMOVE_USER_TASK",Ze="EDIT_USER_TASK",et="SET_USER_TASKS_FILTERED_PIPELINE",tt="ADD_ASSIGNED_USER_TO_USER_TASK",st="REMOVE_ASSIGNED_USER_FROM_USER_TASK",at="CHANGE_USER_TASK_DONE_STATUS",nt="SET_CUSTOM_FIELDS",it="ADD_CUSTOM_FIELD",ot="DELETE_CUSTOM_FIELD",rt="SET_CUSTOM_FIELD_LOADING",ct="SET_CUSTOM_FIELD_INITIAL_DATA",lt="SET_LABELS",dt="ADD_LABEL",ut="REMOVE_LABEL",pt="EDIT_LABEL",ht="SET_LABEL_ACTION_STATE_SELECTION",mt="SET_LABEL_ACTION_STATE_EDITING",wt="SET_LABEL_ACTION_STATE_CREATION",ft="RESET_LABEL_CONTEXT",kt="SET_PIPELINE_AUTOMATIONS",qt="SET_PIPELINE_AUTOMATIONS_LOADING",_t="REMOVE_PIPELINE_AUTOMATION",xt="ADD_PIPELINE_AUTOMATION",gt="UPDATE_PIPELINE_AUTOMATION_ACTIVE_STATUS",vt="SET_META",jt="SET_ACTION_TARGET",bt="RESET_AUTOMATION_TO_TARGET",yt="RESET_AUTOMATION_TO_TRIGGER",Et="RESET_AUTOMATION_TO_ACTION",Tt="SET_PIPELINE_WEBHOOKS",St="SET_PIPELINE_WEBHOOKS_LOADING",At="REMOVE_PIPELINE_WEBHOOK",Ot="ADD_PIPELINE_WEBHOOK",Nt="EDIT_PIPELINE_WEBHOOK",Ct="SET_UPLOADS",It="ADD_UPLOAD",Dt="REMOVE_UPLOAD",Pt=700,Rt=!1,Lt=!1,Mt="#ffffff",Ut="6px",Ft="solid",Kt="#16a34a",$t=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv","text/plain","image/jpeg","image/png","image/gif","image/bmp","image/svg+xml","audio/mpeg","audio/wav","audio/ogg","video/mp4","video/webm","video/ogg","application/zip","application/x-rar-compressed","application/x-tar","application/gzip"],zt=26214400,Gt=/^[a-zA-Z0-9_\-.]+$/,Vt=window.wp.apiFetch;var Bt,Ht,Wt=s.n(Vt);function Qt(){return{"Content-Type":"application/json","X-WPQT-API-Nonce":window.wpqt.apiNonce}}function Yt(e,t,s){return Wt()({path:`/wpqt/v1/tasks/${e}/move`,method:"PATCH",data:{stageId:t,order:s},headers:Qt()})}function Jt(e,t,s){const a=new URLSearchParams({typeId:e,type:t,isPrivate:s.toString()}).toString();return Wt()({path:`/wpqt/v1/comments?${a}`,method:"GET",headers:Qt()})}function Xt(e,t,s,a){return Wt()({path:"/wpqt/v1/comments",data:{comment:a,typeId:e,type:t,isPrivate:s},method:"POST",headers:Qt()})}function Zt(e,t){const s=new URLSearchParams({typeId:e,type:t});return Wt()({path:`/wpqt/v1/logs?${s.toString()}`,method:"GET",headers:Qt()})}function es(e){const t=new URLSearchParams(Object.entries(e).reduce(((e,[t,s])=>(e[t]=String(s),e)),{}));return Wt()({path:`/wpqt/v1/global-logs?${t.toString()}`,method:"GET",headers:Qt()})}function ts(e,t,s){return Wt()({path:`/wpqt/v1/users/${e}/tasks/${t}`,method:"DELETE",data:{user_type:s},headers:Qt()})}function ss(e,t,s){const a=new URLSearchParams({entityId:e,entityType:t,active:String(s)});return Wt()({path:`/wpqt/v1/custom-fields?${a.toString()}`,method:"GET",headers:Qt()})}(Ht=Bt||(Bt={})).QUICKTASKER="quicktasker",Ht.WP_USER="wp-user";function as(e){return!e.user_type||e.user_type===Bt.QUICKTASKER}function ns(e){return e.user_type===Bt.WP_USER}const is=e=>Object.assign(Object.assign({},e),{allow_only_last_stage_task_done:"1"===e.allow_only_last_stage_task_done});var os,rs,cs,ls,ds,us;!function(e){e.TASK_DONE="task-done",e.Task_NOT_DONE="task-not-done",e.TASK_CREATED="task-created",e.TASK_DELETED="task-deleted",e.TASK_ASSIGNED="task-assigned",e.TASK_UNASSIGNED="task-unassigned",e.TASK_PUBLIC_COMMENT_ADDED="task-public-comment-added",e.TASK_PRIVATE_COMMENT_ADDED="task-private-comment-added",e.TASK_FILE_UPLOADED="task-attachment-added",e.TASK_FILE_DELETED="task-attachment-deleted"}(os||(os={})),function(e){e.WOOCOMMERCE_ORDER_ADDED="woocommerce-order-added"}(rs||(rs={})),function(e){e.SEATREG_BOOKING_CREATED="seatreg-booking-created",e.SEATREG_BOOKING_APPROVED="seatreg-booking-approved",e.SEATREG_BOOKING_APPROVED_VIA_MANAGER="seatreg-booking-approved-via-manager",e.SEATREG_BOOKING_PENDING="seatreg-booking-pending",e.SEATREG_BOOKING_PENDING_VIA_MANAGER="seatreg-booking-pending-via-manager"}(cs||(cs={})),function(e){e.PIPELINE="pipeline",e.Stage="stage",e.Task="task",e.quicktasker="quicktasker",e.WOOCOMMERCE_ORDER="woocommerce-order",e.SEATREG_BOOKING="seatreg-booking"}(ls||(ls={})),function(e){e.PIPELINE="pipeline",e.STAGE="stage",e.TASK="task",e.QUICKTASKER="quicktasker",e.WP_USER="wp-user"}(ds||(ds={})),function(e){e.ARCHIVE_TASK="archive-task",e.ASSIGN_USER="assign-user",e.NEW_ENTITY_EMAIL="new-entity-email",e.DELETED_ENTITY_EMAIL="deleted-entity-email",e.TASK_ASSIGNED_EMAIL="task-assigned-email",e.TASK_UNASSIGNED_EMAIL="task-unassigned-email",e.TASK_PUBLIC_COMMENT_ADDED_EMAIL="task-public-comment-added-email",e.TASK_PRIVATE_COMMENT_ADDED_EMAIL="task-private-comment-added-email",e.TASK_FILE_UPLOADED_EMAIL="task-attachment-added-email",e.TASK_FILE_DELETED_EMAIL="task-attachment-deleted-email",e.CREATE_TASK="create-task",e.SEND_SLACK_MESSAGE="send-slack-message"}(us||(us={}));const ps=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active,has_password:"1"===e.has_password}),hs=e=>{switch(e){case ds.QUICKTASKER:return Bt.QUICKTASKER;case ds.WP_USER:return Bt.WP_USER;default:return null}},ms={[Bt.QUICKTASKER]:"Quicktasker",[Bt.WP_USER]:"WordPress User"},ws=e=>Object.assign(Object.assign({},e),{task_order:Number(e.task_order),free_for_all:"1"===e.free_for_all,is_archived:"1"===e.is_archived,is_done:"1"===e.is_done,assigned_users:e.assigned_users?e.assigned_users.map((e=>Object.assign({},ps(e)))):[]}),fs=e=>Object.assign(Object.assign({},e),{stage_order:Number(e.stage_order),tasks:(e.tasks||[]).map((e=>Object.assign({},ws(e))))}),ks=(e,t)=>{var s,a,n,i,o,r,c,l,d,u,x,v,j,T,R;switch(t.type){case p:return Object.assign(Object.assign({},e),{loading:t.payload});case h:{const s=t.payload,a=(s.stages||[]).map((e=>Object.assign({},fs(e)))),n=s.settings?is(s.settings):void 0;return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},s),{stages:a,settings:n,is_primary:"1"===s.is_primary})})}case m:{if(!e.activePipeline||!e.activePipeline.stages)return e;const s=((e,t,s)=>{const a=[...e],n=a.find((e=>e.id===t.droppableId)),i=a.find((e=>e.id===s.droppableId));if((null==n?void 0:n.tasks)&&(null==i?void 0:i.tasks)){const[e]=n.tasks.splice(t.index,1);i.tasks.splice(s.index,0,e)}return a})(e.activePipeline.stages,t.payload.source,t.payload.destination);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:s})})}case"REORDER_TASK":{const{source:n,destination:i}=t.payload,o=i.droppableId,r=i.index;if(!e.activePipeline)return e;const c=null===(s=e.activePipeline.stages)||void 0===s?void 0:s.find((e=>e.id===o));if(!c||!c.tasks)return e;const l=((e,t,s)=>{const a=[...e],[n]=a.splice(t,1);return a.splice(s,0,n),a})(c.tasks,n.index,r),d=null===(a=e.activePipeline.stages)||void 0===a?void 0:a.map((e=>e.id===o?Object.assign(Object.assign({},e),{tasks:l}):e));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:d})})}case w:{const s=ws(t.payload);return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(n=e.activePipeline.stages)||void 0===n?void 0:n.map((e=>e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:[...e.tasks||[],s]}):e))})}):e}case q:{const s=ws(t.payload);if(!e.activePipeline)return e;const a=null===(i=e.activePipeline.stages)||void 0===i?void 0:i.map((e=>{var t;return e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s.id?Object.assign(Object.assign({},e),s):e))}):e}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case f:{const{stage:s}=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:[...e.activePipeline.stages||[],s]})}):e}case _:{const s=t.payload;if(!e.activePipeline)return e;const a=e=>e.id===s.id?Object.assign(Object.assign({},e),{name:s.name,description:s.description}):e,n=null===(o=e.activePipeline.stages)||void 0===o?void 0:o.map(a);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case k:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(r=e.activePipeline.stages)||void 0===r?void 0:r.filter((e=>e.id!==s))})}):e}case b:{const{taskId:s,user:a}=t.payload;if(!e.activePipeline)return e;const n=null===(c=e.activePipeline.stages)||void 0===c?void 0:c.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{if(e.id===s){const t=as(a)?[a,...e.assigned_users||[]]:e.assigned_users||[],s=ns(a)?[a,...e.assigned_wp_users||[]]:e.assigned_wp_users||[];return Object.assign(Object.assign({},e),{assigned_users:t,assigned_wp_users:s})}return e}));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case y:{const{taskId:s,userId:a,userType:n}=t.payload;if(!e.activePipeline)return e;const i=null===(l=e.activePipeline.stages)||void 0===l?void 0:l.map((e=>{var t;const i=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{var t,i;return e.id===s?Object.assign(Object.assign({},e),{assigned_users:n===Bt.QUICKTASKER?null===(t=e.assigned_users)||void 0===t?void 0:t.filter((e=>e.id!==a)):e.assigned_users,assigned_wp_users:n===Bt.WP_USER?null===(i=e.assigned_wp_users)||void 0===i?void 0:i.filter((e=>e.id!==a)):e.assigned_wp_users}):e}));return Object.assign(Object.assign({},e),{tasks:i})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:i})})}case g:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{name:s.name,description:s.description,is_primary:"1"===s.is_primary})}):e}case E:{const{taskId:s,done:a}=t.payload;if(!e.activePipeline)return e;const n=null===(d=e.activePipeline.stages)||void 0===d?void 0:d.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:a}):e));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case S:return Object.assign(Object.assign({},e),{activePipeline:null});case A:{const s=t.payload;if(!e.activePipeline)return e;const a=null===(u=e.activePipeline.stages)||void 0===u?void 0:u.map((e=>{var t;return Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.filter((e=>e.id!==s))})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case O:return Object.assign(Object.assign({},e),{view:t.payload});case N:{const{taskId:s,label:a}=t.payload;if(!e.activePipeline)return e;const n=null===(x=e.activePipeline.stages)||void 0===x?void 0:x.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_labels:[...e.assigned_labels||[],a]}):e));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case C:{const{taskId:s,labelId:a}=t.payload;if(!e.activePipeline)return e;const n=null===(v=e.activePipeline.stages)||void 0===v?void 0:v.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_labels:(e.assigned_labels||[]).filter((e=>e.id!==a))}):e));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case I:{const{label:s}=t.payload;if(!e.activePipeline)return e;const a=null===(j=e.activePipeline.stages)||void 0===j?void 0:j.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>Object.assign(Object.assign({},e),{assigned_labels:(e.assigned_labels||[]).map((e=>e.id===s.id?s:e))})));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case D:{const s=t.payload;if(!e.activePipeline)return e;const a=null===(T=e.activePipeline.stages)||void 0===T?void 0:T.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>Object.assign(Object.assign({},e),{assigned_labels:(e.assigned_labels||[]).filter((e=>e.id!==s))})));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case P:{const{taskId:s,color:a}=t.payload;if(!e.activePipeline)return e;const n=null===(R=e.activePipeline.stages)||void 0===R?void 0:R.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{task_focus_color:a}):e));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}default:return e}};var qs;!function(e){e.PIPELINE="PIPELINE-VIEW",e.TASK="TASK-VIEW"}(qs||(qs={}));const _s=(e,t)=>{if(t.type===Ve){const s=t.payload;return Object.assign(Object.assign({},e),{fullPageLoading:s})}return e},xs={fullPageLoading:!1},gs=(0,a.createContext)({state:xs,loadingDispatch:()=>{}}),vs=({children:e})=>{const[t,s]=(0,a.useReducer)(_s,xs);return(0,n.jsx)(gs.Provider,{value:{state:t,loadingDispatch:s},children:e})};const js={loading:!1,view:qs.PIPELINE,activePipeline:null},bs=(0,a.createContext)({state:js,dispatch:()=>{},fetchAndSetPipelineData:()=>Promise.resolve()}),ys=({children:e})=>{const[t,s]=(0,a.useReducer)(ks,js),{loadingDispatch:r}=(0,a.useContext)(gs);(0,a.useEffect)((()=>{const e=window.wpqt.initialActivePipelineId;e&&l(e,!0)}),[]);const c=(e,t)=>{t?r({type:Ve,payload:e}):s({type:p,payload:e})},l=(e,...t)=>{return a=void 0,n=[e,...t],l=function*(e,t=!1){try{c(!0,t);const{data:{pipeline:a}}=yield function(e){return Wt()({path:`/wpqt/v1/pipelines/${e}`,headers:Qt()})}(e);s({type:h,payload:a})}catch(e){console.error(e),i.oR.error((0,o.__)("Unable to load the board. Please try again later.","quicktasker"))}finally{c(!1,t)}},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof r?a:new r((function(e){e(a)}))).then(s,i)}o((l=l.apply(a,n||[])).next())}));var a,n,r,l};return(0,n.jsx)(bs.Provider,{value:{state:t,dispatch:s,fetchAndSetPipelineData:l},children:e})};var Es=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Ts={[us.ARCHIVE_TASK]:(0,o.__)("Task archived by automation","quicktasker"),[us.ASSIGN_USER]:(0,o.__)("User assigned by automation","quicktasker"),[us.NEW_ENTITY_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[us.DELETED_ENTITY_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[us.TASK_ASSIGNED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[us.TASK_UNASSIGNED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[us.TASK_PUBLIC_COMMENT_ADDED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[us.TASK_PRIVATE_COMMENT_ADDED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[us.TASK_FILE_UPLOADED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[us.TASK_FILE_DELETED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[us.CREATE_TASK]:(0,o.__)("Task created by automation","quicktasker"),[us.SEND_SLACK_MESSAGE]:(0,o.__)("Slack message sent by automation","quicktasker")};function Ss(){const{dispatch:e}=(0,a.useContext)(bs),t=e=>{e&&e.forEach((e=>{if(e.automation_action.includes("email"))return;const t=Ts[e.automation_action]||`Automation executed: ${e.automation_action}`;i.oR.info(t)}))},s=(t,s)=>{t&&s&&t.forEach((t=>{if(t.automation_action===us.ARCHIVE_TASK&&e({type:A,payload:s}),t.automation_action===us.ASSIGN_USER){const n=t.executionResult;!n||!(a=n)||"object"!=typeof a||a.user_type&&a.user_type!==Bt.QUICKTASKER&&a.user_type!==Bt.WP_USER||e({type:b,payload:{taskId:s,user:n}})}var a}))};return{displayAutomationMessages:t,handleExecutedAnimationsResults:s,handleExecutedAutomations:(e,a)=>{0!==e.length&&(s(e,a),t(e))},createAutomation:(e,t,s)=>Es(this,void 0,void 0,(function*(){try{const a=yield function(e,t){var s;return Wt()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"POST",data:{automationTargetId:null,automationTarget:t.automationTarget,automationTrigger:t.automationTrigger,automationAction:null===(s=t.automationAction)||void 0===s?void 0:s.id,automationActionTargetId:t.automationActionTargetId,automationActionTargetType:t.automationActionTargetType,automationMetadata:t.metaData},headers:Qt()})}(e,t);i.oR.success((0,o.__)("Automation created","quicktasker")),s&&s(!0,a.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create automation","quicktasker")),s&&s(!1,null)}})),updateAutomationActiveStatus:(e,t,s)=>Es(this,void 0,void 0,(function*(){try{const a=yield function(e,t,s){return Wt()({path:`/wpqt/v1/pipelines/${e}/automations/${t}/active`,method:"PATCH",data:{active:s},headers:Qt()})}(e,t,s);return i.oR.success(s?(0,o.__)("Automation activated","quicktasker"):(0,o.__)("Automation deactivated","quicktasker")),{success:!0,data:a.data}}catch(e){return console.error(e),i.oR.error(s?(0,o.__)("Failed to activate automation","quicktasker"):(0,o.__)("Failed to deactivate automation","quicktasker")),{success:!1,data:null}}})),deleteAutomation:(e,t,s)=>Es(this,void 0,void 0,(function*(){try{yield function(e,t){return Wt()({path:`/wpqt/v1/pipelines/${e}/automations/${t}`,method:"DELETE",headers:Qt()})}(e,t),i.oR.success((0,o.__)("Automation deleted","quicktasker")),s&&s(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete automation","quicktasker")),s&&s(!1)}}))}}var As=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Os=()=>{const{handleExecutedAutomations:e}=Ss(),{displayErrorMessages:t,getMessagesFromResponse:s}=function(){return{displayErrorMessages:e=>{return t=this,s=void 0,n=function*(){if(e.messages&&Array.isArray(e.messages)&&e.messages.length>0){const t=e.messages.join(", ");i.oR.error(t)}},new((a=void 0)||(a=Promise))((function(e,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(t,s||[])).next())}));var t,s,a,n},getMessagesFromResponse:e=>null!==e&&"object"==typeof e&&"messages"in e&&Array.isArray(e.messages)?e.messages:[]}}();return{editTask:(e,t)=>As(void 0,void 0,void 0,(function*(){try{const s=yield function(e,t){return Wt()({path:`/wpqt/v1/tasks/${e}`,method:"PATCH",data:t,headers:Qt()})}(e,t);return{success:!0,task:s.data}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to update task","quicktasker")),{success:!1,task:null}}})),deleteTask:(t,s)=>As(void 0,void 0,void 0,(function*(){try{const a=yield function(e){return Wt()({path:`/wpqt/v1/tasks/${e}`,method:"DELETE",headers:Qt()})}(t);s&&s({success:!0,taskId:t}),i.oR.success((0,o.__)("Task deleted","quicktasker")),e(a.data.executedAutomations,t)}catch(e){s&&s({success:!1,taskId:t}),console.error(e),i.oR.error((0,o.__)("Failed to delete a task","quicktasker"))}})),archiveTask:(e,t)=>As(void 0,void 0,void 0,(function*(){try{yield function(e){return Wt()({path:`/wpqt/v1/tasks/${e}/archive`,method:"PATCH",headers:Qt()})}(e),t&&t({success:!0,taskId:e}),i.oR.success((0,o.__)("Task archived","quicktasker"))}catch(s){t&&t({success:!1,taskId:e}),console.error(s),i.oR.error((0,o.__)("Failed to archive a task","quicktasker"))}})),restoreArchivedTask:(e,t,a)=>As(void 0,void 0,void 0,(function*(){try{yield function(e,t){return Wt()({path:`/wpqt/v1/tasks/${e}/archive-restore`,method:"PATCH",data:{boardId:t},headers:Qt()})}(e,t),a&&a({success:!0,messages:[]}),i.oR.success((0,o.__)("Task restored","quicktasker"))}catch(e){console.error(e),a&&a({success:!1,messages:s(e)}),i.oR.error((0,o.__)("Failed to restore a task","quicktasker"))}})),removeTaskFromUser:(t,s,a)=>As(void 0,void 0,void 0,(function*(){try{const n=yield ts(t,s,Bt.QUICKTASKER);i.oR.success((0,o.__)("Task has been unassigned","quicktasker")),e(n.data.executedAutomations,s),a&&a()}catch(e){console.error(e),i.oR.error((0,o.__)("Task unassignment failed. Try again","quicktasker"))}})),changeTaskDoneStatus:(s,a,n)=>As(void 0,void 0,void 0,(function*(){try{const t=a?(0,o.__)("Task marked as completed","quicktasker"):(0,o.__)("Task marked as incomplete","quicktasker"),r=yield function(e,t){return Wt()({path:`/wpqt/v1/tasks/${e}/done`,method:"PATCH",data:{done:t},headers:Qt()})}(s,a);n&&n(a),i.oR.success(t),e(r.data.executedAutomations,s)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change task status","quicktasker")),t(e)}})),moveTask:(e,t,s,a)=>As(void 0,void 0,void 0,(function*(){try{yield Yt(e,t,s),i.oR.success((0,o.__)("Task moved","quicktasaker")),a&&a(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a task","quicktasker")),a&&a(!1)}})),updateTaskFocusColor:(e,t)=>As(void 0,void 0,void 0,(function*(){const s={taskId:e,color:t};try{return yield function(e,t){return Wt()({path:`/wpqt/v1/tasks/${e}/focus-color`,method:"PATCH",data:{color:t},headers:Qt()})}(e,t),i.oR.success((0,o.__)("Task focus color changed","quicktasker")),Object.assign({success:!0},s)}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to change task focus color","quicktasker")),Object.assign({success:!1},s)}})),cleanupTaskArchive:()=>As(void 0,void 0,void 0,(function*(){try{const e=(yield Wt()({path:"/wpqt/v1/archive/settings/task-cleanup",method:"PATCH",headers:Qt()})).data.deletedTaskIds;return i.oR.success((0,o.sprintf)((0,o.__)("Removed %d orphaned tasks from archive","quicktasker"),e.length)),{success:!0,deletedTaskIds:e}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to clean up task archive","quicktasker")),{success:!1,deletedTaskIds:[]}}}))}},Ns=(e,t)=>{var s,a,n,i,o,r,c,l;switch(t.type){case xe:{const s=t.payload;return Object.assign(Object.assign({},e),{archivedTasks:s.map(ws)})}case ge:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveSearchValue:s})}case ve:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveFilteredPipelineId:s})}case je:{const a=(null!==(s=e.archivedTasks)&&void 0!==s?s:[]).filter((e=>e.id!==t.payload));return Object.assign(Object.assign({},e),{archivedTasks:a})}case be:{const s=t.payload,n=(null!==(a=e.archivedTasks)&&void 0!==a?a:[]).filter((e=>!s.includes(e.id)));return Object.assign(Object.assign({},e),{archivedTasks:n})}case ye:{const{taskId:s,user:a}=t.payload,i=(null!==(n=e.archivedTasks)&&void 0!==n?n:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:as(a)?[a,...e.assigned_users]:e.assigned_users,assigned_wp_users:ns(a)?[a,...e.assigned_wp_users]:e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case Ee:{const{taskId:s,user:a}=t.payload,n=(null!==(i=e.archivedTasks)&&void 0!==i?i:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:as(a)?e.assigned_users.filter((e=>e.id!==a.id)):e.assigned_users,assigned_wp_users:ns(a)?e.assigned_wp_users.filter((e=>e.id!==a.id)):e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case Te:{const{taskId:s,done:a}=t.payload,n=(null!==(o=e.archivedTasks)&&void 0!==o?o:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:a}):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case Se:{const s=t.payload,a=(null!==(r=e.archivedTasks)&&void 0!==r?r:[]).map((e=>e.id===s.id?ws(s):e));return Object.assign(Object.assign({},e),{archivedTasks:a})}case Ae:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskDoneFilter:s})}case Oe:{const{taskId:s,label:a}=t.payload,n=(null!==(c=e.archivedTasks)&&void 0!==c?c:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_labels:[...e.assigned_labels,a]}):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case Ne:{const{taskId:s,labelId:a}=t.payload,n=(null!==(l=e.archivedTasks)&&void 0!==l?l:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_labels:e.assigned_labels.filter((e=>e.id!==a))}):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case Ce:{const s=t.payload;return Object.assign(Object.assign({},e),{archivedTaskLimit:s})}case Ie:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveLoading:s})}case De:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveFilterOrder:s})}default:return e}};var Cs,Is,Ds,Ps,Rs,Ls;!function(e){e.Task="task",e.User="user"}(Cs||(Cs={})),function(e){e.System="system",e.Admin="admin",e.WPQTUser="quicktasker_user",e.Automation="automation",e.Import="import"}(Is||(Is={})),function(e){e.All="",e.Completed="1",e.NotCompleted="0"}(Ds||(Ds={})),function(e){e.Admin="administrator",e.Other="other"}(Ps||(Ps={})),function(e){e.ALL="",e.ONE_HUNDRED="100",e.TWO_HUNDRED="200",e.FIVE_HUNDRED="500"}(Rs||(Rs={})),function(e){e.ASC="ASC",e.DESC="DESC"}(Ls||(Ls={}));var Ms=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Us={archivedTasks:null,archiveLoading:!1,archiveSearchValue:"",archiveFilteredPipelineId:"",archiveTaskDoneFilter:Ds.All,archivedTaskLimit:Rs.ONE_HUNDRED,archiveFilterOrder:Ls.DESC},Fs=(0,a.createContext)({state:Us,archiveDispatch:()=>{},fetchAndSetArchivedTasks:()=>Ms(void 0,void 0,void 0,(function*(){}))}),Ks=({children:e})=>{const[t,s]=(0,a.useReducer)(Ns,Us);(0,a.useEffect)((()=>{r()}),[]);const r=()=>Ms(void 0,void 0,void 0,(function*(){try{s({type:Ie,payload:!0});const{data:e}=yield function(e){const t=new URLSearchParams;return e.search&&t.set("search",e.search),e.pipelineId&&t.set("pipelineId",e.pipelineId),e.doneFilter&&t.set("status",e.doneFilter),null!==e.limit&&t.set("limit",String(e.limit)),e.order&&t.set("order",e.order),Wt()({path:`/wpqt/v1/tasks/archived?${t}`,method:"GET",headers:Qt()})}({search:t.archiveSearchValue,pipelineId:t.archiveFilteredPipelineId,doneFilter:t.archiveTaskDoneFilter,limit:t.archivedTaskLimit,order:t.archiveFilterOrder});s({type:xe,payload:e})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch archived tasks","quicktasker"))}finally{s({type:Ie,payload:!1})}}));return(0,n.jsx)(Fs.Provider,{value:{state:t,archiveDispatch:s,fetchAndSetArchivedTasks:r},children:e})},$s=()=>Object.assign({},Vs),zs=(e,t)=>{var s,a,n,i,o,r,c,l,d,u,p,h,m,w,f,k;switch(t.type){case U:{const{taskToEdit:s,taskModalSettings:a}=t.payload;return Object.assign(Object.assign({},e),{taskModalOpen:!0,taskToEdit:s,targetStageId:s.stage_id,taskModalSettings:Object.assign(Object.assign({},e.taskModalSettings),a)})}case F:return $s();case Q:{const d=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:as(d)?[d,...null!==(a=null===(s=e.taskToEdit)||void 0===s?void 0:s.assigned_users)&&void 0!==a?a:[]]:null!==(i=null===(n=e.taskToEdit)||void 0===n?void 0:n.assigned_users)&&void 0!==i?i:[],assigned_wp_users:ns(d)?[d,...null!==(r=null===(o=e.taskToEdit)||void 0===o?void 0:o.assigned_wp_users)&&void 0!==r?r:[]]:null!==(l=null===(c=e.taskToEdit)||void 0===c?void 0:c.assigned_wp_users)&&void 0!==l?l:[]})})}case Y:{const s=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:as(s)?(null!==(u=null===(d=e.taskToEdit)||void 0===d?void 0:d.assigned_users)&&void 0!==u?u:[]).filter((e=>e.id!==s.id)):null!==(h=null===(p=e.taskToEdit)||void 0===p?void 0:p.assigned_users)&&void 0!==h?h:[],assigned_wp_users:ns(s)?(null!==(w=null===(m=e.taskToEdit)||void 0===m?void 0:m.assigned_wp_users)&&void 0!==w?w:[]).filter((e=>e.id!==s.id)):null!==(k=null===(f=e.taskToEdit)||void 0===f?void 0:f.assigned_wp_users)&&void 0!==k?k:[]})})}case K:{const{targetPipelineId:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,targetPipelineId:s})}case z:{const{stageToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,stageToEdit:s})}case $:return $s();case G:return Object.assign(Object.assign({},e),{newPipelineModalOpen:!0});case V:{const{pipelineToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{pipelineModalOpen:!0,pipelineToEdit:s})}case B:return $s();case"OPEN_ARCHIVE_TASK_MODAL":{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskModalOpen:!0,archiveModalTask:s})}case"CLOSE_ARCHIVE_TASK_MODAL":return $s();case"OPEN_NEW_USER_MODAL":return Object.assign(Object.assign({},e),{userModalOpen:!0});case W:{const s=t.payload;return Object.assign(Object.assign({},e),{userModalOpen:!0,userToEdit:s})}case H:return $s();case J:return t.payload?Object.assign(Object.assign({},e),{userSettingsModalOpen:!0}):$s();case"CHANGE_TASK_DONE_STATUS":{const{done:s}=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{is_done:s})})}case X:{const{task:s}=t.payload;return Object.assign(Object.assign({},e),{moveTaskModalOpen:!0,taskToEdit:s})}case Z:return $s();case ee:{const{task:s}=t.payload;return Object.assign(Object.assign({},e),{taskColorModalOpen:!0,taskToEdit:s})}case te:return $s();case se:{const{selectedMethod:s}=t.payload;return Object.assign(Object.assign({},e),{taskExportModalOpen:!0,taskExportModalSettings:Object.assign(Object.assign({},e.taskExportModalSettings),{selectedMethod:s})})}case ae:return $s();case ne:{const{selectedMethod:s}=t.payload;return Object.assign(Object.assign({},e),{taskExportModalSettings:Object.assign(Object.assign({},e.taskExportModalSettings),{selectedMethod:s})})}case ie:return Object.assign(Object.assign({},e),{pipelineImportModalOpen:!0});case oe:return $s();case re:return Object.assign(Object.assign({},e),{automationCreatorModalOpen:!0});case ce:return $s();case le:return Object.assign(Object.assign({},e),{automationsModalOpen:!0});case de:return $s();case ue:return t.payload?Object.assign(Object.assign({},e),{archiveSettingsModalOpen:!0}):$s();case pe:{const{taskToRestore:s}=t.payload;return Object.assign(Object.assign({},e),{taskRestoreModalOpen:!0,taskRestoreModalSettings:Object.assign(Object.assign({},e.taskRestoreModalSettings),{taskToRestore:s})})}case me:{const s=t.payload;return Object.assign(Object.assign({},e),{customFieldCreatorModalOpen:s})}case we:{const s=t.payload;return Object.assign(Object.assign({},e),{customFieldRecoveryModalOpen:s})}case he:return $s();case fe:{const s=t.payload;return Object.assign(Object.assign({},e),{webhookCreationModalOpen:s})}case ke:{const s=t.payload;return Object.assign(Object.assign({},e),{webhooksModalOpen:s})}case qe:{const{webhookId:s}=t.payload;return Object.assign(Object.assign({},e),{webhooksLogsModalOpen:!0,webhooksLogsModalSettings:Object.assign(Object.assign({},e.webhooksLogsModalSettings),{webhookId:s})})}case _e:return Object.assign(Object.assign({},e),{webhooksLogsModalOpen:!1,webhooksLogsModalSettings:Object.assign({},Vs.webhooksLogsModalSettings)});case"UPDATE_WEBHOOKS_LOGS_MODAL_SETTINGS":{const s=t.payload;return Object.assign(Object.assign({},e),{webhooksLogsModalSettings:Object.assign(Object.assign({},e.webhooksLogsModalSettings),s)})}default:return e}};var Gs;!function(e){e.PDF="pdf",e.CSV="csv",e.JSON="json"}(Gs||(Gs={}));const Vs={taskModalOpen:!1,targetStageId:"",taskToEdit:null,taskModalSettings:{allowToMarkTaskAsDone:!0},moveTaskModalOpen:!1,stageModalOpen:!1,stageToEdit:null,targetPipelineId:"",pipelineModalOpen:!1,newPipelineModalOpen:!1,pipelineToEdit:null,archiveTaskModalOpen:!1,archiveModalTask:null,userModalOpen:!1,userToEdit:null,userSettingsModalOpen:!1,taskColorModalOpen:!1,taskExportModalOpen:!1,taskExportModalSettings:{selectedMethod:Gs.PDF},pipelineImportModalOpen:!1,automationCreatorModalOpen:!1,automationsModalOpen:!1,archiveSettingsModalOpen:!1,taskRestoreModalOpen:!1,taskRestoreModalSettings:{taskToRestore:null},customFieldCreatorModalOpen:!1,customFieldRecoveryModalOpen:!1,webhookCreationModalOpen:!1,webhooksModalOpen:!1,webhooksLogsModalOpen:!1,webhooksLogsModalSettings:{webhookId:null}},Bs=(0,a.createContext)({state:Vs,modalDispatch:()=>{}}),Hs=({children:e})=>{const[t,s]=(0,a.useReducer)(zs,Vs);return(0,n.jsx)(Bs.Provider,{value:{state:t,modalDispatch:s},children:e})};var Ws=s(2922),Qs=s(6053),Ys=s(9828),Js=s(540),Xs=s(4576),Zs=s(5138),ea=s(6061);function ta({width:e="80",height:t="80",className:s="",color:a="#1d4ed8",secondaryColor:i="#2563eb"}){return(0,n.jsx)(ea.BM,{visible:!0,height:t,width:e,color:a,secondaryColor:i,ariaLabel:"oval-loading",wrapperStyle:{},wrapperClass:s})}function sa(){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-flex-col wpqt-items-center wpqt-justify-center",children:(0,n.jsx)(ta,{})})}function aa({className:e="",ovalSize:t}){const s=t?{width:t,height:t}:{};return(0,n.jsx)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center ${e}`,"data-testid":"loading-oval",children:(0,n.jsx)(ta,Object.assign({},s))})}var na,ia,oa=s(7008);function ra({id:e}){return(0,n.jsx)(oa.m_,{id:e,className:"wpqt-bg-red-600 wpqt-z-9999",children:(0,n.jsx)("span",{children:"Tooltip content"})})}function ca({onClick:e=()=>{},btnText:t,className:s,type:a=na.BUTTON,disabled:i=!1,loading:o=!1,buttonStyleType:r=ia.PRIMARY}){const c=r===ia.PRIMARY?"wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-transparent wpqt-bg-blue-500 wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-text-white wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 focus:wpqt-ring-blue-800 enabled:hover:wpqt-bg-blue-600":r===ia.SECONDARY?"wpqt-inline-flex wpqt-cursor-pointer wpqt-bg-gray-100 wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 enabled:hover:wpqt-bg-gray-200":"wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-transparent wpqt-bg-red-500 wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-text-white wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 focus:wpqt-ring-red-800 enabled:hover:wpqt-bg-red-600";return(0,n.jsx)(Zs.$,{disabled:i||o,className:`${c} ${s}`,onClick:e,type:a,children:o?(0,n.jsx)(ta,{width:"24",height:"24",color:"#ffffff",secondaryColor:"#ffffff"}):t})}function la({icon:e,text:t,onClick:s=()=>{},className:a,tooltipId:i,tooltipText:o,loading:r=!1}){const c=o&&i,l=c?{"data-tooltip-id":i,"data-tooltip-content":o,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,n.jsxs)("div",Object.assign({},l,{className:`wpqt-main-border wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-bg-gray-100 wpqt-p-2 hover:wpqt-bg-white ${a}`,onClick:s,children:[e,t||r?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center wpqt-relative",children:[t&&(0,n.jsx)("span",{className:"wpqt-whitespace-nowrap "+(r?"wpqt-invisible":""),children:t}),r&&(0,n.jsx)(ta,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]}):null,c&&(0,n.jsx)(ra,{id:i})]}))}function da({icon:e,onClick:t=()=>{},className:s,loading:a=!1}){return(0,n.jsxs)("div",{className:`wpqt-main-border wpqt-p-1 wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-bg-gray-100 hover:wpqt-bg-white ${s}`,onClick:t,children:[(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center "+(a?"wpqt-invisible":""),children:e}),a&&(0,n.jsx)(ta,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]})}function ua({modalOpen:e,closeModal:t,children:s,size:a="sm"}){return(0,n.jsxs)(Ws.lG,{open:e,as:"div",className:"wpqt-relative wpqt-z-9999 focus:wpqt-outline-none",onClose:t,children:[(0,n.jsx)(Ws.Xi,{className:"wpqt-fixed wpqt-inset-0 wpqt-bg-black/40"}),(0,n.jsx)("div",{className:"wpqt-fixed wpqt-inset-0 wpqt-z-10 wpqt-w-screen wpqt-overflow-y-auto",children:(0,n.jsx)("div",{className:"wpqt-mt-[8vh] wpqt-flex wpqt-justify-center",children:(0,n.jsxs)(Ws.Lj,{transition:!0,className:`data-[closed]:wpqt-transform-[wpqt-scale(95%)] wpqt-relative wpqt-mt-[20px] wpqt-w-4/5 ${{sm:"wpqt-max-w-sm",md:"wpqt-max-w-lg",lg:"wpqt-max-w-4xl",xl:"wpqt-max-w-6xl"}[a]} wpqt-rounded-xl wpqt-bg-white wpqt-p-8 wpqt-backdrop-blur-2xl wpqt-duration-300 wpqt-ease-out data-[closed]:wpqt-opacity-0`,children:[(0,n.jsx)("div",{className:"wpqt-group wpqt-absolute wpqt-right-[-20px] wpqt-top-[-20px] wpqt-flex wpqt-h-[40px] wpqt-w-[40px] wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-rounded-full wpqt-border wpqt-border-solid wpqt-bg-white wpqt-text-qtBorder",onClick:t,"data-testid":"wpqt-modal-close-button",children:(0,n.jsx)(Xs.A,{className:"wpqt-icon-blue group-hover:wpqt-icon-red wpqt-size-5"})}),s]})})})]})}function pa({children:e,className:t=""}){return(0,n.jsx)(Ws.L3,{as:"div",className:`wpqt-text-base wpqt-font-semibold wpqt-text-black wpqt-mb-2 ${t}`,children:e})}function ha({children:e}){return(0,n.jsx)(Qs.L,{children:e})}function ma({label:e,children:t,tooltipId:s,tooltipText:a}){const i=s&&a,o=i?{"data-tooltip-id":s,"data-tooltip-content":a,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info","data-tooltip-place":"top-end"}:{};return(0,n.jsxs)(Ys.D,{className:"wpqt-mb-3",children:[(0,n.jsx)(Js.JU,Object.assign({className:"wpqt-mb-2 wpqt-block wpqt-text-sm/6 wpqt-font-medium"},o,{children:e})),t,i&&(0,n.jsx)(ra,{id:s})]})}function wa({onSave:e,saveBtnText:t,loading:s=!1}){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-end wpqt-px-2",children:(0,n.jsx)(ca,{btnText:t,loading:s,onClick:e})})}!function(e){e.BUTTON="button",e.SUBMIT="submit",e.RESET="reset"}(na||(na={})),function(e){e.PRIMARY="primary",e.SECONDARY="secondary",e.DANGER="danger"}(ia||(ia={}));var fa=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ka({title:e,description:t,onSave:s,icon:i,saveBtnText:r=(0,o.__)("Clean","quicktask")}){const[c,l]=(0,a.useState)(!1);return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-lg",children:e}),(0,n.jsx)("p",{className:"wpqt-mt-0",children:t}),(0,n.jsx)(la,{onClick:()=>fa(this,void 0,void 0,(function*(){c||(l(!0),yield s(),l(!1))})),icon:i,loading:c,text:r})]})}var qa=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function _a(){const{state:{archiveSettingsModalOpen:e},modalDispatch:t}=(0,a.useContext)(Bs),{cleanupTaskArchive:s}=Os(),{archiveDispatch:i}=function(){const{archiveDispatch:e}=(0,a.useContext)(Fs);return{archiveDispatch:e}}();return(0,n.jsx)(ua,{modalOpen:e,closeModal:()=>{t({type:ue,payload:!1})},size:"md",children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:(0,n.jsx)(ka,{title:(0,o.__)("Archive cleanup","quicktasker"),description:(0,o.__)("Remote tasks from archive that have no parent board.","quicktasker"),icon:(0,n.jsx)(u.xWQ,{className:"wpqt-size-6"}),onSave:()=>qa(this,void 0,void 0,(function*(){const{success:e,deletedTaskIds:t}=yield s();e&&t.length>0&&i({type:be,payload:t})}))})})})}var xa=s(1489);const ga=(e,t)=>{var s;switch(t.type){case j:{const s=t.payload,a=e=>Object.assign({},fs(e)),n=e=>{var t;return Object.assign(Object.assign({},e),{stages:null===(t=e.stages)||void 0===t?void 0:t.map(a),settings:e.settings?is(e.settings):void 0,is_primary:"1"===e.is_primary})};return Object.assign(Object.assign({},e),{pipelines:s.map(n)})}case x:{const a=t.payload,n=e=>Object.assign({},fs(e)),i=Object.assign(Object.assign({},a),{stages:null===(s=a.stages)||void 0===s?void 0:s.map(n),settings:a.settings?is(a.settings):void 0,is_primary:!1});return Object.assign(Object.assign({},e),{pipelines:[...e.pipelines,i]})}case v:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>Object.assign(Object.assign({},e),{is_primary:e.id===s})))})}case g:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>e.id===s.id?Object.assign(Object.assign({},e),{name:s.name,description:s.description}):e))})}case T:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.filter((e=>e.id!==s))})}default:return e}},va={pipelines:[]},ja=(0,a.createContext)({state:va,pipelinesDispatch:()=>{}}),ba=({children:e})=>{const[t,s]=(0,a.useReducer)(ga,va);return(0,a.useEffect)((()=>{const e=window.wpqt.initialPipelines;s({type:j,payload:e})}),[]),(0,n.jsx)(ja.Provider,{value:{state:t,pipelinesDispatch:s},children:e})};function ya(){const{state:{pipelines:e},pipelinesDispatch:t}=(0,a.useContext)(ja);return{pipelines:e,pipelinesDispatch:t,checkIfPipelineNameExists:function(t){return e.some((e=>e.name.toLowerCase()===t.toLowerCase()))}}}var Ea=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};function Ta(e){var{children:t,labelFor:s,className:a=""}=e,i=Ea(e,["children","labelFor","className"]);return(0,n.jsx)("label",Object.assign({htmlFor:s,className:`wpqt-mb-1 ${a}`},i,{children:t}))}var Sa=s(3482);function Aa({options:e,selectedOptionValue:t,onSelectionChange:s,allSelector:a=!0,className:i="",allSelectorLabel:o="All boards",id:r}){return(0,n.jsxs)(Sa.l,{id:r,value:t,onChange:e=>{const t=e.target.value;s(t)},className:`!wpqt-rounded-lg !wpqt-border !wpqt-border-solid !wpqt-border-qtBorder !wpqt-px-2 !wpqt-pr-6 !wpqt-py-1 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`,children:[a&&(0,n.jsx)("option",{value:"",children:o}),e.map((e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value)))]})}var Oa,Na=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ca(){var e;const{state:{taskRestoreModalOpen:t,taskRestoreModalSettings:s},modalDispatch:i}=(0,a.useContext)(Bs),{archiveDispatch:r}=(0,a.useContext)(Fs),{pipelines:c}=ya(),{restoreArchivedTask:l}=Os(),d=(0,a.useMemo)((()=>c.map((e=>({value:e.id,label:e.name})))),[c]),[u,p]=(0,a.useState)(""),[h,m]=(0,a.useState)(!1),[w,f]=(0,a.useState)([]);return(0,a.useEffect)((()=>{var e;const t=(null===(e=null==s?void 0:s.taskToRestore)||void 0===e?void 0:e.pipeline_id)||"";t?p(t):d.length>0&&p(d[0].value)}),[s,d]),(0,n.jsx)(ua,{modalOpen:t,closeModal:()=>{i({type:he}),f([])},children:(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start",children:[(0,n.jsx)(pa,{children:(0,o.sprintf)((0,o.__)("Restore %s","quicktasker"),(null===(e=null==s?void 0:s.taskToRestore)||void 0===e?void 0:e.name)||"")}),(0,n.jsx)(Ta,{labelFor:"task-restore-pipeline-select",children:(0,o.__)("Select the board to restore to","quicktasker")}),(0,n.jsx)(Aa,{options:d,className:"wpqt-mb-2",allSelector:!1,selectedOptionValue:u,id:"task-restore-pipeline-select",onSelectionChange:e=>{p(e),f([])}}),w.length>0&&(0,n.jsx)("div",{className:"wpqt-text-red-500",children:w.map(((e,t)=>(0,n.jsx)("p",{className:"wpqt-mt-0 wpqt-mb-1",children:e},t)))}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-end wpqt-w-full",children:(0,n.jsx)(la,{icon:(0,n.jsx)(xa.A,{className:"wpqt-icon-green wpqt-size-4"}),loading:h,text:(0,o.__)("Restore","quicktasker"),onClick:()=>Na(this,void 0,void 0,(function*(){const e=null==s?void 0:s.taskToRestore;e&&u&&!h&&(m(!0),yield l(e.id,u,(({success:t,messages:s})=>{t?(r({type:je,payload:e.id}),i({type:he})):s&&s.length>0&&f(s)})),m(!1))}))})})]})})})}!function(e){e.SELECTION="select",e.CREATION="create",e.EDIT="edit"}(Oa||(Oa={}));const Ia=(e,t)=>{switch(t.type){case lt:return Object.assign(Object.assign({},e),{labels:t.payload});case dt:return Object.assign(Object.assign({},e),{labels:e.labels?[...e.labels,t.payload]:[t.payload],labelActionState:Oa.SELECTION});case pt:return Object.assign(Object.assign({},e),{labels:e.labels?e.labels.map((e=>e.id===t.payload.id?t.payload:e)):[t.payload]});case ut:return Object.assign(Object.assign({},e),{labels:e.labels?e.labels.filter((e=>e.id!==t.payload.id)):[]});case ht:return Object.assign(Object.assign({},e),{labelActionState:Oa.SELECTION,labelToEdit:null});case mt:return Object.assign(Object.assign({},e),{labelActionState:Oa.EDIT,labelToEdit:t.payload});case wt:return Object.assign(Object.assign({},e),{labelActionState:Oa.CREATION,labelToEdit:null});case ft:return Da;default:return e}},Da={labels:null,labelActionState:Oa.SELECTION,labelToEdit:null},Pa=(0,a.createContext)({state:Da,labelDispatch:()=>{}}),Ra=({children:e})=>{const[t,s]=(0,a.useReducer)(Ia,Da);return(0,n.jsx)(Pa.Provider,{value:{state:t,labelDispatch:s},children:e})};function La({children:e}){const{state:{fullPageLoading:t}}=(0,a.useContext)(gs);return(0,n.jsx)("div",{className:"wpqt-pr-4",children:t?(0,n.jsx)(sa,{}):e})}var Ma,Ua=s(4175),Fa=s(2912);!function(e){e.TEXT="text",e.PASSWORD="password"}(Ma||(Ma={}));const Ka=(0,a.forwardRef)(((e,t)=>{var{value:s,onChange:a,isAutoFocus:i,className:o="",wrapperClassName:r="",disabled:c=!1,type:l=Ma.TEXT,loading:d=!1,inputId:u,name:p}=e,h=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s}(e,["value","onChange","isAutoFocus","className","wrapperClassName","disabled","type","loading","inputId","name"]);return(0,n.jsxs)("div",{className:`wpqt-inline-block wpqt-relative wpqt-mb-3 ${r}`,children:[(0,n.jsx)(Fa.p,Object.assign({ref:t,autoFocus:i,className:`wpqt-block !wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${o}`,value:s,disabled:c,onChange:e=>a(e.target.value),type:l,id:u,name:p},h)),d&&(0,n.jsx)(ta,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"})]})}));function $a({selectedOptionValue:e,selectionChange:t,extraOptions:s=[]}){const{state:{pipelines:i}}=(0,a.useContext)(ja),o=(0,a.useMemo)((()=>i.map((e=>({value:e.id,label:e.name})))),[i]);return(0,n.jsx)(Aa,{options:[...o,...s],selectedOptionValue:e,onSelectionChange:t})}function za({children:e,searchChildren:t,applyFilterChildren:s,title:a,childrenClassName:i="",titleClassName:o=""}){return(0,n.jsxs)("div",{className:"wpqt-mb-8",children:[(0,n.jsx)("div",{className:`wpqt-mb-3 wpqt-text-lg wpqt-text-center wpqt-font-semibold ${o}`,children:a}),(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-justify-center wpqt-gap-2",children:t}),(0,n.jsx)("div",{className:`wpqt-flex wpqt-gap-5 wpqt-items-center wpqt-justify-center wpqt-mb-6 ${i}`,children:e}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:s})]})}function Ga({children:e,title:t,className:s="",labelIdFor:a}){return(0,n.jsxs)("div",{className:`wpqt-flex wpqt-flex-col ${s}`,children:[(0,n.jsx)(Ta,{labelFor:a,children:t}),e]})}function Va(){const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s,archivedTaskLimit:i,archiveFilterOrder:r},archiveDispatch:c,fetchAndSetArchivedTasks:l}=(0,a.useContext)(Fs),d=(0,n.jsx)(la,{text:(0,o.__)("Apply filter","quicktasker"),icon:(0,n.jsx)(Ua.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:l});return(0,n.jsxs)(za,{title:(0,o.__)("Archive filtering","quicktasker"),applyFilterChildren:d,searchChildren:(0,n.jsx)(Ga,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"archive-search",children:(0,n.jsx)(Ka,{inputId:"archive-search",value:e,onChange:e=>{c({type:ge,payload:e})}})}),children:[(0,n.jsx)(Ga,{title:(0,o.__)("Task board","quicktasker"),children:(0,n.jsx)($a,{selectedOptionValue:t,selectionChange:e=>{c({type:ve,payload:e})}})}),(0,n.jsx)(Ga,{title:(0,o.__)("Task status","quicktasker"),children:(0,n.jsx)(Aa,{allSelector:!1,selectedOptionValue:s,options:[{label:(0,o.__)("All","quicktasker"),value:Ds.All},{label:(0,o.__)("Completed","quicktasker"),value:Ds.Completed},{label:(0,o.__)("Not completed","quicktasker"),value:Ds.NotCompleted}],onSelectionChange:e=>{const t=(e=>{switch(e){case Ds.All:return Ds.All;case Ds.Completed:return Ds.Completed;case Ds.NotCompleted:return Ds.NotCompleted;default:throw new Error(`Invalid selection: ${e}`)}})(e);c({type:Ae,payload:t})}})}),(0,n.jsx)(Ga,{title:(0,o.__)("Number of tasks","quicktasker"),children:(0,n.jsx)(Aa,{allSelector:!1,selectedOptionValue:i,options:[{label:(0,o.__)("Show all","quicktasker"),value:Rs.ALL},{label:(0,o.__)("Show 100","quicktasker"),value:Rs.ONE_HUNDRED},{label:(0,o.__)("Show 200","quicktasker"),value:Rs.TWO_HUNDRED},{label:(0,o.__)("Show 500","quicktasker"),value:Rs.FIVE_HUNDRED}],onSelectionChange:e=>{c({type:Ce,payload:e})}})}),(0,n.jsx)(Ga,{title:(0,o.__)("Task order","quicktasker"),children:(0,n.jsx)(Aa,{allSelector:!1,selectedOptionValue:r,options:[{label:(0,o.__)("Desc","quicktasker"),value:Ls.DESC},{label:(0,o.__)("Asc","quicktasker"),value:Ls.ASC}],onSelectionChange:e=>{c({type:De,payload:e})}})})]})}const Ba=(e,t)=>{switch(t.type){case Pe:{const s=t.payload.map(ps);return Object.assign(Object.assign({},e),{users:s})}case Re:{const s=t.payload.map((e=>Object.assign(Object.assign({},e),{id:String(e.id)})));return Object.assign(Object.assign({},e),{wpUsers:s})}case Le:{const s=t.payload,a=ps(s);return Object.assign(Object.assign({},e),{users:[...e.users,a]})}case Ue:{const s=t.payload,a=ps(s),n=e.users.map((e=>e.id===a.id?Object.assign(Object.assign({},e),a):e));return Object.assign(Object.assign({},e),{users:n})}case Ke:{const{isActive:s,userId:a}=t.payload,n=e.users.map((e=>e.id===a?Object.assign(Object.assign({},e),{is_active:s}):e));return Object.assign(Object.assign({},e),{users:n})}case $e:{const s=t.payload,a=e.users.map((e=>e.id===s?Object.assign(Object.assign({},e),{has_password:!1}):e));return Object.assign(Object.assign({},e),{users:a})}case Fe:{const s=t.payload,a=e.users.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{users:a})}case Me:{const s=t.payload;return Object.assign(Object.assign({},e),{usersSearchValue:s})}default:return e}};var Ha=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Wa={users:[],wpUsers:[],usersSearchValue:""},Qa=(0,a.createContext)({state:Wa,userDispatch:()=>{},updateUsers:()=>Ha(void 0,void 0,void 0,(function*(){}))}),Ya=({children:e})=>{const[t,s]=(0,a.useReducer)(Ba,Wa);return(0,a.useEffect)((()=>{const e=window.wpqt.initialUsers,t=window.wpqt.initialWPUsers;s({type:Pe,payload:e}),s({type:Re,payload:t})}),[]),(0,n.jsx)(Qa.Provider,{value:{state:t,userDispatch:s,updateUsers:()=>Ha(void 0,void 0,void 0,(function*(){try{const e=yield Wt()({path:"/wpqt/v1/users",method:"GET",headers:Qt()});s({type:Pe,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch users","quicktasker"))}}))},children:e})};var Ja;!function(e){e.ACTIVE_PIPELINE="ACTIVE_PIPELINE",e.PIPELINES="PIPELINES",e.USER="USER"}(Ja||(Ja={}));const Xa=e=>{const[t,s]=(0,a.useState)(!1),n=(0,a.useRef)(null),{modalDispatch:i}=(0,a.useContext)(Bs),{dispatch:o}=(0,a.useContext)(bs),{pipelinesDispatch:r}=(0,a.useContext)(ja),{userDispatch:c}=(0,a.useContext)(Qa);return{modalSaving:t,setModalSaving:s,modalContentRef:n,closeModal:()=>{i({type:e}),n.current&&n.current.clearContent()},handleSuccess:(e,t,a)=>{let n;switch(a){case Ja.PIPELINES:n=r;break;case Ja.ACTIVE_PIPELINE:n=o;break;case Ja.USER:n=c;break;default:n=o}s(!1),n({type:e,payload:t})},handleError:e=>{s(!1),console.error(e)}}},Za=(e,t)=>{switch(t.type){case Ct:return Object.assign(Object.assign({},e),{uploads:t.payload});case It:return Object.assign(Object.assign({},e),{uploads:[...e.uploads,t.payload]});case Dt:return Object.assign(Object.assign({},e),{uploads:e.uploads.filter((e=>e.id!==t.payload))});default:return e}},en={uploads:[]},tn=(0,a.createContext)({state:en,uploadDispatch:()=>{}}),sn=({children:e})=>{const[t,s]=(0,a.useReducer)(Za,en);return(0,n.jsx)(tn.Provider,{value:{state:t,uploadDispatch:s},children:e})};var an=s(8448),nn=s(8176),on=s(1052);function rn(){const[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1);return{loading1:e,loading2:s,setLoading1:t,setLoading2:n,loading3:i,setLoading3:o}}const cn=(e,t)=>{switch(t.type){case"SET_SITE_URL":{const s=t.payload;return Object.assign(Object.assign({},e),{siteURL:s})}case ze:{const{siteURL:s,publicUserPageId:a,timezone:n,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r,taskUploadsURL:c}=t.payload;return Object.assign(Object.assign({},e),{siteURL:s,publicUserPageId:a,timezone:n,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r,taskUploadsURL:c})}case Ge:{const s=t.payload;return Object.assign(Object.assign({},e),{userPageCustomStyles:s})}default:return e}},ln={siteURL:"",pluginURL:"",publicUserPageId:"",is_customFields:!1,timezone:"",isUserAllowedToDelete:!1,userPageCustomStyles:"",taskUploadsURL:""},dn=(0,a.createContext)({state:ln,appDispatch:()=>{}}),un=({children:e})=>{const[t,s]=(0,a.useReducer)(cn,ln);return(0,a.useEffect)((()=>{const e=window.wpqt.siteURL,t=window.wpqt.publicUserPageId,a=window.wpqt.timezone,n="1"===window.wpqt.isUserAllowedToDelete,i=window.wpqt.userPageCustomStyles,o=window.wpqt.pluginURL,r=window.wpqt.taskUploadsURL;s({type:ze,payload:{siteURL:e,publicUserPageId:t,timezone:a,isUserAllowedToDelete:n,userPageCustomStyles:i,pluginURL:o,taskUploadsURL:r}})}),[]),(0,n.jsx)(dn.Provider,{value:{state:t,appDispatch:s},children:e})};var pn,hn,mn;!function(e){e.Text="text",e.Select="select",e.Checkbox="checkbox",e.Radio="radio",e.Datetime="datetime",e.File="file"}(pn||(pn={})),function(e){e.QUICKTASKER="quicktasker",e.WP_USER="wp-user",e.Pipeline="pipeline",e.Users="users",e.Task="task"}(hn||(hn={})),function(e){e.TASK="task"}(mn||(mn={}));function wn({value:e,onChange:t,debounceTimeout:s=Pt,isAutoFocus:i=!1,wrapperClassName:o,className:r}){const[c,l]=(0,a.useState)(e),[d,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{l(e)}),[e]),(0,a.useEffect)((()=>{if(!p)return;const e=setTimeout((()=>{return e=this,s=void 0,n=function*(){h(!1),u(!0),yield t(c),u(!1)},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n}),s);return()=>clearTimeout(e)}),[c,p,s,t]),(0,n.jsx)(Ka,{isAutoFocus:i,value:c,onChange:e=>{l(e),h(!0)},wrapperClassName:o,className:r,loading:d,disabled:d})}var fn=s(1062),kn=s(4164);function qn({value:e,onChange:t,rowsCount:s=3,colsCount:a,className:i="",disabled:o=!1,loading:r=!1}){return(0,n.jsxs)("div",{className:"wpqt-relative wpqt-mb-3",children:[(0,n.jsx)(fn.T,{className:(0,kn.$)("wpqt-border-1 wpqt-mb-3 wpqt-block wpqt-w-auto wpqt-resize-none wpqt-rounded-lg wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6",`focus:wpqt-shadow-none focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`),rows:s,cols:a,value:e,onChange:e=>t(e.target.value),disabled:o}),r&&(0,n.jsx)(ta,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"})]})}function _n({value:e,onChange:t,debounceTimeout:s=Pt,className:i}){const[o,r]=(0,a.useState)(e),[c,l]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{r(e)}),[e]),(0,a.useEffect)((()=>{if(!d)return;const e=setTimeout((()=>{return e=this,s=void 0,n=function*(){u(!1),l(!0),yield t(o),l(!1)},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n}),s);return()=>clearTimeout(e)}),[o,d,s,t]),(0,n.jsx)(qn,{rowsCount:3,value:o,className:i,onChange:e=>{r(e),u(!0)},disabled:c,loading:c})}const xn=(e,t)=>{switch(t.type){case rt:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case ct:{const{entityId:s,entityType:a}=t.payload;return Object.assign(Object.assign({},e),{entityId:s,entityType:a})}case nt:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:s})}case it:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:[...e.customFields,s]})}case ot:{const s=t.payload,a=e.customFields.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{customFields:a})}default:return e}};const gn={customFields:[],loading:!0,entityId:"",entityType:null},vn=(0,a.createContext)({state:gn,customFieldsDispatch:()=>{},fetchCustomFields:()=>{}}),jn=({children:e,entityId:t,entityType:s})=>{const[r,c]=(0,a.useReducer)(xn,gn);(0,a.useEffect)((()=>{l()}),[]),(0,a.useEffect)((()=>{c({type:ct,payload:{entityType:s,entityId:t}})}),[s,t]);const l=()=>{return e=void 0,a=void 0,r=function*(){try{c({type:rt,payload:!0});const e=yield ss(t,s,!0);c({type:nt,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch custom fields","quicktasker"))}finally{c({type:rt,payload:!1})}},new((n=void 0)||(n=Promise))((function(t,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(i,o)}c((r=r.apply(e,a||[])).next())}));var e,a,n,r};return(0,n.jsx)(vn.Provider,{value:{state:r,customFieldsDispatch:c,fetchCustomFields:l},children:e})};var bn=s(2767),yn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function En(){return{addCustomField:(e,t,s,a,n,r)=>yn(this,void 0,void 0,(function*(){try{const i=yield function(e,t,s,a,n){return Wt()({path:"/wpqt/v1/custom-fields",method:"POST",data:{entityId:e,entityType:t,type:s,name:a,description:n},headers:Qt()})}(e,t,s,a,n);r&&r(i.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add a custom field","quicktasker"))}})),markCustomFieldAsDeleted:(e,t)=>yn(this,void 0,void 0,(function*(){try{yield function(e){return Wt()({path:`/wpqt/v1/custom-fields/${e}`,method:"DELETE",headers:Qt()})}(e),t&&t()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to mark custom field as deleted","quicktasker"))}})),restoreCustomField:(e,t)=>yn(this,void 0,void 0,(function*(){try{const s=yield function(e){return Wt()({path:`/wpqt/v1/custom-fields/${e}/restore`,method:"PATCH",headers:Qt()})}(e);i.oR.success((0,o.__)("Custom field restored","quicktasker")),t&&t(s.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore custom field","quicktasker"))}})),updateCustomFieldValue:(e,t,s,a,n)=>yn(this,void 0,void 0,(function*(){try{yield function(e,t,s,a){return Wt()({path:`/wpqt/v1/custom-fields/${e}/value`,method:"PATCH",data:{value:t,entityId:String(s),entityType:a},headers:Qt()})}(e,t,s,a),i.oR.success((0,o.__)("Custom field value updated","quicktasker")),n&&n()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to update custom field value","quicktasker"))}})),updateCustomFieldDefaultValue:(e,t)=>yn(this,void 0,void 0,(function*(){try{return yield function(e,t){return Wt()({path:`/wpqt/v1/custom-fields/${e}/default-value`,method:"PATCH",data:{value:t},headers:Qt()})}(e,t),i.oR.success((0,o.__)("Custom field default value updated","quicktasker")),{success:!0}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to update custom field default value","quicktasker")),{success:!1}}}))}}function Tn({title:e,description:t,className:s=""}){return(0,n.jsxs)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center wpqt-h-full ${s}`,children:[e&&(0,n.jsx)("h2",{className:"wpqt-font-semibold",children:e}),t&&(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-4",children:t}),(0,n.jsx)("div",{className:"wpqt-text-blue-500 wpqt-font-semibold",children:(0,n.jsx)("a",{href:"https://payhip.com/b/84TLC",target:"_blank",rel:"noreferrer",children:(0,o.__)("Get the premium version","quicktasker")})})]})}var Sn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function An({description:e}){const[t,s]=(0,a.useState)(""),[i,r]=(0,a.useState)(""),[c,l]=(0,a.useState)(pn.Text),{addCustomField:d}=En(),{state:{entityId:u,entityType:p,customFields:h,loading:m},customFieldsDispatch:w}=(0,a.useContext)(vn),{state:{is_customFields:f}}=(0,a.useContext)(dn),[k,q]=(0,a.useState)(!1),{modalDispatch:_}=(0,a.useContext)(Bs),x=[{value:pn.Text,label:"Text"},{value:pn.Checkbox,label:"Checkbox"}],g=h.length>=1&&!f;return m?null:g?(0,n.jsx)(Tn,{description:(0,o.__)("Upgrade to premium to add more custom fields.","quicktasker")}):(0,n.jsxs)("div",{className:"wpqt-mb-6 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)("h2",{children:(0,o.__)("Custom Fields","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-mb-4 wpqt-text-center",children:[e,!f&&(0,n.jsxs)("span",{className:"wpqt-font-semibold",children:[" ",(0,o.__)("Free version allows only one custom field. To add more, please upgrade to premium.","quicktasker")]})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Name","quicktasker")}),(0,n.jsx)(Ka,{value:t,onChange:s})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Description","quicktasker")}),(0,n.jsx)(qn,{value:i,onChange:r})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Type","quicktasker")}),(0,n.jsx)(Aa,{selectedOptionValue:c,options:x,onSelectionChange:e=>{l(e)},allSelector:!1})]})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:(0,n.jsx)(la,{text:(0,o.__)("Add","quicktasker"),onClick:()=>Sn(this,void 0,void 0,(function*(){u&&p?(q(!0),yield d(u,p,c,t,i,(e=>{w({type:it,payload:e}),s(""),r(""),l(pn.Text),_({type:me,payload:!1})})),q(!1)):console.error("Entity ID or Entity Type is missing")})),loading:k,icon:(0,n.jsx)(bn.A,{className:"wpqt-icon-green wpqt-size-5"})})})]})}function On({description:e}){const{state:{customFieldCreatorModalOpen:t},modalDispatch:s}=(0,a.useContext)(Bs);return(0,n.jsx)(ua,{modalOpen:t,closeModal:()=>{s({type:me,payload:!1})},size:"lg",children:(0,n.jsx)(An,{description:e})})}var Nn=s(5066),Cn=s(4353),In=s.n(Cn),Dn=s(8569),Pn=s.n(Dn),Rn=s(3826),Ln=s.n(Rn);In().extend(Ln()),In().extend(Pn());const Mn=(e,t)=>{try{return In().utc(e).tz(t).format("MMMM D, YYYY HH:mm")}catch(t){return console.error("Error: ",t),e+" (UTC)"}},Un=()=>{const{state:{timezone:e}}=(0,a.useContext)(dn);return{convertToWPTimezone:t=>Mn(t,e),convertUTCDateTimeToWPTimezone:t=>((e,t)=>{try{return In().utc(e).tz(t).toDate()}catch(t){return console.error("Error: ",t),new Date(e)}})(t,e)}},Fn={[hn.Pipeline]:(0,o.__)("Board","quicktasker"),[hn.Task]:(0,o.__)("Task","quicktasker"),[hn.QUICKTASKER]:(0,o.__)("Quicktasker","quicktasker"),[hn.WP_USER]:(0,o.__)("WordPress user","quicktasker"),[hn.Users]:(0,o.__)("Global users","quicktasker")};var Kn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function $n({customField:e,refreshDeletedFields:t}){const{customFieldsDispatch:s}=(0,a.useContext)(vn),[i,r]=(0,a.useState)(!1),{restoreCustomField:c}=En(),{convertToWPTimezone:l}=Un();return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Name:","quicktasker")})," ",e.name]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Description:","quicktasker")})," ",e.description]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Level:","quicktasker")})," ",Fn[e.entity_type]]}),e.deleted_at&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Deleted:","quicktasker")})," ",l(e.deleted_at)]}),(0,n.jsx)("div",{children:(0,n.jsx)(da,{onClick:()=>Kn(this,void 0,void 0,(function*(){r(!0),yield c(e.id,(e=>{s({type:it,payload:e}),t()})),r(!1)})),loading:i,icon:(0,n.jsx)(Nn.HCd,{className:"wpqt-icon-green wpqt-size-5"})})})]})}var zn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Gn(){const[e,t]=(0,a.useState)(!0),[s,r]=(0,a.useState)(null),{state:{entityId:c,entityType:l}}=(0,a.useContext)(vn);(0,a.useEffect)((()=>{d()}),[]);const d=()=>zn(this,void 0,void 0,(function*(){if(c&&l)try{t(!0);const e=yield ss(c,l,!1);r(e.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load deleted custom fields","quicktasker"))}finally{t(!1)}else console.error("Entity ID or Entity Type is missing")}));return(0,n.jsxs)("div",{className:"wpqt-my-3 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)("h2",{children:(0,o.__)("Custom Field recovery","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:(0,o.__)("Deleted custom field by accident? No worries! You can recover it here.","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-mb-3",children:e?(0,n.jsx)(aa,{ovalSize:"36"}):s&&0===s.length?(0,n.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No deleted custom fields","quicktasker")}):s&&s.length>0?(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:s.map((e=>(0,n.jsx)($n,{customField:e,refreshDeletedFields:d},e.id)))}):null})]})}function Vn(){const{state:{customFieldRecoveryModalOpen:e},modalDispatch:t}=(0,a.useContext)(Bs);return(0,n.jsx)(ua,{modalOpen:e,closeModal:()=>{t({type:we,payload:!1})},size:"lg",children:(0,n.jsx)(Gn,{})})}var Bn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Hn({data:e,locationOfCustomFields:t,onDelete:s,actionLoading:i}){const{state:{isUserAllowedToDelete:r}}=(0,a.useContext)(dn),c=e.entity_type===t,l=e.entity_type===hn.Pipeline?"board":e.entity_type;return i?(0,n.jsx)(aa,{ovalSize:"24",className:"wpqt-ml-auto"}):(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-ml-auto",children:r&&(0,n.jsx)(la,Object.assign({onClick:()=>Bn(this,void 0,void 0,(function*(){c&&s()})),className:c?"":"!wpqt-cursor-not-allowed",icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-4"})},!c&&{tooltipId:`custom-field-${e.id}-delete`,tooltipText:(0,o.sprintf)((0,o.__)("This custom field is inherited from %s settings and can't be deleted here","quicktasker"),l)}))})}function Wn({name:e,description:t=""}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-mb-1 wpqt-text-base wpqt-font-semibold",children:e}),t&&(0,n.jsx)("div",{className:"wpqt-mb-2 wpqt-italic",children:t})]})}function Qn({data:e,initialValue:t,onChange:s,disabled:i=!1}){const[o,r]=(0,a.useState)(t);return(0,a.useEffect)((()=>{r(t)}),[t]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(Wn,{name:e.name,description:e.description}),(0,n.jsx)("input",{type:"checkbox",checked:"true"===o,className:"!wpqt-block",onChange:e=>{r(e.target.checked?"true":"false"),s(e.target.checked?"true":"false")},disabled:i})]})}function Yn({data:e,initialValue:t,onChange:s,disabled:i=!1}){const[o,r]=(0,a.useState)(t),[c,l]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{r(t),l(!1)}),[t]),(0,a.useEffect)((()=>{if(!c)return;const e=setTimeout((()=>{s(o),l(!1)}),Pt);return()=>clearTimeout(e)}),[o,c,s]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center",children:[(0,n.jsx)(Wn,{name:e.name,description:e.description}),(0,n.jsx)(Ka,{value:o,onChange:e=>{r(e),l(!0)},disabled:i,wrapperClassName:"!wpqt-mb-0","data-testid":"text-custom-field"})]})}var Jn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Xn({data:e}){var t,s;const{state:{entityType:i,entityId:o},customFieldsDispatch:r}=(0,a.useContext)(vn),{updateCustomFieldValue:c,markCustomFieldAsDeleted:l,updateCustomFieldDefaultValue:d}=En(),[u,p]=(0,a.useState)(!1),h=i===hn.QUICKTASKER||i===hn.Task,m=i===hn.Users||i===hn.Pipeline,w=t=>Jn(this,void 0,void 0,(function*(){h?(p(!0),yield c(e.id,t,o,i),p(!1)):m?(p(!0),yield d(e.id,t),p(!1)):console.error("Invalid entity type for saving custom field value")}));let f;const k=null!==(s=null!==(t=e.value)&&void 0!==t?t:e.default_value)&&void 0!==s?s:"",q=h||m;switch(e.type){case pn.Text:f=(0,n.jsx)(Yn,{data:e,initialValue:k,onChange:w,disabled:u||!q});break;case pn.Checkbox:f=(0,n.jsx)(Qn,{data:e,initialValue:k,onChange:w,disabled:u||!h})}return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-py-4 wpqt-items-center wpqt-border-0 wpqt-border-b wpqt-border-solid wpqt-border-gray-200",children:[f,(0,n.jsx)(Hn,{data:e,locationOfCustomFields:i,onDelete:()=>Jn(this,void 0,void 0,(function*(){p(!0),yield l(e.id,(()=>{r({type:ot,payload:e.id})})),p(!1)})),actionLoading:u})]})}function Zn(){const{state:{loading:e,customFields:t}}=(0,a.useContext)(vn);return e?(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(ta,{width:"36",height:"36"})}):t&&0===t.length?(0,n.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No related custom fields created","quicktasker")}):(0,n.jsx)("div",{className:"wpqt-my-4 wpqt-flex wpqt-flex-col wpqt-gap-3",children:t.map((e=>(0,n.jsx)(Xn,{data:e},e.id)))})}function ei({className:e=""}){const{modalDispatch:t}=(0,a.useContext)(Bs);return(0,n.jsxs)("div",{className:`wpqt-flex wpqt-gap-2 ${e}`,children:[(0,n.jsx)(la,{onClick:()=>{t({type:we,payload:!0})},icon:(0,n.jsx)(Nn.HCd,{className:"wpqt-icon-blue wpqt-size-4"})}),(0,n.jsx)(la,{onClick:()=>{t({type:me,payload:!0})},icon:(0,n.jsx)(bn.A,{className:"wpqt-icon-green wpqt-size-4"})})]})}const ti={[hn.QUICKTASKER]:(0,o.__)("Add user-specific custom fields. If you want to add custom fields to all users, please go to users settings.","quicktasker"),[hn.WP_USER]:(0,o.__)("Add user-specific custom fields. If you want to add custom fields to all users, please go to users settings.","quicktasker"),[hn.Users]:(0,o.__)("Add custom fields to all users. If you want to add custom fields to a specific user only, please go to that user settings.","quicktasker"),[hn.Pipeline]:(0,o.__)("Add board level custom fields.","quicktasker"),[hn.Task]:(0,o.__)("Add task-specific custom fields. If you want to add custom fields to all tasks in this board, please go to board settings.","quicktasker")},si={[hn.QUICKTASKER]:(0,o.__)("Custom fields applied to this user, including both user-specific and global users fields.","quicktasker"),[hn.WP_USER]:(0,o.__)("Custom fields applied to this user, including both user-specific and global users fields.","quicktasker"),[hn.Users]:(0,o.__)("Global user custom field are applied to all users.","quicktasker"),[hn.Pipeline]:(0,o.__)("Board level fields are applied to all tasks in this board.","quicktasker"),[hn.Task]:(0,o.__)("Custom fields applied to this task, including both task-specific and board-level fields.","quicktasker")},ai={[hn.QUICKTASKER]:(0,o.__)("User custom fields","quicktasker"),[hn.WP_USER]:(0,o.__)("User custom fields","quicktasker"),[hn.Users]:(0,o.__)("Global users custom fields","quicktasker"),[hn.Pipeline]:(0,o.__)("Board custom fields","quicktasker"),[hn.Task]:(0,o.__)("Custom fields","quicktasker")};function ni({entityId:e,entityType:t}){const s=ti[t],a=ai[t],i=si[t];return(0,n.jsx)("div",{className:"wpqt-relative",children:(0,n.jsxs)(jn,{entityId:e,entityType:t,children:[(0,n.jsx)(ei,{className:"wpqt-absolute wpqt--top-2 wpqt-right-0"}),(0,n.jsx)("h2",{className:"wpqt-text-center",children:a}),(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:i}),(0,n.jsx)(Zn,{}),(0,n.jsx)(On,{description:s}),(0,n.jsx)(Vn,{})]})})}function ii({onConfirm:e,confirmMessage:t=(0,o.__)("Are you sure?","quicktasker"),confirmButtonText:s=(0,o.__)("Yes","quicktasker"),cancelButtonText:i=(0,o.__)("No","quicktasker"),children:r,position:c="bottom",containerClassName:l=""}){const[d,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(null),m=(0,a.useRef)(null),w=(0,a.useRef)(null),f=d&&null!==p;(0,a.useEffect)((()=>{if(d&&m.current){const e=m.current.getBoundingClientRect(),t=100,s=8;let a=0,n=0;switch(c){case"top":a=e.top-t-s,n=e.left+e.width/2-112;break;case"right":a=e.top,n=e.right+s;break;case"bottom":a=e.bottom+s,n=e.left+e.width/2-112;break;case"left":a=e.top,n=e.left-224-s}a=Math.max(0,a),n=Math.max(0,n),n=Math.min(n,window.innerWidth-224-10),h({top:a,left:n})}}),[d,c]);const k=e=>{null==e||e.stopPropagation(),u(!1)};return(0,a.useEffect)((()=>{if(!f)return;const e=e=>{m.current&&!m.current.contains(e.target)&&w.current&&!w.current.contains(e.target)&&k()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[f]),(0,n.jsxs)("div",{className:`wpqt-relative ${l}`,ref:m,children:[r({onClick:e=>{e.stopPropagation(),e.preventDefault(),u(!0)}}),f&&(0,n.jsx)("div",{ref:w,className:"wpqt-fixed wpqt-z-50",style:{top:`${p.top}px`,left:`${p.left}px`},onClick:e=>e.stopPropagation(),children:(0,n.jsx)("div",{className:"wpqt-origin-top-right wpqt-main-border wpqt-bg-white wpqt-transition",style:{width:"224px"},children:(0,n.jsxs)("div",{className:"wpqt-p-3",children:[(0,n.jsx)("div",{className:"wpqt-text-sm wpqt-mb-2",children:t}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-space-x-2",children:[(0,n.jsx)(ca,{btnText:i,onClick:k,buttonStyleType:ia.SECONDARY}),(0,n.jsx)(ca,{btnText:s,onClick:t=>{null==t||t.stopPropagation(),e(),u(!1)},buttonStyleType:ia.DANGER})]})]})})})]})}var oi=s(5785);function ri({children:e,inlineStyle:t,className:s=""}){return(0,n.jsx)("div",{className:`wpqt-inline-flex wpqt-py-1 wpqt-px-2 wpqt-font-semibold wpqt-text-xs wpqt-leading-none wpqt-shopping-tag ${s}`,style:t,children:e})}var ci=s(2185);function li({children:e,menuBtn:t,menuBtnClasses:s="",anchor:a="bottom end"}){return(0,n.jsxs)(ci.W1,{children:[(0,n.jsx)(ci.IU,{as:"div",className:`wpqt-cursor-pointer ${s}`,onClick:e=>e.stopPropagation(),children:({active:e})=>(0,n.jsx)(n.Fragment,{children:t({active:e})})}),(0,n.jsx)(ci.c,{anchor:a,transition:!0,className:"wpqt-z-20 wpqt-origin-top wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-white wpqt-p-4 wpqt-transition wpqt-duration-200 wpqt-ease-out data-[closed]:wpqt-scale-95 data-[closed]:wpqt-opacity-0",children:e})]})}function di({isActive:e,IconComponent:t}){return(0,n.jsx)(t,{className:"wpqt-size-6 wpqt-text-gray-400 hover:wpqt-text-qtBlueHover "+(e?"wpqt-text-qtBlueHover":"")})}function ui({text:e,onClick:t,icon:s,className:a,disabled:i=!1,id:o="",tooltipText:r="",loading:c=!1}){const l=""!==r&&""!==o?{"data-tooltip-id":o,"data-tooltip-content":r,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,n.jsx)(ci.Dr,{children:(0,n.jsxs)("div",Object.assign({},l,{className:`wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-relative ${i?"wpqt-cursor-not-allowed wpqt-line-through":"wpqt-cursor-pointer hover:wpqt-underline"} ${a}`,onClick:e=>{!i&&t&&t(e)},children:[s,(0,n.jsx)("span",{className:c?"wpqt-invisible":"",children:e}),c&&(0,n.jsx)(ta,{width:"16",height:"16",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"}),(0,n.jsx)(ra,{id:o})]}))})}var pi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};var hi=s(3858);function mi({labelCreated:e,loading:t=!1}){const{labelDispatch:s}=(0,a.useContext)(Pa),[i,r]=(0,a.useState)(""),[c,l]=(0,a.useState)("");return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3 wpqt-items-center",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Create new label","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)(Ta,{labelFor:"new-label-name",children:(0,o.__)("Name","quicktasker")}),(0,n.jsx)(Ka,{value:i,onChange:r,inputId:"new-label-name"})]}),(0,n.jsx)(hi.A,{color:c,disableAlpha:!0,onChange:e=>{l(e.hex)}}),(0,n.jsx)(ca,{btnText:(0,o.__)("Create","quicktasker"),onClick:()=>{i&&c&&e(i,c)},loading:t}),(0,n.jsx)(ca,{btnText:(0,o.__)("Cancel","quicktasker"),buttonStyleType:ia.SECONDARY,onClick:()=>{s({type:ht})}})]})}var wi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function fi({labelToEdit:e,editLabel:t,deleteLabe:s,closeEdit:i=()=>{}}){if(!e)return null;const[r,c]=(0,a.useState)(Object.assign({},e)),[l,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3 wpqt-items-center",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Edit label","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)(Ta,{labelFor:"edit-label-name",children:(0,o.__)("Name","quicktasker")}),(0,n.jsx)(Ka,{value:r.name,onChange:e=>{c(Object.assign(Object.assign({},r),{name:e}))},inputId:"edit-label-name"})]}),(0,n.jsx)(hi.A,{color:r.color,disableAlpha:!0,onChange:e=>{c(Object.assign(Object.assign({},r),{color:e.hex}))}}),(0,n.jsx)(ca,{btnText:(0,o.__)("Save","quicktasker"),onClick:()=>wi(this,void 0,void 0,(function*(){r.name&&r.color&&(d(!0),yield t(r),d(!1))})),loading:l}),(0,n.jsx)(ca,{btnText:(0,o.__)("Delete","quicktasker"),onClick:()=>wi(this,void 0,void 0,(function*(){p(!0),yield s(r.id),p(!1)})),loading:u,buttonStyleType:ia.DANGER}),(0,n.jsx)(ca,{btnText:(0,o.__)("Cancel","quicktasker"),buttonStyleType:ia.SECONDARY,onClick:i})]})}var ki=s(2601),qi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function _i({labels:e,title:t,labelSelected:s,labelDeSelection:i,loading:r=!1}){const{labelDispatch:c}=(0,a.useContext)(Pa);return e?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-4",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:t}),r?(0,n.jsx)(aa,{ovalSize:"24"}):0===e.length?(0,n.jsx)("div",{className:"wpqt-text-gray-500",children:(0,o.__)("There are no labels created for this board","quicktasker")}):e.map((e=>(0,n.jsx)(xi,{label:e,labelSelected:s,labelDeSelection:i},e.id))),(0,n.jsx)(ca,{btnText:(0,o.__)("Create new label","quicktasker"),className:"wpqt-mt-3",buttonStyleType:ia.SECONDARY,onClick:()=>{c({type:wt})}})]}):null}function xi({label:e,labelSelected:t,labelDeSelection:s}){const{labelDispatch:i}=(0,a.useContext)(Pa),[o,r]=(0,a.useState)(e.selected);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-between wpqt-gap-2 wpqt-w-full",children:[(0,n.jsx)("input",{type:"checkbox",checked:o,onChange:a=>qi(this,void 0,void 0,(function*(){const n=a.target.checked;r(n),n?t(e.id):s(e.id)}))}),(0,n.jsx)(ri,{inlineStyle:{backgroundColor:e.color},className:"wpqt-py-2",children:e.name}),(0,n.jsx)(ki.A,{className:"wpqt-size-5 wpqt-icon-green wpqt-cursor-pointer",onClick:()=>{i({type:mt,payload:e})}})]})}var gi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const vi=(0,a.memo)((({task:e,labelSelected:t,labelDeselected:s,labelDeleted:r})=>{const{state:{labels:c,labelActionState:l,labelToEdit:d},labelDispatch:u}=(0,a.useContext)(Pa),{archiveDispatch:p}=(0,a.useContext)(Fs),{dispatch:h}=(0,a.useContext)(bs),[m,w]=(0,a.useState)(!0),[f,k]=(0,a.useState)(!1),{getPipelineLabels:q,createPipelineLabel:_,assignLabelToTask:x,usassignLabelFromTask:g,editLabel:v,deleteLabel:j}=function(){return{deleteLabel:(e,t,s)=>pi(this,void 0,void 0,(function*(){try{const a=yield function(e,t){return Wt()({path:`/wpqt/v1/pipelines/${e}/labels/${t}`,method:"DELETE",headers:Qt()})}(e,t);i.oR.success((0,o.__)("Label deleted from the board","quicktasker")),s&&s(!0,a.data.deletedLabel)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete label","quicktasker")),s&&s(!1)}})),getPipelineLabels:(e,t)=>pi(this,void 0,void 0,(function*(){try{const a=yield(s=e,Wt()({path:`/wpqt/v1/pipelines/${s}/labels`,method:"GET",headers:Qt()}));t&&t(!0,a.data.labels)}catch(e){console.error(e),t&&t(!1)}var s})),createPipelineLabel:(e,t,s,a)=>pi(this,void 0,void 0,(function*(){try{const n=yield function(e,t,s){return Wt()({path:`/wpqt/v1/pipelines/${e}/labels`,method:"POST",headers:Qt(),data:{name:t,color:s}})}(e,t,s);i.oR.success((0,o.__)("Label created successfully","quicktasker")),a&&a(!0,n.data.label)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create label","quicktasker")),a&&a(!1)}})),editLabel:(e,t,s)=>pi(this,void 0,void 0,(function*(){try{const a=yield function(e,t){return Wt()({path:`/wpqt/v1/pipelines/${e}/labels/${t.id}`,method:"PATCH",headers:Qt(),data:{name:t.name,color:t.color}})}(e,t);i.oR.success((0,o.__)("Label updated successfully","quicktasker")),s&&s(!0,a.data.label)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to update label","quicktasker")),s&&s(!1)}})),assignLabelToTask:(e,t,s,a)=>pi(this,void 0,void 0,(function*(){try{const n=yield function(e,t,s){return Wt()({path:`/wpqt/v1/pipelines/${e}/tasks/${t}/labels`,method:"POST",headers:Qt(),data:{labelId:s}})}(e,t,s);i.oR.success((0,o.__)("Label added to task","quicktasker")),a&&a(!0,n.data.label)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add label to task","quicktasker")),a&&a(!1)}})),usassignLabelFromTask:(e,t,s,a)=>pi(this,void 0,void 0,(function*(){try{yield function(e,t,s){return Wt()({path:`/wpqt/v1/pipelines/${e}/tasks/${t}/labels/${s}`,method:"DELETE",headers:Qt()})}(e,t,s),i.oR.success((0,o.__)("Label removed from task","quicktasker")),a&&a(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to remove label from task","quicktasker")),a&&a(!1)}}))}}();(0,a.useEffect)((()=>(gi(void 0,void 0,void 0,(function*(){w(!0),yield q(e.pipeline_id,((e,t)=>{e&&t&&u({type:lt,payload:t})})),w(!1)})),()=>{u({type:ft})})),[]);const b=()=>{const t=e.assigned_labels||[];return(c||[]).map((e=>Object.assign(Object.assign({},e),{selected:t.some((t=>t.id===e.id))})))},y=s=>gi(void 0,void 0,void 0,(function*(){yield x(e.pipeline_id,e.id,s,((s,a)=>{s&&a&&(h({type:N,payload:{taskId:e.id,label:a}}),p({type:Oe,payload:{taskId:e.id,label:a}}),t(a))}))})),E=t=>gi(void 0,void 0,void 0,(function*(){yield g(e.pipeline_id,e.id,t,(a=>{a&&(h({type:C,payload:{taskId:e.id,labelId:t}}),p({type:Ne,payload:{taskId:e.id,labelId:t}}),s(t))}))})),T=(t,s)=>gi(void 0,void 0,void 0,(function*(){k(!0),yield _(e.pipeline_id,t,s,((e,t)=>{e&&t&&u({type:dt,payload:t})})),k(!1)})),S=t=>gi(void 0,void 0,void 0,(function*(){yield v(e.pipeline_id,t,((e,t)=>{e&&t&&(u({type:pt,payload:t}),h({type:I,payload:{label:t}}))}))})),A=t=>gi(void 0,void 0,void 0,(function*(){yield j(e.pipeline_id,t,((e,s)=>{e&&s&&(u({type:ht}),u({type:ut,payload:s}),h({type:D,payload:t}),r(t))}))}));return(0,n.jsx)("div",{className:"wpqt-min-w-56 wpqt-flex wpqt-flex-col wpqt-gap-4",onClick:e=>e.stopPropagation(),children:(()=>{switch(l){case Oa.SELECTION:return(0,n.jsx)(_i,{title:(0,o.__)("Task label selection","quicktasker"),labels:b(),loading:m,labelSelected:y,labelDeSelection:E});case Oa.CREATION:return(0,n.jsx)(mi,{labelCreated:T,loading:f});case Oa.EDIT:return(0,n.jsx)(fi,{labelToEdit:d,editLabel:S,deleteLabe:A,closeEdit:()=>{u({type:ht})}});default:return null}})()})}));function ji({task:e,labelSelected:t=()=>{},labelDeselected:s=()=>{},labelDeleted:a=()=>{}}){const i=e.assigned_labels||[],o=Array.isArray(i)&&i.length>0;return(0,n.jsx)(li,{menuBtnClasses:"wpqt-inline-flex",anchor:"bottom start",menuBtn:()=>(0,n.jsxs)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1.5",children:[(0,n.jsx)(oi.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`}),o&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-1 wpqt-flex-wrap",children:i.map((e=>(0,n.jsx)(ri,{inlineStyle:{backgroundColor:e.color},children:e.name},e.id)))})]}),children:e&&(0,n.jsx)(vi,{task:e,labelSelected:t,labelDeselected:s,labelDeleted:a})})}var bi=s(2792),yi=s(6797),Ei=s(4403);function Ti({sectionTitle:e,onItemSelect:t=()=>{},users:s=[],ActionIcon:a=Ei.A,actionIconClasses:i,noUsersText:o}){return(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2 wpqt-text-lg",children:e}),s.map(((e,s)=>{var o;return(0,n.jsxs)("div",{onClick:s=>{s.stopPropagation(),t(e)},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-px-2 wpqt-py-1 hover:wpqt-bg-gray-100",children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)("div",{children:e.name}),(0,n.jsx)("div",{className:"wpqt-italic",children:e.description}),ns(e)&&(0,n.jsx)("div",{children:null===(o=e.roles)||void 0===o?void 0:o.join(",")})]}),(0,n.jsx)(a,{className:`wpqt-ml-auto wpqt-size-5 ${i}`})]},s)})),0===s.length&&(0,n.jsx)("div",{children:o})]})}var Si=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ai({task:e,onUserAdd:t,onUserDelete:s}){const{state:{users:r,wpUsers:c}}=(0,a.useContext)(Qa),{handleExecutedAutomations:l}=Ss(),{dispatch:d}=(0,a.useContext)(bs),[u,p]=(0,a.useState)(!1),h=r.filter((t=>{var s;return!(null!==(s=e.assigned_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))})),m=c.filter((t=>{var s;return!(null!==(s=e.assigned_wp_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))})),w=s=>Si(this,void 0,void 0,(function*(){try{p(!0);const a=s.user_type,n=yield function(e,t,s){return Wt()({path:`/wpqt/v1/users/${e}/tasks/${t}`,method:"POST",data:{user_type:s},headers:Qt()})}(s.id,e.id,a);d({type:b,payload:{taskId:e.id,user:s}}),t(s),l(n.data.executedAutomations,e.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to assign user","quicktasker"))}finally{p(!1)}})),f=t=>Si(this,void 0,void 0,(function*(){try{p(!0);const a=t.user_type,n=yield ts(t.id,e.id,a);d({type:y,payload:{taskId:e.id,userId:t.id,userType:a}}),s(t),l(n.data.executedAutomations,e.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to remove user","quicktasker"))}finally{p(!1)}}));return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,n.jsx)(Ti,{sectionTitle:(0,o.__)("Assigned quicktaskers","quicktasker"),users:e.assigned_users,onItemSelect:f,ActionIcon:yi.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No quicktaskers assigned","quicktasker")}),(0,n.jsx)(Ti,{sectionTitle:(0,o.__)("Assigned WordPress users","quicktasker"),users:e.assigned_wp_users,onItemSelect:f,ActionIcon:yi.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No WordPress users assigned","quicktasker")}),(0,n.jsx)(Ti,{sectionTitle:(0,o.__)("Assign a quicktasker","quicktasker"),users:h,onItemSelect:w,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No quicktaskers available to assign","quicktasker")}),(0,n.jsx)(Ti,{sectionTitle:(0,o.__)("Assign a WordPress user","quicktasker"),users:m,onItemSelect:w,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No WordPress users with required permissions available to assign","quicktasker")}),u&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(ta,{width:"30",height:"30"})})]})}function Oi({task:e,onUserAdd:t=()=>{},onUserDelete:s=()=>{},menuBtnClasses:a=""}){const i=[...e.assigned_users||[],...e.assigned_wp_users||[]],o=i.length>0;return(0,n.jsx)(li,{menuBtnClasses:`wpqt-inline-flex ${a}`,anchor:"bottom start",menuBtn:()=>(0,n.jsxs)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:[(0,n.jsx)(bi.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`}),o&&(0,n.jsx)("div",{children:i.map(((e,t)=>(0,n.jsxs)("span",{children:[e.name,t<i.length-1&&", "]},t)))})]}),children:(0,n.jsx)(Ai,{task:e,onUserAdd:t,onUserDelete:s})})}var Ni=s(1848);function Ci({tabs:e,tabsContent:t,tabClassName:s="",tabListClassName:a=""}){return(0,n.jsxs)(Ni.fu,{children:[(0,n.jsx)(Ni.wb,{className:`wpqt-mb-6 wpqt-flex wpqt-border-0 wpqt-border-b wpqt-border-solid wpqt-border-b-gray-300 ${a}`,children:e.map((e=>(0,n.jsx)(Ii,{className:s,children:e},e)))}),(0,n.jsx)(Ni.T2,{children:t.map(((e,t)=>(0,n.jsx)(Di,{children:e},t)))})]})}function Ii({children:e,className:t}){return(0,n.jsx)(Ni.oz,{as:"div",className:`wpqt-flex-1 wpqt-cursor-pointer wpqt-p-1 wpqt-pb-[10px] wpqt-text-center wpqt-text-lg data-[selected]:wpqt-border-b-2 data-[selected]:wpqt-border-l-0 data-[selected]:wpqt-border-r-0 data-[selected]:wpqt-border-t-0 data-[selected]:wpqt-border-solid data-[selected]:wpqt-border-b-blue-500 ${t}`,children:e})}function Di({children:e}){return(0,n.jsx)(Ni.Kp,{children:e})}const Pi={[Is.Admin]:(0,o.__)("Admin","quicktasker"),[Is.Automation]:(0,o.__)("Automation","quicktasker"),[Is.System]:(0,o.__)("System","quicktasker"),[Is.WPQTUser]:"Quicktasker",[Is.Import]:(0,o.__)("Import","quicktasker")},Ri=({log:e,showStatus:t=!1})=>{const{convertToWPTimezone:s}=Un(),a=Pi[e.created_by];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,n.jsx)("div",{className:"wpqt-text-center",children:a})]}),(0,n.jsx)("div",{children:s(e.created_at)}),t&&(0,n.jsx)("div",{children:e.log_status}),(0,n.jsx)("div",{children:e.text})]})};function Li({title:e}){return(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-lg wpqt-underline",children:e})}var Mi=s(3338),Ui=s(3211);const Fi={success:"wpqt-bg-green-100 wpqt-border-green-400 wpqt-text-green-700",error:"wpqt-bg-red-100 wpqt-border-red-400 wpqt-text-red-700",warning:"wpqt-bg-yellow-100 wpqt-border-yellow-400 wpqt-text-yellow-700",info:"wpqt-bg-blue-100 wpqt-border-blue-400 wpqt-text-blue-700",primary:"wpqt-bg-gray-100 wpqt-border-gray-400 wpqt-text-gray-700"};function Ki({type:e="primary",className:t="",children:s}){const a=Fi[e];return(0,n.jsx)("div",{className:`wpqt-inline-flex wpqt-p-2 wpqt-border wpqt-border-solid wpqt-rounded-md ${a} ${t}`,children:s})}var $i=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function zi({typeId:e,fetchData:t,renderItem:s,noDataMessage:i,explanation:r,onAdd:c=()=>$i(this,void 0,void 0,(function*(){})),enableAdd:l=!1}){const[d,u]=(0,a.useState)(null),[p,h]=(0,a.useState)(""),[m,w]=(0,a.useState)(!0),[f,k]=(0,a.useState)(!1);(0,a.useEffect)((()=>{q()}),[e]);const q=()=>$i(this,void 0,void 0,(function*(){w(!0);const e=yield t();e&&u(e),w(!1)}));return null===d?(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(ta,{width:"30",height:"30"})}):(0,n.jsxs)("div",{children:[r&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(Ki,{type:"info",className:"wpqt-mb-3 wpqt-text-center",children:r})}),0===d.length&&(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center",children:i}),(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-mt-3 wpqt-flex wpqt-justify-center",children:(0,n.jsx)(Gi,{isLoading:m,refreshComemnts:q})}),l&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsxs)("div",{className:"wpqt-w-2/3 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(qn,{rowsCount:3,value:p,onChange:e=>h(e),className:"wpqt-mb-4 wpqt-w-full"}),(0,n.jsx)(la,{text:"Add comment",loading:f,onClick:()=>$i(this,void 0,void 0,(function*(){if(!p)return;k(!0);const e=yield c(p);e&&(u((t=>t?[e,...t]:[e])),h("")),k(!1)})),icon:(0,n.jsx)(Mi.A,{className:"wpqt-icon-blue wpqt-size-5"})})]})}),d.length>0&&(0,n.jsxs)("div",{className:"wpqt-mb-[28px] wpqt-mt-[56px] wpqt-logs-grid",children:[(0,n.jsx)(Li,{title:(0,o.__)("Author","quicktasker")}),(0,n.jsx)(Li,{title:(0,o.__)("Date","quicktasker")}),(0,n.jsx)(Li,{title:(0,o.__)("Text","quicktasker")}),d.map((e=>s(e)))]})]})}function Gi({isLoading:e,refreshComemnts:t}){return(0,n.jsx)(n.Fragment,{children:e?(0,n.jsx)(ta,{width:"32",height:"32"}):(0,n.jsx)(Ui.A,{className:"wpqt-icon-blue wpqt-size-8 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:t})})}function Vi({item:e}){const{convertToWPTimezone:t}=Un(),s=null===e.author_name&&null===e.author_id;return(0,n.jsxs)(n.Fragment,{children:[!s&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,n.jsx)("div",{className:"wpqt-text-center",children:"wp-user"===e.author_type?(0,o.__)("Admin","quicktasker"):(0,o.__)("QuickTasker","quicktasker")})]}),s&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:(0,o.__)("Unknown","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-text-center",children:(0,o.__)("Author not found","quicktasker")})]}),(0,n.jsx)("div",{children:t(e.created_at)}),(0,n.jsx)("div",{children:e.text})]})}var Bi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Hi({taskId:e}){return(0,n.jsx)(zi,{typeId:e,fetchData:()=>Bi(this,void 0,void 0,(function*(){try{return(yield Zt(e,Cs.Task)).data}catch(e){console.error(e),i.oR.error("Failed to get log")}})),renderItem:e=>(0,n.jsx)(Ri,{log:e}),noDataMessage:"No logs available"})}var Wi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Qi(){return{addComment:(e,t,s,a)=>Wi(this,void 0,void 0,(function*(){try{const n=yield Xt(e,t,s,a);return i.oR.success((0,o.__)("Comment added","quicktasker")),n.data.newComment}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add comment","quicktasker"))}}))}}var Yi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ji({taskId:e}){const{addComment:t}=Qi();return(0,n.jsx)(zi,{typeId:e,fetchData:()=>Yi(this,void 0,void 0,(function*(){try{return(yield Jt(e,Cs.Task,!0)).data}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>Yi(this,void 0,void 0,(function*(){const a=yield t(e,Cs.Task,!0,s);if(a)return a})),renderItem:e=>(0,n.jsx)(Vi,{item:e}),noDataMessage:"No comments available",enableAdd:!0})}var Xi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Zi({taskId:e}){const{addComment:t}=Qi();return(0,n.jsx)(zi,{typeId:e,fetchData:()=>Xi(this,void 0,void 0,(function*(){try{return(yield Jt(e,Cs.Task,!1)).data}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>Xi(this,void 0,void 0,(function*(){const a=yield t(e,Cs.Task,!1,s);if(a)return a})),renderItem:e=>(0,n.jsx)(Vi,{item:e}),noDataMessage:"No comments available",enableAdd:!0})}function eo({task:e}){const t=[(0,o.__)("Logs","quicktasker"),(0,o.__)("Private comments","quicktasker"),(0,o.__)("Public comments","quicktasker")];return(0,n.jsx)(Ci,{tabs:t,tabsContent:[(0,n.jsx)(Hi,{taskId:e.id},3),(0,n.jsx)(Ji,{taskId:e.id},1),(0,n.jsx)(Zi,{taskId:e.id},2)]})}var to=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function so(){return{getUplaods:(e,t)=>to(this,void 0,void 0,(function*(){try{const s=yield function(e,t){const s=new URLSearchParams({entity_id:e,entity_type:t});return Wt()({path:`/wpqt/v1/uploads?${s.toString()}`,method:"GET"})}(e,t);return{data:s.data,error:null}}catch(e){return console.error(e),{data:null,error:e}}})),uploadFile:e=>to(this,void 0,void 0,(function*(){try{const t=yield function(e){return Wt()({path:"/wpqt/v1/uploads",method:"POST",body:e})}(e);return i.oR.success((0,o.__)("File uploaded successfully","quicktasker")),{data:t.data,error:null}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to upload a file","quicktasker")),{data:null,error:e}}})),deleteUpload:e=>to(this,void 0,void 0,(function*(){try{const t=yield function(e){return Wt()({path:`/wpqt/v1/uploads/${e}`,method:"DELETE"})}(e);return i.oR.success((0,o.__)("File deleted successfully","quicktasker")),{data:t.data,error:null}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to delete a file","quicktasker")),{data:null,error:e}}})),checkFileExists:e=>to(this,void 0,void 0,(function*(){try{return(yield fetch(e,{method:"HEAD"})).ok}catch(e){return!1}}))}}var ao=s(2944),no=s(4015);function io({upload:e,menuBtnClasses:t=""}){const{state:{taskUploadsURL:s}}=(0,a.useContext)(dn),i=`${s}/${e.upload_uuid}/${e.file_name}`;return(0,n.jsx)(li,{menuBtnClasses:`wpqt-inline-flex ${t}`,anchor:"top",menuBtn:()=>(0,n.jsx)(no.A,{className:"wpqt-size-5 wpqt-icon-blue"}),children:(0,n.jsxs)("div",{children:[(0,n.jsx)(oo,{title:(0,o.__)("File name","quicktasker"),children:e.file_name}),(0,n.jsx)(oo,{title:(0,o.__)("File link","quicktasker"),children:(0,n.jsx)("a",{href:i,target:"_blank",rel:"noreferrer",children:i})}),(0,n.jsx)(oo,{title:(0,o.__)("Created at","quicktasker"),children:e.created_at}),(0,n.jsx)(oo,{title:(0,o.__)("Created by","quicktasker"),children:e.uploader_name})]})})}function oo({title:e,children:t}){return(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-uppercase",children:e}),(0,n.jsx)("div",{children:t})]})}var ro=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function co({upload:e}){const{state:{isUserAllowedToDelete:t,taskUploadsURL:s}}=(0,a.useContext)(dn),{uploadDispatch:r}=(0,a.useContext)(tn),[c,l]=(0,a.useState)(!1),{checkFileExists:d,deleteUpload:u}=so(),p=`${s}/${e.upload_uuid}/${e.file_name}`,h=(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-4 wpqt-justify-end wpqt-items-center",children:[(0,n.jsx)("a",{href:p,download:!0,onClick:()=>ro(this,void 0,void 0,(function*(){(yield d(p))||i.oR.error((0,o.__)("File was not found","quicktasker"))})),className:"focus:wpqt-shadow-none",children:(0,n.jsx)(ao.A,{className:"wpqt-icon-blue wpqt-size-5 :hover:wpqt-text-blue-800 wpqt-cursor-pointer"})}),(0,n.jsx)(io,{upload:e}),t&&(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-5 :hover:wpqt-text-red-800 wpqt-cursor-pointer",onClick:()=>ro(this,void 0,void 0,(function*(){l(!0);const{data:t}=yield u(e.id);t&&r({type:Dt,payload:e.id}),l(!1)}))})]});return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3 wpqt-main-border wpqt-p-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold",children:e.file_name}),c?(0,n.jsx)(aa,{ovalSize:"22",className:"!wpqt-items-end"}):h]})}var lo=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function uo({entityId:e,entityType:t}){const{uploadDispatch:s}=(0,a.useContext)(tn),[r,c]=(0,a.useState)(null),[l,d]=(0,a.useState)(!1),{uploadFile:u}=so(),p=(0,a.useRef)(null);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:[(0,n.jsxs)("div",{className:"wpqt-max-w-[300px]",children:[(0,o.sprintf)((0,o.__)("Select file to upload (Max size: %d MB)","quicktasker"),zt/1024/1024),(0,n.jsx)("br",{}),(0,o.__)("Allowed characters in file name: Latin letters, numbers, underscores, hyphens, and dots.","quicktasker")]}),(0,n.jsx)("input",{type:"file",onChange:e=>{if(e.target.files){const t=e.target.files[0];if(t.size>zt)return void i.oR.error((0,o.sprintf)((0,o.__)("File size exceeds the maximum limit of %d MB","quicktasker"),zt));if(!Gt.test(t.name))return void i.oR.error((0,o.__)("Invalid file name","quicktasker"));if(0===t.size)return void i.oR.error((0,o.__)("The selected file is empty","quicktasker"));c(t)}},ref:p,accept:$t.join(",")}),r&&(0,n.jsx)(ca,{btnText:(0,o.__)("Upload","quicktasker"),loading:l,onClick:()=>lo(this,void 0,void 0,(function*(){const a=(()=>{if(!r)return null;const s=new FormData;return s.append("file_to_upload",r),s.append("entity_id",e),s.append("entity_type",t),s})();if(a){d(!0);const{data:e}=yield u(a);e&&(s({type:It,payload:e.upload}),c(null),p.current&&(p.current.value="")),d(!1)}}))})]})}function po({entityId:e,entityType:t}){const{state:{uploads:s},uploadDispatch:r}=(0,a.useContext)(tn),[c,l]=(0,a.useState)(!0),{getUplaods:d}=so(),u=()=>{return s=this,a=void 0,c=function*(){l(!0);const{data:s,error:a}=yield d(e,t);l(!1),s&&s.uploads&&r({type:Ct,payload:s.uploads}),a&&i.oR.error((0,o.__)("Failed to fetch uploads","quicktasker"))},new((n=void 0)||(n=Promise))((function(e,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(i,o)}r((c=c.apply(s,a||[])).next())}));var s,a,n,c};return(0,a.useEffect)((()=>{u()}),[]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2",children:[(0,n.jsx)(uo,{entityId:e,entityType:t}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-flex-wrap wpqt-items-start",children:c?(0,n.jsx)(aa,{ovalSize:"24"}):s.map((e=>(0,n.jsx)(co,{upload:e},e.id)))})]})}var ho=s(303);function mo({checked:e,handleChange:t,id:s,dataTestId:a}){return(0,n.jsx)(ho.A,{onChange:t,checked:e,uncheckedIcon:!1,checkedIcon:!1,height:20,width:44,id:s,"data-testid":a})}function wo({initialValue:e,task:t,onEditTaskCompleted:s}){const[i,o]=(0,a.useState)(!1),[r,c]=(0,a.useState)(e),{editTask:l}=Os();return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)(mo,{checked:r,handleChange:e=>{return a=this,n=void 0,r=function*(){c(e),o(!0);const{success:a,task:n}=yield l(t.id,{free_for_all:e});o(!1),a&&n?s(n):c(!e)},new((i=void 0)||(i=Promise))((function(e,t){function s(e){try{c(r.next(e))}catch(e){t(e)}}function o(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i((function(e){e(a)}))).then(s,o)}c((r=r.apply(a,n||[])).next())}));var a,n,i,r}}),i&&(0,n.jsx)(aa,{ovalSize:"20"})]})}var fo=s(4461);function ko({initialValue:e,task:t,onEditTaskCompleted:s}){const[i,o]=(0,a.useState)(null),[r,c]=(0,a.useState)(!1),{editTask:l}=Os(),{convertUTCDateTimeToWPTimezone:d}=Un();(0,a.useEffect)((()=>{const t=e?d(e):null;o(t)}),[e]);const u=e=>{return a=this,n=void 0,d=function*(){const a=i,n=e?In()(e).utc().format("YYYY-MM-DD HH:mm:ss"):"";o(e),c(!0);const{success:r,task:d}=yield l(t.id,{due_date:n});c(!1),r&&d?s(d):o(a)},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{o(d.next(e))}catch(e){t(e)}}function i(e){try{o(d.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof r?a:new r((function(e){e(a)}))).then(s,i)}o((d=d.apply(a,n||[])).next())}));var a,n,r,d};return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)(fo.A,{onChange:e=>{u(e)},value:i,format:"y-MM-dd HH:mm"}),r&&(0,n.jsx)(aa,{ovalSize:"20"})]})}var qo=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const _o=({deleteTask:e,onEditTaskCompleted:t})=>{const{state:{taskToEdit:s,taskModalSettings:i},modalDispatch:r}=(0,a.useContext)(Bs),{state:{isUserAllowedToDelete:c}}=(0,a.useContext)(dn),{state:{activePipeline:l},fetchAndSetPipelineData:d}=(0,a.useContext)(bs),[u]=(0,a.useState)(!1),[p,h]=(0,a.useState)([]),{archiveTask:m,editTask:w}=Os(),{loading1:f,setLoading1:k,loading2:q,setLoading2:_}=rn(),x=null==s?void 0:s.is_archived;return(0,a.useEffect)((()=>{s&&h(s.assigned_labels)}),[s]),s?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,n.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-6",children:[(0,n.jsxs)("div",{className:"wpqt-mb-2 wpqt-grid wpqt-grid-cols-1 wpqt-gap-10 md:wpqt-grid-cols-[1fr_0.7fr]",children:[(0,n.jsxs)(ha,{children:[(0,n.jsx)(ma,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(wn,{value:s.name,wrapperClassName:"wpqt-w-full",className:"wpqt-w-full",onChange:e=>qo(void 0,void 0,void 0,(function*(){const{success:a,task:n}=yield w(s.id,{name:e});a&&n&&t(n)}))})}),(0,n.jsx)(ma,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(_n,{value:s.description,className:"wpqt-w-full",onChange:e=>qo(void 0,void 0,void 0,(function*(){const{success:a,task:n}=yield w(s.id,{description:e});a&&n&&t(n)}))})}),(0,n.jsx)(ma,{label:(0,o.__)("Assigned users","quicktasker"),children:(0,n.jsx)(Oi,{task:s,onUserAdd:e=>{r({type:Q,payload:e})},onUserDelete:e=>{r({type:Y,payload:e})}})}),(0,n.jsx)(ma,{label:(0,o.__)("Labels","quicktasker"),children:(0,n.jsx)(ji,{task:Object.assign(Object.assign({},s),{assigned_labels:p}),labelSelected:e=>{h((t=>[...t,e]))},labelDeselected:e=>{h((t=>t.filter((t=>t.id!==e))))},labelDeleted:e=>{h((t=>t.filter((t=>t.id!==e))))}})}),(0,n.jsx)(ma,{label:(0,o.__)("Free for all task","quicktasker"),tooltipId:`free-for-all-${s.id}-tooltip`,tooltipText:(0,o.__)("When enabled, users have the ability to self-assign or unassign this task.","quicktasker"),children:(0,n.jsx)(wo,{task:s,initialValue:s.free_for_all,onEditTaskCompleted:t})}),(0,n.jsx)(ma,{label:(0,o.__)("Due date","quicktasker"),children:(0,n.jsx)(ko,{initialValue:s.due_date||"",task:s,onEditTaskCompleted:t})}),i.allowToMarkTaskAsDone&&(0,n.jsx)(xo,{taskId:s.id,isCompleted:s.is_done})]}),(0,n.jsx)("div",{children:(0,n.jsx)(ni,{entityId:s.id,entityType:hn.Task})})]}),(0,n.jsx)(ma,{label:(0,o.__)("File attachment","quicktasker"),children:(0,n.jsx)(po,{entityId:s.id,entityType:mn.TASK})}),(0,n.jsx)("div",{className:"wpqt-mt-7 md:wpqt-pr-3",children:(0,n.jsx)(eo,{task:s})})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[x&&(0,n.jsx)(la,{icon:(0,n.jsx)(xa.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Restore task","quicktasker"),loading:u,onClick:()=>qo(void 0,void 0,void 0,(function*(){r({type:F}),r({type:pe,payload:{taskToRestore:s}})}))}),!x&&(0,n.jsx)(ii,{confirmMessage:(0,o.__)("Are you sure you want to archive this task?","quicktasker"),onConfirm:()=>{_(!0),m(s.id,(()=>{r({type:F}),d(l.id),_(!1)}))},children:({onClick:e})=>(0,n.jsx)(la,{icon:(0,n.jsx)(an.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("Archive task","quicktasker"),loading:q,onClick:e})}),c&&(0,n.jsx)(ii,{onConfirm:()=>qo(void 0,void 0,void 0,(function*(){k(!0),yield e(s),r({type:F}),k(!1)})),children:({onClick:e})=>(0,n.jsx)(la,{icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete task","quicktasker"),loading:f,onClick:e})})]})]})}):null};function xo({isCompleted:e,taskId:t}){const{modalDispatch:s}=(0,a.useContext)(Bs),{dispatch:i}=(0,a.useContext)(bs),[r,c]=(0,a.useState)(!1),{changeTaskDoneStatus:l}=Os();return(0,n.jsx)(ma,{label:e?(0,o.__)("Task completed","quicktasker"):(0,o.__)("Task not completed","quicktasker"),children:r?(0,n.jsx)(ta,{width:"24",height:"24"}):(0,n.jsx)(on.A,{onClick:()=>qo(this,void 0,void 0,(function*(){c(!0),yield l(t,!e,(e=>{s({type:E,payload:{done:e}}),i({type:E,payload:{taskId:t,done:e}})})),c(!1)})),className:`wpqt-size-6 ${e?"wpqt-icon-green":"wpqt-text-gray-300"} wpqt-cursor-pointer`})})}var go=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function vo({deleteTaskCallback:e}){const{state:{taskModalOpen:t}}=(0,a.useContext)(Bs),{deleteTask:s}=Os(),{closeModal:i,handleSuccess:o}=Xa(F);return(0,n.jsx)(ua,{modalOpen:t,closeModal:i,size:"xl",children:(0,n.jsx)(sn,{children:(0,n.jsx)(_o,{deleteTask:t=>go(this,void 0,void 0,(function*(){s(t.id,(()=>{e&&e(t)}))})),onEditTaskCompleted:e=>{o(q,e,Ja.ACTIVE_PIPELINE)}})})})}function jo({text:e=(0,o.__)("No results found","quicktasker")}){return(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-center wpqt-text-xl",children:e})}var bo=s(3033),yo=s(587);function Eo({className:e,onClick:t,title:s,description:a,children:i,dropdown:o,titleClassName:r="",style:c={}}){const l=void 0!==o;return(0,n.jsxs)("div",{className:(0,kn.$)("wpqt-relative wpqt-flex wpqt-flex-col wpqt-rounded wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-4",l&&"wpqt-pr-[24px]",e),style:c,onClick:t,children:[(0,n.jsxs)("div",{className:"wpqt-mb-3",children:[(0,n.jsx)("div",{className:`wpqt-text-lg ${r}`,children:s}),a&&(0,n.jsx)("div",{className:"wpqt-italic wpqt-text-gray-500",children:a})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-h-full",children:i}),l&&(0,n.jsx)("div",{className:"wpqt-absolute wpqt-right-2 wpqt-top-1 wpqt-z-10",children:o})]})}var To=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function So({task:e,onDoneStatusChange:t,className:s=""}){const{changeTaskDoneStatus:i}=Os(),[o,r]=(0,a.useState)(!1),c=e.is_done,l=s=>To(this,void 0,void 0,(function*(){r(!0),yield i(e.id,s,(s=>{t(e.id,s)})),r(!1)}));return o?(0,n.jsx)(aa,{ovalSize:"24",className:"wpqt-mt-auto"}):(0,n.jsx)("div",{className:`wpqt-flex wpqt-justify-center wpqt-mt-auto ${s}`,children:c?(0,n.jsx)(on.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)},"data-testid":"check-icon"}):(0,n.jsx)(on.A,{className:"wpqt-size-6 wpqt-text-gray-300",onClick:e=>{e.stopPropagation(),l(!0)},"data-testid":"check-icon"})})}function Ao({label:e,value:t,valueClassName:s="",valueLink:a,icon:i,onClick:o=()=>{},className:r="",labelClassName:c=""}){return(0,n.jsxs)("div",{className:`wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center ${r}`,onClick:o,children:[i&&i,(0,n.jsx)("div",{className:c,children:t?`${e}:`:e}),(0,n.jsx)("div",{className:`${s}`,children:a?(0,n.jsx)("a",{href:a,target:"_blank",className:"wpqt-text-qtTextBlue wpqt-no-underline",rel:"noreferrer",onClick:e=>e.stopPropagation(),children:t}):t})]})}var Oo=s(6436),No=s(72),Co=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Io({task:e}){const{state:{isUserAllowedToDelete:t}}=(0,a.useContext)(dn),{archiveDispatch:s}=(0,a.useContext)(Fs),{deleteTask:i}=Os(),{modalDispatch:r}=(0,a.useContext)(Bs),[c,l]=(0,a.useState)(!1);return(0,n.jsxs)(li,{menuBtn:({active:e})=>(0,n.jsx)(di,{isActive:e,IconComponent:Oo.A}),children:[(0,n.jsx)(ui,{text:(0,o.__)("View task","quicktasker"),icon:(0,n.jsx)(No.A,{className:"wpqt-icon-blue wpqt-size-4"})}),(0,n.jsx)(ui,{text:(0,o.__)("Restore task","quicktasker"),icon:(0,n.jsx)(xa.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:t=>Co(this,void 0,void 0,(function*(){t.stopPropagation(),r({type:pe,payload:{taskToRestore:e}})}))}),t&&(0,n.jsx)(ui,{text:(0,o.__)("Delete","quicktasker"),loading:c,icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Co(this,void 0,void 0,(function*(){t.stopPropagation(),l(!0),yield i(e.id,(()=>{s({type:je,payload:e.id})})),l(!1)})),className:"!wpqt-mb-0"})]})}function Do({task:e}){const{modalDispatch:t}=(0,a.useContext)(Bs),{archiveDispatch:s}=(0,a.useContext)(Fs),{convertToWPTimezone:i}=Un(),r=e.due_date?i(e.due_date):null;return(0,n.jsxs)(Eo,{title:e.name,description:e.description,dropdown:(0,n.jsx)(Io,{task:e}),className:"wpqt-cursor-pointer",onClick:()=>{t({type:U,payload:{taskToEdit:e}})},children:[(0,n.jsx)(Ao,{label:(0,o.__)("Board","quicktasker"),value:e.pipeline_name?e.pipeline_name:(0,o.__)("Board is deleted!","quicktasker"),icon:(0,n.jsx)(bo.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsxs)("div",{className:"wpqt-mt-2 wpqt-mb-2 wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:[(0,n.jsx)(Oi,{menuBtnClasses:"wpqt-self-start",task:e,onUserAdd:t=>{s({type:ye,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{s({type:Ee,payload:{taskId:e.id,user:t}})}}),(0,n.jsx)(ji,{task:e})]}),r&&(0,n.jsx)(Ao,{label:(0,o.__)("Due date","quicktasker"),value:r,icon:(0,n.jsx)(yo.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(So,{task:e,onDoneStatusChange:(e,t)=>{s({type:Te,payload:{taskId:e,done:t}})}})]})}function Po(){const{state:{archivedTasks:e,archiveLoading:t}}=(0,a.useContext)(Fs);return t?(0,n.jsx)(aa,{className:"wpqt-h-[200px]"}):e&&0===e.length?(0,n.jsx)(jo,{text:(0,o.__)("No match","quicktasker")}):e?(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"wpqt-card-grid",children:e.map((e=>(0,n.jsx)(Do,{task:e},e.id)))})}):null}function Ro(){const{archiveDispatch:e}=(0,a.useContext)(Fs);return(0,n.jsxs)("div",{children:[(0,n.jsx)(Va,{}),(0,n.jsx)(Po,{}),(0,n.jsx)(vo,{editTaskCallback:t=>{e({type:Se,payload:t})},deleteTaskCallback:t=>{e({type:je,payload:t.id})}})]})}function Lo(){const{modalDispatch:e}=(0,a.useContext)(Bs);return(0,n.jsx)(Ks,{children:(0,n.jsx)(Ra,{children:(0,n.jsxs)(La,{children:[(0,n.jsx)(d,{description:(0,o.__)("Archived tasks management page.","quicktasker"),icon:(0,n.jsx)(l.A,{className:"wpqt-icon-gray wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{e({type:ue,payload:!0})}}),children:(0,o.__)("Archive","quicktasker")}),(0,n.jsx)(Ro,{}),(0,n.jsx)(_a,{}),(0,n.jsx)(Ca,{})]})})})}const Mo=()=>{const{state:{pluginURL:e}}=(0,a.useContext)(dn);return(0,n.jsxs)(La,{children:[(0,n.jsx)(d,{description:(0,o.__)("Info about the plugin.","quicktasker"),children:(0,o.__)("About","quicktasker")}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:["Thank you for your interest in the QuickTasker project. For any suggestions or concerns, please write to"," ",(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://wordpress.org/support/plugin/quicktasker/",children:"support forum."})]}),(0,n.jsxs)("p",{children:["For some reading material about the plugin, you can check out the"," ",(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",href:e+"help/index.html",children:"plugin guide."})]})]})]})},Uo=({filterSettings:e,setFilterSettings:t})=>{const{state:{pipelines:s}}=(0,a.useContext)(ja),[i,r]=(0,a.useState)(e),c=(0,n.jsx)(Ga,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"log-search",children:(0,n.jsx)(Ka,{inputId:"log-search",value:i.search,onChange:e=>{r(Object.assign(Object.assign({},i),{search:e}))}})}),l=(0,n.jsx)(la,{text:(0,o.__)("Apply filter","quicktasker"),icon:(0,n.jsx)(Ua.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:()=>t(i)});return(0,n.jsxs)(za,{title:(0,o.__)("Logs filtering","quicktasker"),searchChildren:c,applyFilterChildren:l,children:[(0,n.jsx)(Ga,{title:(0,o.__)("Type","quicktasker"),children:(0,n.jsx)(Aa,{allSelector:!1,selectedOptionValue:i.type,options:[{label:(0,o.__)("All types","quicktasker"),value:Ko.All},{label:(0,o.__)("Board","quicktasker"),value:Ko.Pipeline},{label:(0,o.__)("Task","quicktasker"),value:Ko.Task}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{type:e,typeId:""}))}})}),i.type===Ko.Pipeline&&(0,n.jsx)(Ga,{title:(0,o.__)("Board","quicktasker"),children:(0,n.jsx)(Aa,{allSelector:!0,selectedOptionValue:i.typeId,options:s.map((e=>({label:e.name,value:e.id}))),onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{typeId:e}))}})}),(0,n.jsx)(Ga,{title:(0,o.__)("Created by","quicktasker"),children:(0,n.jsx)(Aa,{allSelector:!1,selectedOptionValue:i.createdBy,options:[{label:(0,o.__)("Everyone","quicktasker"),value:zo.All},{label:(0,o.__)("Admin","quicktasker"),value:zo.Admin},{label:"QuickTasker",value:zo.Quicktasker},{label:(0,o.__)("Automation","quicktasker"),value:zo.Automation},{label:(0,o.__)("Import","quicktasker"),value:zo.Import},{label:(0,o.__)("System","quicktasker"),value:zo.System}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{createdBy:e}))}})}),(0,n.jsx)(Ga,{title:(0,o.__)("Number of logs","quicktasker"),children:(0,n.jsx)(Aa,{allSelector:!1,selectedOptionValue:i.numberOfLogs,options:[{label:(0,o.__)("Show 100","quicktasker"),value:Vo.Hundred},{label:(0,o.__)("Show 200","quicktasker"),value:Vo.TwoHundred},{label:"Show 500",value:Vo.FiveHundred},{label:"Show all",value:Vo.All}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{numberOfLogs:e}))}})}),(0,n.jsx)(Ga,{title:(0,o.__)("Order","quicktasker"),children:(0,n.jsx)(Aa,{allSelector:!1,selectedOptionValue:i.order,options:[{label:(0,o.__)("Ascending","quicktasker"),value:Go.Asc},{label:(0,o.__)("Descending","quicktasker"),value:Go.Desc}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{order:e}))}})}),(0,n.jsx)(Ga,{title:(0,o.__)("Status","quicktasker"),children:(0,n.jsx)(Aa,{allSelector:!1,selectedOptionValue:i.status,options:[{label:(0,o.__)("All","quicktasker"),value:Bo.All},{label:(0,o.__)("Success","quicktasker"),value:Bo.Success},{label:(0,o.__)("Error","quicktasker"),value:Bo.Error}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{status:e}))}})})]})},Fo=({logs:e,loading:t})=>t?(0,n.jsx)(aa,{ovalSize:"64",className:"wpqt-mt-12"}):0===e.length?(0,n.jsx)(jo,{text:(0,o.__)("No logs found","quicktasker")}):(0,n.jsxs)("div",{className:"wpqt-logs-page-grid",children:[(0,n.jsx)(Li,{title:(0,o.__)("Author","quicktasker")}),(0,n.jsx)(Li,{title:(0,o.__)("Created at","quicktasker")}),(0,n.jsx)(Li,{title:(0,o.__)("Status","quicktasker")}),(0,n.jsx)(Li,{title:(0,o.__)("Text","quicktasker")}),e.map((e=>(0,n.jsx)(Ri,{log:e,showStatus:!0},e.id)))]});var Ko,$o,zo;!function(e){e.Pipeline="pipeline",e.Stage="stage",e.Task="task",e.Webhook="webhook",e.All="all"}(Ko||(Ko={})),function(e){e.Success="success",e.Error="error"}($o||($o={})),function(e){e.Admin="admin",e.Quicktasker="quicktasker_user",e.Automation="automation",e.Import="import",e.System="system",e.All="all"}(zo||(zo={}));var Go,Vo,Bo,Ho=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};!function(e){e.Asc="ASC",e.Desc="DESC"}(Go||(Go={})),function(e){e.Hundred="100",e.TwoHundred="200",e.FiveHundred="500",e.All="all"}(Vo||(Vo={})),function(e){e.All="all",e.Success="success",e.Error="error"}(Bo||(Bo={}));const Wo=()=>{const[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)({numberOfLogs:Vo.Hundred,type:Ko.All,typeId:"",createdBy:zo.All,order:Go.Desc,search:"",status:Bo.All}),[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!0);(0,a.useEffect)((()=>{l&&(u(),d(!1))}),[s,l]);const u=()=>Ho(void 0,void 0,void 0,(function*(){try{c(!0);const e=Object.assign({},s);e.numberOfLogs===Vo.All&&delete e.numberOfLogs,e.type===Ko.All&&delete e.type,""===e.typeId&&delete e.typeId,e.createdBy===zo.All&&delete e.createdBy,e.status===Bo.All&&delete e.status;const a=yield es(e);t(a.data)}catch(e){console.error(e),i.oR.error("Failed to fetch logs")}finally{c(!1)}}));return(0,n.jsxs)("div",{children:[(0,n.jsx)(Uo,{filterSettings:s,setFilterSettings:e=>Ho(void 0,void 0,void 0,(function*(){o(e),d(!0)}))}),(0,n.jsx)(Fo,{logs:e,loading:r})]})},Qo=()=>(0,n.jsxs)(La,{children:[(0,n.jsx)(d,{description:(0,o.__)("The logs page where you can see all logs and filter them.","quicktasker"),children:(0,o.__)("Logs","quicktasker")}),(0,n.jsx)(Wo,{})]});function Yo({infoTitle:e,infoDescription:t,infoTitleClick:s,children:a}){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-items-center wpqt-justify-center",children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-1",children:[e&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2 "+(s?"wpqt-cursor-pointer":""),onClick:s||void 0,children:(0,n.jsx)("p",{className:"wpqt-m-0 wpqt-font-semibold wpqt-text-lg",children:e})}),(0,n.jsx)("p",{children:t}),a]})})}function Jo({overviewFilter:e,onCreationDateChange:t,onDoneDateChange:s}){const a=e=>e instanceof Date?In()(e).format("YYYY-MM-DD"):"";return(0,n.jsx)("div",{children:(0,n.jsxs)(za,{title:(0,o.__)("Statistics filtering","quicktasker"),titleClassName:"wpqt-text-center",childrenClassName:"wpqt-gap-6 wpqt-justify-center",searchChildren:null,children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task creation date","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("(Filter tasks that have creation date equal or bigger than)","quicktasker")})]}),(0,n.jsx)(fo.A,{onChange:e=>{const s=a(e);t(s)},value:e.taskCreationDate,format:"y-MM-dd",id:"taskCreationDate"})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task done date","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("(Filter tasks that have done date equal or smaller than)","quicktasker")})]}),(0,n.jsx)(fo.A,{onChange:e=>{const t=a(e);s(t)},value:e.taskDoneDate,format:"y-MM-dd",id:"taskCreationDate"})]})]})})}var Xo=s(2298);function Zo(e){const t=e.slice(1).some((e=>e[1]>0));return e.length>1&&t}function er({text:e}){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-items-center wpqt-h-[400px] wpqt-w-[500px] wpqt-font-semibold",children:e})}function tr({pipelineOverviewData:e,options:t,width:s}){var a,i;const r=[["Archived tasks","Task Count"],["Archived tasks",parseInt(null!==(a=null==e?void 0:e.archivedTasksCount)&&void 0!==a?a:"0")||0],["Not archived tasks",parseInt(null!==(i=null==e?void 0:e.notArchivedTasksCount)&&void 0!==i?i:"0")||0]];return Zo(r)?(0,n.jsx)(Xo.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Archived tasks"}),width:s,height:"400px"}):(0,n.jsx)(er,{text:(0,o.__)("Not enough data to display archived tasks chart","quicktasker")})}function sr({pipelineOverviewData:e,options:t,width:s}){var a;const i=[["Stage","Task Count"],...null!==(a=null==e?void 0:e.stages.map((e=>[e.name,parseInt(e.tasksCount)||0])))&&void 0!==a?a:[]];return Zo(i)?(0,n.jsx)(Xo.t1,{chartType:"PieChart",data:i,options:Object.assign(Object.assign({},t),{title:"Task distribution by stages"}),width:s,height:"400px"}):(0,n.jsx)(er,{text:(0,o.__)("Not enough data to display task distribution by stages chart","quicktasker")})}function ar({pipelineOverviewData:e,options:t,width:s}){var a,i;const r=[["Task status","Task Count"],["Done",parseInt(null!==(a=null==e?void 0:e.doneTasksCount)&&void 0!==a?a:"0")||0],["Not Done",parseInt(null!==(i=null==e?void 0:e.notDoneTasksCount)&&void 0!==i?i:"0")||0]];return Zo(r)?(0,n.jsx)(Xo.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Task status"}),width:s,height:"400px"}):(0,n.jsx)(er,{text:(0,o.__)("Not enough data to display task status chart","quicktasker")})}var nr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const ir={legend:{position:"left",alignment:"center",textStyle:{color:"#233238",fontSize:14}}};function or({pipeline:e,overviewFilter:t}){const[s,i]=(0,a.useState)(null),[o,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(()=>{nr(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e,t){const s=new URLSearchParams({taskStartDate:t.taskCreationDate||"",taskDoneDate:t.taskDoneDate||"",taskAssignees:t.taskAssignees.join(",")});return Wt()({path:`/wpqt/v1/pipelines/${e}/overview?${s.toString()}`,method:"GET",headers:Qt()})}(e.id,t);i(s.data)}catch(e){console.error(e)}finally{r(!1)}}))})()}),[e.id,t]),o||!s?(0,n.jsx)(aa,{ovalSize:"48"}):(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-wrap wpqt-justify-center xl:wpqt-justify-start",children:[(0,n.jsx)(sr,{pipelineOverviewData:s,options:ir,width:"500px"}),(0,n.jsx)(ar,{pipelineOverviewData:s,options:ir,width:"500px"}),(0,n.jsx)(tr,{pipelineOverviewData:s,options:ir,width:"500px"})]})}function rr({pipeline:e}){const[t,s]=(0,a.useState)({taskCreationDate:null,taskDoneDate:null,taskAssignees:[]});return(0,n.jsxs)("div",{children:[(0,n.jsx)(Jo,{overviewFilter:t,onCreationDateChange:e=>{s(Object.assign(Object.assign({},t),{taskCreationDate:e}))},onDoneDateChange:e=>{s(Object.assign(Object.assign({},t),{taskDoneDate:e}))}}),(0,n.jsx)(or,{pipeline:e,overviewFilter:t})]})}function cr(){const{state:{pipelines:e}}=(0,a.useContext)(ja),t=e.map((e=>e.name)),s=e.map((e=>(0,n.jsx)(rr,{pipeline:e},e.id)));return(0,n.jsx)(La,{children:s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{description:(0,o.__)("Get overview of the tasks.","quicktasker"),children:(0,o.__)("Overview","quicktasker")}),(0,n.jsx)(Ci,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]}):(0,n.jsx)(Yo,{infoTitle:(0,o.__)("No overview to display","quicktasker"),infoDescription:(0,o.__)("You need to first create a board to see the overview.","quicktasker")})})}function lr(){const{state:{activePipeline:e}}=(0,a.useContext)(bs),t=()=>(null==e?void 0:e.stages)||[],s=e=>{const s=t();let a=null;return s?(s.forEach((t=>{t.tasks&&!a&&t.tasks.find((t=>t.id===e))&&(a=t)})),a):null},n=(0,a.useMemo)((()=>{const e=t();return e?e.map((e=>({label:e.name,value:e.id}))):[]}),[e]),i=(0,a.useMemo)((()=>{const e=t(),s=[];return e?(e.forEach((e=>{e.tasks&&s.push(...e.tasks)})),s):s}),[e]),o=null==e?void 0:e.settings;return{getActivePipelineStages:t,getActivePipelinStageTasksLength:e=>{const s=t();if(!s)return 0;const a=s.find((t=>t.id===e));return a&&a.tasks?a.tasks.length:0},getTaskStage:s,getTaskOrderInStage:e=>{const t=s(e);if(!t||!t.tasks)return null;const a=t.tasks.findIndex((t=>t.id===e));return-1!==a?a:null},activePipelineTasks:i,activePipelineSettings:o,isTaskOnLastStage:e=>{const a=t();if(!a)return!1;const n=s(e);if(!n)return!1;const i=a[a.length-1];return n.id===i.id},stageOptions:n}}const dr=()=>{const{state:{users:e,wpUsers:t}}=(0,a.useContext)(Qa);return{getUser:(s,a)=>a===Bt.QUICKTASKER?e.find((e=>e.id===s)):a===Bt.WP_USER?t.find((e=>e.id===s)):void 0,combinedUsers:(0,a.useMemo)((()=>[...e,...t]),[e,t])}},ur=(e,t)=>{switch(t.type){case L:{const{id:s,type:a}=t.payload;return Object.assign(Object.assign({},e),{userFilter:{id:s,type:a}})}case R:return Object.assign(Object.assign({},e),{stageIdFilter:t.payload});case M:return Object.assign(Object.assign({},e),{searchText:t.payload});default:return e}},pr={stageIdFilter:"",userFilter:{id:null,type:null},searchText:""},hr=(0,a.createContext)({state:pr,taskViewDispatch:()=>{}}),mr=({children:e})=>{const[t,s]=(0,a.useReducer)(ur,pr);return(0,n.jsx)(hr.Provider,{value:{state:t,taskViewDispatch:s},children:e})};function wr(){const{state:{stageIdFilter:e,userFilter:t,searchText:s},taskViewDispatch:i}=(0,a.useContext)(hr),{stageOptions:r}=lr(),{combinedUsers:c}=dr(),l=c.map((e=>({value:`${e.id}:${e.user_type}`,label:`${e.name} (${ms[e.user_type]})`}))),d=t.id&&t.type?`${t.id}:${t.type}`:"";return(0,n.jsxs)(za,{title:(0,o.__)("Filter tasks","quicktasker"),searchChildren:(0,n.jsx)(Ga,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"task-view-search",children:(0,n.jsx)(Ka,{inputId:"task-view-search",value:s,onChange:e=>{i({type:M,payload:e})}})}),children:[(0,n.jsx)(Ga,{title:(0,o.__)("Stage","quicktasker"),children:(0,n.jsx)(Aa,{id:"task-view-stage-filter",allSelectorLabel:(0,o.__)("All stages","quicktasker"),selectedOptionValue:e,options:r,onSelectionChange:e=>{i({type:R,payload:e})}})}),(0,n.jsx)(Ga,{title:(0,o.__)("Assigned user","quicktasker"),children:(0,n.jsx)(Aa,{id:"task-view-assigned-user-filter",allSelectorLabel:(0,o.__)("All users","quicktasker"),selectedOptionValue:d,options:l,onSelectionChange:e=>{const[t,s]=e.split(":");i({type:L,payload:{id:t,type:s}})}})})]})}var fr,kr,qr=s(9879),_r=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function xr(e){return e.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")}function gr(e){const t=[];let s="",a=!1;for(let n=0;n<e.length;n++){const i=e[n];'"'===i?a&&n+1<e.length&&'"'===e[n+1]?(s+='"',n++):a=!a:","!==i||a?s+=i:(t.push(s.trim()),s="")}return t.push(s.trim()),t}function vr(){return"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}!function(e){e.ADD_CARD="addCard",e.UPDATE_CARD="updateCard",e.Comment_CARD="commentCard"}(fr||(fr={})),function(e){e.TRELLO="TRELLO-IMPORT",e.ASANA="ASANA-IMPORT",e.PIPEDRIVE="PIPEDRIVE-IMPORT",e.QUICKTASKER="QUICKTASKER-IMPORT"}(kr||(kr={}));const jr={pipelineName:"",pipelineDescription:"",stages:[],tasks:[],labels:[],sourcePipelines:[],taskComments:[]},br=e=>{switch(e){case kr.TRELLO:return(0,o.__)("Import from Trello.","quicktasker");case kr.ASANA:return(0,o.__)("Import from Asana.","quicktasker");case kr.PIPEDRIVE:return(0,o.__)("Import from Pipedrive.","quicktasker");case kr.QUICKTASKER:return(0,o.__)("Import from QuickTasker.","quicktasker");default:return(0,o.__)("Select import source","quicktasker")}},yr=e=>{switch(e){case kr.TRELLO:return(0,o.__)("Export your Trello board as JSON format and use it for import.","quicktasker");case kr.ASANA:return(0,o.__)("Export your Asana project as JSON format and use it for import","quicktasker");case kr.PIPEDRIVE:return(0,o.__)("Export your Pipedrive deals as CSV format and use it for import. Please not that generated CSV file column headers should be in English.","quicktasker");case kr.QUICKTASKER:return(0,o.__)("Import your QuickTasker board from JSON format.","quicktasker");default:return(0,o.__)("Select an import source to get started","quicktasker")}};function Er({importData:e,importDataFilter:t,selectedImportSource:s,onNameChange:a,onDescriptionChange:i,onImportDataFilterChange:r,validation:c}){const l=function(e){const t={supportsArchiveTaskToggle:!1,supportTaskCustomFieldsToggle:!1,supportTaskCommentsToggle:!1,allowSourceSelection:!1};switch(e){case kr.PIPEDRIVE:return Object.assign(Object.assign({},t),{supportsArchiveTaskToggle:!0,allowSourceSelection:!0});case kr.TRELLO:return Object.assign(Object.assign({},t),{supportsArchiveTaskToggle:!0,supportTaskCommentsToggle:!0});case kr.ASANA:return Object.assign(Object.assign({},t),{supportsArchiveTaskToggle:!0});case kr.QUICKTASKER:return Object.assign(Object.assign({},t),{supportsArchiveTaskToggle:!0,supportTaskCustomFieldsToggle:!0,supportTaskCommentsToggle:!0});default:return t}}(s);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3 wpqt-mb-3",children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-1",children:[(0,n.jsx)(Tr,{title:(0,o.__)("Board name","quicktasker")}),(0,n.jsx)(Ka,{value:e.pipelineName,onChange:a,wrapperClassName:"wpqt-w-[200px] !wpqt-mb-0",className:"wpqt-w-full wpqt-mb-0"}),c.pipelineNameExists&&(0,n.jsx)("div",{className:"wpqt-text-red-500 wpqt-text-sm",children:(0,o.__)("This board name already exists.","quicktasker")})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-1",children:[(0,n.jsx)(Tr,{title:(0,o.__)("Board description","quicktasker")}),(0,n.jsx)(qn,{value:e.pipelineDescription,onChange:i,rowsCount:2,className:"!wpqt-w-[200px] !wpqt-mb-0"})]}),l.supportsArchiveTaskToggle&&(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-2 wpqt-w-[200px]",children:[(0,n.jsx)(Tr,{title:(0,o.__)("Import archived tasks?","quicktasker")}),(0,n.jsx)(mo,{checked:t.includeArchivedTasks,handleChange:()=>{r(Object.assign(Object.assign({},t),{includeArchivedTasks:!t.includeArchivedTasks}))},dataTestId:"import-archived-tasks-toggle"})]}),l.supportTaskCustomFieldsToggle&&(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-2 wpqt-w-[200px]",children:[(0,n.jsx)(Tr,{title:(0,o.__)("Import task custom fields?","quicktasker")}),(0,n.jsx)(mo,{checked:t.includeTaskCustomFields,handleChange:()=>{r(Object.assign(Object.assign({},t),{includeTaskCustomFields:!t.includeTaskCustomFields}))},dataTestId:"import-task-custom-fields-toggle"})]}),l.supportTaskCommentsToggle&&(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-2 wpqt-w-[200px]",children:[(0,n.jsx)(Tr,{title:(0,o.__)("Import task comments?","quicktasker")}),(0,n.jsx)(mo,{checked:t.includeTaskComments,handleChange:()=>{r(Object.assign(Object.assign({},t),{includeTaskComments:!t.includeTaskComments}))},dataTestId:"import-task-comments-toggle"})]}),l.allowSourceSelection&&(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-2 wpqt-w-[200px]",children:[(0,n.jsx)(Tr,{title:(0,o.__)("Filter by source","quicktasker")}),e.sourcePipelines.map((e=>{const s=t.sourcePipelinesFilter.some((t=>t.id===e.id)),a=`source-${e.id}`;return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)("label",{htmlFor:a,children:e.name}),(0,n.jsx)("input",{type:"checkbox",value:e.name,id:a,checked:s,onChange:()=>{let a;a=s?t.sourcePipelinesFilter.filter((t=>t.id!==e.id)):[...t.sourcePipelinesFilter,e],r(Object.assign(Object.assign({},t),{sourcePipelinesFilter:a}))}})]},e.id)}))]})]})}function Tr({title:e}){return(0,n.jsx)("div",{className:"wpqt-font-semibold",children:e})}function Sr({importData:e}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-2",children:[(0,n.jsxs)("div",{children:[(0,o.__)("Number of tasks","quicktasker"),":"," ",(0,n.jsxs)("span",{className:"wpqt-font-semibold",children:[e.tasks.length," (",(0,o.__)("archived","quicktasker")," ",e.tasks.filter((e=>e.archived)).length,")"]})]}),(0,n.jsxs)("div",{children:[(0,o.__)("Number of task comments","quicktasker"),":"," ",(0,n.jsx)("span",{className:"wpqt-font-semibold",children:e.taskComments.length})]}),(0,n.jsxs)("div",{children:[(0,o.__)("Number of stages","quicktasker"),":"," ",(0,n.jsx)("span",{className:"wpqt-font-semibold",children:e.stages.length})]}),(0,n.jsxs)("div",{children:[(0,o.__)("Number of labels","quicktasker"),":"," ",(0,n.jsx)("span",{className:"wpqt-font-semibold"}),e.labels.length]})]})}var Ar=s(9197),Or=s(7613);const Nr=s.p+"images/icon-80x80.78f40056.png";function Cr({selectedImportSource:e,handleImportSourceChange:t}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2",children:[(0,n.jsx)("div",{"data-testid":"trello-container",className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(e===kr.TRELLO?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>t(kr.TRELLO),children:(0,n.jsx)(Ar.IK4,{className:"wpqt-size-6 wpqt-trello-blue","data-testid":"trello-icon"})}),(0,n.jsx)("div",{"data-testid":"asana-container",className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(e===kr.ASANA?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>t(kr.ASANA),children:(0,n.jsx)(Nn.OpO,{className:"wpqt-size-6 wpqt-asana-pink","data-testid":"asana-icon"})}),(0,n.jsx)("div",{"data-testid":"pipedrive-container",className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(e===kr.PIPEDRIVE?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>t(kr.PIPEDRIVE),children:(0,n.jsx)(Or.nad,{className:"wpqt-size-6 wpqt-pipedrive-green","data-testid":"pipedrive-icon"})}),(0,n.jsx)("div",{"data-testid":"quicktasker-container",className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(e===kr.QUICKTASKER?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>t(kr.QUICKTASKER),children:(0,n.jsx)("img",{src:Nr,className:"wpqt-size-6","data-testid":"quicktasker-icon"})})]})}const Ir={includeArchivedTasks:!0,includeTaskComments:!1,includeTaskCustomFields:!0,sourcePipelinesFilter:[]};function Dr(){const{state:{pipelineImportModalOpen:e},modalDispatch:t}=(0,a.useContext)(Bs),{pipelinesDispatch:s,checkIfPipelineNameExists:r}=ya(),{fetchAndSetPipelineData:c}=(0,a.useContext)(bs),[l,d]=(0,a.useState)(kr.TRELLO),[u,p]=(0,a.useState)(null),[h,m]=(0,a.useState)(Object.assign({},Ir)),[w,f]=(0,a.useState)(null),[k,q]=(0,a.useState)(!1),_=(0,a.useRef)(null),{importPipeline:g}=function(){return{importPipeline:(e,t)=>_r(this,void 0,void 0,(function*(){try{const s=yield function(e,t){return Wt()({path:"/wpqt/v1/import",method:"POST",data:{source:e,data:t},headers:Qt()})}(e,t);return{success:!0,data:s.data}}catch(e){return console.error(e),i.oR.error((0,o.__)("Import failed","quicktasker")),{success:!1,error:e}}}))}}(),v=(0,a.useMemo)((()=>!!(null==u?void 0:u.pipelineName)&&r(u.pipelineName)),[null==u?void 0:u.pipelineName]),j=w&&!v,b=()=>{p(null),f(null),m(Object.assign({},Ir))};return(0,a.useEffect)((()=>{if(u){const e=u.tasks.filter((e=>h.includeArchivedTasks||!e.archived)),t=new Set(e.map((e=>e.taskId))),s=h.includeTaskComments?u.taskComments.filter((e=>t.has(e.taskId))):[];h.includeTaskCustomFields||e.forEach((e=>{e.customFields=[]}));const a=Object.assign(Object.assign({},u),{tasks:e,taskComments:s});h.sourcePipelinesFilter.length>0&&(a.tasks=a.tasks.filter((e=>h.sourcePipelinesFilter.some((t=>e.sourcePipeline&&t.id===e.sourcePipeline.id)))),a.stages=a.stages.filter((e=>h.sourcePipelinesFilter.some((t=>e.sourcePipeline.id===t.id))))),f(a)}}),[u,h]),(0,n.jsx)(ua,{modalOpen:e,closeModal:()=>{t({type:oe}),b()},children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-4",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Import board","quicktasker")}),(0,n.jsx)(Cr,{selectedImportSource:l,handleImportSourceChange:e=>{d(e),b()}}),(0,n.jsxs)("div",{className:"wpqt-text-center wp-mb-4",children:[(0,n.jsx)("p",{className:"wpqt-my-0",children:br(l)}),(0,n.jsx)("p",{className:"wpqt-my-0",children:yr(l)})]}),!u&&(0,n.jsx)(la,{text:(0,o.__)("Select import file","quicktasker"),onClick:()=>{_.current&&_.current.click()},icon:(0,n.jsx)(qr.t76,{className:"wpqt-size-5 wpqt-text-blue-500"})}),u&&(0,n.jsx)(Er,{importData:u,importDataFilter:h,validation:{pipelineNameExists:v},selectedImportSource:l,onNameChange:e=>{p((t=>t?Object.assign(Object.assign({},t),{pipelineName:e}):t))},onDescriptionChange:e=>{p((t=>t?Object.assign(Object.assign({},t),{pipelineDescription:e}):t))},onImportDataFilterChange:m}),w&&(0,n.jsx)(Sr,{importData:w}),j&&(0,n.jsx)(la,{text:(0,o.__)("Start import","quicktasker"),onClick:()=>{return e=this,a=void 0,r=function*(){if(!w||v)return;q(!0);const{data:e}=yield g(l,w);e&&(s({type:x,payload:e.pipeline}),yield c(e.pipeline.id),b(),t({type:oe}),i.oR.success((0,o.__)("Board imported","quicktasker"))),q(!1)},new((n=void 0)||(n=Promise))((function(t,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(i,o)}c((r=r.apply(e,a||[])).next())}));var e,a,n,r},loading:k}),(0,n.jsx)("input",{type:"file",ref:_,id:"import-upload",className:"wpqt-hidden",accept:(()=>{switch(l){case kr.PIPEDRIVE:return".csv";case kr.TRELLO:case kr.ASANA:case kr.QUICKTASKER:default:return".json"}})(),onChange:e=>{var t,s;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){const e=new FileReader,t=null===(s=a.name.split(".").pop())||void 0===s?void 0:s.toLowerCase();e.onload=e=>{var s,a;try{let n,r;switch(n="csv"===t?function(e){if(!e||"string"!=typeof e)return[];const t=e.split("\n").filter((e=>""!==e.trim()));if(0===t.length)return[];const s=gr(t[0]).map(xr),a=[];for(let e=1;e<t.length;e++){const n=gr(t[e]);if(0===n.length)continue;const i={};for(let e=0;e<s.length;e++)i[s[e]]=e<n.length?n[e]:"";a.push(i)}return a}(null===(s=e.target)||void 0===s?void 0:s.result):JSON.parse(null===(a=e.target)||void 0===a?void 0:a.result),l){case kr.TRELLO:{const e=function(e){if(!e||"object"!=typeof e)return"Import data is missing or not an object";const t=e;if(!t.name)return"Missing board name";if(!t.cards)return"Missing cards array";if(!t.lists)return"Missing lists array";if(!t.labels)return"Missing labels array";if(!Array.isArray(t.cards))return"Cards property is not an array";if(!Array.isArray(t.lists))return"Lists property is not an array";if(!Array.isArray(t.labels))return"Labels property is not an array";if(t.lists.length>0&&!t.lists.some((e=>!e.closed)))return"All lists are closed, at least one open list is required";for(const e of t.cards){if(!e.id)return`Card missing ID: ${JSON.stringify(e).substring(0,100)}...`;if(!e.name)return`Card missing name: ${e.id}`;if(!e.idList)return`Card missing list ID: ${e.id}`;if(!Array.isArray(e.labels))return`Card labels is not an array: ${e.id}`}for(const e of t.lists){if(!e.id)return`List missing ID: ${JSON.stringify(e).substring(0,100)}...`;if(!e.name)return`List missing name: ${e.id}`;if("boolean"!=typeof e.closed)return`List closed status is not boolean: ${e.id}`}for(const e of t.labels){if(!e.id)return`Label missing ID: ${JSON.stringify(e).substring(0,100)}...`;if(!e.name&&""!==e.name)return`Label missing name: ${e.id}`;if(!e.color)return`Label missing color: ${e.id}`}return!0}(n);if(!0!==e)return void i.oR.error(`${(0,o.__)("Invalid Trello import","quicktasker")}: ${e}`);r=function(e){const t=[{name:e.name,id:e.id}],s=e.actions.filter((e=>e.type===fr.Comment_CARD));return{pipelineName:e.name,pipelineDescription:e.desc,stages:e.lists.filter((e=>!e.closed)).map((t=>({stageName:t.name,stageDescription:"",stageId:t.id,sourcePipeline:{name:e.name,id:e.id}}))),tasks:e.cards.map((t=>{var s,a;return{taskId:t.id,taskName:t.name,taskDescription:"",stageId:t.idList,archived:t.closed,assignedLabels:t.labels.map((e=>({labelName:e.name,labelId:e.id,color:e.color}))),dueDate:t.due?t.due:null,taskCompletedAt:t.dateCompleted?t.dateCompleted:null,taskFocusColor:null!==(a=null===(s=t.cover)||void 0===s?void 0:s.color)&&void 0!==a?a:null,sourcePipeline:{name:e.name,id:e.id},customFields:[]}})),labels:e.labels.map((e=>({labelName:e.name,labelId:e.id,color:e.color}))),sourcePipelines:t,taskComments:s.map((e=>{var t,s,a;return{commentId:e.id,taskId:null!==(s=null===(t=e.data.card)||void 0===t?void 0:t.id)&&void 0!==s?s:"",createdAt:e.date,commentText:null!==(a=e.data.text)&&void 0!==a?a:"",authorId:e.idMemberCreator,isAuthorAdmin:!1,isPrivate:!0}}))}}(n);break}case kr.ASANA:{const e=function(e){if(!e||"object"!=typeof e)return"Import data is missing or not an object";const t=e;if(!t.data)return"Missing data array";if(!Array.isArray(t.data))return"Data property is not an array";if(0===t.data.length)return"Data array is empty";for(const e of t.data){if(!e.gid)return`Task missing GID: ${JSON.stringify(e).substring(0,100)}...`;if(!e.name)return`Task missing name: ${e.gid}`;if("boolean"!=typeof e.completed)return`Task completed status is not boolean: ${e.gid}`;if(!Array.isArray(e.projects))return`Task projects is not an array: ${e.gid}`;if(0===e.projects.length)return`Task has no projects: ${e.gid}`;if(!Array.isArray(e.memberships))return`Task memberships is not an array: ${e.gid}`;if(!Array.isArray(e.tags))return`Task tags is not an array: ${e.gid}`;for(const t of e.projects){if(!t.gid)return`Project missing GID in task ${e.gid}`;if(!t.name)return`Project missing name in task ${e.gid}`}for(const t of e.memberships){if(!t.project)return`Membership missing project in task ${e.gid}`;if(!t.section)return`Membership missing section in task ${e.gid}`;const s=t.project,a=t.section;if(!s.gid)return`Membership project missing GID in task ${e.gid}`;if(!s.name)return`Membership project missing name in task ${e.gid}`;if(!a.gid)return`Membership section missing GID in task ${e.gid}`;if(!a.name)return`Membership section missing name in task ${e.gid}`}for(const t of e.tags){if(!t.gid)return`Tag missing GID in task ${e.gid}`;if(!t.name)return`Tag missing name in task ${e.gid}`}}return!0}(n);if(!0!==e)return void i.oR.error(`${(0,o.__)("Invalid Asana import","quicktasker")}: ${e}`);r=function(e){if(!e.data||0===e.data.length)return Object.assign({},jr);const t=e.data[0].projects[0].gid,s=e.data[0].projects[0].name,a=new Map,n=new Map,i=[{name:s,id:t}];e.data.forEach((e=>{e.memberships.forEach((e=>{if(e.project.gid===t){const t=e.section;a.has(t.gid)||a.set(t.gid,t)}})),e.tags.forEach((e=>{n.has(e.gid)||n.set(e.gid,e)}))}));const o=Array.from(a.values()).map((e=>({stageId:e.gid,stageName:e.name,stageDescription:"",sourcePipeline:{name:s,id:t}}))),r=Array.from(n.values()).map((e=>({labelId:e.gid,labelName:e.name||"",color:Kt}))),c=e.data.map((e=>{var a;const n=e.memberships.find((e=>e.project.gid===t)),i=(null==n?void 0:n.section.gid)||(null===(a=o[0])||void 0===a?void 0:a.stageId)||"";return{taskId:e.gid,taskName:e.name,taskDescription:"",stageId:i,archived:e.completed,dueDate:e.due_at||e.due_on||null,taskCompletedAt:e.completed_at||null,assignedLabels:e.tags.map((e=>({labelName:e.name,labelId:e.gid,color:Kt}))),taskFocusColor:null,sourcePipeline:{name:s,id:t},customFields:[]}}));return{pipelineName:s,pipelineDescription:"",stages:o,tasks:c,labels:r,sourcePipelines:i,taskComments:[]}}(n);break}case kr.PIPEDRIVE:{const e=function(e){if(!e||!Array.isArray(e))return"Import data is missing or not an array";if(0===e.length)return"Deals array is empty";for(const t of e){if(!t.title)return`Deal missing title: ${JSON.stringify(t).substring(0,100)}...`;if(!t.stage)return`Deal missing stage: ${t.title||"Unknown"}`;if(!t.status)return`Deal missing status: ${t.title||"Unknown"}`;const e=String(t.status).toLowerCase();if(!["open","won","lost","deleted"].includes(e))return`Invalid deal status: ${e} for deal: ${t.title||"Unknown"}`;if(void 0!==t.label&&null!==t.label&&"string"!=typeof t.label)return`Deal label must be a string: ${t.title||"Unknown"}`;if(void 0!==t.expected_close_date&&null!==t.expected_close_date&&"string"!=typeof t.expected_close_date)return`Deal expected_close_date must be a string or null: ${t.title||"Unknown"}`;if(void 0!==t.deal_closed_on&&null!==t.deal_closed_on&&"string"!=typeof t.deal_closed_on)return`Deal deal_closed_on must be a string or null: ${t.title||"Unknown"}`}const t=new Set;for(const s of e)s.stage&&"string"==typeof s.stage&&t.add(s.stage);return 0!==t.size||"No valid stages found in deals"}(n);if(!0!==e)return void i.oR.error(`${(0,o.__)("Invalid Pipedrive import","quicktasker")}: ${e}`);r=function(e){if(!e)return Object.assign({},jr);const t=new Map,s=new Map,a=new Map;e.forEach((e=>{e.pipeline&&!a.has(e.pipeline)&&a.set(e.pipeline,{name:e.pipeline,id:vr()})})),e.forEach((e=>{e.stage&&!t.has(e.stage)&&t.set(e.stage,{stageId:vr(),stageName:e.stage,stageDescription:"",sourcePipeline:a.get(e.pipeline)||{name:"",id:vr()}}),e.label&&e.label.split(",").map((e=>e.trim())).filter(Boolean).forEach((e=>{e&&!s.has(e)&&s.set(e,{labelId:vr(),labelName:e,color:Kt})}))}));const n=Array.from(t.values()).map((e=>({stageId:e.stageId,stageName:e.stageName,stageDescription:"",sourcePipeline:{name:e.sourcePipeline.name,id:e.sourcePipeline.id}}))),i=Array.from(s.values()).map((e=>({labelId:e.labelId,labelName:e.labelName,color:e.color}))),o=Array.from(a.values()).map((e=>({name:e.name,id:e.id}))),r=e.map((e=>{var i;const o=t.get(e.stage),r=e.status.toLocaleLowerCase(),c=[];let l=null;if(e.label&&e.label.split(",").map((e=>e.trim())).filter(Boolean).forEach((e=>{const t=s.get(e);t&&c.push({labelId:t.labelId,labelName:t.labelName,color:t.color})})),e.pipeline){const t=a.get(e.pipeline);t&&(l={name:t.name,id:t.id})}return{taskId:e.id,taskName:e.title,taskDescription:"",stageId:o?o.stageId:(null===(i=n[0])||void 0===i?void 0:i.stageId)||"",archived:"lost"===r||"deleted"===r,assignedLabels:c,dueDate:e.expected_close_date||null,taskFocusColor:null,taskCompletedAt:"won"===r&&e.deal_closed_on||null,sourcePipeline:l,customFields:[]}}));return{pipelineName:"",pipelineDescription:"",stages:n,tasks:r,labels:i,sourcePipelines:o,taskComments:[]}}(n);break}case kr.QUICKTASKER:{const e=function(e){if(!e||"object"!=typeof e)return"Invalid import data: Not a valid object";const t=e;if(!t.pipelineName)return"Pipeline name is required";if(!Array.isArray(t.stages))return"Stages must be an array";for(let e=0;e<t.stages.length;e++){const s=t.stages[e];if(!s.stageName||"string"!=typeof s.stageName||!s.stageName.trim())return`Stage #${e+1} is missing a name`;if(void 0===s.stageId||null===s.stageId)return`Stage #${e+1} is missing an ID`}if(t.tasks&&Array.isArray(t.tasks))for(let e=0;e<t.tasks.length;e++){const s=t.tasks[e];if(!s.taskName||"string"!=typeof s.taskName||!s.taskName.trim())return`Task #${e+1} is missing a name`;if(void 0===s.stageId||null===s.stageId)return`Task #${e+1} is missing a stage ID`;if(!t.stages.some((e=>e.stageId==s.stageId)))return`Task "${s.taskName}" references a stage ID that does not exist in the import data`;if(s.assignedLabels&&Array.isArray(s.assignedLabels))for(let e=0;e<s.assignedLabels.length;e++){const t=s.assignedLabels[e];if(void 0===t.labelId||null===t.labelId||!t.labelName)return`Task "${s.taskName}" has an invalid label at position ${e+1}`}if(s.customFields&&Array.isArray(s.customFields))for(let e=0;e<s.customFields.length;e++)if(!s.customFields[e].task_id)return`Task "${s.taskName}" has a custom field without task_id`}if(t.labels&&Array.isArray(t.labels))for(let e=0;e<t.labels.length;e++){const s=t.labels[e];if(!s.labelName||"string"!=typeof s.labelName||!s.labelName.trim())return`Label #${e+1} is missing a name`;if(void 0===s.labelId||null===s.labelId)return`Label #${e+1} is missing an ID`;if(!s.color||"string"!=typeof s.color||!s.color.trim())return`Label "${s.labelName||e+1}" is missing a color`}return!0}(n);if(!0!==e)return void i.oR.error(`${(0,o.__)("Invalid Quicktasker import","quicktasker")}: ${e}`);r=n;break}default:throw new Error("Unsupported import source")}p(r)}catch(e){console.error("Error parsing import file:",e),i.oR.error((0,o.__)("Failed to parse import file","quicktasker"))}},e.readAsText(a)}}})]})})}function Pr(){const{state:{moveTaskModalOpen:e,taskToEdit:t},modalDispatch:s}=(0,a.useContext)(Bs),{dispatch:i}=(0,a.useContext)(bs),{getActivePipelineStages:r,getActivePipelinStageTasksLength:c,getTaskStage:l,getTaskOrderInStage:d}=lr(),{moveTask:u}=Os(),[p,h]=(0,a.useState)(0),[w,f]=(0,a.useState)(""),[k,q]=(0,a.useState)(!1),_=c(w),x=Array.from({length:_+1},((e,t)=>({value:t.toString(),label:(t+1).toString()}))),g=r().map((e=>({value:e.id,label:e.name}))),v=()=>{s({type:Z})};return(0,a.useEffect)((()=>{if(t){const e=l(t.id),s=d(t.id);e&&null!==s&&(f(e.id),h(s))}}),[t]),(0,n.jsx)(ua,{modalOpen:e,closeModal:v,children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,n.jsx)("h2",{children:(0,o.__)("Change task location on board","quicktasker")}),(0,n.jsx)("label",{htmlFor:"move-task-stage-selection",children:(0,o.__)("Select stage","quicktasker")}),(0,n.jsx)(Aa,{id:"move-task-stage-selection",allSelector:!1,selectedOptionValue:w,options:g,onSelectionChange:e=>{f(e),h(0)}}),(0,n.jsx)("label",{htmlFor:"move-task-order-selection",children:(0,o.__)("Select order","quicktasker")}),(0,n.jsx)(Aa,{id:"move-task-order-selection",allSelector:!1,selectedOptionValue:String(p),options:x,onSelectionChange:e=>h(Number(e))}),(0,n.jsx)(ca,{btnText:(0,o.__)("Apply","quicktasker"),loading:k,onClick:()=>{return e=this,s=void 0,n=function*(){if(!t)return;const e=l(t.id),s=d(t.id);e&&null!==s&&(q(!0),yield u(t.id,w,p,(t=>{t&&(i({type:m,payload:{source:{droppableId:e.id,index:s},destination:{droppableId:w,index:p}}}),v())})),q(!1))},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n}})]})})}const Rr=(0,a.forwardRef)((({addPipeline:e,modalSaving:t},s)=>{const[i,r]=(0,a.useState)(""),[c,l]=(0,a.useState)(""),d=()=>{r(""),l("")};return(0,a.useImperativeHandle)(s,(()=>({clearContent:d}))),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(ha,{children:[(0,n.jsx)(ma,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(Ka,{isAutoFocus:!0,value:i,onChange:e=>r(e),className:"wpqt-w-full",wrapperClassName:"wpqt-w-full"})}),(0,n.jsx)(ma,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(qn,{rowsCount:3,value:c,onChange:e=>l(e),className:"wpqt-w-full"})})]}),(0,n.jsx)(wa,{onSave:()=>{e(i,c)},loading:t,saveBtnText:(0,o.__)("Add board","quicktasker")})]})}));var Lr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Mr(){return{deletePipeline:(e,t)=>Lr(this,void 0,void 0,(function*(){try{const s=yield function(e){return Wt()({path:`/wpqt/v1/pipelines/${e}`,method:"DELETE",headers:Qt()})}(e);t&&t(s.data.deletedPipelineId,s.data.pipelineIdToLoad)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete board","quicktasker"))}})),addPipeline:(e,t,s,a)=>Lr(this,void 0,void 0,(function*(){try{const a=yield(n=e,r=t,Wt()({path:"/wpqt/v1/pipelines",method:"POST",data:{name:n,description:r},headers:Qt()}));i.oR.success((0,o.__)("Board created successfully","quicktasker")),s&&s(a.data)}catch(e){i.oR.error((0,o.__)("Failed to create a board","quicktasker")),a&&a(e)}var n,r})),editPipeline:(e,t)=>Lr(this,void 0,void 0,(function*(){try{const s=yield function(e,t){return Wt()({path:`/wpqt/v1/pipelines/${e}`,method:"PATCH",data:t,headers:Qt()})}(e,t);return i.oR.success((0,o.__)("Board updated successfully","quicktasker")),{success:!0,pipeline:s.data}}catch(e){return i.oR.error((0,o.__)("Failed to update board","quicktasker")),{success:!1,error:e}}}))}}function Ur(){const{state:{newPipelineModalOpen:e}}=(0,a.useContext)(Bs),{fetchAndSetPipelineData:t}=(0,a.useContext)(bs),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=Xa(B),{addPipeline:d}=Mr();return(0,n.jsx)(ua,{modalOpen:e,closeModal:r,size:"sm",children:(0,n.jsx)(Rr,{ref:o,addPipeline:(e,s)=>{return a=this,n=void 0,u=function*(){i(!0),yield d(e,s,(e=>{c(x,e,Ja.PIPELINES),t(e.id),r()}),(e=>{l(e)}))},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{r(u.next(e))}catch(e){t(e)}}function i(e){try{r(u.throw(e))}catch(e){t(e)}}function r(t){var a;t.done?e(t.value):(a=t.value,a instanceof o?a:new o((function(e){e(a)}))).then(s,i)}r((u=u.apply(a,n||[])).next())}));var a,n,o,u},modalSaving:s,setModalSaving:i})})}var Fr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Kr=({onPipelineEditSuccess:e})=>{const{state:{pipelineToEdit:t},modalDispatch:s}=(0,a.useContext)(Bs),{fetchAndSetPipelineData:r,dispatch:c}=(0,a.useContext)(bs),{pipelinesDispatch:l}=(0,a.useContext)(ja),{editPipeline:d}=Mr(),{deletePipeline:u}=Mr(),{loading1:p,setLoading1:h}=rn();return t?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,n.jsx)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:(0,n.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-6 md:wpqt-grid-cols-[1fr_0.7fr]",children:[(0,n.jsxs)(ha,{children:[(0,n.jsx)(ma,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(wn,{isAutoFocus:!0,value:t.name,wrapperClassName:"wpqt-w-full",className:"wpqt-w-full",onChange:s=>Fr(void 0,void 0,void 0,(function*(){const{success:a,pipeline:n}=yield d(t.id,{name:s});a&&n&&e(n)}))})}),(0,n.jsx)(ma,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(_n,{value:t.description||"",className:"wpqt-w-full",onChange:s=>Fr(void 0,void 0,void 0,(function*(){const{success:a,pipeline:n}=yield d(t.id,{description:s});a&&n&&e(n)}))})})]}),(0,n.jsx)(ni,{entityId:t.id,entityType:hn.Pipeline})]})}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:(0,n.jsx)(ii,{onConfirm:()=>{t&&(h(!0),u(t.id,((e,t)=>{s({type:B}),h(!1),i.oR.success((0,o.__)("Board deleted","quicktasker")),l({type:T,payload:e}),null!==t?(l({type:v,payload:t}),r(t)):c({type:S})})))},confirmMessage:(0,o.__)("Are you sure you want to delete this board?","quicktasker"),children:({onClick:e})=>(0,n.jsx)(la,{icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:p,text:(0,o.__)("Delete board","quicktasker"),onClick:e})})})]})}):null};function $r(){const{state:{pipelineModalOpen:e}}=(0,a.useContext)(Bs),{closeModal:t,handleSuccess:s}=Xa(B);return(0,n.jsx)(ua,{modalOpen:e,closeModal:t,size:"xl",children:(0,n.jsx)(Kr,{onPipelineEditSuccess:e=>{s(g,e,Ja.ACTIVE_PIPELINE),s(g,e,Ja.PIPELINES)}})})}function zr(e){switch(e){case Gs.PDF:return(0,o.__)("Export as PDF","quicktasker");case Gs.JSON:return(0,o.__)("Export as JSON","quicktasker");default:return(0,o.__)("Export","quicktasker")}}var Gr=s(6973);function Vr(){const{modalDispatch:e,state:{taskExportModalSettings:t}}=(0,a.useContext)(Bs);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2",children:[(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(t.selectedMethod===Gs.PDF?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>e({type:ne,payload:{selectedMethod:Gs.PDF}}),"data-testid":"task-export-pdf-icon",children:(0,n.jsx)(Ar.uNb,{className:"wpqt-size-5 wpqt-pdf-red"})}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(t.selectedMethod===Gs.JSON?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>e({type:ne,payload:{selectedMethod:Gs.JSON}}),"data-testid":"task-export-json-icon",children:(0,n.jsx)(Gr.Qio,{className:"wpqt-size-5"})})]})}function Br({pipelineId:e}){const{state:{taskExportModalOpen:t,taskExportModalSettings:s},modalDispatch:i}=(0,a.useContext)(Bs),{state:{siteURL:r}}=(0,a.useContext)(dn),[c,l]=(0,a.useState)(""),[d,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(!0);return(0,n.jsx)(ua,{modalOpen:t,closeModal:()=>{i({type:ae})},size:"md",children:(0,n.jsxs)("form",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3 wpqt-items-center",action:r,target:"_blank",method:"GET",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Tasks export","quicktasker")}),(0,n.jsx)(Vr,{}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(Ta,{labelFor:"export-search-filter",children:(0,o.__)("Filter by task name and desription","quicktasker")}),(0,n.jsx)(Ka,{value:c,onChange:l,inputId:"export-search-filter",name:"task_search",wrapperClassName:"wpqt-mb-0"})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(Ta,{labelFor:"export-include-archive-filter",children:(0,o.__)("Include board archived tasks","quicktasker")}),(0,n.jsx)(mo,{checked:d,handleChange:u,id:"export-include-archive-filter"})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(Ta,{labelFor:"export-include-archive-filter",children:(0,o.__)("Include board custom fields","quicktasker")}),(0,n.jsx)(mo,{checked:p,handleChange:h,id:"export-include-task-custom-fields-filter"})]}),(0,n.jsx)(ca,{btnText:zr(s.selectedMethod),type:na.SUBMIT}),e&&(0,n.jsx)("input",{type:"hidden",name:"pipeline_id",value:e}),(0,n.jsx)("input",{type:"hidden",name:"wpqt-page",value:`${s.selectedMethod}-export`}),(0,n.jsx)("input",{type:"hidden",name:"include_archive",value:d?"1":"0"}),(0,n.jsx)("input",{type:"hidden",name:"include_custom_fields",value:p?"1":"0"})]})})}var Hr=s(9919),Wr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Qr=(0,a.forwardRef)((({editStage:e,addStage:t,stageModalSaving:s},i)=>{const{state:{stageToEdit:r}}=(0,a.useContext)(Bs),[c,l]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),p=!!r;(0,a.useEffect)((()=>{r&&(l(r.name),u(r.description))}),[r]);const h=()=>{l(""),u("")};return(0,a.useImperativeHandle)(i,(()=>({clearContent:h}))),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(pa,{children:p?(0,o.__)("Edit Stage","quicktasker"):(0,o.__)("Add Stage","quicktasker")}),(0,n.jsxs)(ha,{children:[(0,n.jsx)(ma,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(Ka,{isAutoFocus:!0,value:c,onChange:e=>l(e)})}),(0,n.jsx)(ma,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(qn,{rowsCount:3,value:d,onChange:e=>u(e)})})]}),(0,n.jsx)(wa,{onSave:()=>{p?e(Object.assign(Object.assign({},r),{name:c,description:d})):t(c,d)},loading:s,saveBtnText:p?(0,o.__)("Save","quicktasker"):(0,o.__)("Add stage","quicktasker")})]})}));var Yr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Jr(){const{state:{stageModalOpen:e,targetPipelineId:t}}=(0,a.useContext)(Bs),{modalSaving:s,setModalSaving:r,modalContentRef:c,closeModal:l,handleSuccess:d,handleError:u}=Xa($),{editStage:p,addStage:h}=function(){return{editStage:(e,t,s)=>Wr(this,void 0,void 0,(function*(){try{const s=yield function(e){return Wt()({path:`/wpqt/v1/stages/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description},headers:Qt()})}(e);i.oR.success((0,o.__)("Stage updated successfully","quicktasker")),t&&t(s.data)}catch(e){i.oR.error((0,o.__)("Failed to update stage","quicktasker")),s&&s(e)}})),addStage:(e,t,s,a,n)=>Wr(this,void 0,void 0,(function*(){try{const n=yield(r=e,c=t,l=s,Wt()({path:"/wpqt/v1/stages",method:"POST",data:{pipelineId:r,name:c,description:l},headers:Qt()}));i.oR.success((0,o.__)("Stage created successfully","quicktasker")),a&&a(n.data)}catch(e){i.oR.error((0,o.__)("Failed to create stage","quicktasker")),n&&n(e)}var r,c,l}))}}();return(0,n.jsx)(ua,{modalOpen:e,closeModal:l,children:(0,n.jsx)(Qr,{ref:c,editStage:e=>Yr(this,void 0,void 0,(function*(){r(!0),yield p(e,(e=>{d(_,e,Ja.ACTIVE_PIPELINE),l()}),(e=>{u(e)}))})),addStage:(e,s)=>Yr(this,void 0,void 0,(function*(){try{r(!0),yield h(t,e,s,(e=>{d(f,{stage:Object.assign(Object.assign({},e),{tasks:[]})},Ja.ACTIVE_PIPELINE),l()}))}catch(e){u(e)}})),stageModalSaving:s,stageTaskModalSaving:r})})}var Xr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Zr(){const{state:{taskColorModalOpen:e,taskToEdit:t},modalDispatch:s}=(0,a.useContext)(Bs),{dispatch:i}=(0,a.useContext)(bs),{updateTaskFocusColor:r}=Os(),[c,l]=(0,a.useState)(Mt),[d,u]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{t&&t.task_focus_color&&l(t.task_focus_color)}),[t]),(0,n.jsx)(ua,{modalOpen:e,closeModal:()=>{s({type:te})},size:"sm",children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-4 wpqt-items-center",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Task focus color","quicktasker")}),(0,n.jsx)(hi.A,{color:c||void 0,disableAlpha:!0,onChange:e=>{l(e.hex)}}),(0,n.jsx)(ca,{btnText:(0,o.__)("Apply changes","quicktasker"),onClick:()=>Xr(this,void 0,void 0,(function*(){if(!t)return;u(!0);const{success:e}=yield r(t.id,c);u(!1),e&&i({type:P,payload:{taskId:t.id,color:c}})})),loading:d}),(0,n.jsx)(ca,{buttonStyleType:ia.DANGER,btnText:(0,o.__)("Reset color","quicktasker"),onClick:()=>{l(Mt)}})]})})}var ec=s(1609);function tc({pipelineId:e,stagesLength:t=0}){const{modalDispatch:s}=(0,a.useContext)(Bs),i=()=>{return t=this,a=void 0,i=function*(){s({type:K,payload:{targetPipelineId:e}})},new((n=void 0)||(n=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,a||[])).next())}));var t,a,n,i};return 0===t?(0,n.jsx)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-w-full wpqt-items-center wpqt-justify-center",children:(0,n.jsxs)("div",{className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-gap-y-1 wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,n.jsx)(bn.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,n.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add first stage","quicktasker")})]})}):(0,n.jsxs)("div",{className:"wpqt-main-border wpqt-mb-3 wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-self-start wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,n.jsx)(bn.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,n.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add stage","quicktasker")})]})}var sc=s(5575),ac=s(6304),nc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ic({stage:e}){var t,s,r,c;const{dispatch:d,state:{activePipeline:u},fetchAndSetPipelineData:p}=(0,a.useContext)(bs),{modalDispatch:h}=(0,a.useContext)(Bs),{state:{isUserAllowedToDelete:m}}=(0,a.useContext)(dn),[w,f]=(0,a.useState)(!1),[q,_]=(0,a.useState)(!1),[x,g]=(0,a.useState)(!1),v=null!==(s=null===(t=null==u?void 0:u.stages)||void 0===t?void 0:t.length)&&void 0!==s?s:0,j=null!==(c=null===(r=e.tasks)||void 0===r?void 0:r.length)&&void 0!==c?c:0,b=+e.stage_order,y=b>0&&b<v,E=b!==v-1,T=t=>nc(this,void 0,void 0,(function*(){try{f(!0),yield function(e,t){return Wt()({path:`/wpqt/v1/stages/${e}/move`,method:"PATCH",data:{direction:t},headers:Qt()})}(e.id,t),yield p(u.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a stage","quicktasker"))}finally{f(!1)}}));return(0,n.jsxs)(li,{menuBtn:({active:e})=>(0,n.jsx)(di,{isActive:e,IconComponent:l.A}),children:[y&&(0,n.jsx)(ui,{text:(0,o.__)("Move left","quicktasker"),loading:w,icon:(0,n.jsx)(sc.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>T("left")}),E&&(0,n.jsx)(ui,{text:(0,o.__)("Move right","quicktasker"),loading:w,icon:(0,n.jsx)(ac.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>T("right")}),(0,n.jsx)(ui,{text:(0,o.__)("Edit stage","quicktasker"),icon:(0,n.jsx)(ki.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:()=>{h({type:z,payload:{stageToEdit:e}})}}),(0,n.jsx)(ii,{onConfirm:()=>nc(this,void 0,void 0,(function*(){try{_(!0),yield(t=e.id,Wt()({path:`/wpqt/v1/stages/${t}/archive-tasks`,method:"PATCH",headers:Qt()})),yield p(u.id),i.oR.success((0,o.sprintf)((0,o.__)("Archived all %s tasks","quicktasker"),e.name))}catch(t){console.error(t),i.oR.error((0,o.sprintf)((0,o.__)("Failed to archive stage %s tasks","quicktasker"),e.name))}finally{_(!1)}var t})),confirmMessage:(0,o.__)("Are you sure you want to archive all tasks on the stage?","quicktasker"),children:({onClick:t})=>(0,n.jsx)(ui,{text:(0,o.__)("Archive all stage tasks","quicktasker"),icon:(0,n.jsx)(an.A,{className:"wpqt-icon-blue wpqt-size-4"}),loading:q,onClick:t,disabled:0===j,id:`item-dropdown-${e.id}-archive`,tooltipText:0===j?(0,o.__)("No tasks to archive on the stage","quicktasker"):void 0})}),m&&(0,n.jsx)(ui,{text:(0,o.__)("Delete stage","quicktasker"),icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:x,onClick:()=>nc(this,void 0,void 0,(function*(){try{g(!0),yield(t=e.id,Wt()({path:`/wpqt/v1/stages/${t}`,method:"DELETE",data:{stageId:t},headers:Qt()})),d({type:k,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a stage","quicktasker"))}finally{g(!1)}var t})),disabled:j>0,className:"!wpqt-mb-0",id:`item-dropdown-${e.id}`,tooltipText:j>0?(0,o.__)("Stage can be deleted when there are no tasks on it","quicktasker"):void 0})]})}var oc=s(1578),rc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function cc({stageId:e}){const[t,s]=(0,a.useState)(""),[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),u=(0,a.useRef)(null),p=(0,a.useRef)(null),{state:{activePipeline:h},dispatch:m}=(0,a.useContext)(bs),{handleExecutedAutomations:f}=Ss();(0,a.useEffect)((()=>{const e=e=>{"Enter"===e.key&&document.activeElement===p.current&&k()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),(0,a.useEffect)((()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&q()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,a.useEffect)((()=>{var e;r&&(null===(e=p.current)||void 0===e||e.focus())}),[r]);const k=()=>rc(this,void 0,void 0,(function*(){if(t)try{d(!0);const s=yield function(e,t,s){return Wt()({path:"/wpqt/v1/tasks",method:"POST",data:{stageId:e,name:s,pipelineId:t},headers:Qt()})}(e,h.id,t);m({type:w,payload:s.data.newTask}),i.oR.success((0,o.__)("Task created","quicktasker")),q(),f(s.data.executedAutomations,s.data.newTask.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create task","quicktasker"))}finally{d(!1)}else i.oR.error((0,o.__)("Task name is required","quicktasker"))})),q=()=>{c(!1),s("")};return(0,n.jsx)("div",{ref:u,className:"wpqt-sticky wpqt-bottom-0 wpqt-z-10 wpqt-order-1 wpqt-mt-2 wpqt-flex wpqt-justify-center wpqt-bg-gray-100 wpqt-py-2",children:r?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,n.jsx)(Ka,{ref:p,value:t,onChange:e=>s(e),wrapperClassName:"!wpqt-mb-0",className:"!wpqt-mb-0"}),l?(0,n.jsx)(ta,{width:"24",height:"24"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(oc.A,{className:"wpqt-icon-red wpqt-size-6 wpqt-cursor-pointer",onClick:q}),(0,n.jsx)(bn.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer",onClick:k})]})]}):(0,n.jsxs)("div",{onClick:()=>c(!0),className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-p-2 hover:wpqt-bg-white",children:[(0,o.__)("Add task","quicktasker"),(0,n.jsx)(bn.A,{className:"wpqt-size-6 wpqt-text-green-600"})]})})}var lc=s(7959),dc=s(1735),uc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function pc({task:e}){const{modalDispatch:t}=(0,a.useContext)(Bs),{dispatch:s}=(0,a.useContext)(bs),{state:{isUserAllowedToDelete:i}}=(0,a.useContext)(dn),{deleteTask:r,archiveTask:c}=Os(),[l,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1);return(0,n.jsxs)(li,{menuBtn:({active:e})=>(0,n.jsx)(di,{isActive:e,IconComponent:Oo.A}),children:[(0,n.jsx)(ii,{confirmMessage:(0,o.__)("Are you sure you want to archive this task?","quicktasker"),onConfirm:()=>uc(this,void 0,void 0,(function*(){p(!0),c(e.id,(({success:t})=>{t&&s({type:A,payload:e.id}),p(!1)}))})),children:({onClick:e})=>(0,n.jsx)(ui,{text:(0,o.__)("Archive task","quicktasker"),icon:(0,n.jsx)(an.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:e,loading:u})}),(0,n.jsx)(ui,{text:(0,o.__)("Edit task","quicktasker"),icon:(0,n.jsx)(ki.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:U,payload:{taskToEdit:e}})}}),(0,n.jsx)(ui,{text:(0,o.__)("Color","quicktasker"),icon:(0,n.jsx)(lc.A,{className:"wpqt-icon-orange wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:ee,payload:{task:e}})}}),(0,n.jsx)(ui,{text:(0,o.__)("Move task","quicktasker"),icon:(0,n.jsx)(dc.zhn,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:X,payload:{task:e}})}}),i&&(0,n.jsx)(ii,{onConfirm:()=>uc(this,void 0,void 0,(function*(){d(!0),yield r(e.id,(({success:t})=>{t&&s({type:A,payload:e.id}),d(!1)}))})),confirmMessage:(0,o.__)("Are you sure you want to delete this task?","quicktasker"),confirmButtonText:(0,o.__)("Delete","quicktasker"),children:({onClick:e})=>(0,n.jsx)(ui,{text:(0,o.__)("Delete task","quicktasker"),icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:l,onClick:e,className:"!wpqt-mb-0"})})]})}function hc({task:e}){const{convertToWPTimezone:t}=Un();return e.due_date?(0,n.jsxs)("div",{className:"wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,n.jsx)(yo.A,{className:`wpqt-size-5 ${function(e){const t=function(e,t){const s=new Date(e),a=new Date(t).getTime()-s.getTime(),n=Math.floor(a/1e3),i=Math.floor(n/60),o=Math.floor(i/60);return{milliseconds:a,seconds:n,minutes:i,hours:o,days:Math.floor(o/24)}}(In()().utc().format("YYYY-MM-DD HH:mm:ss"),e);return t.milliseconds<0?"wpqt-text-red-600":t.hours<24?"wpqt-text-amber-500":t.hours<72?"wpqt-text-yellow-500":"wpqt-icon-blue"}(e.due_date)}`}),(0,n.jsxs)("span",{className:"wpqt-font-semibold",children:[(0,o.__)("Due date","quicktasker"),":"]}),t(e.due_date)]}):null}var mc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function wc({task:e,allowToMarkTaskAsDone:t}){const{dispatch:s}=(0,a.useContext)(bs),{changeTaskDoneStatus:i}=Os(),[o,r]=(0,a.useState)(!1),c=e.is_done,l=t=>mc(this,void 0,void 0,(function*(){r(!0),yield i(e.id,t,(t=>{s({type:E,payload:{taskId:e.id,done:t}})})),r(!1)}));return t?o?(0,n.jsx)(aa,{ovalSize:"24"}):(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:c?(0,n.jsx)(on.A,{className:"wpqt-size-6 wpqt-icon-green hover:wpqt-icon-gray",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,n.jsx)(on.A,{className:"wpqt-size-6 wpqt-icon-gray hover:wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!0)}})}):null}function fc({task:e,index:t,onLastStage:s}){const{modalDispatch:i}=(0,a.useContext)(Bs),{state:{activePipeline:o}}=(0,a.useContext)(bs),r=!(null==o?void 0:o.settings).allow_only_last_stage_task_done||s,c=()=>{i({type:U,payload:{taskToEdit:e,taskModalSettings:{allowToMarkTaskAsDone:r}}})},l=e.task_focus_color?{borderTopColor:e.task_focus_color,borderTopWidth:Ut,borderTopStyle:Ft}:{};return(0,n.jsx)(Hr.sx,{draggableId:e.id,index:t,children:t=>(0,n.jsx)("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{children:(0,n.jsxs)("div",{className:"wpqt-relative wpqt-mx-4 wpqt-mb-2 wpqt-flex !wpqt-cursor-pointer wpqt-flex-col wpqt-gap-1 wpqt-rounded wpqt-border wpqt-border-gray-200 wpqt-bg-white wpqt-p-3 wpqt-shadow hover:wpqt-shadow-md",style:l,onClick:c,children:[(0,n.jsx)("div",{className:"wpqt-absolute wpqt-right-[12px] wpqt-top-[12px]",children:(0,n.jsx)(pc,{task:e})}),(0,n.jsx)("div",{className:"wpqt-text-base",children:e.name}),e.description&&(0,n.jsx)("div",{className:"wpqt-text-sm wpqt-italic",children:e.description}),(0,n.jsxs)("div",{className:"wpqt-mt-2 wpqt-mb-2 wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:[(0,n.jsx)(Oi,{task:e}),(0,n.jsx)(ji,{task:e})]}),(0,n.jsx)(hc,{task:e}),(0,n.jsx)(wc,{task:e,allowToMarkTaskAsDone:r})]})}))},e.id)}function kc({tasks:e}){const t=e.length;return(0,n.jsx)("span",{className:"wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-1 wpqt-text-xs",children:t})}function qc({stage:e,isLastStage:t}){return(0,n.jsxs)("div",{"data-stage-id":e.id,className:"wpqt-relative wpqt-mb-3 wpqt-flex wpqt-max-h-full wpqt-w-[360px] wpqt-flex-none wpqt-flex-col wpqt-overflow-hidden wpqt-rounded-md wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-gray-100",children:[(0,n.jsxs)("div",{className:"wpqt-mb-4 wpqt-flex wpqt-flex-wrap wpqt-items-center wpqt-gap-1 wpqt-px-4 wpqt-pt-3",children:[(0,n.jsxs)("div",{className:"wpqt-mr-auto wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-text-base wpqt-leading-none",children:[e.name," ",(0,n.jsx)(kc,{tasks:e.tasks})]}),(0,n.jsx)(ic,{stage:e}),e.description&&(0,n.jsx)("div",{className:"wpqt-w-full wpqt-flex-shrink-0 wpqt-flex-grow-0 wpqt-text-sm",children:e.description})]}),(0,n.jsx)(Hr.gL,{droppableId:e.id,children:s=>{var a;return(0,n.jsxs)("div",{ref:s.innerRef,className:"wpqt-flex wpqt-h-full wpqt-flex-col wpqt-overflow-y-auto wpqt-overflow-x-hidden",children:[null===(a=e.tasks)||void 0===a?void 0:a.map(((e,s)=>(0,n.jsx)(fc,{task:e,index:s,onLastStage:t},e.id))),s.placeholder,(0,n.jsx)(cc,{stageId:e.id})]})}})]})}const _c=()=>{var e,t;const{state:{activePipeline:s},dispatch:r,fetchAndSetPipelineData:c}=(0,a.useContext)(bs),{isTabVisible:l}=(()=>{const[e,t]=(0,ec.useState)(!document.hidden);return(0,ec.useEffect)((()=>{const e=()=>{t(!document.hidden)};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[]),{isTabVisible:e}})(),{modalDispatch:d}=(0,a.useContext)(Bs);(0,a.useEffect)((()=>{const e=setInterval((()=>{s&&l&&c(s.id)}),3e4);return()=>clearInterval(e)}),[s,l]);const u=(e,t)=>{e.droppableId===t.droppableId?r({type:"REORDER_TASK",payload:{source:e,destination:t}}):r({type:m,payload:{source:e,destination:t}})},p=(0,a.useCallback)((e=>{return t=void 0,s=void 0,n=function*(){const{source:t,destination:s,draggableId:a}=e;if(s){u(t,s);try{yield Yt(a,s.droppableId,s.index)}catch(e){console.error(e),u(s,t),i.oR.error((0,o.__)("Failed to move a task","quicktasker"))}}},new((a=void 0)||(a=Promise))((function(e,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(t,s||[])).next())}));var t,s,a,n}),[s]);return s?(0,n.jsxs)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-gap-[24px] wpqt-overflow-x-auto wpqt-overflow-y-hidden",children:[(0,n.jsx)(Hr.JY,{onDragEnd:p,children:null===(e=s.stages)||void 0===e?void 0:e.map(((e,t)=>{const a=t===s.stages.length-1;return(0,n.jsx)(qc,{stage:e,isLastStage:a},e.id)}))}),(0,n.jsx)(tc,{pipelineId:s.id,stagesLength:null===(t=s.stages)||void 0===t?void 0:t.length}),(0,n.jsx)(vo,{deleteTaskCallback:()=>{s&&c(s.id)}}),(0,n.jsx)(Zr,{}),(0,n.jsx)(Jr,{})]}):(0,n.jsx)(Yo,{infoDescription:(0,o.__)("No boards found. Start by creating a board to organize and manage your tasks effectively.","quicktasker"),children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-center",children:[(0,n.jsx)(la,{text:(0,o.__)("Create a new board","quicktasker"),icon:(0,n.jsx)(bn.A,{className:"wpqt-size-6 wpqt-icon-green"}),onClick:()=>{d({type:G})}}),(0,n.jsx)("span",{children:(0,o.__)("or","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-blue-text wpqt-blue-text-hover wpqt-cursor-pointer",onClick:()=>{d({type:ie})},children:(0,o.__)("Import an existing board","quicktasker")})]})})};var xc=s(8932),gc=s(247),vc=s(1203),jc=s(2496),bc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function yc(){const{state:{activePipeline:e},fetchAndSetPipelineData:t}=(0,a.useContext)(bs),{state:{pipelines:s},pipelinesDispatch:r}=(0,a.useContext)(ja),{modalDispatch:c}=(0,a.useContext)(Bs),l=e=>bc(this,void 0,void 0,(function*(){try{yield(t=e.id,Wt()({path:`/wpqt/v1/pipelines/${t}/set-primary`,method:"PATCH",headers:Qt()})),r({type:v,payload:e.id}),i.oR.success((0,o.__)("Primary board has been set successfully.","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to set primary board","quicktasker"))}var t}));return(0,n.jsxs)(li,{menuBtnClasses:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1 wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-3",menuBtn:({active:t})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-leading-none",children:null==e?void 0:e.name}),(0,n.jsx)(vc.A,{className:"wpqt-size-4 "+(t?"wpqt-text-qtBlueHover":"")})]}),children:[(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center wpqt-font-bold",children:(0,o.__)("Change board","quicktasker")}),s.map((s=>{const a=s.is_primary,i=(null==e?void 0:e.id)===s.id;return(0,n.jsx)(ci.Dr,{children:(0,n.jsxs)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-gap-2",children:[(0,n.jsx)("div",{className:(0,kn.$)("wpqt-cursor-pointer wpqt-text-center",{"wpqt-font-bold":i}),onClick:()=>t(s.id),children:s.name}),(0,n.jsx)("div",{className:"wpqt-ml-auto",children:a?(0,n.jsx)(jc.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-blue-500"}):(0,n.jsx)(gc.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-gray-400",onClick:e=>{e.stopPropagation(),l(s)}})})]})},s.id)})),(0,n.jsx)(ci.Dr,{children:(0,n.jsx)("div",{className:"wpqt-my-4 wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:(0,n.jsx)(la,{text:(0,o.__)("Add new board","quicktasker"),onClick:()=>bc(this,void 0,void 0,(function*(){c({type:G})})),icon:(0,n.jsx)(bn.A,{className:"wpqt-size-6 wpqt-icon-green"}),className:"wpqt-bg-white hover:!wpqt-bg-gray-100"})})},"new-pipeline"),(0,n.jsx)(ci.Dr,{children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-1 wpqt-justify-center wpqt-cursor-pointer wpqt-blue-text wpqt-blue-text-hover",onClick:()=>{c({type:ie})},children:(0,o.__)("Import existing","quicktasker")})},"export-pipeline")]})}function Ec(){const{modalDispatch:e}=(0,a.useContext)(Bs),t=t=>{e({type:se,payload:{selectedMethod:t}})};return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-mr-5 wpqt-gap-2",children:[(0,n.jsx)(Ar.uNb,{className:"wpqt-size-5 wpqt-pdf-red wpqt-cursor-pointer","data-testid":"task-export-pdf-icon",onClick:()=>{t(Gs.PDF)}}),(0,n.jsx)(Gr.Qio,{className:"wpqt-size-5 wpqt-cursor-pointer","data-testid":"task-export-pdf-json-icon",onClick:()=>{t(Gs.JSON)}})]})}function Tc(){const{state:{activePipeline:e,loading:t},fetchAndSetPipelineData:s}=(0,a.useContext)(bs),{modalDispatch:i}=(0,a.useContext)(Bs);return e?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-py-5",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)("div",{className:"wpqt-text-lg wpqt-font-semibold",children:e.name}),(0,n.jsx)(l.A,{className:"wpqt-text-gray-400 wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{e&&i({type:V,payload:{pipelineToEdit:e}})}})]}),e.description&&(0,n.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,n.jsxs)("div",{className:"wpqt-ml-auto wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,n.jsx)(Ec,{}),(0,n.jsx)(Sc,{}),t?(0,n.jsx)(ta,{width:"24",height:"24"}):(0,n.jsx)(Ui.A,{className:"wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover","data-testid":"refresh-icon",onClick:()=>s(e.id)}),(0,n.jsx)(yc,{})]})]}):null}function Sc(){const{state:{view:e},dispatch:t}=(0,a.useContext)(bs);return(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-1 wpqt-items-center wpqt-cursor-pointer wpqt-text-blue-400 wpqt-text-base :hover:wpqt-text-blue-600",onClick:()=>{t({type:O,payload:e===qs.PIPELINE?qs.TASK:qs.PIPELINE})},children:e===qs.PIPELINE?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(xc.A,{className:"wpqt-size-5 wpqt-text-blue-400"}),(0,o.__)("Switch to Task view","quicktasker")]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(bo.A,{className:"wpqt-size-5 wpqt-text-blue-400"}),(0,o.__)("Switch to Board view","quicktasker")]})})}function Ac(){const{modalDispatch:e}=(0,a.useContext)(Bs),{activePipelineTasks:t,activePipelineSettings:s,isTaskOnLastStage:i}=lr(),{taskViewFilter:r}=(()=>{const{state:{stageIdFilter:e,userFilter:t,searchText:s}}=(0,a.useContext)(hr);return{taskViewFilter:a=>{var n,i,o,r;const c=!e||a.stage_id===e,l=!t.id||!t.type||t.type===Bt.QUICKTASKER&&(null===(n=a.assigned_users)||void 0===n?void 0:n.some((e=>e.id===t.id)))||t.type===Bt.WP_USER&&(null===(i=a.assigned_wp_users)||void 0===i?void 0:i.some((e=>e.id===t.id))),d=!s||a.name.toLowerCase().includes(s.toLowerCase())||null!==(r=null===(o=a.description)||void 0===o?void 0:o.toLowerCase().includes(s.toLowerCase()))&&void 0!==r&&r;return c&&l&&d}}})(),c=t.filter(r);return 0===c.length?(0,n.jsx)(jo,{text:(0,o.__)("No tasks","quictasker")}):(0,n.jsxs)("div",{className:"wpqt-card-grid",children:[c.map((t=>{const a=i(t.id),o=!s.allow_only_last_stage_task_done||a,r=t.task_focus_color?{borderTopColor:t.task_focus_color,borderTopWidth:Ut,borderTopStyle:Ft}:{};return(0,n.jsxs)(Eo,{className:"wpqt-cursor-pointer",style:r,title:t.name,description:t.description,dropdown:(0,n.jsx)(pc,{task:t}),onClick:()=>{e({type:U,payload:{taskToEdit:t,taskModalSettings:{allowToMarkTaskAsDone:o}}})},children:[(0,n.jsxs)("div",{className:"wpqt-mt-2 wpqt-mb-2 wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:[(0,n.jsx)(Oi,{task:t}),(0,n.jsx)(ji,{task:t})]}),(0,n.jsx)(hc,{task:t}),(0,n.jsx)(wc,{task:t,allowToMarkTaskAsDone:o})]},t.id)})),(0,n.jsx)(vo,{}),(0,n.jsx)(Zr,{})]})}const Oc=()=>(0,n.jsx)(ys,{children:(0,n.jsx)(Ra,{children:(0,n.jsx)(Nc,{})})}),Nc=()=>{const{state:{view:e,activePipeline:t}}=(0,a.useContext)(bs),s=e===qs.PIPELINE;return(0,n.jsxs)(La,{children:[(0,n.jsx)(Tc,{}),s?(0,n.jsx)(_c,{}):(0,n.jsxs)(mr,{children:[(0,n.jsx)(wr,{}),(0,n.jsx)(Ac,{})]}),(0,n.jsx)(Ur,{}),(0,n.jsx)($r,{}),(0,n.jsx)(Pr,{}),(0,n.jsx)(Br,{pipelineId:(null==t?void 0:t.id)||null}),(0,n.jsx)(Dr,{})]})};var Cc=s(6197),Ic=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Dc(){return{saveCustomUserPageStyles:(e,t)=>Ic(this,void 0,void 0,(function*(){try{const a=yield(s=e,Wt()({path:"/wpqt/v1/settings/user-page-custom-styles",method:"PATCH",data:{styles:s},headers:Qt()}));t&&t(a.data),i.oR.success((0,o.__)("Custom user page styles saved successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to save custom user page styles","quicktasker"))}var s})),saveTaskCompletionDoneSetting:(e,t,s)=>Ic(this,void 0,void 0,(function*(){try{yield function(e,t){return Wt()({path:`/wpqt/v1/pipelines/${e}/settings/task-completion-done-restriction`,method:"PATCH",data:{allow_task_completion_only_on_last_stage:t},headers:Qt()})}(e,t),s&&s(t)}catch(e){s&&s(!t),console.error(e),i.oR.error((0,o.__)("Failed to save setting","quicktasker"))}}))}}const Pc=({children:e,title:t,description:s})=>(0,n.jsxs)("div",{className:"wpqt-mb-5",children:[(0,n.jsx)("h3",{className:"wpqt-mb-1",children:t}),(0,n.jsx)("p",{children:s}),e]});const Rc=()=>{const{state:{userPageCustomStyles:e},appDispatch:t}=(0,a.useContext)(dn),[s,i]=(0,a.useState)(""),[r,c]=(0,a.useState)(!1),{saveCustomUserPageStyles:l}=Dc();return(0,a.useEffect)((()=>{i(e)}),[e]),(0,n.jsxs)(Pc,{title:(0,o.__)("Custom style","quicktasker"),description:(0,o.__)("Add custom CSS rules for QuickTasker user page.","quicktasker"),children:[(0,n.jsx)(qn,{value:s,onChange:i,colsCount:40}),(0,n.jsx)(la,{text:(0,o.__)("Save","quicktasker"),loading:r,onClick:()=>{return e=void 0,a=void 0,i=function*(){c(!0),yield l(s,(e=>{t({type:Ge,payload:e})})),c(!1)},new((n=void 0)||(n=Promise))((function(t,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(e,a||[])).next())}));var e,a,n,i},icon:(0,n.jsx)(Cc.RZ0,{className:"wpqt-icon-blue wpqt-size-4"})})]})};var Lc=s(8046),Mc=s(1226);const Uc=(e,t)=>{var s,a;switch(t.type){case kt:{const s=t.payload.automations;return Object.assign(Object.assign({},e),{automations:s})}case qt:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case _t:{const n=t.payload,i=null!==(a=null===(s=e.automations)||void 0===s?void 0:s.filter((e=>e.id!==n)))&&void 0!==a?a:null;return Object.assign(Object.assign({},e),{automations:i})}case gt:{const s=e.automations?e.automations.map((e=>e.id===t.payload.id?Object.assign(Object.assign({},e),{active:t.payload.active}):e)):null;return Object.assign(Object.assign({},e),{automations:s})}case xt:{const s=t.payload,a=e.automations?[...e.automations,s]:[s];return Object.assign(Object.assign({},e),{automations:a})}default:return e}},Fc={[us.ARCHIVE_TASK]:(0,o.__)("Archive task","quicktasker"),[us.ASSIGN_USER]:(0,o.__)("Assign user","quickkasker"),[us.NEW_ENTITY_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[us.DELETED_ENTITY_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[us.TASK_ASSIGNED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[us.TASK_UNASSIGNED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[us.TASK_PUBLIC_COMMENT_ADDED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[us.TASK_PRIVATE_COMMENT_ADDED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[us.TASK_FILE_UPLOADED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[us.TASK_FILE_DELETED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[us.CREATE_TASK]:(0,o.__)("Create task","quicktasker"),[us.SEND_SLACK_MESSAGE]:(0,o.__)("Send Slack message","quicktasker")},Kc={[ls.Task]:(0,o.__)("Task","quicktasker"),[ls.Stage]:(0,o.__)("Stage","quicktasker"),[ls.PIPELINE]:(0,o.__)("Board","quicktasker"),[ls.quicktasker]:"Quicktasker",[ls.WOOCOMMERCE_ORDER]:(0,o.__)("WooCommerce Order","quicktasker"),[ls.SEATREG_BOOKING]:(0,o.__)("SeatReg Booking","quicktasker")},$c={[os.TASK_DONE]:(0,o.__)("Task marked as done","quicktasker"),[os.Task_NOT_DONE]:(0,o.__)("Task marked as not done","quicktasker"),[os.TASK_CREATED]:(0,o.__)("Task created","quicktasker"),[os.TASK_DELETED]:(0,o.__)("Task deleted","quicktasker"),[os.TASK_ASSIGNED]:(0,o.__)("Task assigned","quicktasker"),[os.TASK_UNASSIGNED]:(0,o.__)("Task unassigned","quicktasker"),[os.TASK_PUBLIC_COMMENT_ADDED]:(0,o.__)("Public comment added","quicktasker"),[os.TASK_PRIVATE_COMMENT_ADDED]:(0,o.__)("Private comment added","quicktasker"),[os.TASK_FILE_UPLOADED]:(0,o.__)("File attached","quicktasker"),[os.TASK_FILE_DELETED]:(0,o.__)("Attached file deleted","quicktasker"),[rs.WOOCOMMERCE_ORDER_ADDED]:(0,o.__)("Order added","quicktasker"),[cs.SEATREG_BOOKING_CREATED]:(0,o.__)("Booking created","quicktasker"),[cs.SEATREG_BOOKING_APPROVED]:(0,o.__)("Booking gets approved state","quicktasker"),[cs.SEATREG_BOOKING_PENDING]:(0,o.__)("Booking gets pending state","quicktasker"),[cs.SEATREG_BOOKING_APPROVED_VIA_MANAGER]:(0,o.__)("Booking gets approved state manually with booking manager","quicktasker"),[cs.SEATREG_BOOKING_PENDING_VIA_MANAGER]:(0,o.__)("Booking gets pending state manually with booking manager","quicktasker")},zc=(rs.WOOCOMMERCE_ORDER_ADDED,(0,o.__)("Order added","quicktasker"),{[os.TASK_DONE]:[{id:us.ARCHIVE_TASK},{id:us.SEND_SLACK_MESSAGE,requireMetaData:!0}],[os.Task_NOT_DONE]:[{id:us.ARCHIVE_TASK}],[os.TASK_CREATED]:[{id:us.ASSIGN_USER,requireAutomationTarget:!0,requireAutomationTargetType:!0},{id:us.NEW_ENTITY_EMAIL,requireMetaData:!0},{id:us.SEND_SLACK_MESSAGE,requireMetaData:!0}],[os.TASK_DELETED]:[{id:us.DELETED_ENTITY_EMAIL,requireMetaData:!0},{id:us.SEND_SLACK_MESSAGE,requireMetaData:!0}],[os.TASK_ASSIGNED]:[{id:us.TASK_ASSIGNED_EMAIL,requireMetaData:!0},{id:us.SEND_SLACK_MESSAGE,requireMetaData:!0}],[os.TASK_UNASSIGNED]:[{id:us.TASK_UNASSIGNED_EMAIL,requireMetaData:!0},{id:us.SEND_SLACK_MESSAGE,requireMetaData:!0}],[os.TASK_PUBLIC_COMMENT_ADDED]:[{id:us.TASK_PUBLIC_COMMENT_ADDED_EMAIL,requireMetaData:!0},{id:us.SEND_SLACK_MESSAGE,requireMetaData:!0}],[os.TASK_PRIVATE_COMMENT_ADDED]:[{id:us.TASK_PRIVATE_COMMENT_ADDED_EMAIL,requireMetaData:!0},{id:us.SEND_SLACK_MESSAGE,requireMetaData:!0}],[os.TASK_FILE_UPLOADED]:[{id:us.TASK_FILE_UPLOADED_EMAIL,requireMetaData:!0}],[os.TASK_FILE_DELETED]:[{id:us.TASK_FILE_DELETED_EMAIL,requireMetaData:!0}]}),Gc={[rs.WOOCOMMERCE_ORDER_ADDED]:[{id:us.CREATE_TASK}]},Vc={[cs.SEATREG_BOOKING_CREATED]:[{id:us.CREATE_TASK}],[cs.SEATREG_BOOKING_APPROVED]:[{id:us.CREATE_TASK}],[cs.SEATREG_BOOKING_PENDING]:[{id:us.CREATE_TASK}],[cs.SEATREG_BOOKING_APPROVED_VIA_MANAGER]:[{id:us.CREATE_TASK}],[cs.SEATREG_BOOKING_PENDING_VIA_MANAGER]:[{id:us.CREATE_TASK}]},Bc={[ls.Task]:zc,[ls.WOOCOMMERCE_ORDER]:Gc,[ls.SEATREG_BOOKING]:Vc};const Hc={automations:null,loading:!0},Wc=(0,a.createContext)({state:Hc,pipelineAutomationsDispatch:()=>{}}),Qc=({children:e,pipelineId:t})=>{const[s,r]=(0,a.useReducer)(Uc,Hc),c=()=>{return e=void 0,s=void 0,n=function*(){try{r({type:qt,payload:!0});const s=yield function(e){return Wt()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"GET",headers:Qt()})}(t);r({type:kt,payload:{automations:(e=s.data.automations,e.map((e=>Object.assign(Object.assign({},e),{active:"1"===e.active,verify_success:"1"===e.verify_success}))))}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load board automations","quicktasker"))}finally{r({type:qt,payload:!1})}var e},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n};return(0,a.useEffect)((()=>{c()}),[]),(0,n.jsx)(Wc.Provider,{value:{state:s,pipelineAutomationsDispatch:r},children:e})},Yc={automationTarget:null,automationTrigger:null,automationAction:null,automationActionTargetId:null,automationActionTargetType:null,metaData:null};function Jc(e,t){switch(t.type){case"SET_TARGET":return Object.assign(Object.assign({},e),{automationTarget:t.payload,automationTrigger:null,automationAction:null});case"SET_TRIGGER":return Object.assign(Object.assign({},e),{automationTrigger:t.payload,automationAction:null});case"SET_ACTION":return Object.assign(Object.assign({},e),{automationAction:t.payload});case"RESET":return Yc;case jt:return Object.assign(Object.assign({},e),{automationActionTargetId:t.payload.automationActionTargetId,automationActionTargetType:t.payload.automationActionTargetType});case vt:return Object.assign(Object.assign({},e),{metaData:t.payload});case bt:return Yc;case yt:return Object.assign(Object.assign({},Yc),{automationTarget:e.automationTarget});case Et:return Object.assign(Object.assign({},Yc),{automationTarget:e.automationTarget,automationTrigger:e.automationTrigger});default:return e}}function Xc({actionTargetId:e,actionTargetType:t}){if(null===e||null===t)return null;const{getUser:s}=dr();if(t===ds.QUICKTASKER||t===ds.WP_USER||null!==e){const a=hs(t);if(a){const t=s(e,a);return(0,n.jsx)("div",{className:"wpqt-text-center",children:(null==t?void 0:t.name)||(0,o.__)("User not found","quicktasker")})}}return null}function Zc({value:e,label:t,onClick:s=()=>{},className:a=""}){return(0,n.jsx)("div",{className:`wpqt-inline-flex wpqt-text-center wpqt-font-semibold wpqt-rounded-xl wpqt-px-4 wpqt-py-2 wpqt-border wpqt-border-solid wpqt-cursor-pointer wpqt-border-qtBorder ${a}`,onClick:()=>{s(e)},children:t})}function el({children:e,title:t}){return(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-base wpqt-mb-4 wpqt-text-center",children:t}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-gap-3 wpqt-flex-wrap",children:e})]})}function tl({automationDispatch:e,automation:t}){if(!t.automationTarget||!t.automationTrigger)return null;const s=t.automationTarget,a=t.automationTrigger,i=Bc[s],r=i&&a in i?i[a]:[];return(0,n.jsx)(el,{title:(0,o.__)("Step 3. Select action","quicktasker"),children:r.map((t=>(0,n.jsx)(Zc,{value:t.id,label:Fc[t.id],onClick:()=>{e({type:"SET_ACTION",payload:t})}},t.id)))})}function sl({quickTaskerUsers:e,wpUsers:t,assignUser:s}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,n.jsx)(Ti,{sectionTitle:(0,o.__)("Assign a quicktasker","quicktasker"),users:e,onItemSelect:s,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No quicktaskers available to assign","quicktasker")}),(0,n.jsx)(Ti,{sectionTitle:(0,o.__)("Assign a WordPress user","quicktasker"),users:t,onItemSelect:s,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No WordPress users with required permissions available to assign","quicktasker")})]})}function al({automationAction:e,onUserAdd:t=()=>{},quickTaskerUserTargets:s=[],wpUserTargets:a=[],menuBtnClasses:i=""}){const o=[...s,...a].length>0;return(0,n.jsx)(li,{menuBtnClasses:`wpqt-inline-flex ${i}`,anchor:"bottom start",menuBtn:()=>(0,n.jsx)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:(0,n.jsx)(bi.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`})}),children:e===us.ASSIGN_USER&&(0,n.jsx)(sl,{quickTaskerUsers:s,wpUsers:a,assignUser:t})})}const nl=[us.ASSIGN_USER];function il({automationDispatch:e,automation:t}){var s;const{state:{users:i,wpUsers:r}}=(0,a.useContext)(Qa),c=null===(s=t.automationAction)||void 0===s?void 0:s.id,l=void 0!==c&&nl.includes(c);return(0,n.jsx)(el,{title:(0,o.__)("Step 4. Select action target","quicktasker"),children:l&&(0,n.jsx)(al,{automationAction:c,quickTaskerUserTargets:i,wpUserTargets:r,onUserAdd:t=>{e({type:jt,payload:{automationActionTargetId:t.id,automationActionTargetType:t.user_type}})}})})}var ol=s(4476);const rl=ol.z.string().email({message:"Invalid email address"});function cl({setAutomationMeta:e}){const[t,s]=(0,a.useState)(""),[i,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(e=>{try{rl.parse(e),r(!0)}catch(e){r(!1)}})(t)}),[t]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-justify-center wpqt-items-center",children:[(0,n.jsx)(Ki,{type:"info",children:(0,o.__)("Make sure your website is configured to send out emails","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)("label",{htmlFor:"automation-meta-email-input",children:(0,o.__)("Email will be sent to","quicktasker")}),(0,n.jsx)(Ka,{inputId:"automation-meta-email-input",value:t,onChange:s,wrapperClassName:"!wpqt-mb-0"}),!i&&(0,n.jsx)("div",{className:"wpqt-text-red-500",children:(0,o.__)("Invalid email address","quicktasker")})]}),(0,n.jsx)(ca,{btnText:(0,o.__)("Set email","quicktasker"),onClick:()=>{i&&e(t)}})]})}const ll=ol.z.string().url({message:"Invalid URL"}).refine((e=>e.startsWith("https://hooks.slack.com/services/")),{message:"Invalid Slack webhook URL"}),dl=function({setAutomationMeta:e}){const[t,s]=(0,a.useState)(""),[i,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(e=>{try{ll.parse(e),r(!0)}catch(e){r(!1)}})(t)}),[t]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-justify-center wpqt-items-center",children:[(0,n.jsxs)(Ki,{type:"info",children:[(0,o.__)("Make sure your have configured your Slack webhook URL.","quicktasker"),(0,n.jsx)("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"wpqt-text-blue-500 hover:underline wpqt-ml-1",children:(0,o.__)("Read more about Slack webhooks.","quicktasker")})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)("label",{htmlFor:"automation-meta-slack-webhook-input",children:(0,o.__)("Slack webhook URL","quicktasker")}),(0,n.jsx)(Ka,{inputId:"automation-meta-slack-webhook-input",value:t,onChange:s,wrapperClassName:"!wpqt-mb-0"}),!i&&(0,n.jsx)("div",{className:"wpqt-text-red-500",children:(0,o.__)("Invalid Slack webhook","quicktasker")})]}),(0,n.jsx)(ca,{btnText:(0,o.__)("Set webhook URL","quicktasker"),onClick:()=>{i&&e(t)}})]})};function ul({automationCreationState:e,automationDispatch:t}){var s;const a=null===(s=null==e?void 0:e.automationAction)||void 0===s?void 0:s.id,i=a===us.NEW_ENTITY_EMAIL||a===us.DELETED_ENTITY_EMAIL||a===us.TASK_ASSIGNED_EMAIL||a===us.TASK_UNASSIGNED_EMAIL||a===us.TASK_PUBLIC_COMMENT_ADDED_EMAIL||a===us.TASK_PRIVATE_COMMENT_ADDED_EMAIL||a===us.TASK_FILE_UPLOADED_EMAIL||a===us.TASK_FILE_DELETED_EMAIL,o=a===us.SEND_SLACK_MESSAGE,r=e=>{t({type:vt,payload:e})};return i?(0,n.jsx)(cl,{setAutomationMeta:r}):o?(0,n.jsx)(dl,{setAutomationMeta:r}):null}function pl({automationDispatch:e}){const t=Object.keys(Bc).map((e=>({value:e,label:Kc[e]||e})));return(0,n.jsx)(el,{title:(0,o.__)("Step 1. Select a target","quicktasker"),children:t.map((({value:t,label:s})=>(0,n.jsx)(Zc,{value:t,label:s,onClick:()=>{e({type:"SET_TARGET",payload:t})}},t)))})}function hl({automationDispatch:e,automation:t}){if(!t.automationTarget)return null;const s=t.automationTarget,a=Object.keys(Bc[s]).map((e=>({value:e,label:$c[e]||e})));return(0,n.jsx)(el,{title:(0,o.__)("Step 2. Select a trigger","quicktasker"),children:a.map((({value:t,label:s})=>(0,n.jsx)(Zc,{value:t,label:s,onClick:()=>{e({type:"SET_TRIGGER",payload:t})}},t)))})}var ml=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function wl({automation:e,automationDispatch:t,createAutomation:s}){const[i,r]=(0,a.useState)(!1);return null===e.automationTarget?(0,n.jsx)(pl,{automationDispatch:t}):null===e.automationTrigger?(0,n.jsx)(hl,{automationDispatch:t,automation:e}):null===e.automationAction?(0,n.jsx)(tl,{automationDispatch:t,automation:e}):e.automationAction&&e.automationAction.requireAutomationTarget&&e.automationAction.requireAutomationTargetType&&(null===e.automationActionTargetType||null===e.automationActionTargetId)?(0,n.jsx)(il,{automationDispatch:t,automation:e}):e.automationAction.requireMetaData&&!e.metaData?(0,n.jsx)(ul,{automationCreationState:e,automationDispatch:t}):(0,n.jsx)(la,{text:(0,o.__)("Create automation","quicktasker"),icon:(0,n.jsx)(Or.ltU,{className:"wpqt-size-6"}),onClick:()=>ml(this,void 0,void 0,(function*(){r(!0),yield s(),r(!1)})),loading:i})}var fl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function kl({pipelineId:e}){const{pipelineAutomationsDispatch:t,state:{loading:s,automations:i}}=(0,a.useContext)(Wc),[r,c]=(0,a.useReducer)(Jc,Yc),{createAutomation:l}=Ss(),d=null!==r.automationActionTargetId&&null!==r.automationActionTargetType,u=null!==r.metaData,p=!Rt&&i&&i.length>=1,h="wpqt-px-3 wpqt-min-w-[60px] wpqt-cursor-pointer",m="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1";return s?null:p?(0,n.jsx)(Tn,{description:(0,o.__)("Free version limit reached. Upgrade to premium to create more automations.","quicktasker")}):(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3",children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-3 wpqt-p-4 wpqt-justify-center wpqt-items-center",children:[(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-start"}),(0,n.jsx)(Eo,{title:(0,o.__)("Target","quicktasker"),className:h,titleClassName:m,onClick:()=>{c({type:bt})},children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTarget?Kc[r.automationTarget]:(0,n.jsx)(ql,{})})}),(0,n.jsx)(Lc.A,{className:"wpqt-icon-blue wpqt-size-6"}),(0,n.jsx)(Eo,{title:(0,o.__)("Trigger","quicktasker"),className:h,titleClassName:m,onClick:()=>{c({type:yt})},children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTrigger?$c[r.automationTrigger]:(0,n.jsx)(ql,{})})}),(0,n.jsx)(Lc.A,{className:"wpqt-icon-blue wpqt-size-6"}),(0,n.jsx)(Eo,{title:(0,o.__)("Action","quicktasker"),className:h,titleClassName:m,onClick:()=>{c({type:Et})},children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center wpqt-items-center",children:[r.automationAction?Fc[r.automationAction.id]:(0,n.jsx)(ql,{}),d&&(0,n.jsx)(Xc,{actionTargetId:r.automationActionTargetId,actionTargetType:r.automationActionTargetType}),u&&(0,n.jsx)("div",{children:r.metaData})]})})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(wl,{automation:r,automationDispatch:c,createAutomation:()=>fl(this,void 0,void 0,(function*(){yield l(e,r,((e,s)=>{e&&s&&(c({type:"RESET"}),t({type:xt,payload:s}))}))}))})})]})})}function ql(){return(0,n.jsx)(Mc.A,{className:"wpqt-size-7 wpqt-text-gray-300"})}function _l({pipelineId:e}){const{state:{automationCreatorModalOpen:t},modalDispatch:s}=(0,a.useContext)(Bs);return(0,n.jsxs)(ua,{modalOpen:t,closeModal:()=>{s({type:ce})},size:"lg",children:[(0,n.jsx)(pa,{className:"wpqt-text-center",children:(0,o.__)("Create a new automation","quicktasker")}),(0,n.jsx)(kl,{pipelineId:e})]})}var xl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function gl({automation:e,className:t="",titleClassName:s=""}){const{deleteAutomation:i,updateAutomationActiveStatus:r}=Ss(),{pipelineAutomationsDispatch:c}=(0,a.useContext)(Wc),[l,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1);return(0,n.jsx)(Eo,{title:(0,o.__)("Controls","quicktasker"),className:`${t} wpqt-ml-6`,titleClassName:s,children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3 wpqt-justify-center",children:[(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-1 wpqt-justify-center wpqt-items-center wpqt-h-[40px]",children:u?(0,n.jsx)(aa,{ovalSize:"32"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Active","quicktasker")}),(0,n.jsx)(mo,{checked:e.active,handleChange:t=>xl(this,void 0,void 0,(function*(){p(!0);const s=yield r(e.pipeline_id,e.id,t);p(!1),s.success&&c({type:gt,payload:{id:e.id,active:t}})}))})]})}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-2",children:(0,n.jsx)(la,{loading:l,icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-5"}),onClick:()=>xl(this,void 0,void 0,(function*(){d(!0),yield i(e.pipeline_id,e.id,(t=>{t&&c({type:_t,payload:e.id})})),d(!1)})),text:(0,o.__)("Delete","quicktasker")})})]})})}function vl({automation:e}){const t="wpqt-px-3 wpqt-pt-1 wpqt-min-w-[60px] wpqt-cursor-default",s="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1",a=null!==e.automation_action_target_id&&null!==e.automation_action_target_type,i=null!==e.metadata;return(0,n.jsxs)("div",{className:"wpqt-flex",children:[(0,n.jsxs)("div",{className:"wpqt-flex-1 wpqt-flex wpqt-p-4 wpqt-items-center wpqt-justify-center wpqt-gap-3",children:[(0,n.jsx)(Eo,{title:(0,o.__)("Target","quicktasker"),className:t,titleClassName:s,children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:Kc[e.target_type]})}),(0,n.jsx)(Lc.A,{className:"wpqt-icon-blue wpqt-size-6"}),(0,n.jsx)(Eo,{title:(0,o.__)("Trigger","quicktasker"),className:t,titleClassName:s,children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:$c[e.automation_trigger]})}),(0,n.jsx)(Lc.A,{className:"wpqt-icon-blue wpqt-size-6"}),(0,n.jsx)(Eo,{title:(0,o.__)("Action","quicktasker"),className:t,titleClassName:s,children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center wpqt-items-center",children:[Fc[e.automation_action],a&&(0,n.jsx)(Xc,{actionTargetId:e.automation_action_target_id,actionTargetType:e.automation_action_target_type}),i&&(0,n.jsx)("div",{children:e.metadata})]})})]}),(0,n.jsx)(gl,{automation:e,className:`${t}`,titleClassName:s})]})}function jl(){const{state:{automations:e,loading:t}}=(0,a.useContext)(Wc);return t?(0,n.jsx)(aa,{ovalSize:"24"}):e&&0!==e.length?(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-4 wpqt-mx-auto wpqt-max-w-7xl",children:e.map((e=>(0,n.jsx)(vl,{automation:e},e.id)))}):(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-4",children:(0,n.jsx)(Ki,{type:"info",children:(0,o.__)("No automations created for this board","quicktasker")})})}function bl(){const{state:{automationsModalOpen:e},modalDispatch:t}=(0,a.useContext)(Bs);return(0,n.jsxs)(ua,{modalOpen:e,closeModal:()=>{t({type:de})},size:"lg",children:[(0,n.jsx)(pa,{className:"wpqt-text-center",children:(0,o.__)("Manage board automations","quicktasker")}),(0,n.jsx)(jl,{})]})}function yl({pipelineId:e}){const t=Rt?(0,o.__)("Set up automated processes to help manage your board.","quicktasker"):(0,o.__)("Set up automated processes to help manage your board. To create more than one automation, please upgrade to the premium version.","quicktasker");return(0,n.jsx)(Qc,{pipelineId:e,children:(0,n.jsxs)(Pc,{title:(0,o.__)("Board automations","quicktasker"),description:t,children:[(0,n.jsx)(El,{}),(0,n.jsx)(bl,{}),(0,n.jsx)(_l,{pipelineId:e})]})})}function El(){const{automations:e,loading:t}=function(){const{state:{automations:e,loading:t}}=(0,a.useContext)(Wc);return{automations:e,loading:t}}(),{modalDispatch:s}=(0,a.useContext)(Bs),i=(null==e?void 0:e.length)||0,r=Rt||i<1;return t?(0,n.jsx)(aa,{ovalSize:"24",className:"!wpqt-items-start"}):(0,n.jsxs)("div",{className:"wpqt-text-left",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:0===i?(0,n.jsx)("p",{children:(0,o.__)("There are no automations configured for this board.","quicktasker")}):(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,o.sprintf)((0,o.__)("There are %d automations configured for this board.","quicktasker"),i)}),(0,n.jsx)("div",{children:(0,n.jsx)("span",{className:"wpqt-cursor-pointer wpqt-text-blue-500 hover:wpqt-underline",onClick:()=>{s({type:le})},children:(0,o.__)("Manage board automations","quicktasker")})})]})}),r&&(0,n.jsx)("div",{children:(0,n.jsx)("span",{className:"wpqt-cursor-pointer wpqt-text-blue-500 hover:wpqt-underline",onClick:()=>{s({type:re})},children:(0,o.__)("Create a new automation","quicktasker")})})]})}var Tl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Sl({allow_only_last_stage_task_done:e,pipelineId:t}){const[s,i]=(0,a.useState)(e),[r,c]=(0,a.useState)(!1),{saveTaskCompletionDoneSetting:l}=Dc();return(0,n.jsx)(Pc,{title:(0,o.__)("Restrict Task Completion","quicktasker"),description:(0,o.__)("Allow to mark task as done only on board last stage. By default, task can be marked as done on any stage. Will apply also to QuickTasker page.","quicktasker"),children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,n.jsx)(mo,{checked:s,handleChange:e=>Tl(this,void 0,void 0,(function*(){i(e),c(!0),yield l(t,e,(e=>{i(e)})),c(!1)}))}),r&&(0,n.jsx)(ta,{width:"20",height:"20"})]})})}var Al=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ol(){return{createWebhook:function(e,t,s,a,n){return Al(this,void 0,void 0,(function*(){try{const i=yield function(e,t,s,a,n){return Wt()({path:`/wpqt/v1/pipelines/${e}/webhooks`,method:"POST",data:{target_type:t,target_action:s,webhook_url:a,webhook_confirm:n},headers:Qt()})}(e,t,s,a,n);return{success:!0,webhook:i.data.webhook}}catch(e){return console.error("Error creating webhook:",e),i.oR.error((0,o.__)("Failed to create webhook","quicktasker")),{success:!1,webhook:null}}}))},editWebhook:function(e,t){return Al(this,void 0,void 0,(function*(){try{const s=yield function(e,t){return Wt()({path:`/wpqt/v1/webhooks/${e}`,method:"PATCH",data:t,headers:Qt()})}(e,t);return{success:!0,webhook:s.data.webhook}}catch(e){return console.error("Error editing webhook:",e),i.oR.error((0,o.__)("Failed to edit webhook","quicktasker")),{success:!1,webhook:null}}}))},deleteWebhook:function(e){return Al(this,void 0,void 0,(function*(){try{return yield function(e){return Wt()({path:`/wpqt/v1/webhooks/${e}`,method:"DELETE",headers:Qt()})}(e),i.oR.success((0,o.__)("Webhook deleted successfully","quicktasker")),{success:!0}}catch(e){return console.error("Error deleting webhook:",e),i.oR.error((0,o.__)("Failed to delete webhook","quicktasker")),{success:!1}}}))}}}const Nl=(e,t)=>{switch(t.type){case Tt:return Object.assign(Object.assign({},e),{webhooks:t.payload.webhooks});case St:return Object.assign(Object.assign({},e),{loading:t.payload});case Ot:return Object.assign(Object.assign({},e),{webhooks:[...e.webhooks,t.payload.webhook]});case At:return Object.assign(Object.assign({},e),{webhooks:e.webhooks.filter((e=>e.id!==t.payload.webhookId))});case Nt:{const{webhookId:s,webhookData:a}=t.payload;return Object.assign(Object.assign({},e),{webhooks:e.webhooks.map((e=>e.id===s?Object.assign(Object.assign({},e),a):e))})}default:return e}};var Cl,Il;!function(e){e.TASK="task"}(Cl||(Cl={})),function(e){e.CREATE="created",e.UPDATE="updated",e.DELETE="deleted",e.STAGE_CHANGED="stage-changed",e.ARCHIVED="archived",e.RESTORED_ARCHIVED="restored-archived",e.COMPLETED="completed",e.ASSIGNED="assigned",e.UNASSIGNED="unassigned",e.COMMENT_ADDED="comment-added",e.LABEL_ADDED="label-added",e.LABEL_REMOVED="label-removed",e.FILE_ADDED="file-added",e.FILE_REMOVED="file-removed"}(Il||(Il={}));const Dl=e=>Object.assign(Object.assign({},e),{webhook_confirm:"1"===e.webhook_confirm}),Pl={[Cl.TASK]:[Il.CREATE,Il.UPDATE,Il.DELETE,Il.STAGE_CHANGED,Il.ARCHIVED,Il.RESTORED_ARCHIVED,Il.COMMENT_ADDED,Il.FILE_ADDED,Il.FILE_REMOVED,Il.LABEL_ADDED,Il.LABEL_REMOVED]};const Rl={webhooks:[],loading:!0},Ll=(0,a.createContext)({state:Rl,pipelineWebhooksDispatch:()=>{}}),Ml=({children:e,pipelineId:t})=>{const[s,r]=(0,a.useReducer)(Nl,Rl),c=()=>{return e=void 0,s=void 0,n=function*(){try{r({type:St,payload:!0});const s=yield function(e){return Wt()({path:`/wpqt/v1/pipelines/${e}/webhooks`,method:"GET",headers:Qt()})}(t);r({type:Tt,payload:{webhooks:(e=s.data.webhooks,e.map(Dl))}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load board webhooks","quicktasker"))}finally{r({type:St,payload:!1})}var e},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n};return(0,a.useEffect)((()=>{c()}),[]),(0,n.jsx)(Ll.Provider,{value:{state:s,pipelineWebhooksDispatch:r},children:e})};function Ul(){const{state:{webhooks:e,loading:t},pipelineWebhooksDispatch:s}=(0,a.useContext)(Ll);return{webhooks:e,loading:t,pipelineWebhooksDispatch:s}}const Fl=ol.z.string().url({message:"Invalid URL"});var Kl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function $l({pipelineId:e}){var t;const[s,r]=(0,a.useState)(Cl.TASK),[c,l]=(0,a.useState)(Il.CREATE),[d,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(""),[m,w]=(0,a.useState)(!1),[f,k]=(0,a.useState)({urlValid:!0,urlDirty:!1}),{createWebhook:q}=Ol(),{pipelineWebhooksDispatch:_}=Ul(),{modalDispatch:x}=(0,a.useContext)(Bs),g=null!==(t=Pl[s])&&void 0!==t?t:[];return(0,a.useEffect)((()=>{k((e=>Object.assign(Object.assign({},e),{urlValid:Fl.safeParse(p).success})))}),[p]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-4 wpqt-mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(Ta,{labelFor:"webhook-target-type",className:"wpqt-block wpqt-mb-3",children:(0,o.__)("Select a target type","quicktasker")}),(0,n.jsx)(Aa,{id:"webhook-target-type",selectedOptionValue:s,options:Object.values(Cl).map((e=>({value:e,label:e}))),allSelector:!1,onSelectionChange:e=>r(e)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(Ta,{labelFor:"webhook-target-action",className:"wpqt-block wpqt-mb-3",children:(0,o.__)("Select a target action","quicktasker")}),(0,n.jsx)(Aa,{id:"webhook-target-action",selectedOptionValue:c,options:Object.values(g).map((e=>({value:e,label:e}))),allSelector:!1,onSelectionChange:e=>l(e)})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)(Ta,{labelFor:"webhook-confirm",className:"wpqt-flex wpqt-mb-3 wpqt-gap-1","data-tooltip-id":"webhook-confirm-tooltip","data-tooltip-content":(0,o.__)("If enabled, the webhook will wait for the HTTP response. Much slower performance but better for debugging.","quicktasker"),"data-tooltip-variant":"info",children:[(0,o.__)("Confirm webhook execution","quicktasker"),(0,n.jsx)(Mc.A,{className:"wpqt-size-5"})]}),(0,n.jsx)(mo,{checked:d,handleChange:u,id:"webhook-confirm"}),(0,n.jsx)(ra,{id:"webhook-confirm-tooltip"})]}),(0,n.jsxs)("div",{className:"wpqt-flex-1",children:[(0,n.jsx)(Ta,{labelFor:"webhook-url",className:"wpqt-block wpqt-mb-3",children:(0,o.__)("Enter the webhook URL","quicktasker")}),(0,n.jsx)(Ka,{inputId:"webhook-url",value:p,onChange:e=>{h(e),k((e=>Object.assign(Object.assign({},e),{urlDirty:!0})))},wrapperClassName:"!wpqt-w-full !wpqt-mb-0",className:"!wpqt-w-full"}),!f.urlValid&&f.urlDirty&&(0,n.jsx)("div",{className:"wpqt-text-red-600 wpqt-mt-1",children:(0,o.__)("Please enter a valid URL","quicktasker")})]})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-end",children:(0,n.jsx)(ca,{btnText:(0,o.__)("Create Webhook","quicktasker"),onClick:function(){return Kl(this,void 0,void 0,(function*(){if(m||!f.urlValid)return;w(!0);const{success:t,webhook:a}=yield q(e,s,c,p,d);w(!1),t&&a&&(i.oR.success((0,o.__)("Webhook created successfully","quicktasker")),_({type:Ot,payload:{webhook:Dl(a)}}),r(Cl.TASK),l(Il.CREATE),h(""),u(!1),k({urlValid:!0,urlDirty:!1}),Lt||x({type:fe,payload:!1}))}))},loading:m})})]})}function zl({pipelineId:e}){const{state:{webhookCreationModalOpen:t},modalDispatch:s}=(0,a.useContext)(Bs);return(0,n.jsx)(ua,{modalOpen:t,closeModal:()=>{s({type:fe,payload:!1})},size:"lg",children:(0,n.jsx)($l,{pipelineId:e})})}var Gl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Vl(){const{state:{webhooksLogsModalOpen:e,webhooksLogsModalSettings:t},modalDispatch:s}=(0,a.useContext)(Bs);return(0,n.jsx)(ua,{modalOpen:e,closeModal:()=>s({type:_e}),size:"lg",children:e&&(0,n.jsx)(Bl,{settings:t})})}function Bl({settings:e}){const[t,s]=(0,a.useState)(!1),[i,o]=(0,a.useState)([]),[r,c]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{e.webhookId&&(()=>{Gl(this,void 0,void 0,(function*(){if(e.webhookId){s(!0),c(!1);try{const t=yield es({type:Ko.Webhook,typeId:e.webhookId,order:Go.Desc});o(t.data)}catch(e){console.error("Error fetching webhook logs:",e),c(!0)}finally{s(!1)}}}))})()}),[e.webhookId]),r?(0,n.jsx)("div",{children:"Error fetching logs"}):(0,n.jsx)(Fo,{loading:t,logs:i})}var Hl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Wl({webhookId:e}){const[t,s]=(0,a.useState)(!1),{deleteWebhook:i}=Ol(),{pipelineWebhooksDispatch:r}=Ul(),{modalDispatch:c}=(0,a.useContext)(Bs);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-w-[100px] wpqt-justify-center wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)(ca,{btnText:(0,o.__)("Logs","quicktasker"),onClick:()=>{c({type:qe,payload:{webhookId:e}})}}),(0,n.jsx)(ii,{confirmMessage:(0,o.__)("Are you sure you want to delete this webhook?","quicktasker"),onConfirm:function(){return Hl(this,void 0,void 0,(function*(){s(!0);const{success:t}=yield i(e);s(!1),t&&r({type:At,payload:{webhookId:e}})}))},children:({onClick:e})=>(0,n.jsx)(ca,{btnText:(0,o.__)("Delete","quicktasker"),buttonStyleType:ia.DANGER,loading:t,onClick:e})})]})}var Ql=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Yl({webhook:e}){const{state:{timezone:t}}=(0,a.useContext)(dn);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-4  wpqt-mb-4",children:[(0,n.jsx)(Jl,{name:(0,o.__)("Target","quicktasker"),value:e.target_type,className:"!wpqt-w-[100px]"}),(0,n.jsx)(Jl,{name:(0,o.__)("Action","quicktasker"),value:e.target_action,className:"!wpqt-w-[100px]"}),(0,n.jsx)(Xl,{webhook:e,name:(0,o.__)("Confirm","quicktasker"),value:e.webhook_confirm}),(0,n.jsx)(Jl,{name:(0,o.__)("URL","quicktasker"),value:e.webhook_url,className:"wpqt-w-[200px]"}),(0,n.jsx)(Jl,{name:(0,o.__)("Created","quicktasker"),value:Mn(e.created_at,t)}),(0,n.jsx)(Wl,{webhookId:e.id})]})}function Jl({name:e,value:t,className:s=""}){return(0,n.jsxs)("div",{className:`wpqt-flex wpqt-flex-col wpqt-w-[160px] ${s}`,children:[(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-font-semibold",children:e}),(0,n.jsx)("div",{children:t})]})}function Xl({webhook:e,name:t,value:s}){const[r,c]=(0,a.useState)(s),[l,d]=(0,a.useState)(!1),{editWebhook:u}=Ol(),{pipelineWebhooksDispatch:p}=Ul();return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-w-[160px]",children:[(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-font-semibold",children:t}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2",children:[(0,n.jsx)(mo,{checked:r,handleChange:t=>Ql(this,void 0,void 0,(function*(){c(t),d(!0);const{success:s}=yield u(e.id,{webhook_confirm:t});d(!1),s?(i.oR.success((0,o.__)("Webhook updated","quicktasker")),p({type:Nt,payload:{webhookId:e.id,webhookData:{webhook_confirm:t}}})):c(!t)}))}),l&&(0,n.jsx)(aa,{ovalSize:"16"})]})]})}function Zl(){const{state:{webhooksModalOpen:e},modalDispatch:t}=(0,a.useContext)(Bs),{webhooks:s}=Ul();return(0,n.jsx)(ua,{modalOpen:e,closeModal:()=>{t({type:ke,payload:!1})},size:"lg",children:(0,n.jsx)(ed,{webhooks:s})})}function ed({webhooks:e}){return 0===e.length?(0,n.jsx)("h2",{children:(0,o.__)("No webhooks found.","quicktasker")}):(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-4",children:e.map((e=>(0,n.jsx)(Yl,{webhook:e},e.id)))})}function td({pipelineId:e}){const t=Lt?(0,o.__)("Send real-time board event data to external services using webhooks.","quicktasker"):(0,o.__)("Send real-time board event data to external services using webhooks. To configure more than one webhook, please upgrade to the premium version.","quicktasker");return(0,n.jsx)(Ml,{pipelineId:e,children:(0,n.jsxs)(Pc,{title:(0,o.__)("Board webhooks","quicktasker"),description:t,children:[(0,n.jsx)(sd,{}),(0,n.jsx)(zl,{pipelineId:e}),(0,n.jsx)(Zl,{}),(0,n.jsx)(Vl,{})]})})}function sd(){const{webhooks:e,loading:t}=Ul(),{modalDispatch:s}=(0,a.useContext)(Bs),i=(null==e?void 0:e.length)||0,r=Lt||i<1;return t?(0,n.jsx)(aa,{ovalSize:"24",className:"!wpqt-items-start"}):(0,n.jsxs)("div",{className:"wpqt-text-left",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:0===i?(0,n.jsx)("p",{children:(0,o.__)("There are no webhooks configured for this board.","quicktasker")}):(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,o.sprintf)((0,o.__)("There are %d webhooks configured for this board.","quicktasker"),i)}),(0,n.jsx)("div",{children:(0,n.jsx)("span",{className:"wpqt-cursor-pointer wpqt-text-blue-500 hover:wpqt-underline",onClick:()=>{s({type:ke,payload:!0})},children:(0,o.__)("Manage board webhooks","quicktasker")})})]})}),r&&(0,n.jsx)("div",{children:(0,n.jsx)("span",{className:"wpqt-cursor-pointer wpqt-text-blue-500 hover:wpqt-underline",onClick:()=>{s({type:fe,payload:!0})},children:(0,o.__)("Create a new webhook","quicktasker")})})]})}var ad=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function nd({pipeline:e}){const[t,s]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null);return(0,a.useEffect)((()=>{(()=>{ad(this,void 0,void 0,(function*(){try{s(!0);const a=yield(t=e.id,Wt()({path:`/wpqt/v1/pipelines/${t}/settings`,method:"GET",headers:Qt()}));o(is(a.data.settings))}catch(e){console.error(e)}finally{s(!1)}var t}))})()}),[]),t?(0,n.jsx)(aa,{}):i?(0,n.jsxs)("div",{children:[(0,n.jsx)(Sl,{pipelineId:e.id,allow_only_last_stage_task_done:i.allow_only_last_stage_task_done}),(0,n.jsx)(yl,{pipelineId:e.id}),(0,n.jsx)(td,{pipelineId:e.id})]}):null}function id(){const{state:{pipelines:e}}=(0,a.useContext)(ja),t=e.map((e=>e.name)),s=e.map((e=>(0,n.jsx)(nd,{pipeline:e},e.id)));return(0,n.jsx)("div",{children:(0,n.jsx)(Ci,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})})}const od=()=>(0,n.jsxs)(La,{children:[(0,n.jsx)(d,{description:(0,o.__)("Manage settings, preferences, and configurations.","quicktasker"),children:(0,o.__)("Settings","quicktasker")}),(0,n.jsx)(Rc,{}),(0,n.jsx)(id,{})]});function rd(){const{state:{siteURL:e,publicUserPageId:t}}=(0,a.useContext)(dn);return{userPage:e+`/wpqt?page=${t}&page_id=wpqt`}}function cd(){const{userPage:e}=rd();return(0,n.jsxs)(La,{children:[(0,n.jsx)(d,{description:(0,o.__)("Lets you manage assigned tasks on separate page.","quicktasker"),children:(0,o.__)("User app","quicktasker")}),(0,n.jsx)("div",{children:(0,n.jsx)("a",{onClick:t=>{t.preventDefault(),window.open(e,"_blank")},href:"",children:(0,o.__)("Open your user page","quicktasker")})})]})}var ld=s(1548),dd=s(1266),ud=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function pd(){return{createUser:(e,t,s)=>ud(this,void 0,void 0,(function*(){try{const r=yield(a=e,n=t,Wt()({path:"/wpqt/v1/users",method:"POST",data:{name:a,description:n},headers:Qt()}));s&&s(r.data),i.oR.success((0,o.__)("User created successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User creation failed. Please try again","quicktasker"))}var a,n})),editUser:(e,t)=>ud(this,void 0,void 0,(function*(){try{const s=yield function(e,t){return Wt()({path:`/wpqt/v1/users/${e}`,method:"PATCH",data:t,headers:Qt()})}(e,t);return{success:!0,user:s.data}}catch(e){return console.error(e),i.oR.error((0,o.__)("User edit failed. Please try again","quicktasker")),{success:!1}}})),changeUserStatus:(e,t,s)=>ud(this,void 0,void 0,(function*(){try{const a=yield function(e,t){return Wt()({path:`/wpqt/v1/users/${e}/status`,method:"PATCH",data:{status:t},headers:Qt()})}(e,t);s&&s(a.data),i.oR.success((0,o.__)("User status changed successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change user status. Please try again","quicktasker"))}})),deleteUser:(e,t)=>ud(this,void 0,void 0,(function*(){try{yield function(e){return Wt()({path:`/wpqt/v1/users/${e}`,method:"DELETE",headers:Qt()})}(e),t&&t(e),i.oR.success((0,o.__)("User deleted successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete user. Please try again","quicktasker"))}})),resetUserPassword:(e,t)=>ud(this,void 0,void 0,(function*(){try{yield function(e){return Wt()({path:`/wpqt/v1/users/${e}/password-reset`,method:"PATCH",headers:Qt()})}(e),t&&t(e),i.oR.success((0,o.__)("User password reset successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to reset user password. Please try again","quicktasker"))}}))}}var hd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function md({data:e,changeStatus:t,changeSetUpStatus:s,changePasswordStatus:i}){const{changeUserStatus:r,deleteUser:c,resetUserPassword:l}=pd(),{userDispatch:d}=(0,a.useContext)(Qa),{loading1:u,setLoading1:p,loading2:h,setLoading2:m,loading3:w,setLoading3:f}=rn(),k=e.is_active,q=e.has_password;return(0,n.jsxs)("div",{className:"wpqt-mt-5 wpqt-flex wpqt-gap-2",children:[(0,n.jsx)(la,{icon:(0,n.jsx)(xc.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${e.id}/tasks`}}),!k&&(0,n.jsx)(la,{icon:(0,n.jsx)(ld.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:h,onClick:()=>hd(this,void 0,void 0,(function*(){m(!0),yield r(e.id,!0,(e=>{d({type:Ue,payload:Object.assign({},e)}),t(!0)})),m(!1)}))}),k&&(0,n.jsx)(la,{icon:(0,n.jsx)(ld.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:h,onClick:()=>hd(this,void 0,void 0,(function*(){m(!0),yield r(e.id,!1,(e=>{d({type:Ue,payload:Object.assign({},e)}),t(!1)})),m(!1)}))}),q&&(0,n.jsx)(la,{icon:(0,n.jsx)(dd.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:u,text:(0,o.__)("Reset password","quicktasker"),onClick:()=>hd(this,void 0,void 0,(function*(){p(!0),yield l(e.id,(()=>{s(!1),i(!1)})),p(!1)}))}),(0,n.jsx)(la,{icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:w,text:(0,o.__)("Delete user","quicktasker"),onClick:()=>hd(this,void 0,void 0,(function*(){f(!0),yield c(e.id,(e=>{d({type:Fe,payload:e}),window.location.hash="#/users"})),f(!1)}))})]})}var wd=s(8624),fd=s(3997),kd=s(5028);function qd({data:e}){const{userPage:t}=rd(),{convertToWPTimezone:s}=Un(),a=e.is_active,i=t+"&code="+e.page_hash;return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,n.jsx)(_d,{label:(0,o.__)("Name","quicktasker"),value:e.name,icon:(0,n.jsx)(wd.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(_d,{label:(0,o.__)("Created at","quicktasker"),value:s(e.created_at),icon:(0,n.jsx)(fd.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(_d,{label:(0,o.__)("Assigned tasks count","quicktasker"),value:e.assigned_tasks_count,icon:(0,n.jsx)(xc.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(_d,{label:(0,o.__)("Setup completed","quicktasker"),value:e.setup_completed?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,n.jsx)(kd.A,{className:"wpqt-size-5 wpqt-text-yellow-600"})}),(0,n.jsx)(_d,{label:(0,o.__)("Is active","quicktasker"),value:a?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,n.jsx)(ld.A,{className:"wpqt-size-5 "+(a?"wpqt-icon-green":"wpqt-icon-red")})}),(0,n.jsx)(_d,{label:(0,o.__)("User Page","quicktasker"),value:(0,n.jsx)("a",{href:i,rel:"noreferrer",target:"_blank",children:i}),icon:(0,n.jsx)(No.A,{className:"wpqt-size-5 wpqt-icon-blue"})})]})}function _d({label:e,value:t,icon:s}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[s,(0,n.jsxs)("span",{className:"wpqt-font-semibold",children:[e,": "]}),(0,n.jsx)("span",{children:t})]})}var xd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function gd({userId:e}){const{loadingDispatch:t}=(0,a.useContext)(gs),[s,r]=(0,a.useState)(null);return(0,a.useEffect)((()=>{(()=>{xd(this,void 0,void 0,(function*(){try{t({type:Ve,payload:!0});const a=yield function(e){return Wt()({path:`/wpqt/v1/users/${e}/extended`,method:"GET",headers:Qt()})}(e);r((s=a.data,Object.assign(Object.assign({},s),{is_active:"1"===s.is_active})))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to get user data. Please try again","quicktasker"))}finally{t({type:Ve,payload:!1})}var s}))})()}),[]),(0,n.jsx)(La,{children:s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{description:(0,o.__)("User details","quicktasker"),children:s.name}),(0,n.jsx)(qd,{data:s}),(0,n.jsx)(md,{data:s,changeStatus:e=>xd(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{is_active:e}):t))})),changeSetUpStatus:e=>xd(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{setup_completed:e}):t))})),changePasswordStatus:e=>xd(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{has_password:e}):t))}))})]})})}s(8987);const vd=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active||!0===e.is_active}),jd=(e,t)=>{var s;switch(t.type){case Be:return Object.assign(Object.assign({},e),{sessionsSearchValue:null!==(s=t.payload)&&void 0!==s?s:""});case He:{const s=t.payload.map(vd);return Object.assign(Object.assign({},e),{userSessions:s})}case We:{const{sessionId:s,status:a}=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_active:a}):e))})}case Qe:{const s=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.filter((e=>e.id!==s))})}default:return e}};var bd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const yd={loading:!0,sessionsSearchValue:"",userSessions:[]},Ed=(0,a.createContext)({state:yd,usersSessionDispatch:()=>{},loadUserSessions:()=>bd(void 0,void 0,void 0,(function*(){}))}),Td=({children:e})=>{const[t,s]=(0,a.useReducer)(jd,yd),{loadingDispatch:r}=(0,a.useContext)(gs);(0,a.useEffect)((()=>{c()}),[]);const c=()=>bd(void 0,void 0,void 0,(function*(){try{r({type:Ve,payload:!0});const e=yield Wt()({path:"/wpqt/v1/users/sessions",method:"GET",headers:Qt()});s({type:He,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user sessions","quicktasker"))}finally{r({type:Ve,payload:!1})}}));return(0,n.jsx)(Ed.Provider,{value:{state:t,usersSessionDispatch:s,loadUserSessions:c},children:e})};function Sd(){const{state:{sessionsSearchValue:e},usersSessionDispatch:t}=(0,a.useContext)(Ed);return(0,n.jsx)(za,{title:(0,o.__)("Session filtering","quicktasker"),searchChildren:(0,n.jsx)(Ga,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"session-search",children:(0,n.jsx)(Ka,{inputId:"session-search",value:e,onChange:e=>{t({type:Be,payload:e})}})})})}const Ad=()=>{const{state:{sessionsSearchValue:e}}=(0,a.useContext)(Ed);return{filterSessions:t=>t.user_name.toLowerCase().includes(e.toLowerCase())||t.user_description&&t.user_description.toLowerCase().includes(e.toLowerCase())}};var Od=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Nd({session:e}){const{usersSessionDispatch:t}=(0,a.useContext)(Ed),{state:{isUserAllowedToDelete:s}}=(0,a.useContext)(dn),{convertToWPTimezone:r}=Un(),c=e.is_active,l=s=>Od(this,void 0,void 0,(function*(){try{yield function(e,t){return Wt()({path:`/wpqt/v1/users/sessions/${e}/status`,method:"PATCH",data:{status:t},headers:Qt()})}(e.id,s),t({type:We,payload:{sessionId:e.id,status:s}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change session status","quicktasker"))}}));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:e.user_name}),(0,n.jsx)("div",{className:"wpqt-italic",children:e.user_description})]}),(0,n.jsx)("div",{children:r(e.created_at_utc)}),(0,n.jsx)("div",{children:r(e.expires_at_utc)}),(0,n.jsx)("div",{className:c?"wpqt-text-qtTextGreen":"wpqt-text-qtTextRed",children:c?(0,o.__)("On","quicktasker"):(0,o.__)("Off","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-4",children:[c?(0,n.jsx)(ld.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!1),title:(0,o.__)("Turn session off","quicktasker")}):(0,n.jsx)(ld.A,{className:"wpqt-icon-green wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!0),title:(0,o.__)("Turn session on","quicktasker")}),s&&(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",title:(0,o.__)("Delete session","quicktasker"),onClick:()=>Od(this,void 0,void 0,(function*(){try{yield(s=e.id,Wt()({path:`/wpqt/v1/users/sessions/${s}`,method:"DELETE",headers:Qt()})),t({type:Qe,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete session","quicktasker"))}var s}))})]})]})}function Cd(){const{state:{userSessions:e}}=(0,a.useContext)(Ed),{filterSessions:t}=Ad(),s=e.filter(t);return 0===s.length?(0,n.jsx)(jo,{text:(0,o.__)("No sessions found","quicktasker")}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-mb-4 wpqt-grid wpqt-grid-cols-5 wpqt-font-bold",children:[(0,n.jsx)("div",{children:(0,o.__)("Session owner","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Created at","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Expires at","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Status","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Actions","quicktasker")})]}),(0,n.jsx)("div",{className:"wpqt-grid wpqt-grid-cols-5 wpqt-items-center wpqt-gap-y-4",children:s.map((e=>(0,n.jsx)(Nd,{session:e},e.id)))})]})}function Id(){return(0,n.jsx)(Td,{children:(0,n.jsx)(La,{children:(0,n.jsx)(Dd,{})})})}function Dd(){const{state:{userSessions:e}}=(0,a.useContext)(Ed);return e.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{children:(0,o.__)("Quicktasker sessions","quicktasker")}),(0,n.jsx)(Sd,{}),(0,n.jsx)(Cd,{})]}):(0,n.jsx)(Yo,{infoTitle:(0,o.__)("No sessions","quicktasker"),infoDescription:(0,o.__)("No QuickTasker sessions found","quicktasker")})}function Pd(){const{state:{usersSearchValue:e},userDispatch:t}=(0,a.useContext)(Qa);return(0,n.jsx)(za,{title:(0,o.__)("User filtering","quicktasker"),searchChildren:(0,n.jsx)(Ga,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"user-search",children:(0,n.jsx)(Ka,{inputId:"user-search",value:e,onChange:e=>{t({type:Me,payload:e})}})})})}var Rd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ld({userId:e}){return(0,n.jsx)(zi,{typeId:e,fetchData:()=>Rd(this,void 0,void 0,(function*(){try{return(yield Zt(e,Cs.User)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load log","quicktasker"))}})),renderItem:e=>(0,n.jsx)(Ri,{log:e}),noDataMessage:(0,o.__)("No logs available","quicktasker")})}var Md=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ud({userId:e}){return(0,n.jsx)(zi,{typeId:e,fetchData:()=>Md(this,void 0,void 0,(function*(){try{return(yield Jt(e,Bt.QUICKTASKER,!0)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load private comments","quicktasker"))}})),onAdd:t=>Md(this,void 0,void 0,(function*(){try{return(yield Xt(e,Bt.QUICKTASKER,!0,t)).data.newComment}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add private comment","quicktasker"))}})),renderItem:e=>(0,n.jsx)(Vi,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),enableAdd:!0})}var Fd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Kd({userId:e}){const{addComment:t}=Qi();return(0,n.jsx)(zi,{typeId:e,fetchData:()=>Fd(this,void 0,void 0,(function*(){try{return(yield Jt(e,Bt.QUICKTASKER,!1)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load comments","quicktasker"))}})),onAdd:s=>Fd(this,void 0,void 0,(function*(){const a=yield t(e,Bt.QUICKTASKER,!1,s);if(a)return a})),renderItem:e=>(0,n.jsx)(Vi,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),enableAdd:!0})}function $d({user:e}){const t=[(0,o.__)("Logs","quicktasker"),(0,o.__)("Private comments","quicktasker"),(0,o.__)("Public comments","quicktasker")];return(0,n.jsx)(Ci,{tabs:t,tabsContent:[(0,n.jsx)(Ld,{userId:e.id},3),(0,n.jsx)(Ud,{userId:e.id},1),(0,n.jsx)(Kd,{userId:e.id},2)]})}var zd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Gd=({onEditUserCompleted:e})=>{const{state:{userToEdit:t},modalDispatch:s}=(0,a.useContext)(Bs),{state:{isUserAllowedToDelete:i}}=(0,a.useContext)(dn),[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),{changeUserStatus:u,deleteUser:p,resetUserPassword:h,editUser:m}=pd(),{userDispatch:w}=(0,a.useContext)(Qa),{loading1:f,setLoading1:k,loading2:q,setLoading2:_,loading3:x,setLoading3:g}=rn();return(0,a.useEffect)((()=>{t&&(c(t.is_active),d(t.has_password))}),[t]),t?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,n.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-6",children:[(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-10 md:wpqt-grid-cols-[1fr_0.7fr]",children:[(0,n.jsx)("div",{children:(0,n.jsxs)(ha,{children:[(0,n.jsx)(ma,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(wn,{isAutoFocus:!0,value:t.name,wrapperClassName:"wpqt-w-full",className:"wpqt-w-full",onChange:s=>zd(void 0,void 0,void 0,(function*(){const{success:a,user:n}=yield m(t.id,{name:s});a&&n&&e(n)}))})}),(0,n.jsx)(ma,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(_n,{value:t.description,className:"wpqt-w-full",onChange:s=>zd(void 0,void 0,void 0,(function*(){const{success:a,user:n}=yield m(t.id,{description:s});a&&n&&e(n)}))})})]})}),(0,n.jsx)(ni,{entityId:t.id,entityType:hn.QUICKTASKER})]}),(0,n.jsx)("div",{className:"wpqt-mt-7",children:(0,n.jsx)($d,{user:t})})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,n.jsx)(la,{icon:(0,n.jsx)(wd.A,{className:"wpqt-icon-blue wpqt-size-4"}),text:(0,o.__)("User details","quicktasker"),onClick:()=>{window.location.hash=`#/users/${t.id}`,s({type:H})}}),(0,n.jsx)(la,{icon:(0,n.jsx)(xc.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${t.id}/tasks`,s({type:H})}}),l&&(0,n.jsx)(la,{icon:(0,n.jsx)(dd.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Reset password","quicktasker"),loading:f,onClick:()=>zd(void 0,void 0,void 0,(function*(){k(!0),yield h(t.id,(()=>{w({type:$e,payload:t.id}),d(!1)})),k(!1)}))}),!r&&(0,n.jsx)(la,{icon:(0,n.jsx)(ld.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:q,onClick:()=>zd(void 0,void 0,void 0,(function*(){_(!0),yield u(t.id,!0,(e=>{w({type:Ue,payload:Object.assign({},e)}),c(!0)})),_(!1)}))}),r&&(0,n.jsx)(la,{icon:(0,n.jsx)(ld.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:q,onClick:()=>zd(void 0,void 0,void 0,(function*(){_(!0),yield u(t.id,!1,(e=>{w({type:Ue,payload:Object.assign({},e)}),c(!1)})),_(!1)}))}),i&&(0,n.jsx)(ii,{confirmMessage:(0,o.__)("Are you sure you want to delete this user?","quicktasker"),onConfirm:()=>zd(void 0,void 0,void 0,(function*(){g(!0),yield p(t.id,(e=>{w({type:Fe,payload:e}),s({type:H})})),g(!1)})),containerClassName:"wpqt-flex",children:({onClick:e})=>(0,n.jsx)(la,{icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete user","quicktasker"),loading:x,onClick:e,className:"wpqt-w-full"})})]})]})}):null};function Vd(){const{state:{userModalOpen:e}}=(0,a.useContext)(Bs),{closeModal:t,handleSuccess:s}=Xa(H);return(0,n.jsx)(ua,{modalOpen:e,closeModal:t,size:"xl",children:(0,n.jsx)(Gd,{onEditUserCompleted:e=>{s(Ue,e,Ja.USER)}})})}function Bd(){const{state:{userSettingsModalOpen:e},modalDispatch:t}=(0,a.useContext)(Bs);return(0,n.jsx)(ua,{modalOpen:e,closeModal:()=>t({type:J,payload:!1}),size:"md",children:(0,n.jsx)("div",{children:(0,n.jsx)(ni,{entityId:"null",entityType:hn.Users})})})}var Hd=s(8316),Wd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Qd(){const[e,t]=(0,a.useState)(!1),[s,r]=(0,a.useState)(""),[c,l]=(0,a.useState)(""),{userDispatch:d}=(0,a.useContext)(Qa),{createUser:u}=pd(),p=()=>{r(""),l(""),t(!1)};return(0,n.jsx)("div",{className:"wpqt-mb-6",children:e?(0,n.jsxs)("div",{className:"wpqt-w-1/4",children:[(0,n.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User name","quicktasker")}),(0,n.jsx)(Ka,{value:s,onChange:r,className:"wpqt-w-full"}),(0,n.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User description","quicktasker")}),(0,n.jsx)(qn,{value:c,onChange:l,className:"wpqt-w-full"}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,n.jsx)(la,{text:(0,o.__)("Cancel","quicktasker"),onClick:p,icon:(0,n.jsx)(Xs.A,{className:"wpqt-icon-red wpqt-size-5"})}),(0,n.jsx)(la,{text:(0,o.__)("Add","quicktasker"),onClick:()=>Wd(this,void 0,void 0,(function*(){s?yield u(s,c,(e=>{d({type:Le,payload:e}),p()})):i.oR.error("User name is required")})),icon:(0,n.jsx)(Hd.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]}):(0,n.jsx)(la,{text:(0,o.__)("Add QuickTasker","quicktasker"),onClick:()=>t(!0),icon:(0,n.jsx)(Hd.A,{className:"wpqt-icon-green wpqt-size-5"})})})}const Yd=()=>{const{state:{usersSearchValue:e}}=(0,a.useContext)(Qa);return{filterUsers:t=>t.name.toLowerCase().includes(e.toLowerCase())||t.description&&t.description.toLowerCase().includes(e.toLowerCase())}};var Jd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Xd({user:e}){const{modalDispatch:t}=(0,a.useContext)(Bs),{userDispatch:s}=(0,a.useContext)(Qa),{changeUserStatus:i,deleteUser:r,resetUserPassword:c}=pd(),[l,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1),w=e.is_active,f=t=>Jd(this,void 0,void 0,(function*(){m(!0),yield i(e.id,t,(()=>{s({type:Ke,payload:{userId:e.id,isActive:t}})})),m(!1)}));return(0,n.jsxs)(li,{menuBtn:({active:e})=>(0,n.jsx)(di,{isActive:e,IconComponent:Oo.A}),children:[(0,n.jsx)(ui,{text:(0,o.__)("User details","quicktasker"),icon:(0,n.jsx)(wd.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,n.jsx)(ui,{text:(0,o.__)("User tasks","quicktasker"),icon:(0,n.jsx)(xc.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}/tasks`}}),(0,n.jsx)(ui,{text:(0,o.__)("Edit user","quicktasker"),icon:(0,n.jsx)(ki.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:W,payload:e})}}),e.has_password&&(0,n.jsx)(ui,{text:(0,o.__)("Reset password","quicktasker"),loading:l,icon:(0,n.jsx)(dd.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Jd(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield c(e.id,(()=>{s({type:$e,payload:e.id})})),d(!1)}))}),w&&(0,n.jsx)(ui,{text:(0,o.__)("Disable user","quicktasker"),loading:h,icon:(0,n.jsx)(ld.A,{className:"wpqt-icon-red wpqt-size-4"}),className:"!wpqt-mb-0",onClick:e=>{e.stopPropagation(),f(!1)}}),!w&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ui,{text:(0,o.__)("Activate user","quicktasker"),loading:h,icon:(0,n.jsx)(ld.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:e=>{e.stopPropagation(),f(!0)}}),(0,n.jsx)(ui,{text:(0,o.__)("Delete user","quicktasker"),loading:u,icon:(0,n.jsx)(nn.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Jd(this,void 0,void 0,(function*(){t.stopPropagation(),p(!0),yield r(e.id,(e=>{s({type:Fe,payload:e})})),p(!1)}))})]})]})}function Zd({user:e}){const{userPage:t}=rd(),{modalDispatch:s}=(0,a.useContext)(Bs),i=e.is_active,r=t+"&code="+e.page_hash;return(0,n.jsxs)(Eo,{title:e.name,description:e.description,dropdown:(0,n.jsx)(Xd,{user:e}),onClick:()=>{s({type:W,payload:e})},className:"wpqt-cursor-pointer",children:[(0,n.jsx)(Ao,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("Open user page","quicktasker"),icon:(0,n.jsx)(No.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:e=>{e.stopPropagation(),window.open(r,"_blank")}}),(0,n.jsx)(Ao,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("View user details","quicktasker"),icon:(0,n.jsx)(No.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,n.jsx)(Ao,{label:(0,o.__)("Status","quicktasker"),value:i?(0,o.__)("Active","quicktasker"):(0,o.__)("Disabled","quicktasker"),valueClassName:i?"wpqt-text-qtTextGreen wpqt-font-bold":"wpqt-text-qtTextRed wpqt-font-bold",icon:(0,n.jsx)(ld.A,{className:"wpqt-size-5 "+(i?"wpqt-icon-green":"wpqt-icon-red")})})]})}function eu(){const{state:{users:e}}=(0,a.useContext)(Qa),{filterUsers:t}=Yd(),s=e.filter(t);return e&&0===e.length?(0,n.jsx)(jo,{text:(0,o.__)("No users found","quicktasker")}):s&&0===s.length?(0,n.jsx)(jo,{}):(0,n.jsx)("div",{className:"wpqt-card-grid",children:s.map((e=>(0,n.jsx)(Zd,{user:e},e.id)))})}function tu(){return(0,n.jsxs)("div",{children:[(0,n.jsx)(Qd,{}),(0,n.jsx)(Pd,{}),(0,n.jsx)(eu,{}),(0,n.jsx)(Bd,{}),(0,n.jsx)(Vd,{})]})}var su=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};var au=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function nu({user:e}){const[t,s]=(0,a.useState)({quicktasker_admin_role:"quicktasker_admin_role"in e.allcaps,quicktasker_admin_role_allow_delete:"quicktasker_admin_role_allow_delete"in e.allcaps,quicktasker_admin_role_manage_users:"quicktasker_admin_role_manage_users"in e.allcaps,quicktasker_admin_role_manage_settings:"quicktasker_admin_role_manage_settings"in e.allcaps,quicktasker_admin_role_manage_archive:"quicktasker_admin_role_manage_archive"in e.allcaps,quicktasker_access_user_page_app:"quicktasker_access_user_page_app"in e.allcaps}),[i,r]=(0,a.useState)(!1),{updateWPUserCapabilities:c}=function(){return{updateWPUserCapabilities:(e,t,s,a)=>su(this,void 0,void 0,(function*(){try{yield function(e,t){return Wt()({path:`/wpqt/v1/wp-users/${e}/capabilities`,method:"PATCH",data:{quicktasker_admin_role:t.quicktasker_admin_role,quicktasker_admin_role_allow_delete:t.quicktasker_admin_role_allow_delete,quicktasker_admin_role_manage_users:t.quicktasker_admin_role_manage_users,quicktasker_admin_role_manage_settings:t.quicktasker_admin_role_manage_settings,quicktasker_admin_role_manage_archive:t.quicktasker_admin_role_manage_archive,quicktasker_access_user_page_app:t.quicktasker_access_user_page_app},headers:Qt()})}(e,t),s&&s()}catch(e){a&&a(e)}}))}}(),l=(a,n)=>au(this,void 0,void 0,(function*(){if(i)return;r(!0);const o=Object.assign({},t),l=Object.assign(Object.assign({},t),{[n]:a});s(l),yield c(e.id,l,(()=>{}),(()=>{s(o)})),r(!1)}));return(0,n.jsxs)(Eo,{title:e.name,description:e.description,children:[(0,n.jsx)(Ao,{label:(0,o.__)("Role","quicktasker"),value:Array.isArray(e.roles)?e.roles.join(", "):""}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to admin areas","quicktasker")}),(0,n.jsx)(mo,{checked:t.quicktasker_admin_role,handleChange:e=>{l(e,"quicktasker_admin_role")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to users page","quicktasker")}),(0,n.jsx)(mo,{checked:t.quicktasker_admin_role_manage_users,handleChange:e=>{l(e,"quicktasker_admin_role_manage_users")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to settings page","quicktasker")}),(0,n.jsx)(mo,{checked:t.quicktasker_admin_role_manage_settings,handleChange:e=>{l(e,"quicktasker_admin_role_manage_settings")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to archive page","quicktasker")}),(0,n.jsx)(mo,{checked:t.quicktasker_admin_role_manage_archive,handleChange:e=>{l(e,"quicktasker_admin_role_manage_archive")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Allow to delete resources","quicktasker")}),(0,n.jsx)(mo,{checked:t.quicktasker_admin_role_allow_delete,handleChange:e=>{l(e,"quicktasker_admin_role_allow_delete")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Allow access to user page app","quicktasker")}),(0,n.jsx)(mo,{checked:t.quicktasker_access_user_page_app,handleChange:e=>{l(e,"quicktasker_access_user_page_app")}})]}),i&&(0,n.jsx)(aa,{ovalSize:"24"})]})}var iu=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ou(){const[e,t]=(0,a.useState)(null),[s,i]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(()=>{iu(this,void 0,void 0,(function*(){try{i(!0);const s=yield(e=Ps.Other,Wt()({path:`/wpqt/v1/wp-users?type=${encodeURIComponent(e)}`,method:"GET",headers:Qt()}));t(s.data)}catch(e){console.error(e)}finally{i(!1)}var e}))})()}),[]),s||null===e?(0,n.jsx)(aa,{ovalSize:"48"}):0===e.length?(0,n.jsx)(jo,{text:(0,o.__)("No non-admin WordPress users found","quicktasker")}):(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Displaying non-admin WordPress users.","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-card-grid",children:e.map((e=>(0,n.jsx)(nu,{user:e},e.id)))})]})}function ru(){const{updateUsers:e}=(0,a.useContext)(Qa),{loadingDispatch:t}=(0,a.useContext)(gs),{modalDispatch:s}=(0,a.useContext)(Bs),i=[(0,n.jsx)(tu,{},0),(0,n.jsx)(ou,{},1)];return(0,a.useEffect)((()=>{(()=>{var s,a,n,i;s=this,a=void 0,i=function*(){t({type:Ve,payload:!0}),yield e(),t({type:Ve,payload:!1})},new((n=void 0)||(n=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function r(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(s,a||[])).next())}))})()}),[]),(0,n.jsxs)(La,{children:[(0,n.jsx)(d,{description:(0,o.__)("Manage QuickTaskers and WordPress users. This plugin supports three types of users: WordPress admins, other WordPress users, and QuickTaskers. WordPress admins have full access to all admin areas. Other WordPress users do not have any access by default but can be granted if needed. QuickTaskers are separate users who do not have admin access but can manage tasks through a mobile-friendly webpage.","quicktasker"),icon:(0,n.jsx)(l.A,{className:"wpqt-icon-gray wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{s({type:J,payload:!0})}}),children:(0,o.__)("Users","quicktasker")}),(0,n.jsx)(Ci,{tabs:["QuickTaskers","WordPress users"],tabsContent:i,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}const cu=(e,t)=>{switch(t.type){case Ye:{const s=t.payload.map(ws);return Object.assign(Object.assign({},e),{tasks:s})}case Xe:{const s=t.payload;return Object.assign(Object.assign({},e),{tasks:e.tasks.filter((e=>e.id!==s))})}case Ze:{const s=t.payload,a=e.tasks.map((e=>e.id===s.id?ws(s):e));return Object.assign(Object.assign({},e),{tasks:a})}case Je:{const s=t.payload;return Object.assign(Object.assign({},e),{searchValue:s})}case et:{const s=t.payload;return Object.assign(Object.assign({},e),{filteredPipelineId:s})}case tt:{const{taskId:s,user:a}=t.payload,n=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:as(a)?[a,...e.assigned_users]:e.assigned_users,assigned_wp_users:ns(a)?[a,...e.assigned_wp_users]:e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{tasks:n})}case st:{const{taskId:s,user:a}=t.payload,n=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:as(a)?e.assigned_users.filter((e=>e.id!==a.id)):e.assigned_users,assigned_wp_users:ns(a)?e.assigned_wp_users.filter((e=>e.id!==a.id)):e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{tasks:n})}case at:{const{taskId:s,done:a}=t.payload,n=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:a}):e));return Object.assign(Object.assign({},e),{tasks:n})}default:return e}};var lu=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const du={tasks:[],searchValue:"",filteredPipelineId:""},uu=(0,a.createContext)({state:du,userTasksDispatch:()=>{},fetchAndSetUserTasks:()=>lu(void 0,void 0,void 0,(function*(){}))}),pu=({children:e,userId:t})=>{const[s,r]=(0,a.useReducer)(cu,du),{loadingDispatch:c}=(0,a.useContext)(gs);(0,a.useEffect)((()=>{l()}),[]);const l=()=>lu(void 0,void 0,void 0,(function*(){try{c({type:Ve,payload:!0});const e=yield function(e){return Wt()({path:`/wpqt/v1/users/${e}/tasks`,method:"GET",headers:Qt()})}(t);r({type:Ye,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user tasks","quicktasker"))}finally{c({type:Ve,payload:!1})}}));return(0,n.jsx)(uu.Provider,{value:{state:s,userTasksDispatch:r,fetchAndSetUserTasks:l},children:e})};function hu(){const{state:{searchValue:e,filteredPipelineId:t},userTasksDispatch:s}=(0,a.useContext)(uu);return(0,n.jsx)(za,{title:(0,o.__)("Filter tasks","quicktasker"),searchChildren:(0,n.jsx)(Ga,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"user-tasks-search",children:(0,n.jsx)(Ka,{inputId:"user-tasks-search",value:e,onChange:e=>{s({type:Je,payload:e})},className:"!wpqt-mb-0"})}),children:(0,n.jsx)(Ga,{title:(0,o.__)("Board","quicktasker"),children:(0,n.jsx)($a,{selectedOptionValue:t,selectionChange:e=>{s({type:et,payload:e})}})})})}var mu=s(7028),wu=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function fu({taskId:e,onUnAssignTask:t}){const[s,i]=(0,a.useState)(!1);return(0,n.jsx)(li,{menuBtn:({active:e})=>(0,n.jsx)(di,{isActive:e,IconComponent:Oo.A}),children:(0,n.jsx)(ui,{text:(0,o.__)("Unassign from task","quicktasker"),loading:s,icon:(0,n.jsx)(mu.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:s=>wu(this,void 0,void 0,(function*(){s.stopPropagation(),i(!0),yield t(e),i(!1)})),className:"!wpqt-mb-0"})})}const ku=()=>{const{state:{searchValue:e,filteredPipelineId:t}}=(0,a.useContext)(uu);return{filterTasks:s=>{const a=s.name&&s.name.toLowerCase().includes(e.toLowerCase())||s.description&&s.description.toLowerCase().includes(e.toLowerCase()),n=!t||s.pipeline_id===t;return a&&n}}};var qu=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function _u({userId:e}){var t;const{filterTasks:s}=ku(),{modalDispatch:i}=(0,a.useContext)(Bs),{state:{tasks:r},userTasksDispatch:c}=(0,a.useContext)(uu),{removeTaskFromUser:l}=Os(),d=null!==(t=null==r?void 0:r.filter(s))&&void 0!==t?t:[],u=t=>qu(this,void 0,void 0,(function*(){yield l(e,t,(()=>{c({type:Xe,payload:t})}))}));return r&&0===r.length?(0,n.jsx)(jo,{text:(0,o.__)("User has no tasks","quicktasker")}):d&&0===d.length?(0,n.jsx)(jo,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-card-grid",children:d.map((e=>(0,n.jsxs)(Eo,{className:"wpqt-cursor-pointer",title:e.name,description:e.description,dropdown:(0,n.jsx)(fu,{taskId:e.id,onUnAssignTask:u}),onClick:()=>{i({type:U,payload:{taskToEdit:e}})},children:[(0,n.jsx)("div",{className:"wpqt-mt-2 wpqt-mb-2 wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:(0,n.jsx)(Oi,{task:e,onUserAdd:t=>{c({type:tt,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{c({type:st,payload:{taskId:e.id,user:t}})}})}),(0,n.jsx)(So,{task:e,onDoneStatusChange:(e,t)=>{c({type:at,payload:{taskId:e,done:t}})}})]},e.id)))}),(0,n.jsx)(vo,{editTaskCallback:e=>{c({type:Ze,payload:e})}})]})}function xu({userId:e}){return(0,n.jsx)(pu,{userId:e,children:(0,n.jsxs)(La,{children:[(0,n.jsx)(d,{description:(0,o.__)("Tasks assigned to user","quicktasker"),children:(0,o.__)("User tasks","quicktasker")}),(0,n.jsx)(hu,{}),(0,n.jsx)(_u,{userId:e})]})})}const gu=()=>{const{page:e,hash:t}=vu();if("wp-quick-tasks"===e){const e=t.match(/^#\/users\/(\d+)\/tasks$/);if(e){const t=e[1];return(0,n.jsx)(xu,{userId:t})}const s=t.match(/^#\/users\/(\d+)$/);if(s){const e=s[1];return(0,n.jsx)(gd,{userId:e})}switch(t){case"#/users":return(0,n.jsx)(ru,{});case"#/overview":return(0,n.jsx)(cr,{});case"#/archive":return(0,n.jsx)(Lo,{});case"#/user-sessions":return(0,n.jsx)(Id,{});case"#/logs":return(0,n.jsx)(Qo,{});case"#/settings":return(0,n.jsx)(od,{});case"#/guide":return(0,n.jsx)(Mo,{});case"#/user-page-link":return(0,n.jsx)(cd,{});default:return(0,n.jsx)(Oc,{})}}},vu=()=>({page:new URLSearchParams(window.location.search).get("page"),hash:window.location.hash}),ju=function(){const e=(()=>{const[e,t]=(0,a.useState)(gu());return(0,a.useEffect)((()=>{const e=()=>{t(gu()),(()=>{const{page:e,hash:t}=vu();if("wp-quick-tasks"!==e)return;const s=document.querySelectorAll("#toplevel_page_wp-quick-tasks .wp-submenu li");s.forEach((e=>e.classList.remove("wpqt-current")));const a={"#/users":"#/users","#/overview":"#/overview","#/archive":"#/archive","#/user-sessions":"#/user-sessions","#/user-page-link":"#/user-page-link","#/logs":"#/logs","#/settings":"#/settings","#/guide":"#/guide",default:""};let n=a.default;void 0!==a[t]?n=a[t]:/^#\/users(\/\d+)?(\/tasks)?$/.test(t)&&(n="#/users"),s.forEach((e=>{const t=e.querySelector("a");t&&t.getAttribute("href")&&t.getAttribute("href")===`admin.php?page=wp-quick-tasks${n}`&&e.classList.add("wpqt-current")}))})()};return e(),window.addEventListener("popstate",e),window.addEventListener("hashchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("hashchange",e)}}),[]),e})();return(0,n.jsx)(c,{children:(0,n.jsx)(un,{children:(0,n.jsx)(Ya,{children:(0,n.jsx)(Hs,{children:(0,n.jsx)(ba,{children:(0,n.jsxs)(vs,{children:[e,(0,n.jsx)(i.N9,{position:"bottom-right",className:"wpqt-z-[999999]"})]})})})})})})};(0,a.render)((0,n.jsx)(ju,{}),document.getElementById("wpqt-app"))},1609:e=>{e.exports=window.React},5795:e=>{e.exports=window.ReactDOM},790:e=>{e.exports=window.ReactJSXRuntime}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}};return a[e].call(s.exports,s,s.exports,i),s.exports}i.m=a,e=[],i.O=(t,s,a,n)=>{if(!s){var o=1/0;for(d=0;d<e.length;d++){for(var[s,a,n]=e[d],r=!0,c=0;c<s.length;c++)(!1&n||o>=n)&&Object.keys(i.O).every((e=>i.O[e](s[c])))?s.splice(c--,1):(r=!1,n<o&&(o=n));if(r){e.splice(d--,1);var l=a();void 0!==l&&(t=l)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,a,n]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var n=Object.create(null);i.r(n);var o={};t=t||[null,s({}),s([]),s(s)];for(var r=2&a&&e;"object"==typeof r&&!~t.indexOf(r);r=s(r))Object.getOwnPropertyNames(r).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(n,o),n},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=524,(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");if(s.length)for(var a=s.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=s[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={524:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var a,n,[o,r,c]=s,l=0;if(o.some((t=>0!==e[t]))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(c)var d=c(i)}for(t&&t(s);l<o.length;l++)n=o[l],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(d)},s=globalThis.webpackChunkquicktasker=globalThis.webpackChunkquicktasker||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.nc=void 0;var o=i.O(void 0,[96],(()=>i(1969)));o=i.O(o)})();