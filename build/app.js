(()=>{"use strict";var e,t,s,n={9323:(e,t,s)=>{const n=window.wp.element;var a=s(790),i=s(9571);const o=window.wp.i18n;class r extends n.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){var e;return this.state.hasError?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-h-screen wpqt-items-center wpqt-justify-center wpqt-text-center wpqt-text-lg",children:[(0,o.__)("Something went wrong. Please refresh the page.","quicktasker"),(0,a.jsx)("br",{}),null===(e=this.state.error)||void 0===e?void 0:e.message]}):this.props.children}}const c=r;function l({children:e,description:t=null,icon:s=null}){return(0,a.jsx)("div",{className:"wpqt-mb-6 wpqt-inline-grid wpqt-grid-cols-[auto_auto] wpqt-items-center wpqt-gap-2",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{children:[e,s&&(0,a.jsx)("span",{className:"wpqt-ml-1 wpqt-align-middle",children:s})]}),t&&(0,a.jsx)("div",{children:t})]})})}const d=window.wp.apiFetch;var u=s.n(d);function p(){return{"Content-Type":"application/json","X-WPQT-API-Nonce":window.wpqt.apiNonce}}function h(e,t,s){const n=new URLSearchParams({typeId:e,type:t,isPrivate:s.toString()}).toString();return u()({path:`/wpqt/v1/comments?${n}`,method:"GET",headers:p()})}function w(e,t,s,n){return u()({path:"/wpqt/v1/comments",data:{comment:n,typeId:e,type:t,isPrivate:s},method:"POST",headers:p()})}function v(e,t){const s=new URLSearchParams({typeId:e,type:t});return u()({path:`/wpqt/v1/logs?${s.toString()}`,method:"GET",headers:p()})}function x(e,t){return u()({path:`/wpqt/v1/users/${e}/tasks`,method:"DELETE",data:{task_id:t},headers:p()})}const q="SET_LOADING",f="SET_PIPELINE",m="ADD_TASK",g="ADD_STAGE",j="DELETE_STAGE",k="EDIT_TASK",_="EDIT_STAGE",y="ADD_PIPELINE",b="EDIT_PIPELINE",S="SET_PRIMARY",C="SET_PIPELINES",O="ADD_USER_TO_TASK",T="REMOVE_USER_FROM_TASK",N="CHANGE_TASK_DONE_STATUS",E="REMOVE_PIPELINE",A="REMOVE_ACTIVE_PIPELINE",P="OPEN_EDIT_TASK_MODAL",I="CLOSE_TASK_MODAL",D="OPEN_NEW_STAGE_MODAL",R="CLOSE_STAGE_MODAL",U="OPEN_STAGE_EDIT_MODAL",L="OPEN_NEW_PIPELINE_MODAL",F="OPEN_EDIT_PIPELINE_MODAL",M="CLOSE_PIPELINE_EDIT_MODAL",z="CLOSE_USER_MODAL",$="OPEN_EDIT_USER_MODAL",V="ADD_ASSIGNED_USER_TO_EDITING_TASK",H="REMOVE_ASSIGNED_USER_FROM_EDITING_TASK",B="CHANGE_USER_SETTINGS_MODAL_OPEN",G="SET_ARCHIVE_TASKS",K="SET_ARCHIVE_SEARCH_VALUE",W="SET_ARCHIVE_FILTERED_PIPELINE",Q="REMOVE_ARCHIVED_TASK",Y="ADD_ASSIGNED_USER_TO_ARCHIVED_TASK",X="REMOVE_ASSINGED_USER_FROM_ARCHIVED_TASK",J="CHANGE_ARCHIVED_TASK_DONE_STATUS",Z="EDIT_ARCHIVED_TASK",ee="CHANGE_ARCHIVE_TASK_DONE_FILTER",te="SET_USERS",se="ADD_USER",ne="SET_USERS_SEARCH_VALUE",ae="EDIT_USER",ie="DELETE_USER",oe="CHANGE_USER_STATUS",re="RESET_PASSWORD",ce="INIT_APP_STATE",le="SET_CUSTOM_USER_PAGE_STYLES",de="SET_FULL_PAGE_LOADING",ue="SET_USER_SESSIONS_SEARCH_VALUE",pe="SET_USER_SESSIONS",he="CHANGE_USER_SESSION_STATUS",we="DELETE_USER_SESSION",ve="SET_USER_TASKS",xe="SET_USER_TASKS_SEARCH_VALUE",qe="REMOVE_USER_TASK",fe="EDIT_USER_TASK",me="SET_USER_TASKS_FILTERED_PIPELINE",ge="ADD_ASSIGNED_USER_TO_USER_TASK",je="REMOVE_ASSIGNED_USER_FROM_USER_TASK",ke="CHANGE_USER_TASK_DONE_STATUS",_e="SET_CUSTOM_FIELDS",ye="ADD_CUSTOM_FIELD",be="DELETE_CUSTOM_FIELD",Se="SET_CUSTOM_FIELD_LOADING",Ce="SET_CUSTOM_FIELD_INITIAL_DATA",Oe=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active,has_password:"1"===e.has_password}),Te=e=>Object.assign(Object.assign({},e),{task_order:Number(e.task_order),free_for_all:"1"===e.free_for_all,is_archived:"1"===e.is_archived,is_done:"1"===e.is_done,assigned_users:e.assigned_users?e.assigned_users.map((e=>Object.assign({},Oe(e)))):[]}),Ne=(e,t)=>{var s,n,a,i,o;switch(t.type){case G:{const s=t.payload;return Object.assign(Object.assign({},e),{archivedTasks:s.map(Te)})}case K:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveSearchValue:s})}case W:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveFilteredPipelineId:s})}case Q:{const n=(null!==(s=e.archivedTasks)&&void 0!==s?s:[]).filter((e=>e.id!==t.payload));return Object.assign(Object.assign({},e),{archivedTasks:n})}case Y:{const{taskId:s,user:a}=t.payload,i=(null!==(n=e.archivedTasks)&&void 0!==n?n:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:[a,...e.assigned_users]}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case X:{const{taskId:s,user:n}=t.payload,i=(null!==(a=e.archivedTasks)&&void 0!==a?a:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:e.assigned_users.filter((e=>e.id!==n.id))}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case J:{const{taskId:s,done:n}=t.payload,a=(null!==(i=e.archivedTasks)&&void 0!==i?i:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{archivedTasks:a})}case Z:{const s=t.payload,n=(null!==(o=e.archivedTasks)&&void 0!==o?o:[]).map((e=>e.id===s.id?Te(s):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case ee:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskDoneFilter:s})}default:return e}};var Ee,Ae,Pe;!function(e){e.Task="task",e.User="user"}(Ee||(Ee={})),function(e){e.System="system",e.Admin="admin",e.WPQTUser="quicktasker_user"}(Ae||(Ae={})),function(e){e.All="all",e.Completed="completed",e.NotCompleted="not completed"}(Pe||(Pe={}));const Ie=(e,t)=>{if(t.type===de){const s=t.payload;return Object.assign(Object.assign({},e),{fullPageLoading:s})}return e},De={fullPageLoading:!1},Re=(0,n.createContext)({state:De,loadingDispatch:()=>{}}),Ue=({children:e})=>{const[t,s]=(0,n.useReducer)(Ie,De);return(0,a.jsx)(Re.Provider,{value:{state:t,loadingDispatch:s},children:e})};const Le={archivedTasks:null,archiveLoading:!1,archiveSearchValue:"",archiveFilteredPipelineId:"",archiveTaskDoneFilter:Pe.All},Fe=(0,n.createContext)({state:Le,archiveDispatch:()=>{}}),Me=({children:e})=>{const[t,s]=(0,n.useReducer)(Ne,Le),{loadingDispatch:r}=(0,n.useContext)(Re);(0,n.useEffect)((()=>{c()}),[]);const c=()=>{return e=void 0,t=void 0,a=function*(){try{r({type:de,payload:!0});const{data:e}=yield u()({path:"/wpqt/v1/tasks/archived",method:"GET",headers:p()});s({type:G,payload:e})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch archived tasks","quicktasker"))}finally{r({type:de,payload:!1})}},new((n=void 0)||(n=Promise))((function(s,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}));var e,t,n,a};return(0,a.jsx)(Fe.Provider,{value:{state:t,archiveDispatch:s},children:e})};var ze=s(6061);function $e({width:e="80",height:t="80",className:s=""}){return(0,a.jsx)(ze.BM,{visible:!0,height:t,width:e,color:"#1d4ed8",secondaryColor:"#2563eb",ariaLabel:"oval-loading",wrapperStyle:{},wrapperClass:s})}function Ve(){return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-flex-col wpqt-items-center wpqt-justify-center",children:(0,a.jsx)($e,{})})}function He({className:e,ovalSize:t}){const s=t?{width:t,height:t}:{};return(0,a.jsx)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center ${e}`,children:(0,a.jsx)($e,Object.assign({},s))})}function Be({children:e}){const{state:{fullPageLoading:t}}=(0,n.useContext)(Re);return(0,a.jsx)("div",{className:"wpqt-pr-4",children:t?(0,a.jsx)(Ve,{}):e})}var Ge=s(2912);const Ke=e=>Object.assign(Object.assign({},e),{allow_only_last_stage_task_done:"1"===e.allow_only_last_stage_task_done}),We=e=>Object.assign(Object.assign({},e),{stage_order:Number(e.stage_order),tasks:(e.tasks||[]).map((e=>Object.assign({},Te(e))))}),Qe=(e,t)=>{var s;switch(t.type){case C:{const s=t.payload,n=e=>Object.assign({},We(e)),a=e=>{var t;return Object.assign(Object.assign({},e),{stages:null===(t=e.stages)||void 0===t?void 0:t.map(n),settings:e.settings?Ke(e.settings):void 0,is_primary:"1"===e.is_primary})};return Object.assign(Object.assign({},e),{pipelines:s.map(a)})}case y:{const n=t.payload,a=e=>Object.assign({},We(e)),i=Object.assign(Object.assign({},n),{stages:null===(s=n.stages)||void 0===s?void 0:s.map(a),settings:n.settings?Ke(n.settings):void 0,is_primary:!1});return Object.assign(Object.assign({},e),{pipelines:[...e.pipelines,i]})}case S:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>Object.assign(Object.assign({},e),{is_primary:e.id===s})))})}case b:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>e.id===s.id?s:e))})}case E:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.filter((e=>e.id!==s))})}default:return e}},Ye={pipelines:[]},Xe=(0,n.createContext)({state:Ye,pipelinesDispatch:()=>{}}),Je=({children:e})=>{const[t,s]=(0,n.useReducer)(Qe,Ye);return(0,n.useEffect)((()=>{const e=window.wpqt.initialPipelines;s({type:C,payload:e})}),[]),(0,a.jsx)(Xe.Provider,{value:{state:t,pipelinesDispatch:s},children:e})};var Ze=s(3482);function et({options:e,selectedOptionValue:t,onSelectionChange:s,allSelector:n=!0,className:i=""}){return(0,a.jsxs)(Ze.l,{value:t,onChange:e=>{const t=e.target.value;s(t)},className:`!wpqt-rounded-lg !wpqt-border !wpqt-border-solid !wpqt-border-qtBorder !wpqt-px-2 !wpqt-pr-6 !wpqt-py-1 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`,children:[n&&(0,a.jsx)("option",{value:"",children:"All boards"}),e.map((e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value)))]})}function tt({selectedOptionValue:e,selectionChange:t,extraOptions:s=[]}){const{state:{pipelines:i}}=(0,n.useContext)(Xe),o=(0,n.useMemo)((()=>i.map((e=>({value:e.id,label:e.name})))),[i]);return(0,a.jsx)(et,{options:[...o,...s],selectedOptionValue:e,onSelectionChange:t})}function st({children:e,title:t}){return(0,a.jsxs)("div",{className:"wpqt-mb-8",children:[(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-text-base",children:t}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:e})]})}function nt(){const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s},archiveDispatch:i}=(0,n.useContext)(Fe);return(0,a.jsxs)(st,{title:(0,o.__)("Archive filtering","quicktasker"),children:[(0,a.jsx)(Ge.p,{type:"text",value:e,onChange:e=>{i({type:K,payload:e.target.value})}}),(0,a.jsx)(tt,{selectedOptionValue:t,selectionChange:e=>{i({type:W,payload:e})},extraOptions:[{value:"DELETED",label:(0,o.__)("DELETED","quicktasker")}]}),(0,a.jsx)(et,{allSelector:!1,selectedOptionValue:s,options:[{label:(0,o.__)("All status","quicktasker"),value:Pe.All},{label:(0,o.__)("Completed","quicktasker"),value:Pe.Completed},{label:(0,o.__)("Not completed","quicktasker"),value:Pe.NotCompleted}],onSelectionChange:e=>{const t=(e=>{switch(e){case Pe.All:return Pe.All;case Pe.Completed:return Pe.Completed;case Pe.NotCompleted:return Pe.NotCompleted;default:throw new Error(`Invalid selection: ${e}`)}})(e);i({type:ee,payload:t})}})]})}var at=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const it=()=>({deleteTask:(e,t)=>at(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}`,method:"DELETE",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task deleted","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a task","quicktasker"))}})),archiveTask:(e,t)=>at(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task archived","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to archive a task","quicktasker"))}})),restoreArchivedTask:(e,t)=>at(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive-restore`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task restored","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore a task","quicktasker"))}})),removeTaskFromUser:(e,t,s)=>at(void 0,void 0,void 0,(function*(){try{yield x(e,t),s&&s(),i.oR.success((0,o.__)("Task has been unassigned","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Task unassignment failed. Try again","quicktasker"))}})),changeTaskDoneStatus:(e,t,s)=>at(void 0,void 0,void 0,(function*(){try{const n=t?(0,o.__)("Task marked as completed","quicktasker"):(0,o.__)("Task marked as incomplete","quicktasker");yield function(e,t){return u()({path:`/wpqt/v1/tasks/${e}/done`,method:"PATCH",data:{done:t},headers:p()})}(e,t),s&&s(t),i.oR.success(n)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change task status","quicktasker"))}}))}),ot=(e,t)=>{var s,n,a,i,o,r,c,l,d;switch(t.type){case q:return Object.assign(Object.assign({},e),{loading:t.payload});case f:{const s=t.payload,n=(s.stages||[]).map((e=>Object.assign({},We(e)))),a=s.settings?Ke(s.settings):void 0;return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},s),{stages:n,settings:a,is_primary:"1"===s.is_primary})})}case"MOVE_TASK":{if(!e.activePipeline||!e.activePipeline.stages)return e;const s=((e,t,s)=>{const n=[...e],a=n.find((e=>e.id===t.droppableId)),i=n.find((e=>e.id===s.droppableId));if((null==a?void 0:a.tasks)&&(null==i?void 0:i.tasks)){const[e]=a.tasks.splice(t.index,1);i.tasks.splice(s.index,0,e)}return n})(e.activePipeline.stages,t.payload.source,t.payload.destination);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:s})})}case"REORDER_TASK":{const{source:a,destination:i}=t.payload,o=i.droppableId,r=i.index;if(!e.activePipeline)return e;const c=null===(s=e.activePipeline.stages)||void 0===s?void 0:s.find((e=>e.id===o));if(!c||!c.tasks)return e;const l=((e,t,s)=>{const n=[...e],[a]=n.splice(t,1);return n.splice(s,0,a),n})(c.tasks,a.index,r),d=null===(n=e.activePipeline.stages)||void 0===n?void 0:n.map((e=>e.id===o?Object.assign(Object.assign({},e),{tasks:l}):e));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:d})})}case m:{const s=Te(t.payload);return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(a=e.activePipeline.stages)||void 0===a?void 0:a.map((e=>e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:[...e.tasks||[],s]}):e))})}):e}case k:{const s=Te(t.payload);if(!e.activePipeline)return e;const n=null===(i=e.activePipeline.stages)||void 0===i?void 0:i.map((e=>{var t;return e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s.id?s:e))}):e}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case g:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:[...e.activePipeline.stages||[],s]})}):e}case _:{const s=t.payload;if(!e.activePipeline)return e;const n=e=>e.id===s.id?Object.assign(Object.assign({},e),{name:s.name,description:s.description}):e,a=null===(o=e.activePipeline.stages)||void 0===o?void 0:o.map(n);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case j:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(r=e.activePipeline.stages)||void 0===r?void 0:r.filter((e=>e.id!==s))})}):e}case O:{const{taskId:s,user:n}=t.payload;if(!e.activePipeline)return e;const a=null===(c=e.activePipeline.stages)||void 0===c?void 0:c.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:[n,...e.assigned_users||[]]}):e));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case T:{const{taskId:s,userId:n}=t.payload;if(!e.activePipeline)return e;const a=null===(l=e.activePipeline.stages)||void 0===l?void 0:l.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{var t;return e.id===s?Object.assign(Object.assign({},e),{assigned_users:null===(t=e.assigned_users)||void 0===t?void 0:t.filter((e=>e.id!==n))}):e}));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case b:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{name:s.name,description:s.description,is_primary:"1"===s.is_primary})}):e}case N:{const{taskId:s,done:n}=t.payload;if(!e.activePipeline)return e;const a=null===(d=e.activePipeline.stages)||void 0===d?void 0:d.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case A:return Object.assign(Object.assign({},e),{activePipeline:null});default:return e}};const rt={loading:!1,activePipeline:null},ct=(0,n.createContext)({state:rt,dispatch:()=>{},fetchAndSetPipelineData:()=>Promise.resolve()}),lt=({children:e})=>{const[t,s]=(0,n.useReducer)(ot,rt),{loadingDispatch:r}=(0,n.useContext)(Re);(0,n.useEffect)((()=>{const e=window.wpqt.initialActivePipelineId;e&&l(e,!0)}),[]);const c=(e,t)=>{t?r({type:de,payload:e}):s({type:q,payload:e})},l=(e,...t)=>{return n=void 0,a=[e,...t],l=function*(e,t=!1){try{c(!0,t);const{data:{pipeline:n}}=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,headers:p()})}(e);s({type:f,payload:n})}catch(e){console.error(e),i.oR.error((0,o.__)("Unable to load the board. Please try again later.","quicktasker"))}finally{c(!1,t)}},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,i)}o((l=l.apply(n,a||[])).next())}));var n,a,r,l};return(0,a.jsx)(ct.Provider,{value:{state:t,dispatch:s,fetchAndSetPipelineData:l},children:e})},dt=()=>Object.assign({},pt),ut=(e,t)=>{var s,n,a,i;switch(t.type){case P:{const{taskToEdit:s,taskModalSettings:n}=t.payload;return Object.assign(Object.assign({},e),{taskModalOpen:!0,taskToEdit:s,targetStageId:s.stage_id,taskModalSettings:Object.assign(Object.assign({},e.taskModalSettings),n)})}case I:return dt();case V:{const a=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:[a,...null!==(n=null===(s=e.taskToEdit)||void 0===s?void 0:s.assigned_users)&&void 0!==n?n:[]]})})}case H:{const s=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:(null!==(i=null===(a=e.taskToEdit)||void 0===a?void 0:a.assigned_users)&&void 0!==i?i:[]).filter((e=>e.id!==s.id))})})}case D:{const{targetPipelineId:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,targetPipelineId:s})}case U:{const{stageToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,stageToEdit:s})}case R:return dt();case L:return Object.assign(Object.assign({},e),{newPipelineModalOpen:!0});case F:{const{pipelineToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{pipelineModalOpen:!0,pipelineToEdit:s})}case M:return dt();case"OPEN_ARCHIVE_TASK_MODAL":{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskModalOpen:!0,archiveModalTask:s})}case"CLOSE_ARCHIVE_TASK_MODAL":return dt();case"OPEN_NEW_USER_MODAL":return Object.assign(Object.assign({},e),{userModalOpen:!0});case $:{const s=t.payload;return Object.assign(Object.assign({},e),{userModalOpen:!0,userToEdit:s})}case z:return dt();case B:return t.payload?Object.assign(Object.assign({},e),{userSettingsModalOpen:!0}):dt();case"CHANGE_TASK_DONE_STATUS":{const{done:s}=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{is_done:s})})}default:return e}},pt={taskModalOpen:!1,targetStageId:"",taskToEdit:null,taskModalSettings:{allowToMarkTaskAsDone:!0},stageModalOpen:!1,stageToEdit:null,targetPipelineId:"",pipelineModalOpen:!1,newPipelineModalOpen:!1,pipelineToEdit:null,archiveTaskModalOpen:!1,archiveModalTask:null,userModalOpen:!1,userToEdit:null,userSettingsModalOpen:!1},ht=(0,n.createContext)({state:pt,modalDispatch:()=>{}}),wt=({children:e})=>{const[t,s]=(0,n.useReducer)(ut,pt);return(0,a.jsx)(ht.Provider,{value:{state:t,modalDispatch:s},children:e})},vt=(e,t)=>{switch(t.type){case te:{const s=t.payload.map(Oe);return Object.assign(Object.assign({},e),{users:s})}case se:{const s=t.payload,n=Oe(s);return Object.assign(Object.assign({},e),{users:[...e.users,n]})}case ae:{const s=t.payload,n=Oe(s),a=e.users.map((e=>e.id===n.id?n:e));return Object.assign(Object.assign({},e),{users:a})}case oe:{const{isActive:s,userId:n}=t.payload,a=e.users.map((e=>e.id===n?Object.assign(Object.assign({},e),{is_active:s}):e));return Object.assign(Object.assign({},e),{users:a})}case re:{const s=t.payload,n=e.users.map((e=>e.id===s?Object.assign(Object.assign({},e),{has_password:!1}):e));return Object.assign(Object.assign({},e),{users:n})}case ie:{const s=t.payload,n=e.users.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{users:n})}case ne:{const s=t.payload;return Object.assign(Object.assign({},e),{usersSearchValue:s})}default:return e}};var xt=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const qt={users:[],usersSearchValue:""},ft=(0,n.createContext)({state:qt,userDispatch:()=>{},updateUsers:()=>xt(void 0,void 0,void 0,(function*(){}))}),mt=({children:e})=>{const[t,s]=(0,n.useReducer)(vt,qt);return(0,n.useEffect)((()=>{const e=window.wpqt.initialUsers;s({type:te,payload:e})}),[]),(0,a.jsx)(ft.Provider,{value:{state:t,userDispatch:s,updateUsers:()=>xt(void 0,void 0,void 0,(function*(){try{const e=yield u()({path:"/wpqt/v1/users",method:"GET",headers:p()});s({type:te,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch users","quicktasker"))}}))},children:e})};var gt;!function(e){e.ACTIVE_PIPELINE="ACTIVE_PIPELINE",e.PIPELINES="PIPELINES",e.USER="USER"}(gt||(gt={}));const jt=e=>{const[t,s]=(0,n.useState)(!1),a=(0,n.useRef)(null),{modalDispatch:i}=(0,n.useContext)(ht),{dispatch:o}=(0,n.useContext)(ct),{pipelinesDispatch:r}=(0,n.useContext)(Xe),{userDispatch:c}=(0,n.useContext)(ft),l=()=>{i({type:e}),d()},d=()=>{a.current&&a.current.clearContent()};return{modalSaving:t,setModalSaving:s,modalContentRef:a,closeModal:l,handleSuccess:(e,t,n)=>{let a;switch(n){case gt.PIPELINES:a=r;break;case gt.ACTIVE_PIPELINE:a=o;break;case gt.USER:a=c;break;default:a=o}s(!1),a({type:e,payload:t}),l()},handleError:e=>{s(!1),console.error(e)}}};var kt,_t=s(2922),yt=s(6053),bt=s(9828),St=s(540),Ct=s(4576),Ot=s(3223),Tt=s(7008);function Nt({id:e}){return(0,a.jsx)(Tt.m_,{id:e,className:"wpqt-bg-red-600",children:(0,a.jsx)("span",{children:"Tooltip content"})})}function Et({icon:e,text:t,onClick:s=()=>{},className:n,tooltipId:i,tooltipText:o,loading:r=!1}){const c=o&&i,l=c?{"data-tooltip-id":i,"data-tooltip-content":o,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-main-border wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-bg-gray-100 wpqt-p-2 hover:wpqt-bg-white ${n}`,onClick:s,children:[e,t&&(0,a.jsx)("span",{className:"wpqt-whitespace-nowrap "+(r?"wpqt-invisible":""),children:t}),r&&(0,a.jsx)($e,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-y-center wpqt-transform-x-center"}),c&&(0,a.jsx)(Nt,{id:i})]}))}function At({modalOpen:e,closeModal:t,children:s,size:n="sm"}){return(0,a.jsxs)(_t.lG,{open:e,as:"div",className:"wpqt-relative wpqt-z-9999 focus:wpqt-outline-none",onClose:t,children:[(0,a.jsx)(_t.Xi,{className:"wpqt-fixed wpqt-inset-0 wpqt-bg-black/40"}),(0,a.jsx)("div",{className:"wpqt-fixed wpqt-inset-0 wpqt-z-10 wpqt-w-screen wpqt-overflow-y-auto",children:(0,a.jsx)("div",{className:"wpqt-mt-[8vh] wpqt-flex wpqt-justify-center",children:(0,a.jsxs)(_t.Lj,{transition:!0,className:`data-[closed]:wpqt-transform-[wpqt-scale(95%)] wpqt-relative wpqt-mt-[20px] wpqt-w-4/5 ${{sm:"wpqt-max-w-sm",md:"wpqt-max-w-lg",lg:"wpqt-max-w-4xl",xl:"wpqt-max-w-6xl"}[n]} wpqt-rounded-xl wpqt-bg-white wpqt-p-8 wpqt-backdrop-blur-2xl wpqt-duration-300 wpqt-ease-out data-[closed]:wpqt-opacity-0`,children:[(0,a.jsx)("div",{className:"wpqt-group wpqt-absolute wpqt-right-[-20px] wpqt-top-[-20px] wpqt-flex wpqt-h-[40px] wpqt-w-[40px] wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-rounded-full wpqt-border wpqt-border-solid wpqt-bg-white wpqt-text-qtBorder",onClick:t,children:(0,a.jsx)(Ct.A,{className:"wpqt-icon-blue group-hover:wpqt-icon-red wpqt-size-5"})}),s]})})})]})}function Pt({children:e}){return(0,a.jsx)(_t.L3,{as:"div",className:"wpqt-text-base/7 wpqt-font-medium wpqt-text-black",children:e})}function It({children:e}){return(0,a.jsx)(yt.L,{children:e})}function Dt({label:e,children:t,tooltipId:s,tooltipText:n}){const i=s&&n,o=i?{"data-tooltip-id":s,"data-tooltip-content":n,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info","data-tooltip-place":"top-end"}:{};return(0,a.jsxs)(bt.D,{className:"wpqt-mb-3",children:[(0,a.jsx)(St.JU,Object.assign({className:"wpqt-mb-2 wpqt-block wpqt-text-sm/6 wpqt-font-medium"},o,{children:e})),t,i&&(0,a.jsx)(Nt,{id:s})]})}function Rt({onSave:e,saveBtnText:t,loading:s=!1}){return(0,a.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-justify-end",children:(0,a.jsx)(Et,{text:t,loading:s,icon:(0,a.jsx)(Ot.RZ0,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:e})})}!function(e){e.BUTTON="button",e.SUBMIT="submit",e.RESET="reset"}(kt||(kt={}));var Ut=s(1489),Lt=s(8448),Ft=s(8176),Mt=s(1052);function zt(){const[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)(!1),[i,o]=(0,n.useState)(!1);return{loading1:e,loading2:s,setLoading1:t,setLoading2:a,loading3:i,setLoading3:o}}const $t=(e,t)=>{switch(t.type){case"SET_SITE_URL":{const s=t.payload;return Object.assign(Object.assign({},e),{siteURL:s})}case ce:{const{siteURL:s,publicUserPageId:n,timezone:a,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r}=t.payload;return Object.assign(Object.assign({},e),{siteURL:s,publicUserPageId:n,timezone:a,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r})}case le:{const s=t.payload;return Object.assign(Object.assign({},e),{userPageCustomStyles:s})}default:return e}},Vt={siteURL:"",pluginURL:"",publicUserPageId:"",is_customFields:!1,timezone:"",isUserAllowedToDelete:!1,userPageCustomStyles:""},Ht=(0,n.createContext)({state:Vt,appDispatch:()=>{}}),Bt=({children:e})=>{const[t,s]=(0,n.useReducer)($t,Vt);return(0,n.useEffect)((()=>{const e=window.wpqt.siteURL,t=window.wpqt.publicUserPageId,n=window.wpqt.timezone,a="1"===window.wpqt.isUserAllowedToDelete,i=window.wpqt.userPageCustomStyles,o=window.wpqt.pluginURL;s({type:ce,payload:{siteURL:e,publicUserPageId:t,timezone:n,isUserAllowedToDelete:a,userPageCustomStyles:i,pluginURL:o}})}),[]),(0,a.jsx)(Ht.Provider,{value:{state:t,appDispatch:s},children:e})};var Gt,Kt,Wt;!function(e){e.Text="text",e.Select="select",e.Checkbox="checkbox",e.Radio="radio",e.Datetime="datetime",e.File="file"}(Gt||(Gt={})),function(e){e.User="user",e.Pipeline="pipeline",e.Users="users",e.Task="task"}(Kt||(Kt={})),function(e){e.TEXT="text",e.PASSWORD="password"}(Wt||(Wt={}));const Qt=(0,n.forwardRef)((({value:e,onChange:t,isAutoFocus:s,className:n="",wrapperClassName:i="",disabled:o=!1,type:r=Wt.TEXT,loading:c=!1},l)=>(0,a.jsxs)("div",{className:`wpqt-inline-block wpqt-relative wpqt-mb-3 ${i}`,children:[(0,a.jsx)(Ge.p,{ref:l,autoFocus:s,className:`wpqt-block wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${n}`,value:e,disabled:o,onChange:e=>t(e.target.value),type:r}),c&&(0,a.jsx)($e,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"})]})));var Yt=s(1062),Xt=s(4164);function Jt({value:e,onChange:t,rowsCount:s=3,className:n}){return(0,a.jsx)(Yt.T,{className:(0,Xt.$)("wpqt-border-1 wpqt-mb-3 wpqt-block wpqt-resize-none wpqt-rounded-lg wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6",`focus:wpqt-shadow-none focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${n}`),rows:s,value:e,onChange:e=>t(e.target.value)})}var Zt=s(303);function es({checked:e,handleChange:t}){return(0,a.jsx)(Zt.A,{onChange:t,checked:e,uncheckedIcon:!1,checkedIcon:!1,height:20,width:44})}const ts=(e,t)=>{switch(t.type){case Se:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case Ce:{const{entityId:s,entityType:n}=t.payload;return Object.assign(Object.assign({},e),{entityId:s,entityType:n})}case _e:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:s})}case ye:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:[...e.customFields,s]})}case be:{const s=t.payload,n=e.customFields.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{customFields:n})}default:return e}};const ss={customFields:[],loading:!0,entityId:"",entityType:null},ns=(0,n.createContext)({state:ss,customFieldsDispatch:()=>{},fetchCustomFields:()=>{}}),as=({children:e,entityId:t,entityType:s})=>{const[r,c]=(0,n.useReducer)(ts,ss);(0,n.useEffect)((()=>{l()}),[]),(0,n.useEffect)((()=>{c({type:Ce,payload:{entityType:s,entityId:t}})}),[s,t]);const l=()=>{return e=void 0,n=void 0,r=function*(){try{c({type:Se,payload:!0});const e=yield function(e,t){const s=new URLSearchParams({entityId:e,entityType:t});return u()({path:`/wpqt/v1/custom-fields?${s.toString()}`,method:"GET",headers:p()})}(t,s);c({type:_e,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch custom fields","quicktasker"))}finally{c({type:Se,payload:!1})}},new((a=void 0)||(a=Promise))((function(t,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}));var e,n,a,r};return(0,a.jsx)(ns.Provider,{value:{state:r,customFieldsDispatch:c,fetchCustomFields:l},children:e})};var is=s(9197),os=s(2767),rs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function cs(){return{addCustomField:(e,t,s,n,a,r)=>rs(this,void 0,void 0,(function*(){try{const i=yield function(e,t,s,n,a){return u()({path:"/wpqt/v1/custom-fields",method:"POST",data:{entityId:e,entityType:t,type:s,name:n,description:a},headers:p()})}(e,t,s,n,a);r&&r(i.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add a custom field","quicktasker"))}})),markCustomFieldAsDeleted:(e,t)=>rs(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/custom-fields/${e}`,method:"DELETE",headers:p()})}(e),t&&t()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to mark custom field as deleted","quicktasker"))}})),updateCustomFieldValue:(e,t,s,n,a)=>rs(this,void 0,void 0,(function*(){try{yield function(e,t,s,n){return u()({path:`/wpqt/v1/custom-fields/${e}/value`,method:"PATCH",data:{value:t,entityId:String(s),entityType:n},headers:p()})}(e,t,s,n),a&&a()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to update custom field value","quicktasker"))}}))}}var ls=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ds({description:e}){const[t,s]=(0,n.useState)(""),[i,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(Gt.Text),{addCustomField:p}=cs(),{state:{entityId:h,entityType:w},customFieldsDispatch:v}=(0,n.useContext)(ns),[x,q]=(0,n.useState)(!1),f=[{value:Gt.Text,label:"Text"},{value:Gt.Checkbox,label:"Checkbox"}];return(0,a.jsxs)("div",{className:"wpqt-mb-6 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)("h2",{children:(0,o.__)("Custom Fields","quicktasker")}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:e}),c&&(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Name","quicktasker")}),(0,a.jsx)(Qt,{value:t,onChange:s})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Description","quicktasker")}),(0,a.jsx)(Jt,{value:i,onChange:r})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Type","quicktasker")}),(0,a.jsx)(et,{selectedOptionValue:d,options:f,onSelectionChange:e=>{u(e)},allSelector:!1})]})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,a.jsx)(Et,{text:c?(0,o.__)("Cancel","quicktasker"):(0,o.__)("Add new custom field","quicktasker"),onClick:()=>l(!c),icon:c?(0,a.jsx)(is.A,{className:"wpqt-icon-red wpqt-size-5"}):(0,a.jsx)(os.A,{className:"wpqt-icon-green wpqt-size-5"})}),c&&(0,a.jsx)(Et,{text:(0,o.__)("Add","quicktasker"),onClick:()=>ls(this,void 0,void 0,(function*(){h&&w?(q(!0),yield p(h,w,d,t,i,(e=>{v({type:ye,payload:e}),s(""),r(""),u(Gt.Text),l(!1)})),q(!1)):console.error("Entity ID or Entity Type is missing")})),loading:x,icon:(0,a.jsx)(os.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]})}var us=s(72),ps=s(2601),hs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ws({data:e,onSave:t,locationOfCustomFields:s,onDelete:i,actionLoading:r}){const{state:{isUserAllowedToDelete:c}}=(0,n.useContext)(Ht),l=e.entity_type===s,d=s===Kt.Task||s===Kt.User,u=e.entity_type===Kt.Pipeline?"board":e.entity_type;return r?(0,a.jsx)(He,{ovalSize:"24"}):(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-gap-2",children:[d&&(0,a.jsx)(Et,{onClick:t,icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-green wpqt-size-4"}),tooltipId:`custom-field-${e.id}-update`,tooltipText:(0,o.__)("Edit custom field value","quicktasker")}),c&&(0,a.jsx)(Et,Object.assign({onClick:()=>hs(this,void 0,void 0,(function*(){l&&i()})),className:l?"":"!wpqt-cursor-not-allowed",icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-4"})},!l&&{tooltipId:`custom-field-${e.id}-delete`,tooltipText:(0,o.sprintf)((0,o.__)("This custom field is inherited from %s settings and can't be deleted here","quicktasker"),u)}))]})}var vs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function xs({data:e}){const[t,s]=(0,n.useState)(""),{state:{entityType:i,entityId:o},customFieldsDispatch:r}=(0,n.useContext)(ns),{updateCustomFieldValue:c,markCustomFieldAsDeleted:l}=cs(),[d,u]=(0,n.useState)(!1);let p;switch((0,n.useEffect)((()=>{e.value&&s(e.value)}),[e.value]),e.type){case Gt.Text:p=(0,a.jsx)(qs,{data:e,value:t,onChange:s});break;case Gt.Checkbox:p=(0,a.jsx)(fs,{data:e,value:t,onChange:s})}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{}),p,(0,a.jsx)(ws,{data:e,locationOfCustomFields:i,onSave:()=>vs(this,void 0,void 0,(function*(){i===Kt.User||i===Kt.Task?(u(!0),yield c(e.id,t,o,i),u(!1)):console.error("Invalid entity type for saving custom field value")})),onDelete:()=>vs(this,void 0,void 0,(function*(){u(!0),yield l(e.id,(()=>{r({type:be,payload:e.id})})),u(!1)})),actionLoading:d})]})}function qs({data:e,value:t,onChange:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center",children:[(0,a.jsx)(ms,{name:e.name,description:e.description}),(0,a.jsx)(Qt,{value:t,onChange:s})]})}function fs({data:e,value:t,onChange:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)(ms,{name:e.name,description:e.description}),(0,a.jsx)("input",{type:"checkbox",checked:"true"===t,className:"!wpqt-block",onChange:e=>s(e.target.checked?"true":"false")})]})}function ms({name:e,description:t=""}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-mb-1 wpqt-text-base wpqt-font-semibold",children:e}),t&&(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-italic",children:t})]})}function gs(){const{state:{loading:e,customFields:t}}=(0,n.useContext)(ns),[s,i]=(0,n.useState)(!1);return e?(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)($e,{width:"36",height:"36"})}):t&&0===t.length?(0,a.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No related custom fields created","quicktasker")}):s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-my-6 wpqt-grid wpqt-grid-cols-[100px_1fr_100px] wpqt-items-center wpqt-gap-3",children:t.map((e=>(0,a.jsx)(xs,{data:e},e.id)))}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Et,{text:(0,o.__)("Close","quicktasker"),onClick:()=>i(!1),icon:(0,a.jsx)(us.A,{className:"wpqt-icon-red wpqt-size-5"})})})]}):(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Et,{text:(0,o.__)("Show custom fields","quicktasker"),onClick:()=>i(!0),icon:(0,a.jsx)(us.A,{className:"wpqt-icon-blue wpqt-size-5"})})})}function js(){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center wpqt-h-full",children:[(0,a.jsx)("h2",{className:"wpqt-font-semibold",children:(0,o.__)("Custom fields")}),(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-4",children:(0,o.__)("Premium feature to create and manage custom data fields. Allows to add extra data to tasks and users.")}),(0,a.jsx)("div",{className:"wpqt-text-blue-500 wpqt-font-semibold",children:(0,a.jsx)("a",{href:"https://payhip.com/b/84TLC",target:"_blank",rel:"noreferrer",children:(0,o.__)("Get the premium version","quicktasker")})})]})}const ks={[Kt.User]:(0,o.__)("Add custom fields to this user only.","quicktasker"),[Kt.Users]:(0,o.__)("Add custom fields to all users. If you want to add custom fields to a specific user, please go to that user settings.","quicktasker"),[Kt.Pipeline]:(0,o.__)("Add custom fields to all tasks in this board.","quicktasker"),[Kt.Task]:(0,o.__)("Add custom fields to this task only. If you want to add custom fields to all tasks in this board, please go to board settings.","quicktasker")},_s={[Kt.User]:(0,o.__)("Add custom fields to this user only.","quicktasker"),[Kt.Users]:(0,o.__)("Add custom fields to all users. If you want to add custom fields to a specific user, please go to that user settings.","quicktasker"),[Kt.Pipeline]:(0,o.__)("Add custom fields to all tasks in this board.","quicktasker"),[Kt.Task]:(0,o.__)("Custom fields applied to this task, including both task-specific and board-level fields.","quicktasker")},ys={[Kt.User]:(0,o.__)("User custom fields","quicktasker"),[Kt.Users]:(0,o.__)("Users custom fields","quicktasker"),[Kt.Pipeline]:(0,o.__)("Board custom fields","quicktasker"),[Kt.Task]:(0,o.__)("Task custom fields","quicktasker")};function bs({entityId:e,entityType:t}){const{state:{is_customFields:s}}=(0,n.useContext)(Ht),i=ks[t],o=ys[t],r=_s[t];return(0,a.jsx)(a.Fragment,{children:s?(0,a.jsx)("div",{children:(0,a.jsxs)(as,{entityId:e,entityType:t,children:[(0,a.jsx)(ds,{description:i}),(0,a.jsx)("h2",{className:"wpqt-text-center",children:o}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:r}),(0,a.jsx)(gs,{})]})}):(0,a.jsx)(js,{})})}var Ss=s(2792),Cs=s(6797),Os=s(4403),Ts=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ns({task:e,onUserAdd:t,onUserDelete:s}){const{state:{users:r}}=(0,n.useContext)(ft),{dispatch:c}=(0,n.useContext)(ct),[l,d]=(0,n.useState)(!1),h=r.filter((t=>{var s;return!(null!==(s=e.assigned_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))}));return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,a.jsx)(Es,{sectionTitle:(0,o.__)("Assigned users","quicktasker"),users:e.assigned_users,onItemSelect:t=>Ts(this,void 0,void 0,(function*(){try{d(!0),yield x(t.id,e.id),c({type:T,payload:{taskId:e.id,userId:t.id}}),s(t)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to remove user","quicktasker"))}finally{d(!1)}})),ActionIcon:Cs.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No users assigned","quicktasker")}),(0,a.jsx)(Es,{sectionTitle:(0,o.__)("Assign a user","quicktasker"),users:h,onItemSelect:s=>Ts(this,void 0,void 0,(function*(){try{d(!0),yield(n=s.id,a=e.id,u()({path:`/wpqt/v1/users/${n}/tasks`,method:"POST",data:{task_id:a},headers:p()})),c({type:O,payload:{taskId:e.id,user:s}}),t(s)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to assign user","quicktasker"))}finally{d(!1)}var n,a})),actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No users available to assign","quicktasker")}),l&&(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)($e,{width:"30",height:"30"})})]})}function Es({sectionTitle:e,onItemSelect:t=()=>{},users:s=[],ActionIcon:n=Os.A,actionIconClasses:i,noUsersText:o}){return(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-text-lg",children:e}),s.map((e=>(0,a.jsxs)("div",{onClick:s=>{s.stopPropagation(),t(e)},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-px-2 wpqt-py-1 hover:wpqt-bg-gray-100",children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,a.jsx)("div",{children:e.name}),(0,a.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,a.jsx)(n,{className:`wpqt-ml-auto wpqt-size-5 ${i}`})]},e.id))),0===s.length&&(0,a.jsx)("div",{children:o})]})}var As=s(2185);function Ps({children:e,menuBtn:t,menuBtnClasses:s="",anchor:n="bottom end"}){return(0,a.jsxs)(As.W1,{children:[(0,a.jsx)(As.IU,{as:"div",className:`wpqt-cursor-pointer ${s}`,onClick:e=>e.stopPropagation(),children:({active:e})=>(0,a.jsx)(a.Fragment,{children:t({active:e})})}),(0,a.jsx)(As.c,{anchor:n,transition:!0,className:"wpqt-z-20 wpqt-origin-top wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-white wpqt-p-4 wpqt-transition wpqt-duration-200 wpqt-ease-out data-[closed]:wpqt-scale-95 data-[closed]:wpqt-opacity-0",children:e})]})}function Is({isActive:e,IconComponent:t}){return(0,a.jsx)(t,{className:"wpqt-size-6 wpqt-text-gray-400 hover:wpqt-text-qtBlueHover "+(e?"wpqt-text-qtBlueHover":"")})}function Ds({text:e,onClick:t,icon:s,className:n,disabled:i=!1,id:o="",tooltipText:r="",loading:c=!1}){const l=""!==r&&""!==o?{"data-tooltip-id":o,"data-tooltip-content":r,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsx)(As.Dr,{children:(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-relative ${i?"wpqt-cursor-not-allowed wpqt-line-through":"wpqt-cursor-pointer hover:wpqt-underline"} ${n}`,onClick:e=>{!i&&t&&t(e)},children:[s,(0,a.jsx)("span",{className:c?"wpqt-invisible":"",children:e}),c&&(0,a.jsx)($e,{width:"16",height:"16",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-y-center wpqt-transform-x-center"}),(0,a.jsx)(Nt,{id:o})]}))})}function Rs({task:e,onUserAdd:t=()=>{},onUserDelete:s=()=>{},menuBtnClasses:n=""}){const i=e.assigned_users&&e.assigned_users.length>0;return(0,a.jsx)(Ps,{menuBtnClasses:`wpqt-inline-flex ${n}`,anchor:"bottom start",menuBtn:()=>(0,a.jsxs)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:[(0,a.jsx)(Ss.A,{className:`wpqt-mr-1 wpqt-size-5 ${i?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`}),e.assigned_users&&(0,a.jsx)("div",{children:e.assigned_users.map(((t,s)=>(0,a.jsxs)("span",{children:[t.name,s<e.assigned_users.length-1&&", "]},t.id)))})]}),children:(0,a.jsx)(Ns,{task:e,onUserAdd:t,onUserDelete:s})})}var Us=s(1848);function Ls({tabs:e,tabsContent:t}){return(0,a.jsxs)(Us.fu,{children:[(0,a.jsx)(Us.wb,{className:"wpqt-mb-6 wpqt-flex wpqt-border-0 wpqt-border-b wpqt-border-solid wpqt-border-b-gray-300",children:e.map((e=>(0,a.jsx)(Fs,{children:e},e)))}),(0,a.jsx)(Us.T2,{children:t.map(((e,t)=>(0,a.jsx)(Ms,{children:e},t)))})]})}function Fs({children:e}){return(0,a.jsx)(Us.oz,{as:"div",className:"wpqt-flex-1 wpqt-cursor-pointer wpqt-p-1 wpqt-pb-[10px] wpqt-text-center wpqt-text-lg data-[selected]:wpqt-border-b-2 data-[selected]:wpqt-border-l-0 data-[selected]:wpqt-border-r-0 data-[selected]:wpqt-border-t-0 data-[selected]:wpqt-border-solid data-[selected]:wpqt-border-b-blue-500",children:e})}function Ms({children:e}){return(0,a.jsx)(Us.Kp,{children:e})}var zs=s(4353),$s=s.n(zs),Vs=s(8569),Hs=s.n(Vs),Bs=s(3826),Gs=s.n(Bs);$s().extend(Gs()),$s().extend(Hs());const Ks=()=>{const{state:{timezone:e}}=(0,n.useContext)(Ht);return{convertToWPTimezone:t=>((e,t)=>{try{return $s().utc(e).tz(t).format("MMMM D, YYYY HH:mm")}catch(t){return console.error("Error: ",t),e+" (UTC)"}})(t,e)}},Ws=({log:e})=>{const{convertToWPTimezone:t}=Ks();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,a.jsx)("div",{className:"wpqt-text-center",children:e.created_by===Ae.Admin?(0,o.__)("Admin","quicktasker"):(0,o.__)("QuickTasker","quicktasker")})]}),(0,a.jsx)("div",{children:e.text}),(0,a.jsx)("div",{children:t(e.created_at)})]})};var Qs=s(3338),Ys=s(3211),Xs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Js({typeId:e,fetchData:t,renderItem:s,noDataMessage:i,explanation:o,onAdd:r=()=>Xs(this,void 0,void 0,(function*(){})),enableAdd:c=!1}){const[l,d]=(0,n.useState)(null),[u,p]=(0,n.useState)(""),[h,w]=(0,n.useState)(!0),[v,x]=(0,n.useState)(!1);(0,n.useEffect)((()=>{q()}),[e]);const q=()=>Xs(this,void 0,void 0,(function*(){w(!0);const e=yield t();e&&d(e),w(!1)}));return null===l?(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)($e,{width:"30",height:"30"})}):(0,a.jsxs)("div",{children:[o&&(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center wpqt-font-semibold",children:o}),0===l.length&&(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center",children:i}),l.length>0&&(0,a.jsx)("div",{className:"wpqt-mb-[28px] wpqt-mt-[56px] wpqt-logs-grid",children:l.map((e=>s(e)))}),(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Zs,{isLoading:h,refreshComemnts:q})}),c&&(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsxs)("div",{className:"wpqt-w-2/3",children:[(0,a.jsx)(Jt,{rowsCount:3,value:u,onChange:e=>p(e),className:"wpqt-mb-4 wpqt-w-full"}),(0,a.jsx)(Et,{text:"Add comment",loading:v,onClick:()=>Xs(this,void 0,void 0,(function*(){x(!0);const e=yield r(u);e&&(d((t=>t?[...t,e]:[e])),p("")),x(!1)})),className:"wpqt-float-right",icon:(0,a.jsx)(Qs.A,{className:"wpqt-icon-blue wpqt-size-5"})})]})})]})}function Zs({isLoading:e,refreshComemnts:t}){return(0,a.jsx)(a.Fragment,{children:e?(0,a.jsx)($e,{width:"32",height:"32"}):(0,a.jsx)(Ys.A,{className:"wpqt-icon-blue wpqt-size-8 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:t})})}function en({item:e}){const{convertToWPTimezone:t}=Ks();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,a.jsx)("div",{className:"wpqt-text-center",children:e.is_admin_comment?(0,o.__)("Admin","quicktasker"):(0,o.__)("QuickTasker","quicktasker")})]}),(0,a.jsx)("div",{children:e.text}),(0,a.jsx)("div",{children:t(e.created_at)})]})}var tn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function sn({taskId:e}){return(0,a.jsx)(Js,{typeId:e,fetchData:()=>tn(this,void 0,void 0,(function*(){try{return(yield v(e,Ee.Task)).data}catch(e){console.error(e),i.oR.error("Failed to get log")}})),renderItem:e=>(0,a.jsx)(Ws,{log:e}),noDataMessage:"No logs available",explanation:"Logs can be seen only by WordPress users (with required permissions)"})}var nn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function an(){return{addComment:(e,t,s,n)=>nn(this,void 0,void 0,(function*(){try{const a=yield w(e,t,s,n);return i.oR.success((0,o.__)("Comment added","quicktasker")),a.data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add comment","quicktasker"))}}))}}const on=e=>Object.assign(Object.assign({},e),{is_admin_comment:"1"===e.is_admin_comment});var rn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function cn({taskId:e}){const{addComment:t}=an();return(0,a.jsx)(Js,{typeId:e,fetchData:()=>rn(this,void 0,void 0,(function*(){try{return(yield h(e,Ee.Task,!0)).data.map(on)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>rn(this,void 0,void 0,(function*(){const n=yield t(e,Ee.Task,!0,s);if(n)return on(n)})),renderItem:e=>(0,a.jsx)(en,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed only by WordPress users (with required permissions).",enableAdd:!0})}var ln=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function dn({taskId:e}){const{addComment:t}=an();return(0,a.jsx)(Js,{typeId:e,fetchData:()=>ln(this,void 0,void 0,(function*(){try{return(yield h(e,Ee.Task,!1)).data.map(on)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>ln(this,void 0,void 0,(function*(){const n=yield t(e,Ee.Task,!1,s);if(n)return on(n)})),renderItem:e=>(0,a.jsx)(en,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed by WordPress users (with required permissions) and QuickTasker users who have been assigned to the task.",enableAdd:!0})}function un({task:e}){return(0,a.jsx)(Ls,{tabs:["Private comments","Public comments","Logs"],tabsContent:[(0,a.jsx)(cn,{taskId:e.id},1),(0,a.jsx)(dn,{taskId:e.id},2),(0,a.jsx)(sn,{taskId:e.id},3)]})}var pn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const hn=(0,n.forwardRef)((({taskModalSaving:e,editTask:t,deleteTask:s},i)=>{const{state:{taskToEdit:r,taskModalSettings:c},modalDispatch:l}=(0,n.useContext)(ht),{state:{isUserAllowedToDelete:d}}=(0,n.useContext)(Ht),{state:{activePipeline:u},fetchAndSetPipelineData:p}=(0,n.useContext)(ct),{archiveDispatch:h}=(0,n.useContext)(Fe),[w,v]=(0,n.useState)(""),[x,q]=(0,n.useState)(""),[f,m]=(0,n.useState)(!1),{archiveTask:g,restoreArchivedTask:j}=it(),{loading1:k,setLoading1:_,loading2:y,setLoading2:b}=zt(),S=null==r?void 0:r.is_archived,C=null!==(null==r?void 0:r.pipeline_name);(0,n.useEffect)((()=>{r&&(v(r.name),q(r.description),m(r.free_for_all))}),[r]);const O=()=>{v(""),q("")};return(0,n.useImperativeHandle)(i,(()=>({clearContent:O}))),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,a.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsxs)(It,{children:[(0,a.jsx)(Dt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Qt,{isAutoFocus:!0,value:w,onChange:e=>v(e)})}),(0,a.jsx)(Dt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Jt,{rowsCount:3,value:x,onChange:e=>q(e)})}),(0,a.jsx)(Dt,{label:(0,o.__)("Assigned users","quicktasker"),children:(0,a.jsx)(Rs,{task:r,onUserAdd:e=>{l({type:V,payload:e})},onUserDelete:e=>{l({type:H,payload:e})}})}),(0,a.jsx)(Dt,{label:(0,o.__)("Free for all task","quicktasker"),tooltipId:`free-for-all-${r.id}-tooltip`,tooltipText:(0,o.__)("When enabled, all QuickTasker users have the ability to self-assign or unassign this task.","quicktasker"),children:(0,a.jsx)(es,{checked:f,handleChange:m})}),c.allowToMarkTaskAsDone&&(0,a.jsx)(wn,{taskId:r.id,isCompleted:r.is_done})]}),(0,a.jsx)("div",{children:(0,a.jsx)(bs,{entityId:r.id,entityType:Kt.Task})})]}),(0,a.jsx)("div",{className:"wpqt-mt-7 md:wpqt-pr-3",children:(0,a.jsx)(un,{task:r})})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[S&&C&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ut.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Restore task","quicktasker"),onClick:()=>{j(r.id,(()=>{l({type:I}),h({type:Q,payload:r.id})}))}}),!S&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Lt.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("Archive task","quicktasker"),loading:y,onClick:()=>{b(!0),g(r.id,(()=>{l({type:I}),p(u.id),b(!1)}))}}),d&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete task","quicktasker"),loading:k,onClick:()=>pn(void 0,void 0,void 0,(function*(){_(!0),yield s(r),l({type:I}),_(!1)}))})]})]}),(0,a.jsx)(Rt,{onSave:()=>{r&&t(Object.assign(Object.assign({},r),{name:w,description:x,free_for_all:f}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));function wn({isCompleted:e,taskId:t}){const{modalDispatch:s}=(0,n.useContext)(ht),{dispatch:i}=(0,n.useContext)(ct),[r,c]=(0,n.useState)(!1),{changeTaskDoneStatus:l}=it();return(0,a.jsx)(Dt,{label:e?(0,o.__)("Task completed","quicktasker"):(0,o.__)("Task not completed","quicktasker"),children:r?(0,a.jsx)($e,{width:"24",height:"24"}):(0,a.jsx)(Mt.A,{onClick:()=>pn(this,void 0,void 0,(function*(){c(!0),yield l(t,!e,(e=>{s({type:N,payload:{done:e}}),i({type:N,payload:{taskId:t,done:e}})})),c(!1)})),className:`wpqt-size-6 ${e?"wpqt-icon-green":"wpqt-text-gray-300"} wpqt-cursor-pointer`})})}var vn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function xn({editTaskCallback:e,deleteTaskCallback:t}){const{state:{taskModalOpen:s}}=(0,n.useContext)(ht),{deleteTask:i}=it(),{modalSaving:o,setModalSaving:r,modalContentRef:c,closeModal:l,handleSuccess:d,handleError:h}=jt(I);return(0,a.jsx)(At,{modalOpen:s,closeModal:l,size:"xl",children:(0,a.jsx)(hn,{ref:c,editTask:t=>vn(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e){return u()({path:`/wpqt/v1/tasks/${e.id}`,method:"PATCH",data:{id:e.id,name:e.name,description:e.description,freeForAll:e.free_for_all},headers:p()})}(t);d(k,s.data,gt.ACTIVE_PIPELINE),e&&e(s.data)}catch(e){h(e)}})),deleteTask:e=>vn(this,void 0,void 0,(function*(){i(e.id,(()=>{t&&t(e)}))})),taskModalSaving:o})})}function qn({text:e=(0,o.__)("No results found","quicktasker")}){return(0,a.jsx)("div",{className:"wpqt-font-semibold",children:e})}const fn=()=>{const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s}}=(0,n.useContext)(Fe);return{filterArchive:n=>{const a=n.name.toLowerCase().includes(e.toLowerCase())||n.description&&n.description.toLowerCase().includes(e.toLowerCase()),i=!t||("DELETED"===t?null===n.pipeline_name:n.pipeline_id===t),o=s===Pe.All||s===Pe.Completed&&n.is_done||s===Pe.NotCompleted&&!n.is_done;return a&&i&&o}}};var mn=s(3033);function gn({className:e,onClick:t,title:s,description:n,children:i,dropdown:o}){const r=void 0!==o;return(0,a.jsxs)("div",{className:(0,Xt.$)("wpqt-relative wpqt-flex wpqt-flex-col wpqt-rounded wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-4",r&&"wpqt-pr-[24px]",e),onClick:t,children:[(0,a.jsxs)("div",{className:"wpqt-mb-3",children:[(0,a.jsx)("div",{className:"wpqt-text-lg",children:s}),n&&(0,a.jsx)("div",{className:"wpqt-italic wpqt-text-gray-500",children:n})]}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-h-full",children:i}),r&&(0,a.jsx)("div",{className:"wpqt-absolute wpqt-right-2 wpqt-top-1 wpqt-z-10",children:o})]})}function jn({label:e,value:t,valueClassName:s="",valueLink:n,icon:i,onClick:o=()=>{},className:r="",labelClassName:c=""}){return(0,a.jsxs)("div",{className:`wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center ${r}`,onClick:o,children:[i&&i,(0,a.jsx)("div",{className:c,children:t?`${e}:`:e}),(0,a.jsx)("div",{className:`${s}`,children:n?(0,a.jsx)("a",{href:n,target:"_blank",className:"wpqt-text-qtTextBlue wpqt-no-underline",rel:"noreferrer",onClick:e=>e.stopPropagation(),children:t}):t})]})}var kn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function _n({task:e,onDoneStatusChange:t,className:s=""}){const{changeTaskDoneStatus:i}=it(),[o,r]=(0,n.useState)(!1),c=e.is_done,l=s=>kn(this,void 0,void 0,(function*(){r(!0),yield i(e.id,s,(s=>{t(e.id,s)})),r(!1)}));return o?(0,a.jsx)(He,{ovalSize:"24",className:"wpqt-mt-auto"}):(0,a.jsx)("div",{className:`wpqt-flex wpqt-justify-center wpqt-mt-auto ${s}`,children:c?(0,a.jsx)(Mt.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,a.jsx)(Mt.A,{className:"wpqt-size-6 wpqt-text-gray-300",onClick:e=>{e.stopPropagation(),l(!0)}})})}var yn=s(6436),bn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Sn({task:e}){const{state:{isUserAllowedToDelete:t}}=(0,n.useContext)(Ht),{archiveDispatch:s}=(0,n.useContext)(Fe),{deleteTask:i,restoreArchivedTask:o}=it(),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),u=null!==e.pipeline_name;return(0,a.jsxs)(Ps,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:yn.A}),children:[(0,a.jsx)(Ds,{text:"View task",icon:(0,a.jsx)(us.A,{className:"wpqt-icon-blue wpqt-size-4"})}),(0,a.jsx)(Ds,{text:"Restore task",loading:r,icon:(0,a.jsx)(Ut.A,{className:"wpqt-icon-green wpqt-size-4"}),disabled:!u,id:`restore-task-${e.id}-dropdown-item`,tooltipText:"Task cannot be restored because the board has been deleted.",onClick:t=>bn(this,void 0,void 0,(function*(){t.stopPropagation(),c(!0),yield o(e.id,(()=>{s({type:Q,payload:e.id})})),c(!1)}))}),t&&(0,a.jsx)(Ds,{text:"Delete",loading:l,icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>bn(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield i(e.id,(()=>{s({type:Q,payload:e.id})})),d(!1)})),className:"!wpqt-mb-0"})]})}function Cn({task:e}){const{modalDispatch:t}=(0,n.useContext)(ht),{archiveDispatch:s}=(0,n.useContext)(Fe);return(0,a.jsxs)(gn,{title:e.name,description:e.description,dropdown:(0,a.jsx)(Sn,{task:e}),className:"wpqt-cursor-pointer",onClick:()=>{t({type:P,payload:{taskToEdit:e}})},children:[(0,a.jsx)(jn,{label:(0,o.__)("Board","quicktasker"),value:e.pipeline_name?e.pipeline_name:(0,o.__)("Board is deleted!","quicktasker"),icon:(0,a.jsx)(mn.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(Rs,{menuBtnClasses:"wpqt-self-start",task:e,onUserAdd:t=>{s({type:Y,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{s({type:X,payload:{taskId:e.id,user:t}})}}),(0,a.jsx)(_n,{task:e,onDoneStatusChange:(e,t)=>{s({type:J,payload:{taskId:e,done:t}})}})]})}function On(){var e;const{state:{archivedTasks:t=[]}}=(0,n.useContext)(Fe),{filterArchive:s}=fn(),i=null!==(e=null==t?void 0:t.filter(s))&&void 0!==e?e:[];return t&&0===t.length?(0,a.jsx)(qn,{text:(0,o.__)("No tasks archived","quicktasker")}):i&&0===i.length?(0,a.jsx)(qn,{}):(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"wpqt-card-grid",children:i.map((e=>(0,a.jsx)(Cn,{task:e},e.id)))})})}function Tn(){const{state:{archivedTasks:e},archiveDispatch:t}=(0,n.useContext)(Fe);return e?(0,a.jsxs)("div",{children:[(0,a.jsx)(nt,{}),(0,a.jsx)(On,{}),(0,a.jsx)(xn,{editTaskCallback:e=>{t({type:Z,payload:e})},deleteTaskCallback:e=>{t({type:Q,payload:e.id})}})]}):(0,a.jsx)(He,{className:"wpqt-h-[200px]"})}function Nn(){return(0,a.jsx)(Me,{children:(0,a.jsxs)(Be,{children:[(0,a.jsx)(l,{description:(0,o.__)("Archived tasks management page.","quicktasker"),children:(0,o.__)("Archive","quicktasker")}),(0,a.jsx)(Tn,{})]})})}const En=()=>{const{state:{pluginURL:e}}=(0,n.useContext)(Ht);return(0,a.jsxs)(Be,{children:[(0,a.jsx)(l,{description:(0,o.__)("Reading material about QuickTasker features and usage.","quicktasker"),children:(0,o.__)("Guide","quicktasker")}),(0,a.jsx)("div",{children:(0,a.jsx)("a",{target:"_blank",rel:"noreferrer",href:e+"help/index.html",children:(0,o.__)("View Guide","quicktasker")})})]})};var An=s(4175);const Pn=({filterSettings:e,setFilterSettings:t})=>{const{state:{pipelines:s}}=(0,n.useContext)(Xe),[i,r]=(0,n.useState)(e);return(0,a.jsxs)(st,{title:(0,o.__)("Logs filtering","quicktasker"),children:[(0,a.jsx)(et,{allSelector:!1,selectedOptionValue:i.type,options:[{label:(0,o.__)("All types","quicktasker"),value:Dn.All},{label:(0,o.__)("Board","quicktasker"),value:Dn.Pipeline},{label:(0,o.__)("Stage","quicktasker"),value:Dn.Stage},{label:(0,o.__)("Task","quicktasker"),value:Dn.Task}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{type:e,typeId:""}))}}),i.type===Dn.Pipeline&&(0,a.jsx)(et,{allSelector:!0,selectedOptionValue:i.typeId,options:s.map((e=>({label:e.name,value:e.id}))),onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{typeId:e}))}}),(0,a.jsx)(et,{allSelector:!1,selectedOptionValue:i.createdBy,options:[{label:(0,o.__)("Everyone","quicktasker"),value:Rn.All},{label:(0,o.__)("Admin","quicktasker"),value:Rn.Admin},{label:"QuickTasker",value:Rn.Quicktasker}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{createdBy:e}))}}),(0,a.jsx)(et,{allSelector:!1,selectedOptionValue:i.numberOfLogs,options:[{label:(0,o.__)("Show 100","quicktasker"),value:Ln.Hundred},{label:(0,o.__)("Show 200","quicktasker"),value:Ln.TwoHundred},{label:"Show 500",value:Ln.FiveHundred},{label:"Show all",value:Ln.All}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{numberOfLogs:e}))}}),(0,a.jsx)(et,{allSelector:!1,selectedOptionValue:i.order,options:[{label:(0,o.__)("ASC","quicktasker"),value:Un.Asc},{label:(0,o.__)("DESC","quicktasker"),value:Un.Desc}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{order:e}))}}),(0,a.jsx)(Et,{text:(0,o.__)("Apply filter","quicktasker"),icon:(0,a.jsx)(An.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:()=>t(i)})]})},In=({logs:e,loading:t})=>t?(0,a.jsx)(He,{ovalSize:"64",className:"wpqt-mt-12"}):(0,a.jsx)("div",{className:"wpqt-logs-grid",children:e.map((e=>(0,a.jsx)(Ws,{log:e},e.id)))});var Dn,Rn,Un,Ln,Fn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};!function(e){e.Pipeline="pipeline",e.Stage="stage",e.Task="task",e.All="all"}(Dn||(Dn={})),function(e){e.Admin="admin",e.Quicktasker="quicktasker_user",e.All="all"}(Rn||(Rn={})),function(e){e.Asc="asc",e.Desc="desc"}(Un||(Un={})),function(e){e.Hundred="100",e.TwoHundred="200",e.FiveHundred="500",e.All="all"}(Ln||(Ln={}));const Mn=()=>{const[e,t]=(0,n.useState)([]),[s,o]=(0,n.useState)({numberOfLogs:Ln.Hundred,type:Dn.All,typeId:"",createdBy:Rn.All,order:Un.Desc}),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!0);(0,n.useEffect)((()=>{l&&(h(),d(!1))}),[s,l]);const h=()=>Fn(void 0,void 0,void 0,(function*(){try{c(!0);const e=Object.assign({},s);e.numberOfLogs===Ln.All&&delete e.numberOfLogs,e.type===Dn.All&&delete e.type,""===e.typeId&&delete e.typeId,e.createdBy===Rn.All&&delete e.createdBy;const n=yield function(e){const t=new URLSearchParams(Object.entries(e).reduce(((e,[t,s])=>(e[t]=String(s),e)),{}));return u()({path:`/wpqt/v1/global-logs?${t.toString()}`,method:"GET",headers:p()})}(e);t(n.data)}catch(e){console.error(e),i.oR.error("Failed to fetch logs")}finally{c(!1)}}));return(0,a.jsxs)("div",{children:[(0,a.jsx)(Pn,{filterSettings:s,setFilterSettings:e=>Fn(void 0,void 0,void 0,(function*(){o(e),d(!0)}))}),(0,a.jsx)(In,{logs:e,loading:r})]})},zn=()=>(0,a.jsxs)(Be,{children:[(0,a.jsx)(l,{description:(0,o.__)("The logs page where you can see all logs and filter them.","quicktasker"),children:(0,o.__)("Logs","quicktasker")}),(0,a.jsx)(Mn,{})]});function $n(){return(0,a.jsxs)(Be,{children:[(0,a.jsx)(l,{children:"Overview"}),(0,a.jsx)("p",{children:"This is the overview page."})]})}const Vn=(0,n.forwardRef)((({addPipeline:e,modalSaving:t},s)=>{const[i,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(""),d=()=>{r(""),l("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:d}))),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(It,{children:[(0,a.jsx)(Dt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Qt,{isAutoFocus:!0,value:i,onChange:e=>r(e)})}),(0,a.jsx)(Dt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Jt,{rowsCount:3,value:c,onChange:e=>l(e)})})]}),(0,a.jsx)(Rt,{onSave:()=>{e(i,c)},loading:t,saveBtnText:(0,o.__)("Add board","quicktasker")})]})}));function Hn(){const{state:{newPipelineModalOpen:e}}=(0,n.useContext)(ht),{fetchAndSetPipelineData:t}=(0,n.useContext)(ct),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=jt(M);return(0,a.jsx)(At,{modalOpen:e,closeModal:r,children:(0,a.jsx)(Vn,{ref:o,addPipeline:(e,s)=>{return n=this,a=void 0,r=function*(){try{i(!0);const o=yield(n=e,a=s,u()({path:"/wpqt/v1/pipelines",method:"POST",data:{name:n,description:a},headers:p()}));c(y,o.data,gt.PIPELINES),t(o.data.id)}catch(e){l(e)}var n,a},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{c(r.next(e))}catch(e){t(e)}}function i(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,i)}c((r=r.apply(n,a||[])).next())}));var n,a,o,r},modalSaving:s,setModalSaving:i})})}function Bn(){return{deletePipeline:(e,t)=>{return s=this,n=void 0,r=function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,method:"DELETE",headers:p()})}(e);t&&t(s.data.deletedPipelineId,s.data.pipelineIdToLoad)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete board","quicktasker"))}},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{c(r.next(e))}catch(e){t(e)}}function o(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(i,o)}c((r=r.apply(s,n||[])).next())}));var s,n,a,r}}}const Gn=(0,n.forwardRef)((({editPipeline:e,modalSaving:t},s)=>{const{state:{pipelineToEdit:r},modalDispatch:c}=(0,n.useContext)(ht),{fetchAndSetPipelineData:l,dispatch:d}=(0,n.useContext)(ct),{pipelinesDispatch:u}=(0,n.useContext)(Xe),{deletePipeline:p}=Bn(),[h,w]=(0,n.useState)(""),[v,x]=(0,n.useState)(""),{loading1:q,setLoading1:f}=zt();(0,n.useEffect)((()=>{r&&(w(r.name),x(r.description||""))}),[r]);const m=()=>{w(""),x("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:m}))),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsx)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:(0,a.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsxs)(It,{children:[(0,a.jsx)(Dt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Qt,{isAutoFocus:!0,value:h,onChange:e=>w(e)})}),(0,a.jsx)(Dt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Jt,{rowsCount:3,value:v,onChange:e=>x(e)})})]}),(0,a.jsx)(bs,{entityId:r.id,entityType:Kt.Pipeline})]})}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:(0,a.jsx)(Et,{icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:q,text:(0,o.__)("Delete board","quicktasker"),onClick:()=>{r&&(f(!0),p(r.id,((e,t)=>{c({type:M}),f(!1),i.oR.success((0,o.__)("Board deleted","quicktasker")),u({type:E,payload:e}),null!==t?(u({type:S,payload:t}),l(t)):d({type:A})})))}})})]}),(0,a.jsx)(Rt,{onSave:()=>{r&&e(Object.assign(Object.assign({},r),{name:h,description:v}))},loading:t,saveBtnText:(0,o.__)("Save","quicktasker")})]}):null}));function Kn(){const{state:{pipelineModalOpen:e}}=(0,n.useContext)(ht),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r,handleError:c}=jt(M);return(0,a.jsx)(At,{modalOpen:e,closeModal:o,size:"xl",children:(0,a.jsx)(Gn,{ref:i,editPipeline:e=>{return t=this,n=void 0,i=function*(){try{s(!0);const t=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description,is_primary:e.is_primary},headers:p()})}(e);r(b,t.data,gt.ACTIVE_PIPELINE)}catch(e){c(e)}},new((a=void 0)||(a=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,n||[])).next())}));var t,n,a,i},modalSaving:t,setModalSaving:s})})}var Wn=s(9919);const Qn=(0,n.forwardRef)((({editStage:e,addStage:t,stageModalSaving:s},i)=>{const{state:{stageToEdit:r}}=(0,n.useContext)(ht),[c,l]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),p=!!r;(0,n.useEffect)((()=>{r&&(l(r.name),u(r.description))}),[r]);const h=()=>{l(""),u("")};return(0,n.useImperativeHandle)(i,(()=>({clearContent:h}))),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Pt,{children:p?(0,o.__)("Edit Stage","quicktasker"):(0,o.__)("Add Stage","quicktasker")}),(0,a.jsxs)(It,{children:[(0,a.jsx)(Dt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Qt,{isAutoFocus:!0,value:c,onChange:e=>l(e)})}),(0,a.jsx)(Dt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Jt,{rowsCount:3,value:d,onChange:e=>u(e)})})]}),(0,a.jsx)(Rt,{onSave:()=>{p?e(Object.assign(Object.assign({},r),{name:c,description:d})):t(c,d)},loading:s,saveBtnText:p?(0,o.__)("Save","quicktasker"):(0,o.__)("Add stage","quicktasker")})]})}));var Yn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Xn(){const{state:{stageModalOpen:e,targetPipelineId:t}}=(0,n.useContext)(ht),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=jt(R);return(0,a.jsx)(At,{modalOpen:e,closeModal:r,children:(0,a.jsx)(Qn,{ref:o,editStage:e=>Yn(this,void 0,void 0,(function*(){try{i(!0);const t=yield function(e){return u()({path:`/wpqt/v1/stages/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description},headers:p()})}(e);c(_,t.data,gt.ACTIVE_PIPELINE)}catch(e){l(e)}})),addStage:(e,s)=>Yn(this,void 0,void 0,(function*(){try{i(!0);const r=yield(n=t,a=e,o=s,u()({path:"/wpqt/v1/stages",method:"POST",data:{pipelineId:n,name:a,description:o},headers:p()}));c(g,Object.assign(Object.assign({},r.data),{tasks:[]}),gt.ACTIVE_PIPELINE)}catch(e){l(e)}var n,a,o})),stageModalSaving:s,stageTaskModalSaving:i})})}function Jn({pipelineId:e,stagesLength:t=0}){const{modalDispatch:s}=(0,n.useContext)(ht),i=()=>{return t=this,n=void 0,i=function*(){s({type:D,payload:{targetPipelineId:e}})},new((a=void 0)||(a=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,n||[])).next())}));var t,n,a,i};return 0===t?(0,a.jsx)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-w-full wpqt-items-center wpqt-justify-center",children:(0,a.jsxs)("div",{className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-gap-y-1 wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,a.jsx)(os.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,a.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add first stage","quicktasker")})]})}):(0,a.jsxs)("div",{className:"wpqt-main-border wpqt-mb-3 wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-self-start wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,a.jsx)(os.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,a.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add stage","quicktasker")})]})}function Zn(){const{modalDispatch:e}=(0,n.useContext)(ht);return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-items-center wpqt-justify-center",children:(0,a.jsxs)("div",{onClick:()=>{return t=this,s=void 0,a=function*(){e({type:L})},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:[(0,a.jsx)(os.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer"}),(0,a.jsx)("span",{children:(0,o.__)("Add your first Board","quicktasker")})]})})}var ea=s(12),ta=s(5575),sa=s(6304),na=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function aa({stage:e}){var t,s,r,c;const{dispatch:l,state:{activePipeline:d},fetchAndSetPipelineData:h}=(0,n.useContext)(ct),{modalDispatch:w}=(0,n.useContext)(ht),{state:{isUserAllowedToDelete:v}}=(0,n.useContext)(Ht),[x,q]=(0,n.useState)(!1),[f,m]=(0,n.useState)(!1),[g,k]=(0,n.useState)(!1),_=null!==(s=null===(t=null==d?void 0:d.stages)||void 0===t?void 0:t.length)&&void 0!==s?s:0,y=null!==(c=null===(r=e.tasks)||void 0===r?void 0:r.length)&&void 0!==c?c:0,b=+e.stage_order,S=b>0&&b<_,C=b!==_-1,O=t=>na(this,void 0,void 0,(function*(){try{q(!0),yield function(e,t){return u()({path:`/wpqt/v1/stages/${e}/move`,method:"PATCH",data:{direction:t},headers:p()})}(e.id,t),yield h(d.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a stage","quicktasker"))}finally{q(!1)}}));return(0,a.jsxs)(Ps,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:ea.A}),children:[S&&(0,a.jsx)(Ds,{text:(0,o.__)("Move left","quicktasker"),loading:x,icon:(0,a.jsx)(ta.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>O("left")}),C&&(0,a.jsx)(Ds,{text:(0,o.__)("Move right","quicktasker"),loading:x,icon:(0,a.jsx)(sa.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>O("right")}),(0,a.jsx)(Ds,{text:(0,o.__)("Edit stage","quicktasker"),icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:()=>{w({type:U,payload:{stageToEdit:e}})}}),(0,a.jsx)(Ds,{text:(0,o.__)("Archive all stage tasks","quicktasker"),icon:(0,a.jsx)(Lt.A,{className:"wpqt-icon-blue wpqt-size-4"}),loading:f,onClick:()=>na(this,void 0,void 0,(function*(){try{m(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}/archive-tasks`,method:"PATCH",headers:p()})),yield h(d.id),i.oR.success((0,o.sprintf)((0,o.__)("Archived all %s tasks","quicktasker"),e.name))}catch(t){console.error(t),i.oR.error((0,o.sprintf)((0,o.__)("Failed to archive stage %s tasks","quicktasker"),e.name))}finally{m(!1)}var t})),disabled:0===y,id:`item-dropdown-${e.id}-archive`,tooltipText:0===y?(0,o.__)("No tasks to archive on the stage","quicktasker"):void 0}),v&&(0,a.jsx)(Ds,{text:(0,o.__)("Delete stage","quicktasker"),icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:g,onClick:()=>na(this,void 0,void 0,(function*(){try{k(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}`,method:"DELETE",data:{stageId:t},headers:p()})),l({type:j,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a stage","quicktasker"))}finally{k(!1)}var t})),disabled:y>0,className:"!wpqt-mb-0",id:`item-dropdown-${e.id}`,tooltipText:(0,o.__)("Stage can be deleted when there are no tasks on it","quicktasker")})]})}var ia=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function oa({stageId:e}){const[t,s]=(0,n.useState)(""),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),h=(0,n.useRef)(null),w=(0,n.useRef)(null),{state:{activePipeline:v},dispatch:x}=(0,n.useContext)(ct);(0,n.useEffect)((()=>{const e=e=>{"Enter"===e.key&&document.activeElement===w.current&&q()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),(0,n.useEffect)((()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&f()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,n.useEffect)((()=>{var e;r&&(null===(e=w.current)||void 0===e||e.focus())}),[r]);const q=()=>ia(this,void 0,void 0,(function*(){if(t)try{d(!0);const s=yield function(e,t,s){return u()({path:"/wpqt/v1/tasks",method:"POST",data:{stageId:e,name:s,pipelineId:t},headers:p()})}(e,v.id,t);x({type:m,payload:s.data}),f()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create task","quicktasker"))}finally{d(!1)}else i.oR.error((0,o.__)("Task name is required","quicktasker"))})),f=()=>{c(!1),s("")};return(0,a.jsx)("div",{ref:h,className:"wpqt-sticky wpqt-bottom-0 wpqt-z-10 wpqt-order-1 wpqt-mt-2 wpqt-flex wpqt-justify-center wpqt-bg-gray-100 wpqt-py-2",children:r?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,a.jsx)(Qt,{ref:w,value:t,onChange:e=>s(e),wrapperClassName:"!wpqt-mb-0",className:"!wpqt-mb-0"}),l?(0,a.jsx)($e,{width:"24",height:"24"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(is.A,{className:"wpqt-icon-red wpqt-size-6 wpqt-cursor-pointer",onClick:f}),(0,a.jsx)(os.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer",onClick:q})]})]}):(0,a.jsxs)("div",{onClick:()=>c(!0),className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-p-2 hover:wpqt-bg-white",children:[(0,o.__)("Add task","quicktasker"),(0,a.jsx)(os.A,{className:"wpqt-size-6 wpqt-text-green-600"})]})})}var ra=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ca({task:e}){const{modalDispatch:t}=(0,n.useContext)(ht),{state:{activePipeline:s},fetchAndSetPipelineData:i}=(0,n.useContext)(ct),{state:{isUserAllowedToDelete:r}}=(0,n.useContext)(Ht),{deleteTask:c,archiveTask:l}=it(),[d,u]=(0,n.useState)(!1);return(0,a.jsxs)(Ps,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:yn.A}),children:[(0,a.jsx)(Ds,{text:(0,o.__)("Archive task","quicktasker"),icon:(0,a.jsx)(Lt.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),l(e.id,(()=>{i(s.id)}))}}),(0,a.jsx)(Ds,{text:(0,o.__)("Edit task","quicktasker"),icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:P,payload:{taskToEdit:e}})}}),r&&(0,a.jsx)(Ds,{text:(0,o.__)("Delete task","quicktasker"),icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:d,onClick:t=>ra(this,void 0,void 0,(function*(){t.stopPropagation(),u(!0),yield c(e.id,(()=>{i(s.id)})),u(!1)})),className:"!wpqt-mb-0"})]})}var la=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function da({task:e,index:t,onLastStage:s}){const{modalDispatch:i}=(0,n.useContext)(ht),{state:{activePipeline:o}}=(0,n.useContext)(ct),r=!(null==o?void 0:o.settings).allow_only_last_stage_task_done||s,c=()=>{i({type:P,payload:{taskToEdit:e,taskModalSettings:{allowToMarkTaskAsDone:r}}})};return(0,a.jsx)(Wn.sx,{draggableId:e.id,index:t,children:t=>(0,a.jsxs)("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:"wpqt-relative wpqt-mx-4 wpqt-mb-2 wpqt-flex !wpqt-cursor-pointer wpqt-flex-col wpqt-gap-1 wpqt-rounded wpqt-border wpqt-border-gray-200 wpqt-bg-white wpqt-p-3 wpqt-shadow hover:wpqt-shadow-md",onClick:c,children:[(0,a.jsx)("div",{className:"wpqt-absolute wpqt-right-[12px] wpqt-top-[12px]",children:(0,a.jsx)(ca,{task:e})}),(0,a.jsx)("div",{className:"wpqt-text-base",children:e.name}),e.description&&(0,a.jsx)("div",{className:"wpqt-text-sm wpqt-italic",children:e.description}),(0,a.jsx)("div",{className:"wpqt-mt-2",children:(0,a.jsx)(Rs,{task:e})}),(0,a.jsx)(ua,{task:e,allowToMarkTaskAsDone:r})]}))},e.id)}function ua({task:e,allowToMarkTaskAsDone:t}){const{dispatch:s}=(0,n.useContext)(ct),{changeTaskDoneStatus:i}=it(),[o,r]=(0,n.useState)(!1),c=e.is_done,l=t=>la(this,void 0,void 0,(function*(){r(!0),yield i(e.id,t,(t=>{s({type:N,payload:{taskId:e.id,done:t}})})),r(!1)}));return t?o?(0,a.jsx)(He,{ovalSize:"24"}):(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:c?(0,a.jsx)(Mt.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,a.jsx)(Mt.A,{className:"wpqt-size-6 wpqt-icon-gray",onClick:e=>{e.stopPropagation(),l(!0)}})}):null}function pa({tasks:e}){const t=e.length;return(0,a.jsx)("span",{className:"wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-1 wpqt-text-xs",children:t})}function ha({stage:e,isLastStage:t}){return(0,a.jsxs)("div",{"data-stage-id":e.id,className:"wpqt-relative wpqt-mb-3 wpqt-flex wpqt-max-h-full wpqt-w-[360px] wpqt-flex-none wpqt-flex-col wpqt-overflow-hidden wpqt-rounded-md wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-gray-100",children:[(0,a.jsxs)("div",{className:"wpqt-mb-4 wpqt-flex wpqt-flex-wrap wpqt-items-center wpqt-gap-1 wpqt-px-4 wpqt-pt-3",children:[(0,a.jsxs)("div",{className:"wpqt-mr-auto wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-text-base wpqt-leading-none",children:[e.name," ",(0,a.jsx)(pa,{tasks:e.tasks})]}),(0,a.jsx)(aa,{stage:e}),e.description&&(0,a.jsx)("div",{className:"wpqt-w-full wpqt-flex-shrink-0 wpqt-flex-grow-0 wpqt-text-sm",children:e.description})]}),(0,a.jsx)(Wn.gL,{droppableId:e.id,children:s=>{var n;return(0,a.jsxs)("div",{ref:s.innerRef,className:"wpqt-flex wpqt-h-full wpqt-flex-col wpqt-overflow-y-auto wpqt-overflow-x-hidden",children:[null===(n=e.tasks)||void 0===n?void 0:n.map(((e,s)=>(0,a.jsx)(da,{task:e,index:s,onLastStage:t},e.id))),s.placeholder,(0,a.jsx)(oa,{stageId:e.id})]})}})]})}const wa=()=>{var e,t;const{state:{activePipeline:s},dispatch:r,fetchAndSetPipelineData:c}=(0,n.useContext)(ct);(0,n.useEffect)((()=>{const e=setInterval((()=>{s&&c(s.id)}),3e4);return()=>clearInterval(e)}),[s]);const l=(e,t)=>{e.droppableId===t.droppableId?r({type:"REORDER_TASK",payload:{source:e,destination:t}}):r({type:"MOVE_TASK",payload:{source:e,destination:t}})},d=(0,n.useCallback)((e=>{return t=void 0,s=void 0,a=function*(){const{source:t,destination:s,draggableId:n}=e;if(s){l(t,s);try{yield(a=n,r=s.droppableId,c=s.index,u()({path:`/wpqt/v1/tasks/${a}/move`,method:"PATCH",data:{stageId:r,order:c},headers:p()}))}catch(e){console.error(e),l(s,t),i.oR.error((0,o.__)("Failed to move a task","quicktasker"))}var a,r,c}},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a}),[s]);return s?(0,a.jsxs)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-gap-[24px] wpqt-overflow-x-auto wpqt-overflow-y-hidden",children:[(0,a.jsx)(Wn.JY,{onDragEnd:d,children:null===(e=s.stages)||void 0===e?void 0:e.map(((e,t)=>{const n=t===s.stages.length-1;return(0,a.jsx)(ha,{stage:e,isLastStage:n},e.id)}))}),(0,a.jsx)(Jn,{pipelineId:s.id,stagesLength:null===(t=s.stages)||void 0===t?void 0:t.length}),(0,a.jsx)(xn,{deleteTaskCallback:()=>{s&&c(s.id)}}),(0,a.jsx)(Xn,{})]}):(0,a.jsx)(Zn,{})};var va=s(247),xa=s(1203),qa=s(2496),fa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ma(){const{state:{activePipeline:e},fetchAndSetPipelineData:t}=(0,n.useContext)(ct),{state:{pipelines:s},pipelinesDispatch:r}=(0,n.useContext)(Xe),{modalDispatch:c}=(0,n.useContext)(ht),l=e=>fa(this,void 0,void 0,(function*(){try{yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/set-primary`,method:"PATCH",headers:p()})),r({type:S,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to set primary board","quicktasker"))}var t}));return(0,a.jsxs)(Ps,{menuBtnClasses:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1 wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-3",menuBtn:({active:t})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-leading-none",children:null==e?void 0:e.name}),(0,a.jsx)(xa.A,{className:"wpqt-size-4 "+(t?"wpqt-text-qtBlueHover":"")})]}),children:[(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center wpqt-font-bold",children:(0,o.__)("Change board","quicktasker")}),s.map((s=>{const n=s.is_primary,i=(null==e?void 0:e.id)===s.id;return(0,a.jsx)(As.Dr,{children:(0,a.jsxs)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-gap-2",children:[(0,a.jsx)("div",{className:(0,Xt.$)("wpqt-cursor-pointer wpqt-text-center",{"wpqt-font-bold":i}),onClick:()=>t(s.id),children:s.name}),(0,a.jsx)("div",{className:"wpqt-ml-auto",children:n?(0,a.jsx)(qa.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-blue-500"}):(0,a.jsx)(va.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-gray-400",onClick:e=>{e.stopPropagation(),l(s)}})})]})},s.id)})),(0,a.jsx)(As.Dr,{children:(0,a.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:(0,a.jsx)(Et,{text:(0,o.__)("Add new board","quicktasker"),onClick:()=>fa(this,void 0,void 0,(function*(){c({type:L})})),icon:(0,a.jsx)(os.A,{className:"wpqt-size-6 wpqt-icon-green"}),className:"wpqt-bg-white hover:!wpqt-bg-gray-100"})})},"new-pipeline")]})}function ga(){const{state:{activePipeline:e,loading:t},fetchAndSetPipelineData:s}=(0,n.useContext)(ct),{modalDispatch:i}=(0,n.useContext)(ht);return e?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-py-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,a.jsx)("div",{className:"wpqt-text-lg",children:e.name}),(0,a.jsx)(ea.A,{className:"wpqt-text-gray-400 wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{e&&i({type:F,payload:{pipelineToEdit:e}})}})]}),e.description&&(0,a.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,a.jsxs)("div",{className:"wpqt-ml-auto wpqt-flex wpqt-items-center wpqt-gap-3",children:[t?(0,a.jsx)($e,{width:"24",height:"24"}):(0,a.jsx)(Ys.A,{className:"wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>s(e.id)}),(0,a.jsx)(ma,{})]})]}):null}const ja=()=>(0,a.jsx)(lt,{children:(0,a.jsxs)(Be,{children:[(0,a.jsx)(ga,{}),(0,a.jsx)(wa,{}),(0,a.jsx)(Hn,{}),(0,a.jsx)(Kn,{})]})});var ka=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function _a(){return{saveCustomUserPageStyles:(e,t)=>ka(this,void 0,void 0,(function*(){try{const n=yield(s=e,u()({path:"/wpqt/v1/settings/user-page-custom-styles",method:"PATCH",data:{styles:s},headers:p()}));t&&t(n.data),i.oR.success((0,o.__)("Custom user page styles saved successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to save custom user page styles","quicktasker"))}var s})),saveTaskCompletionDoneSetting:(e,t,s)=>ka(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/pipelines/${e}/settings/task-completion-done-restriction`,method:"PATCH",data:{allow_task_completion_only_on_last_stage:t},headers:p()})}(e,t),s&&s(t)}catch(e){s&&s(!t),console.error(e),i.oR.error((0,o.__)("Failed to save setting","quicktasker"))}}))}}const ya=({children:e,title:t,description:s})=>(0,a.jsxs)("div",{className:"wpqt-mb-3",children:[(0,a.jsx)("h3",{children:t}),(0,a.jsx)("p",{children:s}),e]});const ba=()=>{const{state:{userPageCustomStyles:e},appDispatch:t}=(0,n.useContext)(Ht),[s,i]=(0,n.useState)(""),[r,c]=(0,n.useState)(!1),{saveCustomUserPageStyles:l}=_a();return(0,n.useEffect)((()=>{i(e)}),[e]),(0,a.jsxs)(ya,{title:(0,o.__)("Custom style","quicktasker"),description:(0,o.__)("Add custom CSS rules for QuickTasker user page.","quicktasker"),children:[(0,a.jsx)(Jt,{value:s,onChange:i}),(0,a.jsx)(Et,{text:(0,o.__)("Save","quicktasker"),loading:r,onClick:()=>{return e=void 0,n=void 0,i=function*(){c(!0),yield l(s,(e=>{t({type:le,payload:e})})),c(!1)},new((a=void 0)||(a=Promise))((function(t,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(e,n||[])).next())}));var e,n,a,i},icon:(0,a.jsx)(Ot.RZ0,{className:"wpqt-icon-blue wpqt-size-4"})})]})};var Sa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ca({allow_only_last_stage_task_done:e,pipelineId:t}){const[s,i]=(0,n.useState)(e),[r,c]=(0,n.useState)(!1),{saveTaskCompletionDoneSetting:l}=_a();return(0,a.jsx)(ya,{title:(0,o.__)("Restrict Task Completion","quicktasker"),description:(0,o.__)("Allow to mark task as done only on board last stage. By default, task can be marked as done on any stage. Will apply also to QuickTasker page","quicktasker"),children:(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,a.jsx)(es,{checked:s,handleChange:e=>Sa(this,void 0,void 0,(function*(){i(e),c(!0),yield l(t,e,(e=>{i(e)})),c(!1)}))}),r&&(0,a.jsx)($e,{width:"20",height:"20"})]})})}var Oa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ta({pipeline:e}){const[t,s]=(0,n.useState)(!0),[i,o]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(()=>{Oa(this,void 0,void 0,(function*(){try{s(!0);const n=yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/settings`,method:"GET",headers:p()}));o(Ke(n.data))}catch(e){console.error(e)}finally{s(!1)}var t}))})()}),[]),t?(0,a.jsx)(He,{}):i?(0,a.jsx)("div",{children:(0,a.jsx)(Ca,{pipelineId:e.id,allow_only_last_stage_task_done:i.allow_only_last_stage_task_done})}):null}function Na(){const{state:{pipelines:e}}=(0,n.useContext)(Xe),t=e.map((e=>e.name)),s=e.map((e=>(0,a.jsx)(Ta,{pipeline:e},e.id)));return(0,a.jsx)("div",{children:(0,a.jsx)(Ls,{tabs:t,tabsContent:s})})}const Ea=()=>(0,a.jsxs)(Be,{children:[(0,a.jsx)(l,{description:(0,o.__)("Manage settings, preferences, and configurations.","quicktasker"),children:(0,o.__)("Settings","quicktasker")}),(0,a.jsx)(ba,{}),(0,a.jsx)(Na,{})]});var Aa=s(8932),Pa=s(1548),Ia=s(1266),Da=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ra(){return{createUser:(e,t,s)=>Da(this,void 0,void 0,(function*(){try{const r=yield(n=e,a=t,u()({path:"/wpqt/v1/users",method:"POST",data:{name:n,description:a},headers:p()}));s&&s(r.data),i.oR.success((0,o.__)("User created successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User creation failed. Please try again","quicktasker"))}var n,a})),editUser:(e,t)=>Da(this,void 0,void 0,(function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/users/${e.id}`,method:"PATCH",data:{user:e},headers:p()})}(e);t&&t(s.data),i.oR.success((0,o.__)("User edited successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User edit failed. Please try again","quicktasker"))}})),changeUserStatus:(e,t,s)=>Da(this,void 0,void 0,(function*(){try{const n=yield function(e,t){return u()({path:`/wpqt/v1/users/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e,t);s&&s(n.data),i.oR.success((0,o.__)("User status changed successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change user status. Please try again","quicktasker"))}})),deleteUser:(e,t)=>Da(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}`,method:"DELETE",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User deleted successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete user. Please try again","quicktasker"))}})),resetUserPassword:(e,t)=>Da(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}/password-reset`,method:"PATCH",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User password reset successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to reset user password. Please try again","quicktasker"))}}))}}var Ua=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function La({data:e,changeStatus:t,changeSetUpStatus:s,changePasswordStatus:i}){const{changeUserStatus:r,deleteUser:c,resetUserPassword:l}=Ra(),{userDispatch:d}=(0,n.useContext)(ft),{loading1:u,setLoading1:p,loading2:h,setLoading2:w,loading3:v,setLoading3:x}=zt(),q=e.is_active,f=e.has_password;return(0,a.jsxs)("div",{className:"wpqt-mt-5 wpqt-flex wpqt-gap-2",children:[(0,a.jsx)(Et,{icon:(0,a.jsx)(Aa.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${e.id}/tasks`}}),!q&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Pa.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:h,onClick:()=>Ua(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!0,(e=>{d({type:ae,payload:Object.assign({},e)}),t(!0)})),w(!1)}))}),q&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Pa.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:h,onClick:()=>Ua(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!1,(e=>{d({type:ae,payload:Object.assign({},e)}),t(!1)})),w(!1)}))}),f&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ia.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:u,text:(0,o.__)("Reset password","quicktasker"),onClick:()=>Ua(this,void 0,void 0,(function*(){p(!0),yield l(e.id,(()=>{s(!1),i(!1)})),p(!1)}))}),(0,a.jsx)(Et,{icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:v,text:(0,o.__)("Delete user","quicktasker"),onClick:()=>Ua(this,void 0,void 0,(function*(){x(!0),yield c(e.id,(e=>{d({type:ie,payload:e}),window.location.hash="#/users"})),x(!1)}))})]})}var Fa=s(8624),Ma=s(3997),za=s(5028);function $a(){const{state:{siteURL:e,publicUserPageId:t}}=(0,n.useContext)(Ht);return{userPage:e+`/wpqt?page=${t}&page_id=wpqt`}}function Va({data:e}){const{userPage:t}=$a(),{convertToWPTimezone:s}=Ks(),n=e.is_active,i=t+"&code="+e.page_hash;return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,a.jsx)(Ha,{label:(0,o.__)("Name","quicktasker"),value:e.name,icon:(0,a.jsx)(Fa.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(Ha,{label:(0,o.__)("Created at","quicktasker"),value:s(e.created_at),icon:(0,a.jsx)(Ma.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(Ha,{label:(0,o.__)("Assigned tasks count","quicktasker"),value:e.assigned_tasks_count,icon:(0,a.jsx)(Aa.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(Ha,{label:(0,o.__)("Setup completed","quicktasker"),value:e.setup_completed?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,a.jsx)(za.A,{className:"wpqt-size-5 wpqt-text-yellow-600"})}),(0,a.jsx)(Ha,{label:(0,o.__)("Is active","quicktasker"),value:n?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,a.jsx)(Pa.A,{className:"wpqt-size-5 "+(n?"wpqt-icon-green":"wpqt-icon-red")})}),(0,a.jsx)(Ha,{label:(0,o.__)("User Page","quicktasker"),value:(0,a.jsx)("a",{href:i,rel:"noreferrer",target:"_blank",children:i}),icon:(0,a.jsx)(us.A,{className:"wpqt-size-5 wpqt-icon-blue"})})]})}function Ha({label:e,value:t,icon:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[s,(0,a.jsxs)("span",{className:"wpqt-font-semibold",children:[e,": "]}),(0,a.jsx)("span",{children:t})]})}var Ba=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ga({userId:e}){const{loadingDispatch:t}=(0,n.useContext)(Re),[s,r]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(()=>{Ba(this,void 0,void 0,(function*(){try{t({type:de,payload:!0});const n=yield function(e){return u()({path:`/wpqt/v1/users/${e}/extended`,method:"GET",headers:p()})}(e);r((s=n.data,Object.assign(Object.assign({},s),{is_active:"1"===s.is_active})))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to get user data. Please try again","quicktasker"))}finally{t({type:de,payload:!1})}var s}))})()}),[]),(0,a.jsx)(Be,{children:s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l,{description:(0,o.__)("User details","quicktasker"),children:s.name}),(0,a.jsx)(Va,{data:s}),(0,a.jsx)(La,{data:s,changeStatus:e=>Ba(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{is_active:e}):t))})),changeSetUpStatus:e=>Ba(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{setup_completed:e}):t))})),changePasswordStatus:e=>Ba(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{has_password:e}):t))}))})]})})}const Ka=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active}),Wa=(e,t)=>{var s;switch(t.type){case ue:return Object.assign(Object.assign({},e),{sessionsSearchValue:null!==(s=t.payload)&&void 0!==s?s:""});case pe:{const s=t.payload.map(Ka);return Object.assign(Object.assign({},e),{userSessions:s})}case he:{const{sessionId:s,status:n}=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_active:n}):e))})}case we:{const s=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.filter((e=>e.id!==s))})}default:return e}};var Qa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Ya={loading:!0,sessionsSearchValue:"",userSessions:[]},Xa=(0,n.createContext)({state:Ya,usersSessionDispatch:()=>{},loadUserSessions:()=>Qa(void 0,void 0,void 0,(function*(){}))}),Ja=({children:e})=>{const[t,s]=(0,n.useReducer)(Wa,Ya),{loadingDispatch:r}=(0,n.useContext)(Re);(0,n.useEffect)((()=>{c()}),[]);const c=()=>Qa(void 0,void 0,void 0,(function*(){try{r({type:de,payload:!0});const e=yield u()({path:"/wpqt/v1/users/sessions",method:"GET",headers:p()});s({type:pe,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user sessions","quicktasker"))}finally{r({type:de,payload:!1})}}));return(0,a.jsx)(Xa.Provider,{value:{state:t,usersSessionDispatch:s,loadUserSessions:c},children:e})};function Za(){const{state:{sessionsSearchValue:e},usersSessionDispatch:t}=(0,n.useContext)(Xa);return(0,a.jsx)(st,{title:(0,o.__)("Session filtering","quicktasker"),children:(0,a.jsx)(Qt,{value:e,onChange:e=>{t({type:ue,payload:e})}})})}const ei=()=>{const{state:{sessionsSearchValue:e}}=(0,n.useContext)(Xa);return{filterSessions:t=>t.user_name.toLowerCase().includes(e.toLowerCase())||t.user_description&&t.user_description.toLowerCase().includes(e.toLowerCase())}};var ti=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function si({session:e}){const{usersSessionDispatch:t}=(0,n.useContext)(Xa),{state:{isUserAllowedToDelete:s}}=(0,n.useContext)(Ht),{convertToWPTimezone:r}=Ks(),c=e.is_active,l=s=>ti(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/users/sessions/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e.id,s),t({type:he,payload:{sessionId:e.id,status:s}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change session status","quicktasker"))}}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:e.user_name}),(0,a.jsx)("div",{className:"wpqt-italic",children:e.user_description})]}),(0,a.jsx)("div",{children:r(e.created_at_utc)}),(0,a.jsx)("div",{children:r(e.expires_at_utc)}),(0,a.jsx)("div",{className:c?"wpqt-text-qtTextGreen":"wpqt-text-qtTextRed",children:c?(0,o.__)("On","quicktasker"):(0,o.__)("Off","quicktasker")}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-4",children:[c?(0,a.jsx)(Pa.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!1),title:(0,o.__)("Turn session off","quicktasker")}):(0,a.jsx)(Pa.A,{className:"wpqt-icon-green wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!0),title:(0,o.__)("Turn session on","quicktasker")}),s&&(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",title:(0,o.__)("Delete session","quicktasker"),onClick:()=>ti(this,void 0,void 0,(function*(){try{yield(s=e.id,u()({path:`/wpqt/v1/users/sessions/${s}`,method:"DELETE",headers:p()})),t({type:we,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete session","quicktasker"))}var s}))})]})]})}function ni(){const{state:{userSessions:e}}=(0,n.useContext)(Xa),{filterSessions:t}=ei();return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-4 wpqt-grid wpqt-grid-cols-5 wpqt-font-bold",children:[(0,a.jsx)("div",{children:(0,o.__)("Session owner","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Created at","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Expires at","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Status","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Actions","quicktasker")})]}),(0,a.jsx)("div",{className:"wpqt-grid wpqt-grid-cols-5 wpqt-items-center wpqt-gap-y-4",children:e.filter(t).map((e=>(0,a.jsx)(si,{session:e},e.id)))})]})}function ai(){return(0,a.jsx)(Ja,{children:(0,a.jsxs)(Be,{children:[(0,a.jsx)(l,{children:(0,o.__)("Quicktasker sessions","quicktasker")}),(0,a.jsx)(Za,{}),(0,a.jsx)(ni,{})]})})}function ii(){const{state:{usersSearchValue:e},userDispatch:t}=(0,n.useContext)(ft);return(0,a.jsx)(st,{title:(0,o.__)("User filtering","quicktasker"),children:(0,a.jsx)(Ge.p,{type:"text",value:e,onChange:e=>{t({type:ne,payload:e.target.value})}})})}var oi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ri({userId:e}){return(0,a.jsx)(Js,{typeId:e,fetchData:()=>oi(this,void 0,void 0,(function*(){try{return(yield v(e,Ee.User)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load log","quicktasker"))}})),renderItem:e=>(0,a.jsx)(Ws,{log:e}),noDataMessage:(0,o.__)("No logs available","quicktasker"),explanation:(0,o.__)("Logs can be seen only by WordPress users (with required permissions)","quicktasker")})}var ci=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function li({userId:e}){return(0,a.jsx)(Js,{typeId:e,fetchData:()=>ci(this,void 0,void 0,(function*(){try{return(yield h(e,Ee.User,!0)).data.map(on)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load private comments","quicktasker"))}})),onAdd:t=>ci(this,void 0,void 0,(function*(){try{const s=yield w(e,Ee.User,!0,t);return on(s.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add private comment","quicktasker"))}})),renderItem:e=>(0,a.jsx)(en,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed only by WordPress users (with required permissions).","quicktasker"),enableAdd:!0})}var di=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ui({userId:e}){const{addComment:t}=an();return(0,a.jsx)(Js,{typeId:e,fetchData:()=>di(this,void 0,void 0,(function*(){try{return(yield h(e,Ee.User,!1)).data.map(on)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load comments","quicktasker"))}})),onAdd:s=>di(this,void 0,void 0,(function*(){const n=yield t(e,Ee.User,!1,s);if(n)return on(n)})),renderItem:e=>(0,a.jsx)(en,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed by WordPress users (with required permissions) and current QuickTasker user (in user page).","quicktasker"),enableAdd:!0})}function pi({user:e}){const t=[(0,o.__)("Private comments","quicktasker"),(0,o.__)("Public comments","quicktasker"),(0,o.__)("Logs","quicktasker")];return(0,a.jsx)(Ls,{tabs:t,tabsContent:[(0,a.jsx)(li,{userId:e.id},1),(0,a.jsx)(ui,{userId:e.id},2),(0,a.jsx)(ri,{userId:e.id},3)]})}var hi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const wi=(0,n.forwardRef)((function({modalSaving:e,editUser:t},s){const{state:{userToEdit:i},modalDispatch:r}=(0,n.useContext)(ht),{state:{isUserAllowedToDelete:c}}=(0,n.useContext)(Ht),[l,d]=(0,n.useState)(""),[u,p]=(0,n.useState)(""),[h,w]=(0,n.useState)(!1),[v,x]=(0,n.useState)(!1),{changeUserStatus:q,deleteUser:f,resetUserPassword:m}=Ra(),{userDispatch:g}=(0,n.useContext)(ft),{loading1:j,setLoading1:k,loading2:_,setLoading2:y,loading3:b,setLoading3:S}=zt();(0,n.useEffect)((()=>{i&&(d(i.name),p(i.description),w(i.is_active),x(i.has_password))}),[i]);const C=()=>{d(""),p("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:C}))),i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-3 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsx)("div",{children:(0,a.jsxs)(It,{children:[(0,a.jsx)(Dt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(Qt,{isAutoFocus:!0,value:l,onChange:e=>d(e)})}),(0,a.jsx)(Dt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(Jt,{rowsCount:3,value:u,onChange:e=>p(e)})})]})}),(0,a.jsx)(bs,{entityId:i.id,entityType:Kt.User})]}),(0,a.jsx)("div",{className:"wpqt-mt-7",children:(0,a.jsx)(pi,{user:i})})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,a.jsx)(Et,{icon:(0,a.jsx)(Fa.A,{className:"wpqt-icon-blue wpqt-size-4"}),text:(0,o.__)("User details","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}`,r({type:z})}}),(0,a.jsx)(Et,{icon:(0,a.jsx)(Aa.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}/tasks`,r({type:z})}}),v&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ia.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Reset password","quicktasker"),loading:j,onClick:()=>hi(this,void 0,void 0,(function*(){k(!0),yield m(i.id,(()=>{g({type:re,payload:i.id}),x(!1)})),k(!1)}))}),!h&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Pa.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:_,onClick:()=>hi(this,void 0,void 0,(function*(){y(!0),yield q(i.id,!0,(e=>{g({type:ae,payload:Object.assign({},e)}),w(!0)})),y(!1)}))}),h&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Pa.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:_,onClick:()=>hi(this,void 0,void 0,(function*(){y(!0),yield q(i.id,!1,(e=>{g({type:ae,payload:Object.assign({},e)}),w(!1)})),y(!1)}))}),c&&(0,a.jsx)(Et,{icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete user","quicktasker"),loading:b,onClick:()=>hi(this,void 0,void 0,(function*(){S(!0),yield f(i.id,(e=>{g({type:ie,payload:e}),r({type:z})})),S(!1)}))})]})]}),(0,a.jsx)(Rt,{onSave:()=>{i&&t(Object.assign(Object.assign({},i),{name:l,description:u}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));var vi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function xi(){const{state:{userModalOpen:e}}=(0,n.useContext)(ht),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r}=jt(z),{editUser:c}=Ra();return(0,a.jsx)(At,{modalOpen:e,closeModal:o,size:"xl",children:(0,a.jsx)(wi,{ref:i,modalSaving:t,editUser:e=>vi(this,void 0,void 0,(function*(){s(!0),yield c(e,(e=>{r(ae,e,gt.USER)})),s(!1)}))})})}function qi(){const{state:{userSettingsModalOpen:e},modalDispatch:t}=(0,n.useContext)(ht);return(0,a.jsx)(At,{modalOpen:e,closeModal:()=>t({type:B,payload:!1}),size:"lg",children:(0,a.jsx)("div",{children:(0,a.jsx)(bs,{entityId:"null",entityType:Kt.Users})})})}var fi=s(8316),mi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function gi(){const[e,t]=(0,n.useState)(!1),[s,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(""),{userDispatch:d}=(0,n.useContext)(ft),{createUser:u}=Ra(),p=()=>{r(""),l(""),t(!1)};return(0,a.jsx)("div",{className:"wpqt-mb-6",children:e?(0,a.jsxs)("div",{className:"wpqt-w-1/4",children:[(0,a.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User name","quicktasker")}),(0,a.jsx)(Qt,{value:s,onChange:r,className:"wpqt-w-full"}),(0,a.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User description","quicktasker")}),(0,a.jsx)(Jt,{value:c,onChange:l,className:"wpqt-w-full"}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,a.jsx)(Et,{text:(0,o.__)("Cancel","quicktasker"),onClick:p,icon:(0,a.jsx)(Ct.A,{className:"wpqt-icon-red wpqt-size-5"})}),(0,a.jsx)(Et,{text:(0,o.__)("Add","quicktasker"),onClick:()=>mi(this,void 0,void 0,(function*(){s?yield u(s,c,(e=>{d({type:se,payload:e}),p()})):i.oR.error("User name is required")})),icon:(0,a.jsx)(fi.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]}):(0,a.jsx)(Et,{text:(0,o.__)("Add User","quicktasker"),onClick:()=>t(!0),icon:(0,a.jsx)(fi.A,{className:"wpqt-icon-green wpqt-size-5"})})})}const ji=()=>{const{state:{usersSearchValue:e}}=(0,n.useContext)(ft);return{filterUsers:t=>t.name.toLowerCase().includes(e.toLowerCase())||t.description&&t.description.toLowerCase().includes(e.toLowerCase())}};var ki=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function _i({user:e}){const{modalDispatch:t}=(0,n.useContext)(ht),{userDispatch:s}=(0,n.useContext)(ft),{changeUserStatus:i,deleteUser:r,resetUserPassword:c}=Ra(),[l,d]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),[h,w]=(0,n.useState)(!1),v=e.is_active,x=t=>ki(this,void 0,void 0,(function*(){w(!0),yield i(e.id,t,(()=>{s({type:oe,payload:{userId:e.id,isActive:t}})})),w(!1)}));return(0,a.jsxs)(Ps,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:yn.A}),children:[(0,a.jsx)(Ds,{text:(0,o.__)("User details","quicktasker"),icon:(0,a.jsx)(Fa.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,a.jsx)(Ds,{text:(0,o.__)("User tasks","quicktasker"),icon:(0,a.jsx)(Aa.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}/tasks`}}),(0,a.jsx)(Ds,{text:(0,o.__)("Edit user","quicktasker"),icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:$,payload:e})}}),e.has_password&&(0,a.jsx)(Ds,{text:(0,o.__)("Reset password","quicktasker"),loading:l,icon:(0,a.jsx)(Ia.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>ki(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield c(e.id,(()=>{s({type:re,payload:e.id})})),d(!1)}))}),v&&(0,a.jsx)(Ds,{text:(0,o.__)("Disable user","quicktasker"),loading:h,icon:(0,a.jsx)(Pa.A,{className:"wpqt-icon-red wpqt-size-4"}),className:"!wpqt-mb-0",onClick:e=>{e.stopPropagation(),x(!1)}}),!v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ds,{text:(0,o.__)("Activate user","quicktasker"),loading:h,icon:(0,a.jsx)(Pa.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:e=>{e.stopPropagation(),x(!0)}}),(0,a.jsx)(Ds,{text:(0,o.__)("Delete user","quicktasker"),loading:u,icon:(0,a.jsx)(Ft.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>ki(this,void 0,void 0,(function*(){t.stopPropagation(),p(!0),yield r(e.id,(e=>{s({type:ie,payload:e})})),p(!1)}))})]})]})}function yi({user:e}){const{userPage:t}=$a(),{modalDispatch:s}=(0,n.useContext)(ht),i=e.is_active,r=t+"&code="+e.page_hash;return(0,a.jsxs)(gn,{title:e.name,description:e.description,dropdown:(0,a.jsx)(_i,{user:e}),onClick:()=>{s({type:$,payload:e})},className:"wpqt-cursor-pointer",children:[(0,a.jsx)(jn,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("Open user page","quicktasker"),icon:(0,a.jsx)(us.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:e=>{e.stopPropagation(),window.open(r,"_blank")}}),(0,a.jsx)(jn,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("View user details","quicktasker"),icon:(0,a.jsx)(us.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,a.jsx)(jn,{label:(0,o.__)("Status","quicktasker"),value:i?(0,o.__)("Active","quicktasker"):(0,o.__)("Disabled","quicktasker"),valueClassName:i?"wpqt-text-qtTextGreen wpqt-font-bold":"wpqt-text-qtTextRed wpqt-font-bold",icon:(0,a.jsx)(Pa.A,{className:"wpqt-size-5 "+(i?"wpqt-icon-green":"wpqt-icon-red")})})]})}function bi(){const{state:{users:e}}=(0,n.useContext)(ft),{filterUsers:t}=ji(),s=e.filter(t);return e&&0===e.length?(0,a.jsx)(qn,{text:(0,o.__)("No users found","quicktasker")}):s&&0===s.length?(0,a.jsx)(qn,{}):(0,a.jsx)("div",{className:"wpqt-card-grid",children:s.map((e=>(0,a.jsx)(yi,{user:e},e.id)))})}function Si(){const{updateUsers:e}=(0,n.useContext)(ft),{loadingDispatch:t}=(0,n.useContext)(Re),{modalDispatch:s}=(0,n.useContext)(ht);return(0,n.useEffect)((()=>{(()=>{var s,n,a,i;s=this,n=void 0,i=function*(){t({type:de,payload:!0}),yield e(),t({type:de,payload:!1})},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function r(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(s,n||[])).next())}))})()}),[]),(0,a.jsxs)(Be,{children:[(0,a.jsx)(l,{description:(0,o.__)("Create and manage QuickTaskers who can access a mobile-like page to manage their assigned tasks.","quicktasker"),icon:(0,a.jsx)(ea.A,{className:"wpqt-icon-gray wpqt-size-7 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{s({type:B,payload:!0})}}),children:(0,o.__)("QuickTaskers","quicktasker")}),(0,a.jsx)(gi,{}),(0,a.jsx)(ii,{}),(0,a.jsx)(bi,{}),(0,a.jsx)(qi,{}),(0,a.jsx)(xi,{})]})}const Ci=(e,t)=>{switch(t.type){case ve:{const s=t.payload.map(Te);return Object.assign(Object.assign({},e),{tasks:s})}case qe:{const s=t.payload;return Object.assign(Object.assign({},e),{tasks:e.tasks.filter((e=>e.id!==s))})}case fe:{const s=t.payload,n=e.tasks.map((e=>e.id===s.id?Te(s):e));return Object.assign(Object.assign({},e),{tasks:n})}case xe:{const s=t.payload;return Object.assign(Object.assign({},e),{searchValue:s})}case me:{const s=t.payload;return Object.assign(Object.assign({},e),{filteredPipelineId:s})}case ge:{const{taskId:s,user:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:[n,...e.assigned_users]}):e));return Object.assign(Object.assign({},e),{tasks:a})}case je:{const{taskId:s,user:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:e.assigned_users.filter((e=>e.id!==n.id))}):e));return Object.assign(Object.assign({},e),{tasks:a})}case ke:{const{taskId:s,done:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{tasks:a})}default:return e}};var Oi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Ti={tasks:[],searchValue:"",filteredPipelineId:""},Ni=(0,n.createContext)({state:Ti,userTasksDispatch:()=>{},fetchAndSetUserTasks:()=>Oi(void 0,void 0,void 0,(function*(){}))}),Ei=({children:e,userId:t})=>{const[s,r]=(0,n.useReducer)(Ci,Ti),{loadingDispatch:c}=(0,n.useContext)(Re);(0,n.useEffect)((()=>{l()}),[]);const l=()=>Oi(void 0,void 0,void 0,(function*(){try{c({type:de,payload:!0});const e=yield function(e){return u()({path:`/wpqt/v1/users/${e}/tasks`,method:"GET",headers:p()})}(t);r({type:ve,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user tasks","quicktasker"))}finally{c({type:de,payload:!1})}}));return(0,a.jsx)(Ni.Provider,{value:{state:s,userTasksDispatch:r,fetchAndSetUserTasks:l},children:e})};function Ai(){const{state:{searchValue:e,filteredPipelineId:t},userTasksDispatch:s}=(0,n.useContext)(Ni);return(0,a.jsxs)(st,{title:(0,o.__)("Filter tasks","quicktasker"),children:[(0,a.jsx)(Qt,{value:e,onChange:e=>{s({type:xe,payload:e})},className:"!wpqt-mb-0"}),(0,a.jsx)(tt,{selectedOptionValue:t,selectionChange:e=>{s({type:me,payload:e})}})]})}var Pi=s(7028),Ii=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Di({taskId:e,onUnAssignTask:t}){const[s,i]=(0,n.useState)(!1);return(0,a.jsx)(Ps,{menuBtn:({active:e})=>(0,a.jsx)(Is,{isActive:e,IconComponent:yn.A}),children:(0,a.jsx)(Ds,{text:(0,o.__)("Unassign from task","quicktasker"),loading:s,icon:(0,a.jsx)(Pi.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:s=>Ii(this,void 0,void 0,(function*(){s.stopPropagation(),i(!0),yield t(e),i(!1)})),className:"!wpqt-mb-0"})})}const Ri=()=>{const{state:{searchValue:e,filteredPipelineId:t}}=(0,n.useContext)(Ni);return{filterTasks:s=>{const n=s.name&&s.name.toLowerCase().includes(e.toLowerCase())||s.description&&s.description.toLowerCase().includes(e.toLowerCase()),a=!t||s.pipeline_id===t;return n&&a}}};var Ui=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Li({userId:e}){var t;const{filterTasks:s}=Ri(),{modalDispatch:i}=(0,n.useContext)(ht),{state:{tasks:r},userTasksDispatch:c}=(0,n.useContext)(Ni),{removeTaskFromUser:l}=it(),d=null!==(t=null==r?void 0:r.filter(s))&&void 0!==t?t:[],u=t=>Ui(this,void 0,void 0,(function*(){yield l(e,t,(()=>{c({type:qe,payload:t})}))}));return r&&0===r.length?(0,a.jsx)(qn,{text:(0,o.__)("User has no tasks","quicktasker")}):d&&0===d.length?(0,a.jsx)(qn,{}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-card-grid",children:d.map((e=>(0,a.jsxs)(gn,{className:"wpqt-cursor-pointer",title:e.name,description:e.description,dropdown:(0,a.jsx)(Di,{taskId:e.id,onUnAssignTask:u}),onClick:()=>{i({type:P,payload:{taskToEdit:e}})},children:[(0,a.jsx)(Rs,{task:e,onUserAdd:t=>{c({type:ge,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{c({type:je,payload:{taskId:e.id,user:t}})}}),(0,a.jsx)(_n,{task:e,onDoneStatusChange:(e,t)=>{c({type:ke,payload:{taskId:e,done:t}})}})]},e.id)))}),(0,a.jsx)(xn,{editTaskCallback:e=>{c({type:fe,payload:e})}})]})}function Fi({userId:e}){return(0,a.jsx)(Ei,{userId:e,children:(0,a.jsxs)(Be,{children:[(0,a.jsx)(l,{description:(0,o.__)("Tasks assigned to user","quicktasker"),children:(0,o.__)("User tasks","quicktasker")}),(0,a.jsx)(Ai,{}),(0,a.jsx)(Li,{userId:e})]})})}const Mi=()=>{const{page:e,hash:t}=zi();if("wp-quick-tasks"===e){const e=t.match(/^#\/users\/(\d+)\/tasks$/);if(e){const t=e[1];return(0,a.jsx)(Fi,{userId:t})}const s=t.match(/^#\/users\/(\d+)$/);if(s){const e=s[1];return(0,a.jsx)(Ga,{userId:e})}switch(t){case"#/users":return(0,a.jsx)(Si,{});case"#/overview":return(0,a.jsx)($n,{});case"#/archive":return(0,a.jsx)(Nn,{});case"#/user-sessions":return(0,a.jsx)(ai,{});case"#/logs":return(0,a.jsx)(zn,{});case"#/settings":return(0,a.jsx)(Ea,{});case"#/guide":return(0,a.jsx)(En,{});default:return(0,a.jsx)(ja,{})}}},zi=()=>({page:new URLSearchParams(window.location.search).get("page"),hash:window.location.hash}),$i=function(){const e=(()=>{const[e,t]=(0,n.useState)(Mi());return(0,n.useEffect)((()=>{const e=()=>{t(Mi()),(()=>{const{page:e,hash:t}=zi();if("wp-quick-tasks"!==e)return;const s=document.querySelectorAll("#toplevel_page_wp-quick-tasks .wp-submenu li");s.forEach((e=>e.classList.remove("wpqt-current")));const n={"#/users":"#/users","#/overview":"#/overview","#/archive":"#/archive","#/user-sessions":"#/user-sessions","#/logs":"#/logs","#/settings":"#/settings","#/guide":"#/guide",default:""};let a=n.default;void 0!==n[t]?a=n[t]:/^#\/users(\/\d+)?(\/tasks)?$/.test(t)&&(a="#/users"),s.forEach((e=>{const t=e.querySelector("a");t&&t.getAttribute("href")&&t.getAttribute("href")===`admin.php?page=wp-quick-tasks${a}`&&e.classList.add("wpqt-current")}))})()};return e(),window.addEventListener("popstate",e),window.addEventListener("hashchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("hashchange",e)}}),[]),e})();return(0,a.jsx)(c,{children:(0,a.jsx)(Bt,{children:(0,a.jsx)(mt,{children:(0,a.jsx)(wt,{children:(0,a.jsx)(Je,{children:(0,a.jsxs)(Ue,{children:[e,(0,a.jsx)(i.N9,{position:"bottom-right"})]})})})})})})};(0,n.render)((0,a.jsx)($i,{}),document.getElementById("wpqt-app"))},1609:e=>{e.exports=window.React},5795:e=>{e.exports=window.ReactDOM},790:e=>{e.exports=window.ReactJSXRuntime}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var s=a[e]={exports:{}};return n[e].call(s.exports,s,s.exports,i),s.exports}i.m=n,e=[],i.O=(t,s,n,a)=>{if(!s){var o=1/0;for(d=0;d<e.length;d++){for(var[s,n,a]=e[d],r=!0,c=0;c<s.length;c++)(!1&a||o>=a)&&Object.keys(i.O).every((e=>i.O[e](s[c])))?s.splice(c--,1):(r=!1,a<o&&(o=a));if(r){e.splice(d--,1);var l=n();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[s,n,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);i.r(a);var o={};t=t||[null,s({}),s([]),s(s)];for(var r=2&n&&e;"object"==typeof r&&!~t.indexOf(r);r=s(r))Object.getOwnPropertyNames(r).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(a,o),a},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=524,(()=>{var e={524:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var n,a,[o,r,c]=s,l=0;if(o.some((t=>0!==e[t]))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(c)var d=c(i)}for(t&&t(s);l<o.length;l++)a=o[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(d)},s=globalThis.webpackChunkquicktasker=globalThis.webpackChunkquicktasker||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.nc=void 0;var o=i.O(void 0,[96],(()=>i(9323)));o=i.O(o)})();