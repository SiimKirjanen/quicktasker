(()=>{"use strict";var e,t,s,a={9623:(e,t,s)=>{const a=window.wp.element;var n=s(790),i=s(9571);const o=window.wp.i18n;class r extends a.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){var e;return this.state.hasError?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-h-screen wpqt-items-center wpqt-justify-center wpqt-text-center wpqt-text-lg",children:[(0,o.__)("Something went wrong. Please refresh the page.","quicktasker"),(0,n.jsx)("br",{}),null===(e=this.state.error)||void 0===e?void 0:e.message]}):this.props.children}}const c=r;var l=s(12);function d({children:e,description:t=null,icon:s=null}){return(0,n.jsx)("div",{className:"wpqt-mb-6 wpqt-inline-grid wpqt-grid-cols-[auto_auto] wpqt-items-center wpqt-gap-2",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{children:[e,s&&(0,n.jsx)("span",{className:"wpqt-ml-1 wpqt-align-middle",children:s})]}),t&&(0,n.jsx)("div",{children:t})]})})}var u=s(7908);const p="SET_LOADING",h="SET_PIPELINE",m="MOVE_TASK",w="ADD_TASK",f="ADD_STAGE",k="DELETE_STAGE",q="EDIT_TASK",x="EDIT_STAGE",_="ADD_PIPELINE",g="EDIT_PIPELINE",v="SET_PRIMARY",j="SET_PIPELINES",b="ADD_USER_TO_TASK",y="REMOVE_USER_FROM_TASK",E="CHANGE_TASK_DONE_STATUS",T="REMOVE_PIPELINE",S="REMOVE_ACTIVE_PIPELINE",A="REMOVE_TASK",O="TOGGLE_VIEW",N="ADD_LABEL_TO_TASK",C="REMOVE_LABEL_FROM_TASK",I="EDIT_PIPELINE_LABEL",D="REMOVE_PIPELINE_LABEL",P="SET_TASK_FOCUS_COLOR",R="SET_STAGE_FILTER",L="SET_USER_FILTER",M="SET_TASK_VIEW_SEARCH_TEXT",U="OPEN_EDIT_TASK_MODAL",F="CLOSE_TASK_MODAL",K="OPEN_NEW_STAGE_MODAL",$="CLOSE_STAGE_MODAL",z="OPEN_STAGE_EDIT_MODAL",G="OPEN_NEW_PIPELINE_MODAL",V="OPEN_EDIT_PIPELINE_MODAL",B="CLOSE_PIPELINE_EDIT_MODAL",H="CLOSE_USER_MODAL",W="OPEN_EDIT_USER_MODAL",Q="ADD_ASSIGNED_USER_TO_EDITING_TASK",Y="REMOVE_ASSIGNED_USER_FROM_EDITING_TASK",J="CHANGE_USER_SETTINGS_MODAL_OPEN",X="OPEN_MOVE_TASK_MODAL",Z="CLOSE_MOVE_TASK_MODAL",ee="OPEN_TASK_COLOR_MODAL",te="CLOSE_TASK_COLOR_MODAL",se="OPEN_TASK_EXPORT_MODAL",ae="CLOSE_TASK_EXPORT_MODAL",ne="CHANGE_TASK_EXPORT_MODAL_METHOD",ie="OPEN_PIPELINE_IMPORT_MODAL",oe="CLOSE_PIPELINE_IMPORT_MODAL",re="ARCHIVE_SETTINGS_MODAL_OPEN",ce="OPEN_TASK_RESTORE_MODAL",le="CLOSE_TASK_RESTORE_MODAL",de="SET_CUSTOM_FIELD_CREATOR_MODAL_OPEN",ue="SET_CUSTOM_FIELD_RECOVERY_MODAL_OPEN",pe="SET_WEBHOOK_CREATION_MODAL_OPEN",he="SET_WEBHOOKS_MODAL_OPEN",me="OPEN_WEBHOOKS_LOGS_MODAL",we="CLOSE_WEBHOOKS_LOGS_MODAL",fe="SET_ARCHIVE_TASKS",ke="SET_ARCHIVE_SEARCH_VALUE",qe="SET_ARCHIVE_FILTERED_PIPELINE",xe="REMOVE_ARCHIVED_TASK",_e="REMOVE_ARCHIVED_TASKS",ge="ADD_ASSIGNED_USER_TO_ARCHIVED_TASK",ve="REMOVE_ASSINGED_USER_FROM_ARCHIVED_TASK",je="CHANGE_ARCHIVED_TASK_DONE_STATUS",be="EDIT_ARCHIVED_TASK",ye="CHANGE_ARCHIVE_TASK_DONE_FILTER",Ee="ADD_LABEL_ARCHIVED_TASK",Te="REMOVE_LABEL_ARCHIVED_TASK",Se="CHANGE_ARCHIVED_TASKS_LIMIT_FILTER",Ae="SET_ARCHIVE_LOADING",Oe="SET_ARCHIVE_FILTER_ORDER",Ne="SET_USERS",Ce="SET_WP_USERS",Ie="ADD_USER",De="SET_USERS_SEARCH_VALUE",Pe="EDIT_USER",Re="DELETE_USER",Le="CHANGE_USER_STATUS",Me="RESET_PASSWORD",Ue="INIT_APP_STATE",Fe="SET_CUSTOM_USER_PAGE_STYLES",Ke="SET_FULL_PAGE_LOADING",$e="SET_USER_SESSIONS_SEARCH_VALUE",ze="SET_USER_SESSIONS",Ge="CHANGE_USER_SESSION_STATUS",Ve="DELETE_USER_SESSION",Be="SET_USER_TASKS",He="SET_USER_TASKS_SEARCH_VALUE",We="REMOVE_USER_TASK",Qe="EDIT_USER_TASK",Ye="SET_USER_TASKS_FILTERED_PIPELINE",Je="ADD_ASSIGNED_USER_TO_USER_TASK",Xe="REMOVE_ASSIGNED_USER_FROM_USER_TASK",Ze="CHANGE_USER_TASK_DONE_STATUS",et="SET_CUSTOM_FIELDS",tt="ADD_CUSTOM_FIELD",st="DELETE_CUSTOM_FIELD",at="SET_CUSTOM_FIELD_LOADING",nt="SET_CUSTOM_FIELD_INITIAL_DATA",it="SET_LABELS",ot="ADD_LABEL",rt="REMOVE_LABEL",ct="EDIT_LABEL",lt="SET_LABEL_ACTION_STATE_SELECTION",dt="SET_LABEL_ACTION_STATE_EDITING",ut="SET_LABEL_ACTION_STATE_CREATION",pt="RESET_LABEL_CONTEXT",ht="SET_PIPELINE_AUTOMATIONS",mt="SET_PIPELINE_AUTOMATIONS_LOADING",wt="REMOVE_PIPELINE_AUTOMATION",ft="ADD_PIPELINE_AUTOMATION",kt="UPDATE_PIPELINE_AUTOMATION_ACTIVE_STATUS",qt="SET_META",xt="SET_ACTION_TARGET",_t="RESET_AUTOMATION_TO_TARGET",gt="RESET_AUTOMATION_TO_TRIGGER",vt="RESET_AUTOMATION_TO_ACTION",jt="SET_PIPELINE_WEBHOOKS",bt="SET_PIPELINE_WEBHOOKS_LOADING",yt="REMOVE_PIPELINE_WEBHOOK",Et="ADD_PIPELINE_WEBHOOK",Tt="EDIT_PIPELINE_WEBHOOK",St="SET_UPLOADS",At="ADD_UPLOAD",Ot="REMOVE_UPLOAD",Nt=700,Ct=!0,It="#ffffff",Dt="6px",Pt="solid",Rt="#16a34a",Lt=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv","text/plain","image/jpeg","image/png","image/gif","image/bmp","image/svg+xml","audio/mpeg","audio/wav","audio/ogg","video/mp4","video/webm","video/ogg","application/zip","application/x-rar-compressed","application/x-tar","application/gzip"],Mt=26214400,Ut=/^[a-zA-Z0-9_\-.]+$/,Ft=window.wp.apiFetch;var Kt,$t,zt=s.n(Ft);function Gt(){return{"Content-Type":"application/json","X-WPQT-API-Nonce":window.wpqt.apiNonce}}function Vt(e,t,s){return zt()({path:`/wpqt/v1/tasks/${e}/move`,method:"PATCH",data:{stageId:t,order:s},headers:Gt()})}function Bt(e,t,s){const a=new URLSearchParams({typeId:e,type:t,isPrivate:s.toString()}).toString();return zt()({path:`/wpqt/v1/comments?${a}`,method:"GET",headers:Gt()})}function Ht(e,t,s,a){return zt()({path:"/wpqt/v1/comments",data:{comment:a,typeId:e,type:t,isPrivate:s},method:"POST",headers:Gt()})}function Wt(e,t){const s=new URLSearchParams({typeId:e,type:t});return zt()({path:`/wpqt/v1/logs?${s.toString()}`,method:"GET",headers:Gt()})}function Qt(e){const t=new URLSearchParams(Object.entries(e).reduce(((e,[t,s])=>(e[t]=String(s),e)),{}));return zt()({path:`/wpqt/v1/global-logs?${t.toString()}`,method:"GET",headers:Gt()})}function Yt(e,t,s){return zt()({path:`/wpqt/v1/users/${e}/tasks/${t}`,method:"DELETE",data:{user_type:s},headers:Gt()})}function Jt(e,t,s){const a=new URLSearchParams({entityId:e,entityType:t,active:String(s)});return zt()({path:`/wpqt/v1/custom-fields?${a.toString()}`,method:"GET",headers:Gt()})}($t=Kt||(Kt={})).QUICKTASKER="quicktasker",$t.WP_USER="wp-user";function Xt(e){return!e.user_type||e.user_type===Kt.QUICKTASKER}function Zt(e){return e.user_type===Kt.WP_USER}const es=e=>Object.assign(Object.assign({},e),{allow_only_last_stage_task_done:"1"===e.allow_only_last_stage_task_done});var ts,ss,as,ns,is,os;!function(e){e.TASK_DONE="task-done",e.Task_NOT_DONE="task-not-done",e.TASK_CREATED="task-created",e.TASK_DELETED="task-deleted",e.TASK_ASSIGNED="task-assigned",e.TASK_UNASSIGNED="task-unassigned",e.TASK_PUBLIC_COMMENT_ADDED="task-public-comment-added",e.TASK_PRIVATE_COMMENT_ADDED="task-private-comment-added",e.TASK_FILE_UPLOADED="task-attachment-added",e.TASK_FILE_DELETED="task-attachment-deleted"}(ts||(ts={})),function(e){e.WOOCOMMERCE_ORDER_ADDED="woocommerce-order-added"}(ss||(ss={})),function(e){e.SEATREG_BOOKING_CREATED="seatreg-booking-created",e.SEATREG_BOOKING_APPROVED="seatreg-booking-approved",e.SEATREG_BOOKING_APPROVED_VIA_MANAGER="seatreg-booking-approved-via-manager",e.SEATREG_BOOKING_PENDING="seatreg-booking-pending",e.SEATREG_BOOKING_PENDING_VIA_MANAGER="seatreg-booking-pending-via-manager"}(as||(as={})),function(e){e.PIPELINE="pipeline",e.Stage="stage",e.Task="task",e.quicktasker="quicktasker",e.WOOCOMMERCE_ORDER="woocommerce-order",e.SEATREG_BOOKING="seatreg-booking"}(ns||(ns={})),function(e){e.PIPELINE="pipeline",e.STAGE="stage",e.TASK="task",e.QUICKTASKER="quicktasker",e.WP_USER="wp-user"}(is||(is={})),function(e){e.ARCHIVE_TASK="archive-task",e.ASSIGN_USER="assign-user",e.NEW_ENTITY_EMAIL="new-entity-email",e.DELETED_ENTITY_EMAIL="deleted-entity-email",e.TASK_ASSIGNED_EMAIL="task-assigned-email",e.TASK_UNASSIGNED_EMAIL="task-unassigned-email",e.TASK_PUBLIC_COMMENT_ADDED_EMAIL="task-public-comment-added-email",e.TASK_PRIVATE_COMMENT_ADDED_EMAIL="task-private-comment-added-email",e.TASK_FILE_UPLOADED_EMAIL="task-attachment-added-email",e.TASK_FILE_DELETED_EMAIL="task-attachment-deleted-email",e.CREATE_TASK="create-task",e.SEND_SLACK_MESSAGE="send-slack-message"}(os||(os={}));const rs=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active,has_password:"1"===e.has_password}),cs=e=>{switch(e){case is.QUICKTASKER:return Kt.QUICKTASKER;case is.WP_USER:return Kt.WP_USER;default:return null}},ls={[Kt.QUICKTASKER]:"Quicktasker",[Kt.WP_USER]:"WordPress User"},ds=e=>Object.assign(Object.assign({},e),{task_order:Number(e.task_order),free_for_all:"1"===e.free_for_all,is_archived:"1"===e.is_archived,is_done:"1"===e.is_done,assigned_users:e.assigned_users?e.assigned_users.map((e=>Object.assign({},rs(e)))):[]}),us=e=>Object.assign(Object.assign({},e),{stage_order:Number(e.stage_order),tasks:(e.tasks||[]).map((e=>Object.assign({},ds(e))))}),ps=(e,t)=>{var s,a,n,i,o,r,c,l,d,u,_,v,j,T,R;switch(t.type){case p:return Object.assign(Object.assign({},e),{loading:t.payload});case h:{const s=t.payload,a=(s.stages||[]).map((e=>Object.assign({},us(e)))),n=s.settings?es(s.settings):void 0;return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},s),{stages:a,settings:n,is_primary:"1"===s.is_primary})})}case m:{if(!e.activePipeline||!e.activePipeline.stages)return e;const s=((e,t,s)=>{const a=[...e],n=a.find((e=>e.id===t.droppableId)),i=a.find((e=>e.id===s.droppableId));if((null==n?void 0:n.tasks)&&(null==i?void 0:i.tasks)){const[e]=n.tasks.splice(t.index,1);i.tasks.splice(s.index,0,e)}return a})(e.activePipeline.stages,t.payload.source,t.payload.destination);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:s})})}case"REORDER_TASK":{const{source:n,destination:i}=t.payload,o=i.droppableId,r=i.index;if(!e.activePipeline)return e;const c=null===(s=e.activePipeline.stages)||void 0===s?void 0:s.find((e=>e.id===o));if(!c||!c.tasks)return e;const l=((e,t,s)=>{const a=[...e],[n]=a.splice(t,1);return a.splice(s,0,n),a})(c.tasks,n.index,r),d=null===(a=e.activePipeline.stages)||void 0===a?void 0:a.map((e=>e.id===o?Object.assign(Object.assign({},e),{tasks:l}):e));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:d})})}case w:{const s=ds(t.payload);return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(n=e.activePipeline.stages)||void 0===n?void 0:n.map((e=>e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:[...e.tasks||[],s]}):e))})}):e}case q:{const s=ds(t.payload);if(!e.activePipeline)return e;const a=null===(i=e.activePipeline.stages)||void 0===i?void 0:i.map((e=>{var t;return e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s.id?Object.assign(Object.assign({},e),s):e))}):e}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case f:{const{stage:s}=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:[...e.activePipeline.stages||[],s]})}):e}case x:{const s=t.payload;if(!e.activePipeline)return e;const a=e=>e.id===s.id?Object.assign(Object.assign({},e),{name:s.name,description:s.description}):e,n=null===(o=e.activePipeline.stages)||void 0===o?void 0:o.map(a);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case k:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(r=e.activePipeline.stages)||void 0===r?void 0:r.filter((e=>e.id!==s))})}):e}case b:{const{taskId:s,user:a}=t.payload;if(!e.activePipeline)return e;const n=null===(c=e.activePipeline.stages)||void 0===c?void 0:c.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{if(e.id===s){const t=Xt(a)?[a,...e.assigned_users||[]]:e.assigned_users||[],s=Zt(a)?[a,...e.assigned_wp_users||[]]:e.assigned_wp_users||[];return Object.assign(Object.assign({},e),{assigned_users:t,assigned_wp_users:s})}return e}));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case y:{const{taskId:s,userId:a,userType:n}=t.payload;if(!e.activePipeline)return e;const i=null===(l=e.activePipeline.stages)||void 0===l?void 0:l.map((e=>{var t;const i=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{var t,i;return e.id===s?Object.assign(Object.assign({},e),{assigned_users:n===Kt.QUICKTASKER?null===(t=e.assigned_users)||void 0===t?void 0:t.filter((e=>e.id!==a)):e.assigned_users,assigned_wp_users:n===Kt.WP_USER?null===(i=e.assigned_wp_users)||void 0===i?void 0:i.filter((e=>e.id!==a)):e.assigned_wp_users}):e}));return Object.assign(Object.assign({},e),{tasks:i})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:i})})}case g:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{name:s.name,description:s.description,is_primary:"1"===s.is_primary})}):e}case E:{const{taskId:s,done:a}=t.payload;if(!e.activePipeline)return e;const n=null===(d=e.activePipeline.stages)||void 0===d?void 0:d.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:a}):e));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case S:return Object.assign(Object.assign({},e),{activePipeline:null});case A:{const s=t.payload;if(!e.activePipeline)return e;const a=null===(u=e.activePipeline.stages)||void 0===u?void 0:u.map((e=>{var t;return Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.filter((e=>e.id!==s))})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case O:return Object.assign(Object.assign({},e),{view:t.payload});case N:{const{taskId:s,label:a}=t.payload;if(!e.activePipeline)return e;const n=null===(_=e.activePipeline.stages)||void 0===_?void 0:_.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_labels:[...e.assigned_labels||[],a]}):e));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case C:{const{taskId:s,labelId:a}=t.payload;if(!e.activePipeline)return e;const n=null===(v=e.activePipeline.stages)||void 0===v?void 0:v.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_labels:(e.assigned_labels||[]).filter((e=>e.id!==a))}):e));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case I:{const{label:s}=t.payload;if(!e.activePipeline)return e;const a=null===(j=e.activePipeline.stages)||void 0===j?void 0:j.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>Object.assign(Object.assign({},e),{assigned_labels:(e.assigned_labels||[]).map((e=>e.id===s.id?s:e))})));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case D:{const s=t.payload;if(!e.activePipeline)return e;const a=null===(T=e.activePipeline.stages)||void 0===T?void 0:T.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>Object.assign(Object.assign({},e),{assigned_labels:(e.assigned_labels||[]).filter((e=>e.id!==s))})));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case P:{const{taskId:s,color:a}=t.payload;if(!e.activePipeline)return e;const n=null===(R=e.activePipeline.stages)||void 0===R?void 0:R.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{task_focus_color:a}):e));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}default:return e}};var hs;!function(e){e.PIPELINE="PIPELINE-VIEW",e.TASK="TASK-VIEW"}(hs||(hs={}));const ms=(e,t)=>{if(t.type===Ke){const s=t.payload;return Object.assign(Object.assign({},e),{fullPageLoading:s})}return e},ws={fullPageLoading:!1},fs=(0,a.createContext)({state:ws,loadingDispatch:()=>{}}),ks=({children:e})=>{const[t,s]=(0,a.useReducer)(ms,ws);return(0,n.jsx)(fs.Provider,{value:{state:t,loadingDispatch:s},children:e})};const qs={loading:!1,view:hs.PIPELINE,activePipeline:null},xs=(0,a.createContext)({state:qs,dispatch:()=>{},fetchAndSetPipelineData:()=>Promise.resolve()}),_s=({children:e})=>{const[t,s]=(0,a.useReducer)(ps,qs),{loadingDispatch:r}=(0,a.useContext)(fs);(0,a.useEffect)((()=>{const e=window.wpqt.initialActivePipelineId;e&&l(e,!0)}),[]);const c=(e,t)=>{t?r({type:Ke,payload:e}):s({type:p,payload:e})},l=(e,...t)=>{return a=void 0,n=[e,...t],l=function*(e,t=!1){try{c(!0,t);const{data:{pipeline:a}}=yield function(e){return zt()({path:`/wpqt/v1/pipelines/${e}`,headers:Gt()})}(e);s({type:h,payload:a})}catch(e){console.error(e),i.oR.error((0,o.__)("Unable to load the board. Please try again later.","quicktasker"))}finally{c(!1,t)}},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof r?a:new r((function(e){e(a)}))).then(s,i)}o((l=l.apply(a,n||[])).next())}));var a,n,r,l};return(0,n.jsx)(xs.Provider,{value:{state:t,dispatch:s,fetchAndSetPipelineData:l},children:e})};var gs=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const vs={[os.ARCHIVE_TASK]:(0,o.__)("Task archived by automation","quicktasker"),[os.ASSIGN_USER]:(0,o.__)("User assigned by automation","quicktasker"),[os.NEW_ENTITY_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[os.DELETED_ENTITY_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[os.TASK_ASSIGNED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[os.TASK_UNASSIGNED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[os.TASK_PUBLIC_COMMENT_ADDED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[os.TASK_PRIVATE_COMMENT_ADDED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[os.TASK_FILE_UPLOADED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[os.TASK_FILE_DELETED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[os.CREATE_TASK]:(0,o.__)("Task created by automation","quicktasker"),[os.SEND_SLACK_MESSAGE]:(0,o.__)("Slack message sent by automation","quicktasker")};function js(){const{dispatch:e}=(0,a.useContext)(xs),t=e=>{e&&e.forEach((e=>{if(e.automation_action.includes("email"))return;const t=vs[e.automation_action]||`Automation executed: ${e.automation_action}`;i.oR.info(t)}))},s=(t,s)=>{t&&s&&t.forEach((t=>{if(t.automation_action===os.ARCHIVE_TASK&&e({type:A,payload:s}),t.automation_action===os.ASSIGN_USER){const n=t.executionResult;!n||!(a=n)||"object"!=typeof a||a.user_type&&a.user_type!==Kt.QUICKTASKER&&a.user_type!==Kt.WP_USER||e({type:b,payload:{taskId:s,user:n}})}var a}))};return{displayAutomationMessages:t,handleExecutedAnimationsResults:s,handleExecutedAutomations:(e,a)=>{0!==e.length&&(s(e,a),t(e))},createAutomation:(e,t,s)=>gs(this,void 0,void 0,(function*(){try{const a=yield function(e,t){var s;return zt()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"POST",data:{automationTargetId:null,automationTarget:t.automationTarget,automationTrigger:t.automationTrigger,automationAction:null===(s=t.automationAction)||void 0===s?void 0:s.id,automationActionTargetId:t.automationActionTargetId,automationActionTargetType:t.automationActionTargetType,automationMetadata:t.metaData},headers:Gt()})}(e,t);i.oR.success((0,o.__)("Automation created","quicktasker")),s&&s(!0,a.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create automation","quicktasker")),s&&s(!1,null)}})),updateAutomationActiveStatus:(e,t,s)=>gs(this,void 0,void 0,(function*(){try{const a=yield function(e,t,s){return zt()({path:`/wpqt/v1/pipelines/${e}/automations/${t}/active`,method:"PATCH",data:{active:s},headers:Gt()})}(e,t,s);return i.oR.success(s?(0,o.__)("Automation activated","quicktasker"):(0,o.__)("Automation deactivated","quicktasker")),{success:!0,data:a.data}}catch(e){return console.error(e),i.oR.error(s?(0,o.__)("Failed to activate automation","quicktasker"):(0,o.__)("Failed to deactivate automation","quicktasker")),{success:!1,data:null}}})),deleteAutomation:(e,t,s)=>gs(this,void 0,void 0,(function*(){try{yield function(e,t){return zt()({path:`/wpqt/v1/pipelines/${e}/automations/${t}`,method:"DELETE",headers:Gt()})}(e,t),i.oR.success((0,o.__)("Automation deleted","quicktasker")),s&&s(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete automation","quicktasker")),s&&s(!1)}}))}}var bs=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const ys=()=>{const{handleExecutedAutomations:e}=js(),{displayErrorMessages:t,getMessagesFromResponse:s}=function(){return{displayErrorMessages:e=>{return t=this,s=void 0,n=function*(){if(e.messages&&Array.isArray(e.messages)&&e.messages.length>0){const t=e.messages.join(", ");i.oR.error(t)}},new((a=void 0)||(a=Promise))((function(e,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(t,s||[])).next())}));var t,s,a,n},getMessagesFromResponse:e=>null!==e&&"object"==typeof e&&"messages"in e&&Array.isArray(e.messages)?e.messages:[]}}();return{editTask:(e,t)=>bs(void 0,void 0,void 0,(function*(){try{const s=yield function(e,t){return zt()({path:`/wpqt/v1/tasks/${e}`,method:"PATCH",data:t,headers:Gt()})}(e,t);return{success:!0,task:s.data}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to update task","quicktasker")),{success:!1,task:null}}})),deleteTask:(t,s)=>bs(void 0,void 0,void 0,(function*(){try{const a=yield function(e){return zt()({path:`/wpqt/v1/tasks/${e}`,method:"DELETE",headers:Gt()})}(t);s&&s({success:!0,taskId:t}),i.oR.success((0,o.__)("Task deleted","quicktasker")),e(a.data.executedAutomations,t)}catch(e){s&&s({success:!1,taskId:t}),console.error(e),i.oR.error((0,o.__)("Failed to delete a task","quicktasker"))}})),archiveTask:(e,t)=>bs(void 0,void 0,void 0,(function*(){try{yield function(e){return zt()({path:`/wpqt/v1/tasks/${e}/archive`,method:"PATCH",headers:Gt()})}(e),t&&t({success:!0,taskId:e}),i.oR.success((0,o.__)("Task archived","quicktasker"))}catch(s){t&&t({success:!1,taskId:e}),console.error(s),i.oR.error((0,o.__)("Failed to archive a task","quicktasker"))}})),restoreArchivedTask:(e,t,a)=>bs(void 0,void 0,void 0,(function*(){try{yield function(e,t){return zt()({path:`/wpqt/v1/tasks/${e}/archive-restore`,method:"PATCH",data:{boardId:t},headers:Gt()})}(e,t),a&&a({success:!0,messages:[]}),i.oR.success((0,o.__)("Task restored","quicktasker"))}catch(e){console.error(e),a&&a({success:!1,messages:s(e)}),i.oR.error((0,o.__)("Failed to restore a task","quicktasker"))}})),removeTaskFromUser:(t,s,a)=>bs(void 0,void 0,void 0,(function*(){try{const n=yield Yt(t,s,Kt.QUICKTASKER);i.oR.success((0,o.__)("Task has been unassigned","quicktasker")),e(n.data.executedAutomations,s),a&&a()}catch(e){console.error(e),i.oR.error((0,o.__)("Task unassignment failed. Try again","quicktasker"))}})),changeTaskDoneStatus:(s,a,n)=>bs(void 0,void 0,void 0,(function*(){try{const t=a?(0,o.__)("Task marked as completed","quicktasker"):(0,o.__)("Task marked as incomplete","quicktasker"),r=yield function(e,t){return zt()({path:`/wpqt/v1/tasks/${e}/done`,method:"PATCH",data:{done:t},headers:Gt()})}(s,a);n&&n(a),i.oR.success(t),e(r.data.executedAutomations,s)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change task status","quicktasker")),t(e)}})),moveTask:(e,t,s,a)=>bs(void 0,void 0,void 0,(function*(){try{yield Vt(e,t,s),i.oR.success((0,o.__)("Task moved","quicktasaker")),a&&a(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a task","quicktasker")),a&&a(!1)}})),updateTaskFocusColor:(e,t)=>bs(void 0,void 0,void 0,(function*(){const s={taskId:e,color:t};try{return yield function(e,t){return zt()({path:`/wpqt/v1/tasks/${e}/focus-color`,method:"PATCH",data:{color:t},headers:Gt()})}(e,t),i.oR.success((0,o.__)("Task focus color changed","quicktasker")),Object.assign({success:!0},s)}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to change task focus color","quicktasker")),Object.assign({success:!1},s)}})),cleanupTaskArchive:()=>bs(void 0,void 0,void 0,(function*(){try{const e=(yield zt()({path:"/wpqt/v1/archive/settings/task-cleanup",method:"PATCH",headers:Gt()})).data.deletedTaskIds;return i.oR.success((0,o.sprintf)((0,o.__)("Removed %d orphaned tasks from archive","quicktasker"),e.length)),{success:!0,deletedTaskIds:e}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to clean up task archive","quicktasker")),{success:!1,deletedTaskIds:[]}}}))}},Es=(e,t)=>{var s,a,n,i,o,r,c,l;switch(t.type){case fe:{const s=t.payload;return Object.assign(Object.assign({},e),{archivedTasks:s.map(ds)})}case ke:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveSearchValue:s})}case qe:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveFilteredPipelineId:s})}case xe:{const a=(null!==(s=e.archivedTasks)&&void 0!==s?s:[]).filter((e=>e.id!==t.payload));return Object.assign(Object.assign({},e),{archivedTasks:a})}case _e:{const s=t.payload,n=(null!==(a=e.archivedTasks)&&void 0!==a?a:[]).filter((e=>!s.includes(e.id)));return Object.assign(Object.assign({},e),{archivedTasks:n})}case ge:{const{taskId:s,user:a}=t.payload,i=(null!==(n=e.archivedTasks)&&void 0!==n?n:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Xt(a)?[a,...e.assigned_users]:e.assigned_users,assigned_wp_users:Zt(a)?[a,...e.assigned_wp_users]:e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case ve:{const{taskId:s,user:a}=t.payload,n=(null!==(i=e.archivedTasks)&&void 0!==i?i:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Xt(a)?e.assigned_users.filter((e=>e.id!==a.id)):e.assigned_users,assigned_wp_users:Zt(a)?e.assigned_wp_users.filter((e=>e.id!==a.id)):e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case je:{const{taskId:s,done:a}=t.payload,n=(null!==(o=e.archivedTasks)&&void 0!==o?o:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:a}):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case be:{const s=t.payload,a=(null!==(r=e.archivedTasks)&&void 0!==r?r:[]).map((e=>e.id===s.id?ds(s):e));return Object.assign(Object.assign({},e),{archivedTasks:a})}case ye:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskDoneFilter:s})}case Ee:{const{taskId:s,label:a}=t.payload,n=(null!==(c=e.archivedTasks)&&void 0!==c?c:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_labels:[...e.assigned_labels,a]}):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case Te:{const{taskId:s,labelId:a}=t.payload,n=(null!==(l=e.archivedTasks)&&void 0!==l?l:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_labels:e.assigned_labels.filter((e=>e.id!==a))}):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case Se:{const s=t.payload;return Object.assign(Object.assign({},e),{archivedTaskLimit:s})}case Ae:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveLoading:s})}case Oe:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveFilterOrder:s})}default:return e}};var Ts,Ss,As,Os,Ns,Cs;!function(e){e.Task="task",e.User="user"}(Ts||(Ts={})),function(e){e.System="system",e.Admin="admin",e.WPQTUser="quicktasker_user",e.Automation="automation",e.Import="import"}(Ss||(Ss={})),function(e){e.All="",e.Completed="1",e.NotCompleted="0"}(As||(As={})),function(e){e.Admin="administrator",e.Other="other"}(Os||(Os={})),function(e){e.ALL="",e.ONE_HUNDRED="100",e.TWO_HUNDRED="200",e.FIVE_HUNDRED="500"}(Ns||(Ns={})),function(e){e.ASC="ASC",e.DESC="DESC"}(Cs||(Cs={}));var Is=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Ds={archivedTasks:null,archiveLoading:!1,archiveSearchValue:"",archiveFilteredPipelineId:"",archiveTaskDoneFilter:As.All,archivedTaskLimit:Ns.ONE_HUNDRED,archiveFilterOrder:Cs.DESC},Ps=(0,a.createContext)({state:Ds,archiveDispatch:()=>{},fetchAndSetArchivedTasks:()=>Is(void 0,void 0,void 0,(function*(){}))}),Rs=({children:e})=>{const[t,s]=(0,a.useReducer)(Es,Ds);(0,a.useEffect)((()=>{r()}),[]);const r=()=>Is(void 0,void 0,void 0,(function*(){try{s({type:Ae,payload:!0});const{data:e}=yield function(e){const t=new URLSearchParams;return e.search&&t.set("search",e.search),e.pipelineId&&t.set("pipelineId",e.pipelineId),e.doneFilter&&t.set("status",e.doneFilter),null!==e.limit&&t.set("limit",String(e.limit)),e.order&&t.set("order",e.order),zt()({path:`/wpqt/v1/tasks/archived?${t}`,method:"GET",headers:Gt()})}({search:t.archiveSearchValue,pipelineId:t.archiveFilteredPipelineId,doneFilter:t.archiveTaskDoneFilter,limit:t.archivedTaskLimit,order:t.archiveFilterOrder});s({type:fe,payload:e})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch archived tasks","quicktasker"))}finally{s({type:Ae,payload:!1})}}));return(0,n.jsx)(Ps.Provider,{value:{state:t,archiveDispatch:s,fetchAndSetArchivedTasks:r},children:e})},Ls=()=>Object.assign({},Fs),Ms=(e,t)=>{var s,a,n,i,o,r,c,l,d,u,p,h,m,w,f,k;switch(t.type){case U:{const{taskToEdit:s,taskModalSettings:a}=t.payload;return Object.assign(Object.assign({},e),{taskModalOpen:!0,taskToEdit:s,targetStageId:s.stage_id,taskModalSettings:Object.assign(Object.assign({},e.taskModalSettings),a)})}case F:return Ls();case Q:{const d=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:Xt(d)?[d,...null!==(a=null===(s=e.taskToEdit)||void 0===s?void 0:s.assigned_users)&&void 0!==a?a:[]]:null!==(i=null===(n=e.taskToEdit)||void 0===n?void 0:n.assigned_users)&&void 0!==i?i:[],assigned_wp_users:Zt(d)?[d,...null!==(r=null===(o=e.taskToEdit)||void 0===o?void 0:o.assigned_wp_users)&&void 0!==r?r:[]]:null!==(l=null===(c=e.taskToEdit)||void 0===c?void 0:c.assigned_wp_users)&&void 0!==l?l:[]})})}case Y:{const s=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:Xt(s)?(null!==(u=null===(d=e.taskToEdit)||void 0===d?void 0:d.assigned_users)&&void 0!==u?u:[]).filter((e=>e.id!==s.id)):null!==(h=null===(p=e.taskToEdit)||void 0===p?void 0:p.assigned_users)&&void 0!==h?h:[],assigned_wp_users:Zt(s)?(null!==(w=null===(m=e.taskToEdit)||void 0===m?void 0:m.assigned_wp_users)&&void 0!==w?w:[]).filter((e=>e.id!==s.id)):null!==(k=null===(f=e.taskToEdit)||void 0===f?void 0:f.assigned_wp_users)&&void 0!==k?k:[]})})}case K:{const{targetPipelineId:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,targetPipelineId:s})}case z:{const{stageToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,stageToEdit:s})}case $:return Ls();case G:return Object.assign(Object.assign({},e),{newPipelineModalOpen:!0});case V:{const{pipelineToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{pipelineModalOpen:!0,pipelineToEdit:s})}case B:return Ls();case"OPEN_ARCHIVE_TASK_MODAL":{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskModalOpen:!0,archiveModalTask:s})}case"CLOSE_ARCHIVE_TASK_MODAL":return Ls();case"OPEN_NEW_USER_MODAL":return Object.assign(Object.assign({},e),{userModalOpen:!0});case W:{const s=t.payload;return Object.assign(Object.assign({},e),{userModalOpen:!0,userToEdit:s})}case H:return Ls();case J:return t.payload?Object.assign(Object.assign({},e),{userSettingsModalOpen:!0}):Ls();case"CHANGE_TASK_DONE_STATUS":{const{done:s}=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{is_done:s})})}case X:{const{task:s}=t.payload;return Object.assign(Object.assign({},e),{moveTaskModalOpen:!0,taskToEdit:s})}case Z:return Ls();case ee:{const{task:s}=t.payload;return Object.assign(Object.assign({},e),{taskColorModalOpen:!0,taskToEdit:s})}case te:return Ls();case se:{const{selectedMethod:s}=t.payload;return Object.assign(Object.assign({},e),{taskExportModalOpen:!0,taskExportModalSettings:Object.assign(Object.assign({},e.taskExportModalSettings),{selectedMethod:s})})}case ae:return Ls();case ne:{const{selectedMethod:s}=t.payload;return Object.assign(Object.assign({},e),{taskExportModalSettings:Object.assign(Object.assign({},e.taskExportModalSettings),{selectedMethod:s})})}case ie:return Object.assign(Object.assign({},e),{pipelineImportModalOpen:!0});case oe:return Ls();case re:return t.payload?Object.assign(Object.assign({},e),{archiveSettingsModalOpen:!0}):Ls();case ce:{const{taskToRestore:s}=t.payload;return Object.assign(Object.assign({},e),{taskRestoreModalOpen:!0,taskRestoreModalSettings:Object.assign(Object.assign({},e.taskRestoreModalSettings),{taskToRestore:s})})}case de:{const s=t.payload;return Object.assign(Object.assign({},e),{customFieldCreatorModalOpen:s})}case ue:{const s=t.payload;return Object.assign(Object.assign({},e),{customFieldRecoveryModalOpen:s})}case le:return Ls();case pe:{const s=t.payload;return Object.assign(Object.assign({},e),{webhookCreationModalOpen:s})}case he:{const s=t.payload;return Object.assign(Object.assign({},e),{webhooksModalOpen:s})}case me:{const{webhookId:s}=t.payload;return Object.assign(Object.assign({},e),{webhooksLogsModalOpen:!0,webhooksLogsModalSettings:Object.assign(Object.assign({},e.webhooksLogsModalSettings),{webhookId:s})})}case we:return Object.assign(Object.assign({},e),{webhooksLogsModalOpen:!1,webhooksLogsModalSettings:Object.assign({},Fs.webhooksLogsModalSettings)});case"UPDATE_WEBHOOKS_LOGS_MODAL_SETTINGS":{const s=t.payload;return Object.assign(Object.assign({},e),{webhooksLogsModalSettings:Object.assign(Object.assign({},e.webhooksLogsModalSettings),s)})}default:return e}};var Us;!function(e){e.PDF="pdf",e.CSV="csv",e.JSON="json"}(Us||(Us={}));const Fs={taskModalOpen:!1,targetStageId:"",taskToEdit:null,taskModalSettings:{allowToMarkTaskAsDone:!0},moveTaskModalOpen:!1,stageModalOpen:!1,stageToEdit:null,targetPipelineId:"",pipelineModalOpen:!1,newPipelineModalOpen:!1,pipelineToEdit:null,archiveTaskModalOpen:!1,archiveModalTask:null,userModalOpen:!1,userToEdit:null,userSettingsModalOpen:!1,taskColorModalOpen:!1,taskExportModalOpen:!1,taskExportModalSettings:{selectedMethod:Us.PDF},pipelineImportModalOpen:!1,automationCreatorModalOpen:!1,automationsModalOpen:!1,archiveSettingsModalOpen:!1,taskRestoreModalOpen:!1,taskRestoreModalSettings:{taskToRestore:null},customFieldCreatorModalOpen:!1,customFieldRecoveryModalOpen:!1,webhookCreationModalOpen:!1,webhooksModalOpen:!1,webhooksLogsModalOpen:!1,webhooksLogsModalSettings:{webhookId:null}},Ks=(0,a.createContext)({state:Fs,modalDispatch:()=>{}}),$s=({children:e})=>{const[t,s]=(0,a.useReducer)(Ms,Fs);return(0,n.jsx)(Ks.Provider,{value:{state:t,modalDispatch:s},children:e})};var zs,Gs,Vs=s(2922),Bs=s(6053),Hs=s(9828),Ws=s(540),Qs=s(4576),Ys=s(5138),Js=s(6061);function Xs({width:e="80",height:t="80",className:s="",color:a="#1d4ed8",secondaryColor:i="#2563eb"}){return(0,n.jsx)(Js.BM,{visible:!0,height:t,width:e,color:a,secondaryColor:i,ariaLabel:"oval-loading",wrapperStyle:{},wrapperClass:s})}function Zs(){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-flex-col wpqt-items-center wpqt-justify-center",children:(0,n.jsx)(Xs,{})})}function ea({className:e="",ovalSize:t}){const s=t?{width:t,height:t}:{};return(0,n.jsx)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center ${e}`,"data-testid":"loading-oval",children:(0,n.jsx)(Xs,Object.assign({},s))})}function ta({onClick:e=()=>{},btnText:t,className:s,type:a=zs.BUTTON,disabled:i=!1,loading:o=!1,buttonStyleType:r=Gs.PRIMARY}){const c=r===Gs.PRIMARY?"wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-transparent wpqt-bg-blue-500 wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-text-white wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 focus:wpqt-ring-blue-800 enabled:hover:wpqt-bg-blue-600":r===Gs.SECONDARY?"wpqt-inline-flex wpqt-cursor-pointer wpqt-bg-gray-100 wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 enabled:hover:wpqt-bg-gray-200":"wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-transparent wpqt-bg-red-500 wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-text-white wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 focus:wpqt-ring-red-800 enabled:hover:wpqt-bg-red-600";return(0,n.jsx)(Ys.$,{disabled:i||o,className:`${c} ${s}`,onClick:e,type:a,children:o?(0,n.jsx)(Xs,{width:"24",height:"24",color:"#ffffff",secondaryColor:"#ffffff"}):t})}!function(e){e.BUTTON="button",e.SUBMIT="submit",e.RESET="reset"}(zs||(zs={})),function(e){e.PRIMARY="primary",e.SECONDARY="secondary",e.DANGER="danger"}(Gs||(Gs={}));var sa=s(7008);function aa({id:e}){return(0,n.jsx)(sa.m_,{id:e,className:"wpqt-bg-red-600 wpqt-z-9999",children:(0,n.jsx)("span",{children:"Tooltip content"})})}function na({modalOpen:e,closeModal:t,children:s,size:a="sm"}){return(0,n.jsxs)(Vs.lG,{open:e,as:"div",className:"wpqt-relative wpqt-z-9999 focus:wpqt-outline-none",onClose:t,children:[(0,n.jsx)(Vs.Xi,{className:"wpqt-fixed wpqt-inset-0 wpqt-bg-black/40"}),(0,n.jsx)("div",{className:"wpqt-fixed wpqt-inset-0 wpqt-z-10 wpqt-w-screen wpqt-overflow-y-auto",children:(0,n.jsx)("div",{className:"wpqt-mt-[8vh] wpqt-flex wpqt-justify-center",children:(0,n.jsxs)(Vs.Lj,{transition:!0,className:`data-[closed]:wpqt-transform-[wpqt-scale(95%)] wpqt-relative wpqt-mt-[20px] wpqt-w-4/5 ${{sm:"wpqt-max-w-sm",md:"wpqt-max-w-lg",lg:"wpqt-max-w-4xl",xl:"wpqt-max-w-6xl"}[a]} wpqt-rounded-xl wpqt-bg-white wpqt-p-8 wpqt-backdrop-blur-2xl wpqt-duration-300 wpqt-ease-out data-[closed]:wpqt-opacity-0`,children:[(0,n.jsx)("div",{className:"wpqt-group wpqt-absolute wpqt-right-[-20px] wpqt-top-[-20px] wpqt-flex wpqt-h-[40px] wpqt-w-[40px] wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-rounded-full wpqt-border wpqt-border-solid wpqt-bg-white wpqt-text-qtBorder",onClick:t,"data-testid":"wpqt-modal-close-button",children:(0,n.jsx)(Qs.A,{className:"wpqt-icon-blue group-hover:wpqt-icon-red wpqt-size-5"})}),s]})})})]})}function ia({children:e,className:t=""}){return(0,n.jsx)(Vs.L3,{as:"div",className:`wpqt-text-base wpqt-font-semibold wpqt-text-black wpqt-mb-2 ${t}`,children:e})}function oa({children:e}){return(0,n.jsx)(Bs.L,{children:e})}function ra({label:e,description:t,children:s,tooltipId:a,tooltipText:i}){const o=a&&i,r=o?{"data-tooltip-id":a,"data-tooltip-content":i,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info","data-tooltip-place":"top-end"}:{};return(0,n.jsxs)(Hs.D,{className:"wpqt-mb-3",children:[(0,n.jsx)(Ws.JU,Object.assign({className:"wpqt-mb-2 wpqt-block wpqt-text-sm/6 wpqt-font-medium"},r,{children:e})),t&&(0,n.jsx)("p",{className:"wpqt-mb-2 wpqt-mt-0 wpqt-text-xs wpqt-text-gray-500",children:t}),s,o&&(0,n.jsx)(aa,{id:a})]})}function ca({onSave:e,saveBtnText:t,loading:s=!1}){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-end wpqt-px-2",children:(0,n.jsx)(ta,{btnText:t,loading:s,onClick:e})})}function la({icon:e,text:t,onClick:s,className:a,tooltipId:i,tooltipText:o,loading:r=!1}){const c=o&&i,l=c?{"data-tooltip-id":i,"data-tooltip-content":o,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,n.jsxs)("div",Object.assign({},l,{className:`wpqt-main-border wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-bg-gray-100 wpqt-p-2 hover:wpqt-bg-white ${a}`,onClick:s,children:[e,t||r?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center wpqt-relative",children:[t&&(0,n.jsx)("span",{className:"wpqt-whitespace-nowrap "+(r?"wpqt-invisible":""),children:t}),r&&(0,n.jsx)(Xs,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]}):null,c&&(0,n.jsx)(aa,{id:i})]}))}var da=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ua({title:e,description:t,onSave:s,icon:i,saveBtnText:r=(0,o.__)("Clean","quicktask")}){const[c,l]=(0,a.useState)(!1);return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-lg",children:e}),(0,n.jsx)("p",{className:"wpqt-mt-0",children:t}),(0,n.jsx)(la,{onClick:()=>da(this,void 0,void 0,(function*(){c||(l(!0),yield s(),l(!1))})),icon:i,loading:c,text:r})]})}var pa=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ha(){const{state:{archiveSettingsModalOpen:e},modalDispatch:t}=(0,a.useContext)(Ks),{cleanupTaskArchive:s}=ys(),{archiveDispatch:i}=function(){const{archiveDispatch:e}=(0,a.useContext)(Ps);return{archiveDispatch:e}}();return(0,n.jsx)(na,{modalOpen:e,closeModal:()=>{t({type:re,payload:!1})},size:"md",children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:(0,n.jsx)(ua,{title:(0,o.__)("Archive cleanup","quicktasker"),description:(0,o.__)("Remove tasks from archive that have no parent board.","quicktasker"),icon:(0,n.jsx)(u.xWQ,{className:"wpqt-size-6"}),onSave:()=>pa(this,void 0,void 0,(function*(){const{success:e,deletedTaskIds:t}=yield s();e&&t.length>0&&i({type:_e,payload:t})}))})})})}var ma=s(1489);const wa=(e,t)=>{var s;switch(t.type){case j:{const s=t.payload,a=e=>Object.assign({},us(e)),n=e=>{var t;return Object.assign(Object.assign({},e),{stages:null===(t=e.stages)||void 0===t?void 0:t.map(a),settings:e.settings?es(e.settings):void 0,is_primary:"1"===e.is_primary})};return Object.assign(Object.assign({},e),{pipelines:s.map(n)})}case _:{const a=t.payload,n=e=>Object.assign({},us(e)),i=Object.assign(Object.assign({},a),{stages:null===(s=a.stages)||void 0===s?void 0:s.map(n),settings:a.settings?es(a.settings):void 0,is_primary:!1});return Object.assign(Object.assign({},e),{pipelines:[...e.pipelines,i]})}case v:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>Object.assign(Object.assign({},e),{is_primary:e.id===s})))})}case g:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>e.id===s.id?Object.assign(Object.assign({},e),{name:s.name,description:s.description}):e))})}case T:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.filter((e=>e.id!==s))})}default:return e}},fa={pipelines:[]},ka=(0,a.createContext)({state:fa,pipelinesDispatch:()=>{}}),qa=({children:e})=>{const[t,s]=(0,a.useReducer)(wa,fa);return(0,a.useEffect)((()=>{const e=window.wpqt.initialPipelines;s({type:j,payload:e})}),[]),(0,n.jsx)(ka.Provider,{value:{state:t,pipelinesDispatch:s},children:e})};function xa(){const{state:{pipelines:e},pipelinesDispatch:t}=(0,a.useContext)(ka);return{pipelines:e,pipelinesDispatch:t,checkIfPipelineNameExists:function(t){return e.some((e=>e.name.toLowerCase()===t.toLowerCase()))}}}var _a=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};function ga(e){var{children:t,labelFor:s,className:a=""}=e,i=_a(e,["children","labelFor","className"]);return(0,n.jsx)("label",Object.assign({htmlFor:s,className:`wpqt-mb-1 ${a}`},i,{children:t}))}var va=s(3482);function ja({options:e,selectedOptionValue:t,onSelectionChange:s,allSelector:a=!0,className:i="",allSelectorLabel:o="All boards",id:r}){return(0,n.jsxs)(va.l,{id:r,value:t,onChange:e=>{const t=e.target.value;s(t)},className:`!wpqt-rounded-lg !wpqt-border !wpqt-border-solid !wpqt-border-qtBorder !wpqt-px-2 !wpqt-pr-6 !wpqt-py-1 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`,children:[a&&(0,n.jsx)("option",{value:"",children:o}),e.map((e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value)))]})}var ba,ya=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ea(){var e;const{state:{taskRestoreModalOpen:t,taskRestoreModalSettings:s},modalDispatch:i}=(0,a.useContext)(Ks),{archiveDispatch:r}=(0,a.useContext)(Ps),{pipelines:c}=xa(),{restoreArchivedTask:l}=ys(),d=(0,a.useMemo)((()=>c.map((e=>({value:e.id,label:e.name})))),[c]),[u,p]=(0,a.useState)(""),[h,m]=(0,a.useState)(!1),[w,f]=(0,a.useState)([]);return(0,a.useEffect)((()=>{var e;const t=(null===(e=null==s?void 0:s.taskToRestore)||void 0===e?void 0:e.pipeline_id)||"";t?p(t):d.length>0&&p(d[0].value)}),[s,d]),(0,n.jsx)(na,{modalOpen:t,closeModal:()=>{i({type:le}),f([])},children:(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start",children:[(0,n.jsx)(ia,{children:(0,o.sprintf)((0,o.__)("Restore %s","quicktasker"),(null===(e=null==s?void 0:s.taskToRestore)||void 0===e?void 0:e.name)||"")}),(0,n.jsx)(ga,{labelFor:"task-restore-pipeline-select",children:(0,o.__)("Select the board to restore to","quicktasker")}),(0,n.jsx)(ja,{options:d,className:"wpqt-mb-2",allSelector:!1,selectedOptionValue:u,id:"task-restore-pipeline-select",onSelectionChange:e=>{p(e),f([])}}),w.length>0&&(0,n.jsx)("div",{className:"wpqt-text-red-500",children:w.map(((e,t)=>(0,n.jsx)("p",{className:"wpqt-mt-0 wpqt-mb-1",children:e},t)))}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-end wpqt-w-full",children:(0,n.jsx)(la,{icon:(0,n.jsx)(ma.A,{className:"wpqt-icon-green wpqt-size-4"}),loading:h,text:(0,o.__)("Restore","quicktasker"),onClick:()=>ya(this,void 0,void 0,(function*(){const e=null==s?void 0:s.taskToRestore;e&&u&&!h&&(m(!0),yield l(e.id,u,(({success:t,messages:s})=>{t?(r({type:xe,payload:e.id}),i({type:le})):s&&s.length>0&&f(s)})),m(!1))}))})})]})})})}!function(e){e.SELECTION="select",e.CREATION="create",e.EDIT="edit"}(ba||(ba={}));const Ta=(e,t)=>{switch(t.type){case it:return Object.assign(Object.assign({},e),{labels:t.payload});case ot:return Object.assign(Object.assign({},e),{labels:e.labels?[...e.labels,t.payload]:[t.payload],labelActionState:ba.SELECTION});case ct:return Object.assign(Object.assign({},e),{labels:e.labels?e.labels.map((e=>e.id===t.payload.id?t.payload:e)):[t.payload]});case rt:return Object.assign(Object.assign({},e),{labels:e.labels?e.labels.filter((e=>e.id!==t.payload.id)):[]});case lt:return Object.assign(Object.assign({},e),{labelActionState:ba.SELECTION,labelToEdit:null});case dt:return Object.assign(Object.assign({},e),{labelActionState:ba.EDIT,labelToEdit:t.payload});case ut:return Object.assign(Object.assign({},e),{labelActionState:ba.CREATION,labelToEdit:null});case pt:return Sa;default:return e}},Sa={labels:null,labelActionState:ba.SELECTION,labelToEdit:null},Aa=(0,a.createContext)({state:Sa,labelDispatch:()=>{}}),Oa=({children:e})=>{const[t,s]=(0,a.useReducer)(Ta,Sa);return(0,n.jsx)(Aa.Provider,{value:{state:t,labelDispatch:s},children:e})};function Na({children:e}){const{state:{fullPageLoading:t}}=(0,a.useContext)(fs);return(0,n.jsx)("div",{className:"wpqt-pr-4",children:t?(0,n.jsx)(Zs,{}):e})}var Ca=s(4175),Ia=s(2912);function Da({errorText:e}){return e?(0,n.jsx)("div",{className:"wpqt-text-qtTextRed wpqt-mt-1",children:e}):null}var Pa;!function(e){e.TEXT="text",e.PASSWORD="password"}(Pa||(Pa={}));const Ra=(0,a.forwardRef)(((e,t)=>{var{value:s,onChange:a,isAutoFocus:i,className:o="",wrapperClassName:r="",disabled:c=!1,type:l=Pa.TEXT,loading:d=!1,inputId:u,name:p,errorText:h}=e,m=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s}(e,["value","onChange","isAutoFocus","className","wrapperClassName","disabled","type","loading","inputId","name","errorText"]);return(0,n.jsxs)("div",{className:`wpqt-inline-block wpqt-relative wpqt-mb-3 ${r}`,children:[(0,n.jsx)(Ia.p,Object.assign({ref:t,autoFocus:i,className:`wpqt-block !wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${o}`,value:s,disabled:c,onChange:e=>a(e.target.value),type:l,id:u,name:p},m)),d&&(0,n.jsx)(Xs,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"}),h&&(0,n.jsx)(Da,{errorText:h})]})}));function La({selectedOptionValue:e,selectionChange:t,extraOptions:s=[]}){const{state:{pipelines:i}}=(0,a.useContext)(ka),o=(0,a.useMemo)((()=>i.map((e=>({value:e.id,label:e.name})))),[i]);return(0,n.jsx)(ja,{options:[...o,...s],selectedOptionValue:e,onSelectionChange:t})}function Ma({children:e,searchChildren:t,applyFilterChildren:s,title:a,childrenClassName:i="",titleClassName:o=""}){return(0,n.jsxs)("div",{className:"wpqt-mb-8",children:[(0,n.jsx)("div",{className:`wpqt-mb-3 wpqt-text-lg wpqt-text-center wpqt-font-semibold ${o}`,children:a}),(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-justify-center wpqt-gap-2",children:t}),(0,n.jsx)("div",{className:`wpqt-flex wpqt-gap-5 wpqt-items-center wpqt-justify-center wpqt-mb-6 ${i}`,children:e}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:s})]})}function Ua({children:e,title:t,className:s="",labelIdFor:a}){return(0,n.jsxs)("div",{className:`wpqt-flex wpqt-flex-col ${s}`,children:[(0,n.jsx)(ga,{labelFor:a,children:t}),e]})}function Fa(){const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s,archivedTaskLimit:i,archiveFilterOrder:r},archiveDispatch:c,fetchAndSetArchivedTasks:l}=(0,a.useContext)(Ps),d=(0,n.jsx)(la,{text:(0,o.__)("Apply filter","quicktasker"),icon:(0,n.jsx)(Ca.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:l});return(0,n.jsxs)(Ma,{title:(0,o.__)("Archive filtering","quicktasker"),applyFilterChildren:d,searchChildren:(0,n.jsx)(Ua,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"archive-search",children:(0,n.jsx)(Ra,{inputId:"archive-search",value:e,onChange:e=>{c({type:ke,payload:e})}})}),children:[(0,n.jsx)(Ua,{title:(0,o.__)("Task board","quicktasker"),children:(0,n.jsx)(La,{selectedOptionValue:t,selectionChange:e=>{c({type:qe,payload:e})}})}),(0,n.jsx)(Ua,{title:(0,o.__)("Task status","quicktasker"),children:(0,n.jsx)(ja,{allSelector:!1,selectedOptionValue:s,options:[{label:(0,o.__)("All","quicktasker"),value:As.All},{label:(0,o.__)("Completed","quicktasker"),value:As.Completed},{label:(0,o.__)("Not completed","quicktasker"),value:As.NotCompleted}],onSelectionChange:e=>{const t=(e=>{switch(e){case As.All:return As.All;case As.Completed:return As.Completed;case As.NotCompleted:return As.NotCompleted;default:throw new Error(`Invalid selection: ${e}`)}})(e);c({type:ye,payload:t})}})}),(0,n.jsx)(Ua,{title:(0,o.__)("Number of tasks","quicktasker"),children:(0,n.jsx)(ja,{allSelector:!1,selectedOptionValue:i,options:[{label:(0,o.__)("Show all","quicktasker"),value:Ns.ALL},{label:(0,o.__)("Show 100","quicktasker"),value:Ns.ONE_HUNDRED},{label:(0,o.__)("Show 200","quicktasker"),value:Ns.TWO_HUNDRED},{label:(0,o.__)("Show 500","quicktasker"),value:Ns.FIVE_HUNDRED}],onSelectionChange:e=>{c({type:Se,payload:e})}})}),(0,n.jsx)(Ua,{title:(0,o.__)("Task order","quicktasker"),children:(0,n.jsx)(ja,{allSelector:!1,selectedOptionValue:r,options:[{label:(0,o.__)("Desc","quicktasker"),value:Cs.DESC},{label:(0,o.__)("Asc","quicktasker"),value:Cs.ASC}],onSelectionChange:e=>{c({type:Oe,payload:e})}})})]})}const Ka=(e,t)=>{switch(t.type){case Ne:{const s=t.payload.map(rs);return Object.assign(Object.assign({},e),{users:s})}case Ce:{const s=t.payload.map((e=>Object.assign(Object.assign({},e),{id:String(e.id)})));return Object.assign(Object.assign({},e),{wpUsers:s})}case Ie:{const s=t.payload,a=rs(s);return Object.assign(Object.assign({},e),{users:[...e.users,a]})}case Pe:{const s=t.payload,a=rs(s),n=e.users.map((e=>e.id===a.id?Object.assign(Object.assign({},e),a):e));return Object.assign(Object.assign({},e),{users:n})}case Le:{const{isActive:s,userId:a}=t.payload,n=e.users.map((e=>e.id===a?Object.assign(Object.assign({},e),{is_active:s}):e));return Object.assign(Object.assign({},e),{users:n})}case Me:{const s=t.payload,a=e.users.map((e=>e.id===s?Object.assign(Object.assign({},e),{has_password:!1}):e));return Object.assign(Object.assign({},e),{users:a})}case Re:{const s=t.payload,a=e.users.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{users:a})}case De:{const s=t.payload;return Object.assign(Object.assign({},e),{usersSearchValue:s})}default:return e}};var $a=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const za={users:[],wpUsers:[],usersSearchValue:""},Ga=(0,a.createContext)({state:za,userDispatch:()=>{},updateUsers:()=>$a(void 0,void 0,void 0,(function*(){}))}),Va=({children:e})=>{const[t,s]=(0,a.useReducer)(Ka,za);return(0,a.useEffect)((()=>{const e=window.wpqt.initialUsers,t=window.wpqt.initialWPUsers;s({type:Ne,payload:e}),s({type:Ce,payload:t})}),[]),(0,n.jsx)(Ga.Provider,{value:{state:t,userDispatch:s,updateUsers:()=>$a(void 0,void 0,void 0,(function*(){try{const e=yield zt()({path:"/wpqt/v1/users",method:"GET",headers:Gt()});s({type:Ne,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch users","quicktasker"))}}))},children:e})};var Ba;!function(e){e.ACTIVE_PIPELINE="ACTIVE_PIPELINE",e.PIPELINES="PIPELINES",e.USER="USER"}(Ba||(Ba={}));const Ha=e=>{const[t,s]=(0,a.useState)(!1),n=(0,a.useRef)(null),{modalDispatch:i}=(0,a.useContext)(Ks),{dispatch:o}=(0,a.useContext)(xs),{pipelinesDispatch:r}=(0,a.useContext)(ka),{userDispatch:c}=(0,a.useContext)(Ga);return{modalSaving:t,setModalSaving:s,modalContentRef:n,closeModal:()=>{i({type:e}),n.current&&n.current.clearContent()},handleSuccess:(e,t,a)=>{let n;switch(a){case Ba.PIPELINES:n=r;break;case Ba.ACTIVE_PIPELINE:n=o;break;case Ba.USER:n=c;break;default:n=o}s(!1),n({type:e,payload:t})},handleError:e=>{s(!1),console.error(e)}}},Wa=(e,t)=>{switch(t.type){case St:return Object.assign(Object.assign({},e),{uploads:t.payload});case At:return Object.assign(Object.assign({},e),{uploads:[...e.uploads,t.payload]});case Ot:return Object.assign(Object.assign({},e),{uploads:e.uploads.filter((e=>e.id!==t.payload))});default:return e}},Qa={uploads:[]},Ya=(0,a.createContext)({state:Qa,uploadDispatch:()=>{}}),Ja=({children:e})=>{const[t,s]=(0,a.useReducer)(Wa,Qa);return(0,n.jsx)(Ya.Provider,{value:{state:t,uploadDispatch:s},children:e})};var Xa=s(8448),Za=s(8176),en=s(1052);function tn(){const[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1);return{loading1:e,loading2:s,setLoading1:t,setLoading2:n,loading3:i,setLoading3:o}}const sn=(e,t)=>{switch(t.type){case"SET_SITE_URL":{const s=t.payload;return Object.assign(Object.assign({},e),{siteURL:s})}case Ue:{const{siteURL:s,publicUserPageId:a,timezone:n,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r,taskUploadsURL:c}=t.payload;return Object.assign(Object.assign({},e),{siteURL:s,publicUserPageId:a,timezone:n,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r,taskUploadsURL:c})}case Fe:{const s=t.payload;return Object.assign(Object.assign({},e),{userPageCustomStyles:s})}default:return e}},an={siteURL:"",pluginURL:"",publicUserPageId:"",is_customFields:!0,timezone:"",isUserAllowedToDelete:!1,userPageCustomStyles:"",taskUploadsURL:""},nn=(0,a.createContext)({state:an,appDispatch:()=>{}}),on=({children:e})=>{const[t,s]=(0,a.useReducer)(sn,an);return(0,a.useEffect)((()=>{const e=window.wpqt.siteURL,t=window.wpqt.publicUserPageId,a=window.wpqt.timezone,n="1"===window.wpqt.isUserAllowedToDelete,i=window.wpqt.userPageCustomStyles,o=window.wpqt.pluginURL,r=window.wpqt.taskUploadsURL;s({type:Ue,payload:{siteURL:e,publicUserPageId:t,timezone:a,isUserAllowedToDelete:n,userPageCustomStyles:i,pluginURL:o,taskUploadsURL:r}})}),[]),(0,n.jsx)(nn.Provider,{value:{state:t,appDispatch:s},children:e})};var rn,cn,ln;!function(e){e.Text="text",e.Select="select",e.Checkbox="checkbox",e.Radio="radio",e.Datetime="datetime",e.File="file"}(rn||(rn={})),function(e){e.QUICKTASKER="quicktasker",e.WP_USER="wp-user",e.Pipeline="pipeline",e.Users="users",e.Task="task"}(cn||(cn={})),function(e){e.TASK="task"}(ln||(ln={}));function dn({value:e,onChange:t,debounceTimeout:s=Nt,isAutoFocus:i=!1,wrapperClassName:o,className:r}){const[c,l]=(0,a.useState)(e),[d,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{l(e)}),[e]),(0,a.useEffect)((()=>{if(!p)return;const e=setTimeout((()=>{return e=this,s=void 0,n=function*(){h(!1),u(!0),yield t(c),u(!1)},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n}),s);return()=>clearTimeout(e)}),[c,p,s,t]),(0,n.jsx)(Ra,{isAutoFocus:i,value:c,onChange:e=>{l(e),h(!0)},wrapperClassName:o,className:r,loading:d,disabled:d})}var un=s(1062),pn=s(4164);function hn({value:e,onChange:t,rowsCount:s=3,colsCount:a,className:i="",disabled:o=!1,loading:r=!1}){return(0,n.jsxs)("div",{className:"wpqt-relative wpqt-mb-3",children:[(0,n.jsx)(un.T,{className:(0,pn.$)("wpqt-border-1 wpqt-mb-3 wpqt-block wpqt-w-auto wpqt-resize-none wpqt-rounded-lg wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6",`focus:wpqt-shadow-none focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`),rows:s,cols:a,value:e,onChange:e=>t(e.target.value),disabled:o}),r&&(0,n.jsx)(Xs,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"})]})}function mn({value:e,onChange:t,debounceTimeout:s=Nt,className:i}){const[o,r]=(0,a.useState)(e),[c,l]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{r(e)}),[e]),(0,a.useEffect)((()=>{if(!d)return;const e=setTimeout((()=>{return e=this,s=void 0,n=function*(){u(!1),l(!0),yield t(o),l(!1)},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n}),s);return()=>clearTimeout(e)}),[o,d,s,t]),(0,n.jsx)(hn,{rowsCount:3,value:o,className:i,onChange:e=>{r(e),u(!0)},disabled:c,loading:c})}const wn=(e,t)=>{switch(t.type){case at:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case nt:{const{entityId:s,entityType:a}=t.payload;return Object.assign(Object.assign({},e),{entityId:s,entityType:a})}case et:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:s})}case tt:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:[...e.customFields,s]})}case st:{const s=t.payload,a=e.customFields.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{customFields:a})}default:return e}};const fn={customFields:[],loading:!0,entityId:"",entityType:null},kn=(0,a.createContext)({state:fn,customFieldsDispatch:()=>{},fetchCustomFields:()=>{}}),qn=({children:e,entityId:t,entityType:s})=>{const[r,c]=(0,a.useReducer)(wn,fn);(0,a.useEffect)((()=>{l()}),[]),(0,a.useEffect)((()=>{c({type:nt,payload:{entityType:s,entityId:t}})}),[s,t]);const l=()=>{return e=void 0,a=void 0,r=function*(){try{c({type:at,payload:!0});const e=yield Jt(t,s,!0);c({type:et,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch custom fields","quicktasker"))}finally{c({type:at,payload:!1})}},new((n=void 0)||(n=Promise))((function(t,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(i,o)}c((r=r.apply(e,a||[])).next())}));var e,a,n,r};return(0,n.jsx)(kn.Provider,{value:{state:r,customFieldsDispatch:c,fetchCustomFields:l},children:e})};var xn=s(2767),_n=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function gn(){return{addCustomField:(e,t,s,a,n,r)=>_n(this,void 0,void 0,(function*(){try{const i=yield function(e,t,s,a,n){return zt()({path:"/wpqt/v1/custom-fields",method:"POST",data:{entityId:e,entityType:t,type:s,name:a,description:n},headers:Gt()})}(e,t,s,a,n);r&&r(i.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add a custom field","quicktasker"))}})),markCustomFieldAsDeleted:(e,t)=>_n(this,void 0,void 0,(function*(){try{yield function(e){return zt()({path:`/wpqt/v1/custom-fields/${e}`,method:"DELETE",headers:Gt()})}(e),t&&t()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to mark custom field as deleted","quicktasker"))}})),restoreCustomField:(e,t)=>_n(this,void 0,void 0,(function*(){try{const s=yield function(e){return zt()({path:`/wpqt/v1/custom-fields/${e}/restore`,method:"PATCH",headers:Gt()})}(e);i.oR.success((0,o.__)("Custom field restored","quicktasker")),t&&t(s.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore custom field","quicktasker"))}})),updateCustomFieldValue:(e,t,s,a,n)=>_n(this,void 0,void 0,(function*(){try{yield function(e,t,s,a){return zt()({path:`/wpqt/v1/custom-fields/${e}/value`,method:"PATCH",data:{value:t,entityId:String(s),entityType:a},headers:Gt()})}(e,t,s,a),i.oR.success((0,o.__)("Custom field value updated","quicktasker")),n&&n()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to update custom field value","quicktasker"))}})),updateCustomFieldDefaultValue:(e,t)=>_n(this,void 0,void 0,(function*(){try{return yield function(e,t){return zt()({path:`/wpqt/v1/custom-fields/${e}/default-value`,method:"PATCH",data:{value:t},headers:Gt()})}(e,t),i.oR.success((0,o.__)("Custom field default value updated","quicktasker")),{success:!0}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to update custom field default value","quicktasker")),{success:!1}}}))}}function vn({title:e,description:t,className:s=""}){return(0,n.jsxs)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center wpqt-h-full ${s}`,children:[e&&(0,n.jsx)("h2",{className:"wpqt-font-semibold",children:e}),t&&(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-4",children:t}),(0,n.jsx)("div",{className:"wpqt-text-blue-500 wpqt-font-semibold",children:(0,n.jsx)("a",{href:"https://payhip.com/b/84TLC",target:"_blank",rel:"noreferrer",children:(0,o.__)("Get the premium version","quicktasker")})})]})}var jn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function bn({description:e}){const[t,s]=(0,a.useState)(""),[i,r]=(0,a.useState)(""),[c,l]=(0,a.useState)(rn.Text),{addCustomField:d}=gn(),{state:{entityId:u,entityType:p,customFields:h,loading:m},customFieldsDispatch:w}=(0,a.useContext)(kn),{state:{is_customFields:f}}=(0,a.useContext)(nn),[k,q]=(0,a.useState)(!1),{modalDispatch:x}=(0,a.useContext)(Ks),_=[{value:rn.Text,label:"Text"},{value:rn.Checkbox,label:"Checkbox"}],g=h.length>=1&&!f;return m?null:g?(0,n.jsx)(vn,{description:(0,o.__)("Upgrade to premium to add more custom fields.","quicktasker")}):(0,n.jsxs)("div",{className:"wpqt-mb-6 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)("h2",{children:(0,o.__)("Custom Fields","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-mb-4 wpqt-text-center",children:[e,!f&&(0,n.jsxs)("span",{className:"wpqt-font-semibold",children:[" ",(0,o.__)("Free version allows only one custom field. To add more, please upgrade to premium.","quicktasker")]})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Name","quicktasker")}),(0,n.jsx)(Ra,{value:t,onChange:s})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Description","quicktasker")}),(0,n.jsx)(hn,{value:i,onChange:r})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Type","quicktasker")}),(0,n.jsx)(ja,{selectedOptionValue:c,options:_,onSelectionChange:e=>{l(e)},allSelector:!1})]})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:(0,n.jsx)(la,{text:(0,o.__)("Add","quicktasker"),onClick:()=>jn(this,void 0,void 0,(function*(){u&&p?(q(!0),yield d(u,p,c,t,i,(e=>{w({type:tt,payload:e}),s(""),r(""),l(rn.Text),x({type:de,payload:!1})})),q(!1)):console.error("Entity ID or Entity Type is missing")})),loading:k,icon:(0,n.jsx)(xn.A,{className:"wpqt-icon-green wpqt-size-5"})})})]})}function yn({description:e}){const{state:{customFieldCreatorModalOpen:t},modalDispatch:s}=(0,a.useContext)(Ks);return(0,n.jsx)(na,{modalOpen:t,closeModal:()=>{s({type:de,payload:!1})},size:"lg",children:(0,n.jsx)(bn,{description:e})})}var En=s(5066),Tn=s(4353),Sn=s.n(Tn),An=s(8569),On=s.n(An),Nn=s(3826),Cn=s.n(Nn);Sn().extend(Cn()),Sn().extend(On());const In=(e,t)=>{try{return Sn().utc(e).tz(t).format("MMMM D, YYYY HH:mm")}catch(t){return console.error("Error: ",t),e+" (UTC)"}},Dn=()=>{const{state:{timezone:e}}=(0,a.useContext)(nn);return{convertToWPTimezone:t=>In(t,e),convertUTCDateTimeToWPTimezone:t=>((e,t)=>{try{return Sn().utc(e).tz(t).toDate()}catch(t){return console.error("Error: ",t),new Date(e)}})(t,e)}},Pn={[cn.Pipeline]:(0,o.__)("Board","quicktasker"),[cn.Task]:(0,o.__)("Task","quicktasker"),[cn.QUICKTASKER]:(0,o.__)("Quicktasker","quicktasker"),[cn.WP_USER]:(0,o.__)("WordPress user","quicktasker"),[cn.Users]:(0,o.__)("Global users","quicktasker")};function Rn({icon:e,onClick:t=()=>{},className:s,loading:a=!1}){return(0,n.jsxs)("div",{className:`wpqt-main-border wpqt-p-1 wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-bg-gray-100 hover:wpqt-bg-white ${s}`,onClick:t,children:[(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center "+(a?"wpqt-invisible":""),children:e}),a&&(0,n.jsx)(Xs,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]})}var Ln=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Mn({customField:e,refreshDeletedFields:t}){const{customFieldsDispatch:s}=(0,a.useContext)(kn),[i,r]=(0,a.useState)(!1),{restoreCustomField:c}=gn(),{convertToWPTimezone:l}=Dn();return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Name:","quicktasker")})," ",e.name]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Description:","quicktasker")})," ",e.description]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Level:","quicktasker")})," ",Pn[e.entity_type]]}),e.deleted_at&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Deleted:","quicktasker")})," ",l(e.deleted_at)]}),(0,n.jsx)("div",{children:(0,n.jsx)(Rn,{onClick:()=>Ln(this,void 0,void 0,(function*(){r(!0),yield c(e.id,(e=>{s({type:tt,payload:e}),t()})),r(!1)})),loading:i,icon:(0,n.jsx)(En.HCd,{className:"wpqt-icon-green wpqt-size-5"})})})]})}var Un=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Fn(){const[e,t]=(0,a.useState)(!0),[s,r]=(0,a.useState)(null),{state:{entityId:c,entityType:l}}=(0,a.useContext)(kn);(0,a.useEffect)((()=>{d()}),[]);const d=()=>Un(this,void 0,void 0,(function*(){if(c&&l)try{t(!0);const e=yield Jt(c,l,!1);r(e.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load deleted custom fields","quicktasker"))}finally{t(!1)}else console.error("Entity ID or Entity Type is missing")}));return(0,n.jsxs)("div",{className:"wpqt-my-3 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)("h2",{children:(0,o.__)("Custom Field recovery","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:(0,o.__)("Deleted custom field by accident? No worries! You can recover it here.","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-mb-3",children:e?(0,n.jsx)(ea,{ovalSize:"36"}):s&&0===s.length?(0,n.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No deleted custom fields","quicktasker")}):s&&s.length>0?(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:s.map((e=>(0,n.jsx)(Mn,{customField:e,refreshDeletedFields:d},e.id)))}):null})]})}function Kn(){const{state:{customFieldRecoveryModalOpen:e},modalDispatch:t}=(0,a.useContext)(Ks);return(0,n.jsx)(na,{modalOpen:e,closeModal:()=>{t({type:ue,payload:!1})},size:"lg",children:(0,n.jsx)(Fn,{})})}var $n=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function zn({data:e,locationOfCustomFields:t,onDelete:s,actionLoading:i}){const{state:{isUserAllowedToDelete:r}}=(0,a.useContext)(nn),c=e.entity_type===t,l=e.entity_type===cn.Pipeline?"board":e.entity_type;return i?(0,n.jsx)(ea,{ovalSize:"24",className:"wpqt-ml-auto"}):(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-ml-auto",children:r&&(0,n.jsx)(la,Object.assign({onClick:()=>$n(this,void 0,void 0,(function*(){c&&s()})),className:c?"":"!wpqt-cursor-not-allowed",icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-4"})},!c&&{tooltipId:`custom-field-${e.id}-delete`,tooltipText:(0,o.sprintf)((0,o.__)("This custom field is inherited from %s settings and can't be deleted here","quicktasker"),l)}))})}function Gn({name:e,description:t=""}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-mb-1 wpqt-text-base wpqt-font-semibold",children:e}),t&&(0,n.jsx)("div",{className:"wpqt-mb-2 wpqt-italic",children:t})]})}function Vn({data:e,initialValue:t,onChange:s,disabled:i=!1}){const[o,r]=(0,a.useState)(t);return(0,a.useEffect)((()=>{r(t)}),[t]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(Gn,{name:e.name,description:e.description}),(0,n.jsx)("input",{type:"checkbox",checked:"true"===o,className:"!wpqt-block",onChange:e=>{r(e.target.checked?"true":"false"),s(e.target.checked?"true":"false")},disabled:i})]})}function Bn({data:e,initialValue:t,onChange:s,disabled:i=!1}){const[o,r]=(0,a.useState)(t),[c,l]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{r(t),l(!1)}),[t]),(0,a.useEffect)((()=>{if(!c)return;const e=setTimeout((()=>{s(o),l(!1)}),Nt);return()=>clearTimeout(e)}),[o,c,s]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center",children:[(0,n.jsx)(Gn,{name:e.name,description:e.description}),(0,n.jsx)(Ra,{value:o,onChange:e=>{r(e),l(!0)},disabled:i,wrapperClassName:"!wpqt-mb-0","data-testid":"text-custom-field"})]})}var Hn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Wn({data:e}){var t,s;const{state:{entityType:i,entityId:o},customFieldsDispatch:r}=(0,a.useContext)(kn),{updateCustomFieldValue:c,markCustomFieldAsDeleted:l,updateCustomFieldDefaultValue:d}=gn(),[u,p]=(0,a.useState)(!1),h=i===cn.QUICKTASKER||i===cn.Task,m=i===cn.Users||i===cn.Pipeline,w=t=>Hn(this,void 0,void 0,(function*(){h?(p(!0),yield c(e.id,t,o,i),p(!1)):m?(p(!0),yield d(e.id,t),p(!1)):console.error("Invalid entity type for saving custom field value")}));let f;const k=null!==(s=null!==(t=e.value)&&void 0!==t?t:e.default_value)&&void 0!==s?s:"",q=h||m;switch(e.type){case rn.Text:f=(0,n.jsx)(Bn,{data:e,initialValue:k,onChange:w,disabled:u||!q});break;case rn.Checkbox:f=(0,n.jsx)(Vn,{data:e,initialValue:k,onChange:w,disabled:u||!h})}return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-py-4 wpqt-items-center wpqt-border-0 wpqt-border-b wpqt-border-solid wpqt-border-gray-200",children:[f,(0,n.jsx)(zn,{data:e,locationOfCustomFields:i,onDelete:()=>Hn(this,void 0,void 0,(function*(){p(!0),yield l(e.id,(()=>{r({type:st,payload:e.id})})),p(!1)})),actionLoading:u})]})}function Qn(){const{state:{loading:e,customFields:t}}=(0,a.useContext)(kn);return e?(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(Xs,{width:"36",height:"36"})}):t&&0===t.length?(0,n.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No related custom fields created","quicktasker")}):(0,n.jsx)("div",{className:"wpqt-my-4 wpqt-flex wpqt-flex-col wpqt-gap-3",children:t.map((e=>(0,n.jsx)(Wn,{data:e},e.id)))})}function Yn({className:e=""}){const{modalDispatch:t}=(0,a.useContext)(Ks);return(0,n.jsxs)("div",{className:`wpqt-flex wpqt-gap-2 ${e}`,children:[(0,n.jsx)(la,{onClick:()=>{t({type:ue,payload:!0})},icon:(0,n.jsx)(En.HCd,{className:"wpqt-icon-blue wpqt-size-4"}),tooltipId:"custom-field-restore",tooltipText:(0,o.__)("Restore deleted custom fields","quicktasker")}),(0,n.jsx)(la,{onClick:()=>{t({type:de,payload:!0})},icon:(0,n.jsx)(xn.A,{className:"wpqt-icon-green wpqt-size-4"}),tooltipId:"custom-field-create",tooltipText:(0,o.__)("Add custom field","quicktasker")})]})}const Jn={[cn.QUICKTASKER]:(0,o.__)("Add user-specific custom fields. If you want to add custom fields to all users, please go to users settings.","quicktasker"),[cn.WP_USER]:(0,o.__)("Add user-specific custom fields. If you want to add custom fields to all users, please go to users settings.","quicktasker"),[cn.Users]:(0,o.__)("Add custom fields to all users. If you want to add custom fields to a specific user only, please go to that user settings.","quicktasker"),[cn.Pipeline]:(0,o.__)("Add board level custom fields.","quicktasker"),[cn.Task]:(0,o.__)("Add task-specific custom fields. If you want to add custom fields to all tasks in this board, please go to board settings.","quicktasker")},Xn={[cn.QUICKTASKER]:(0,o.__)("Custom fields applied to this user, including both user-specific and global users fields.","quicktasker"),[cn.WP_USER]:(0,o.__)("Custom fields applied to this user, including both user-specific and global users fields.","quicktasker"),[cn.Users]:(0,o.__)("Global user custom field are applied to all users.","quicktasker"),[cn.Pipeline]:(0,o.__)("Board level fields are applied to all tasks in this board.","quicktasker"),[cn.Task]:(0,o.__)("Custom fields applied to this task, including both task-specific and board-level fields.","quicktasker")},Zn={[cn.QUICKTASKER]:(0,o.__)("User custom fields","quicktasker"),[cn.WP_USER]:(0,o.__)("User custom fields","quicktasker"),[cn.Users]:(0,o.__)("Global users custom fields","quicktasker"),[cn.Pipeline]:(0,o.__)("Board custom fields","quicktasker"),[cn.Task]:(0,o.__)("Custom fields","quicktasker")};function ei({entityId:e,entityType:t}){const s=Jn[t],a=Zn[t],i=Xn[t];return(0,n.jsx)("div",{className:"wpqt-relative",children:(0,n.jsxs)(qn,{entityId:e,entityType:t,children:[(0,n.jsx)(Yn,{className:"wpqt-absolute wpqt--top-2 wpqt-right-0"}),(0,n.jsx)("h2",{className:"wpqt-text-center",children:a}),(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:i}),(0,n.jsx)(Qn,{}),(0,n.jsx)(yn,{description:s}),(0,n.jsx)(Kn,{})]})})}function ti({onConfirm:e,confirmMessage:t=(0,o.__)("Are you sure?","quicktasker"),confirmButtonText:s=(0,o.__)("Yes","quicktasker"),cancelButtonText:i=(0,o.__)("No","quicktasker"),children:r,position:c="bottom",containerClassName:l=""}){const[d,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(null),m=(0,a.useRef)(null),w=(0,a.useRef)(null),f=d&&null!==p;(0,a.useEffect)((()=>{if(d&&m.current){const e=m.current.getBoundingClientRect(),t=100,s=8;let a=0,n=0;switch(c){case"top":a=e.top-t-s,n=e.left+e.width/2-112;break;case"right":a=e.top,n=e.right+s;break;case"bottom":a=e.bottom+s,n=e.left+e.width/2-112;break;case"left":a=e.top,n=e.left-224-s}a=Math.max(0,a),n=Math.max(0,n),n=Math.min(n,window.innerWidth-224-10),h({top:a,left:n})}}),[d,c]);const k=e=>{null==e||e.stopPropagation(),u(!1)};return(0,a.useEffect)((()=>{if(!f)return;const e=e=>{m.current&&!m.current.contains(e.target)&&w.current&&!w.current.contains(e.target)&&k()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[f]),(0,n.jsxs)("div",{className:`wpqt-relative ${l}`,ref:m,children:[r({onClick:e=>{e.stopPropagation(),e.preventDefault(),u(!0)}}),f&&(0,n.jsx)("div",{ref:w,className:"wpqt-fixed wpqt-z-50",style:{top:`${p.top}px`,left:`${p.left}px`},onClick:e=>e.stopPropagation(),children:(0,n.jsx)("div",{className:"wpqt-origin-top-right wpqt-main-border wpqt-bg-white wpqt-transition",style:{width:"224px"},children:(0,n.jsxs)("div",{className:"wpqt-p-3",children:[(0,n.jsx)("div",{className:"wpqt-text-sm wpqt-mb-2",children:t}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-space-x-2",children:[(0,n.jsx)(ta,{btnText:i,onClick:k,buttonStyleType:Gs.SECONDARY}),(0,n.jsx)(ta,{btnText:s,onClick:t=>{null==t||t.stopPropagation(),e(),u(!1)},buttonStyleType:Gs.DANGER})]})]})})})]})}var si=s(5785);function ai({children:e,inlineStyle:t,className:s=""}){return(0,n.jsx)("div",{className:`wpqt-inline-flex wpqt-py-1 wpqt-px-2 wpqt-font-semibold wpqt-text-xs wpqt-leading-none wpqt-shopping-tag ${s}`,style:t,children:e})}var ni=s(2185);function ii({children:e,menuBtn:t,menuBtnClasses:s="",anchor:a="bottom end"}){return(0,n.jsxs)(ni.W1,{children:[(0,n.jsx)(ni.IU,{as:"div",className:`wpqt-cursor-pointer ${s}`,onClick:e=>e.stopPropagation(),children:({active:e})=>(0,n.jsx)(n.Fragment,{children:t({active:e})})}),(0,n.jsx)(ni.c,{anchor:a,transition:!0,className:"wpqt-z-20 wpqt-origin-top wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-white wpqt-p-4 wpqt-transition wpqt-duration-200 wpqt-ease-out data-[closed]:wpqt-scale-95 data-[closed]:wpqt-opacity-0",children:e})]})}function oi({isActive:e,IconComponent:t}){return(0,n.jsx)(t,{className:"wpqt-size-6 wpqt-text-gray-400 hover:wpqt-text-qtBlueHover "+(e?"wpqt-text-qtBlueHover":"")})}function ri({text:e,onClick:t,icon:s,className:a,disabled:i=!1,id:o="",tooltipText:r="",loading:c=!1}){const l=""!==r&&""!==o?{"data-tooltip-id":o,"data-tooltip-content":r,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,n.jsx)(ni.Dr,{children:(0,n.jsxs)("div",Object.assign({},l,{className:`wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-relative ${i?"wpqt-cursor-not-allowed wpqt-line-through":"wpqt-cursor-pointer hover:wpqt-underline"} ${a}`,onClick:e=>{!i&&t&&t(e)},children:[s,(0,n.jsx)("span",{className:c?"wpqt-invisible":"",children:e}),c&&(0,n.jsx)(Xs,{width:"16",height:"16",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"}),(0,n.jsx)(aa,{id:o})]}))})}var ci=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};var li=s(3858);function di({labelCreated:e,loading:t=!1}){const{labelDispatch:s}=(0,a.useContext)(Aa),[i,r]=(0,a.useState)(""),[c,l]=(0,a.useState)("#FF9800"),[d,u]=(0,a.useState)({});return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Create new label","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-max-w-sm",children:(0,o.__)("Label will be added to the board","quicktasker")})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)(ga,{labelFor:"new-label-name",children:(0,o.__)("Name","quicktasker")}),(0,n.jsx)(Ra,{value:i,onChange:r,inputId:"new-label-name",errorText:d.nameError,className:"wpqt-w-full"})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-mb-2",children:[(0,n.jsx)(ga,{children:(0,o.__)("Color","quicktasker")}),(0,n.jsx)(li.A,{color:c,disableAlpha:!0,onChange:e=>{l(e.hex)},style:{width:"100%"}}),d.nameError&&(0,n.jsx)(Da,{errorText:d.colorError})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-justify-end",children:[(0,n.jsx)(ta,{btnText:(0,o.__)("Cancel","quicktasker"),buttonStyleType:Gs.SECONDARY,onClick:()=>{s({type:lt})}}),(0,n.jsx)(ta,{btnText:(0,o.__)("Create","quicktasker"),onClick:()=>{const t={};i.trim()||(t.nameError=(0,o.__)("Name is required","quicktasker")),c||(t.colorError=(0,o.__)("Color is required","quicktasker")),u(t),Object.keys(t).length>0||e(i,c)},loading:t})]})]})}function ui({labelToEdit:e,editLabel:t,closeEdit:s=()=>{}}){if(!e)return null;const[i,r]=(0,a.useState)(Object.assign({},e)),[c,l]=(0,a.useState)(!1),[d,u]=(0,a.useState)({});return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Edit label","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-max-w-sm",children:(0,o.__)("Make changes to this label","quicktasker")})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)(ga,{labelFor:"edit-label-name",children:(0,o.__)("Name","quicktasker")}),(0,n.jsx)(Ra,{value:i.name,onChange:e=>{r(Object.assign(Object.assign({},i),{name:e}))},inputId:"edit-label-name",className:"wpqt-w-full",errorText:d.nameError})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-mb-2",children:[(0,n.jsx)(ga,{children:(0,o.__)("Color","quicktasker")}),(0,n.jsx)(li.A,{color:i.color,disableAlpha:!0,onChange:e=>{r(Object.assign(Object.assign({},i),{color:e.hex}))},style:{width:"100%"}}),d.nameError&&(0,n.jsx)(Da,{errorText:d.colorError})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-justify-end",children:[(0,n.jsx)(ta,{btnText:(0,o.__)("Cancel","quicktasker"),buttonStyleType:Gs.SECONDARY,onClick:s}),(0,n.jsx)(ta,{btnText:(0,o.__)("Update","quicktasker"),onClick:()=>{return e=this,s=void 0,n=function*(){const e={};i.name.trim()||(e.nameError=(0,o.__)("Name is required","quicktasker")),i.color||(e.colorError=(0,o.__)("Color is required","quicktasker")),u(e),Object.keys(e).length>0||(l(!0),yield t(i),l(!1))},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n},loading:c})]})]})}var pi=s(2601),hi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function mi({labels:e,title:t,description:s,labelSelected:i,labelDeSelection:r,deleteLabe:c,loading:l=!1}){const{labelDispatch:d}=(0,a.useContext)(Aa);return e?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:t}),(0,n.jsx)("div",{className:"wpqt-max-w-sm",children:s})]}),l?(0,n.jsx)(ea,{ovalSize:"24"}):0===e.length?(0,n.jsx)("div",{className:"wpqt-text-gray-500",children:(0,o.__)("There are no labels created for this board","quicktasker")}):e.map((e=>(0,n.jsx)(wi,{label:e,labelSelected:i,labelDeSelection:r,deleteLabe:c},e.id))),(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-justify-end",children:(0,n.jsx)(ta,{btnText:(0,o.__)("Create new label","quicktasker"),className:"wpqt-mt-3",buttonStyleType:Gs.PRIMARY,onClick:()=>{d({type:ut})}})})]}):null}function wi({label:e,labelSelected:t,labelDeSelection:s,deleteLabe:i}){const{labelDispatch:r}=(0,a.useContext)(Aa),[c,l]=(0,a.useState)(e.selected),[d,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(!1);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-between wpqt-gap-2 wpqt-w-full",children:[p?(0,n.jsx)(Xs,{width:"20",height:"20"}):(0,n.jsx)("input",{type:"checkbox",checked:c,onChange:a=>hi(this,void 0,void 0,(function*(){const n=a.target.checked;h(!0);const{success:i}=n?yield t(e.id):yield s(e.id);h(!1),i&&l(n)}))}),(0,n.jsx)(ai,{inlineStyle:{backgroundColor:e.color},className:"wpqt-py-2",children:e.name}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2",children:[(0,n.jsx)(la,{icon:(0,n.jsx)(pi.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:()=>{r({type:dt,payload:e})}}),(0,n.jsx)(ti,{confirmMessage:(0,o.__)("Are you sure you want to delete the label from this board?","quicktasker"),onConfirm:()=>hi(this,void 0,void 0,(function*(){u(!0),yield i(e.id),u(!1)})),containerClassName:"wpqt-flex",children:({onClick:e})=>(0,n.jsx)(Rn,{icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-4"}),className:"wpqt-p-2",onClick:e,loading:d})})]})]})}var fi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const ki=(0,a.memo)((({task:e,labelSelected:t,labelDeselected:s,labelDeleted:r})=>{const{state:{labels:c,labelActionState:l,labelToEdit:d},labelDispatch:u}=(0,a.useContext)(Aa),{archiveDispatch:p}=(0,a.useContext)(Ps),{dispatch:h}=(0,a.useContext)(xs),[m,w]=(0,a.useState)(!0),[f,k]=(0,a.useState)(!1),{getPipelineLabels:q,createPipelineLabel:x,assignLabelToTask:_,usassignLabelFromTask:g,editLabel:v,deleteLabel:j}=function(){return{deleteLabel:(e,t,s)=>ci(this,void 0,void 0,(function*(){try{const a=yield function(e,t){return zt()({path:`/wpqt/v1/pipelines/${e}/labels/${t}`,method:"DELETE",headers:Gt()})}(e,t);i.oR.success((0,o.__)("Label deleted from the board","quicktasker")),s&&s(!0,a.data.deletedLabel)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete label","quicktasker")),s&&s(!1)}})),getPipelineLabels:(e,t)=>ci(this,void 0,void 0,(function*(){try{const a=yield(s=e,zt()({path:`/wpqt/v1/pipelines/${s}/labels`,method:"GET",headers:Gt()}));t&&t(!0,a.data.labels)}catch(e){console.error(e),t&&t(!1)}var s})),createPipelineLabel:(e,t,s,a)=>ci(this,void 0,void 0,(function*(){try{const n=yield function(e,t,s){return zt()({path:`/wpqt/v1/pipelines/${e}/labels`,method:"POST",headers:Gt(),data:{name:t,color:s}})}(e,t,s);i.oR.success((0,o.__)("Label created successfully","quicktasker")),a&&a(!0,n.data.label)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create label","quicktasker")),a&&a(!1)}})),editLabel:(e,t,s)=>ci(this,void 0,void 0,(function*(){try{const a=yield function(e,t){return zt()({path:`/wpqt/v1/pipelines/${e}/labels/${t.id}`,method:"PATCH",headers:Gt(),data:{name:t.name,color:t.color}})}(e,t);i.oR.success((0,o.__)("Label updated successfully","quicktasker")),s&&s(!0,a.data.label)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to update label","quicktasker")),s&&s(!1)}})),assignLabelToTask:(e,t,s)=>ci(this,void 0,void 0,(function*(){try{const a=yield function(e,t,s){return zt()({path:`/wpqt/v1/pipelines/${e}/tasks/${t}/labels`,method:"POST",headers:Gt(),data:{labelId:s}})}(e,t,s);return i.oR.success((0,o.__)("Label added to task","quicktasker")),{success:!0,label:a.data.label}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to add label to task","quicktasker")),{success:!1}}})),usassignLabelFromTask:(e,t,s)=>ci(this,void 0,void 0,(function*(){try{return yield function(e,t,s){return zt()({path:`/wpqt/v1/pipelines/${e}/tasks/${t}/labels/${s}`,method:"DELETE",headers:Gt()})}(e,t,s),i.oR.success((0,o.__)("Label removed from task","quicktasker")),{success:!0}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to remove label from task","quicktasker")),{success:!1}}}))}}();(0,a.useEffect)((()=>(fi(void 0,void 0,void 0,(function*(){w(!0),yield q(e.pipeline_id,((e,t)=>{e&&t&&u({type:it,payload:t})})),w(!1)})),()=>{u({type:pt})})),[]);const b=()=>{const t=e.assigned_labels||[];return(c||[]).map((e=>Object.assign(Object.assign({},e),{selected:t.some((t=>t.id===e.id))})))},y=s=>fi(void 0,void 0,void 0,(function*(){const{success:a,label:n}=yield _(e.pipeline_id,e.id,s);return a&&n&&(h({type:N,payload:{taskId:e.id,label:n}}),p({type:Ee,payload:{taskId:e.id,label:n}}),t(n)),{success:a,label:n}})),E=t=>fi(void 0,void 0,void 0,(function*(){const{success:a}=yield g(e.pipeline_id,e.id,t);return a&&(h({type:C,payload:{taskId:e.id,labelId:t}}),p({type:Te,payload:{taskId:e.id,labelId:t}}),s(t)),{success:a}})),T=(t,s)=>fi(void 0,void 0,void 0,(function*(){k(!0),yield x(e.pipeline_id,t,s,((e,t)=>{e&&t&&u({type:ot,payload:t})})),k(!1)})),S=t=>fi(void 0,void 0,void 0,(function*(){yield v(e.pipeline_id,t,((e,t)=>{e&&t&&(u({type:ct,payload:t}),h({type:I,payload:{label:t}}))}))})),A=t=>fi(void 0,void 0,void 0,(function*(){yield j(e.pipeline_id,t,((e,s)=>{e&&s&&(u({type:lt}),u({type:rt,payload:s}),h({type:D,payload:t}),r(t))}))}));return(0,n.jsx)("div",{className:"wpqt-min-w-56 wpqt-flex wpqt-flex-col wpqt-gap-4",onClick:e=>e.stopPropagation(),children:(()=>{switch(l){case ba.SELECTION:return(0,n.jsx)(mi,{title:(0,o.__)("Board labels","quicktasker"),description:(0,o.__)("Add, edit, or remove board labels. Created labels can be applied or removed from this task.","quicktasker"),labels:b(),loading:m,labelSelected:y,labelDeSelection:E,deleteLabe:A});case ba.CREATION:return(0,n.jsx)(di,{labelCreated:T,loading:f});case ba.EDIT:return(0,n.jsx)(ui,{labelToEdit:d,editLabel:S,closeEdit:()=>{u({type:lt})}});default:return null}})()})}));function qi({task:e,labelSelected:t=()=>{},labelDeselected:s=()=>{},labelDeleted:a=()=>{}}){const i=e.assigned_labels||[],o=Array.isArray(i)&&i.length>0;return(0,n.jsx)(ii,{menuBtnClasses:"wpqt-inline-flex",anchor:"bottom start",menuBtn:()=>(0,n.jsxs)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1.5",children:[(0,n.jsx)(si.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`}),o&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-1 wpqt-flex-wrap",children:i.map((e=>(0,n.jsx)(ai,{inlineStyle:{backgroundColor:e.color},children:e.name},e.id)))})]}),children:e&&(0,n.jsx)(ki,{task:e,labelSelected:t,labelDeselected:s,labelDeleted:a})})}var xi=s(2792),_i=s(6797),gi=s(4403);function vi({sectionTitle:e,onItemSelect:t=()=>{},users:s=[],ActionIcon:a=gi.A,actionIconClasses:i,noUsersText:o}){return(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2 wpqt-text-lg",children:e}),s.map(((e,s)=>{var o;return(0,n.jsxs)("div",{onClick:s=>{s.stopPropagation(),t(e)},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-px-2 wpqt-py-1 hover:wpqt-bg-gray-100",children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)("div",{children:e.name}),(0,n.jsx)("div",{className:"wpqt-italic",children:e.description}),Zt(e)&&(0,n.jsx)("div",{children:null===(o=e.roles)||void 0===o?void 0:o.join(",")})]}),(0,n.jsx)(a,{className:`wpqt-ml-auto wpqt-size-5 ${i}`})]},s)})),0===s.length&&(0,n.jsx)("div",{children:o})]})}var ji=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function bi({task:e,onUserAdd:t,onUserDelete:s}){const{state:{users:r,wpUsers:c}}=(0,a.useContext)(Ga),{handleExecutedAutomations:l}=js(),{dispatch:d}=(0,a.useContext)(xs),[u,p]=(0,a.useState)(!1),h=r.filter((t=>{var s;return!(null!==(s=e.assigned_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))})),m=c.filter((t=>{var s;return!(null!==(s=e.assigned_wp_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))})),w=s=>ji(this,void 0,void 0,(function*(){try{p(!0);const a=s.user_type,n=yield function(e,t,s){return zt()({path:`/wpqt/v1/users/${e}/tasks/${t}`,method:"POST",data:{user_type:s},headers:Gt()})}(s.id,e.id,a);d({type:b,payload:{taskId:e.id,user:s}}),t(s),l(n.data.executedAutomations,e.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to assign user","quicktasker"))}finally{p(!1)}})),f=t=>ji(this,void 0,void 0,(function*(){try{p(!0);const a=t.user_type,n=yield Yt(t.id,e.id,a);d({type:y,payload:{taskId:e.id,userId:t.id,userType:a}}),s(t),l(n.data.executedAutomations,e.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to remove user","quicktasker"))}finally{p(!1)}}));return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,n.jsx)(vi,{sectionTitle:(0,o.__)("Assigned quicktaskers","quicktasker"),users:e.assigned_users,onItemSelect:f,ActionIcon:_i.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No quicktaskers assigned","quicktasker")}),(0,n.jsx)(vi,{sectionTitle:(0,o.__)("Assigned WordPress users","quicktasker"),users:e.assigned_wp_users,onItemSelect:f,ActionIcon:_i.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No WordPress users assigned","quicktasker")}),(0,n.jsx)(vi,{sectionTitle:(0,o.__)("Assign a quicktasker","quicktasker"),users:h,onItemSelect:w,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No quicktaskers available to assign","quicktasker")}),(0,n.jsx)(vi,{sectionTitle:(0,o.__)("Assign a WordPress user","quicktasker"),users:m,onItemSelect:w,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No WordPress users with required permissions available to assign","quicktasker")}),u&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(Xs,{width:"30",height:"30"})})]})}function yi({task:e,onUserAdd:t=()=>{},onUserDelete:s=()=>{},menuBtnClasses:a=""}){const i=[...e.assigned_users||[],...e.assigned_wp_users||[]],o=i.length>0;return(0,n.jsx)(ii,{menuBtnClasses:`wpqt-inline-flex ${a}`,anchor:"bottom start",menuBtn:()=>(0,n.jsxs)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:[(0,n.jsx)(xi.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`}),o&&(0,n.jsx)("div",{children:i.map(((e,t)=>(0,n.jsxs)("span",{children:[e.name,t<i.length-1&&", "]},t)))})]}),children:(0,n.jsx)(bi,{task:e,onUserAdd:t,onUserDelete:s})})}var Ei=s(1848);function Ti({tabs:e,tabsContent:t,tabClassName:s="",tabListClassName:a=""}){return(0,n.jsxs)(Ei.fu,{children:[(0,n.jsx)(Ei.wb,{className:`wpqt-mb-6 wpqt-flex wpqt-border-0 wpqt-border-b wpqt-border-solid wpqt-border-b-gray-300 ${a}`,children:e.map((e=>(0,n.jsx)(Si,{className:s,children:e},e)))}),(0,n.jsx)(Ei.T2,{children:t.map(((e,t)=>(0,n.jsx)(Ai,{children:e},t)))})]})}function Si({children:e,className:t}){return(0,n.jsx)(Ei.oz,{as:"div",className:`wpqt-flex-1 wpqt-cursor-pointer wpqt-p-1 wpqt-pb-[10px] wpqt-text-center wpqt-text-lg data-[selected]:wpqt-border-b-2 data-[selected]:wpqt-border-l-0 data-[selected]:wpqt-border-r-0 data-[selected]:wpqt-border-t-0 data-[selected]:wpqt-border-solid data-[selected]:wpqt-border-b-blue-500 ${t}`,children:e})}function Ai({children:e}){return(0,n.jsx)(Ei.Kp,{children:e})}const Oi={[Ss.Admin]:(0,o.__)("Admin","quicktasker"),[Ss.Automation]:(0,o.__)("Automation","quicktasker"),[Ss.System]:(0,o.__)("System","quicktasker"),[Ss.WPQTUser]:"Quicktasker",[Ss.Import]:(0,o.__)("Import","quicktasker")},Ni=({log:e,showStatus:t=!1})=>{const{convertToWPTimezone:s}=Dn(),a=Oi[e.created_by];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,n.jsx)("div",{className:"wpqt-text-center",children:a})]}),(0,n.jsx)("div",{children:s(e.created_at)}),t&&(0,n.jsx)("div",{children:e.log_status}),(0,n.jsx)("div",{children:e.text})]})};function Ci({title:e}){return(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-lg wpqt-underline",children:e})}var Ii=s(3338),Di=s(3211);const Pi={success:"wpqt-bg-green-100 wpqt-border-green-400 wpqt-text-green-700",error:"wpqt-bg-red-100 wpqt-border-red-400 wpqt-text-red-700",warning:"wpqt-bg-yellow-100 wpqt-border-yellow-400 wpqt-text-yellow-700",info:"wpqt-bg-blue-100 wpqt-border-blue-400 wpqt-text-blue-700",primary:"wpqt-bg-gray-100 wpqt-border-gray-400 wpqt-text-gray-700"};function Ri({type:e="primary",className:t="",children:s}){const a=Pi[e];return(0,n.jsx)("div",{className:`wpqt-inline-flex wpqt-p-2 wpqt-border wpqt-border-solid wpqt-rounded-md ${a} ${t}`,children:s})}var Li=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Mi({typeId:e,fetchData:t,renderItem:s,noDataMessage:i,explanation:r,onAdd:c=()=>Li(this,void 0,void 0,(function*(){})),enableAdd:l=!1}){const[d,u]=(0,a.useState)(null),[p,h]=(0,a.useState)(""),[m,w]=(0,a.useState)(!0),[f,k]=(0,a.useState)(!1);(0,a.useEffect)((()=>{q()}),[e]);const q=()=>Li(this,void 0,void 0,(function*(){w(!0);const e=yield t();e&&u(e),w(!1)}));return null===d?(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(Xs,{width:"30",height:"30"})}):(0,n.jsxs)("div",{children:[r&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(Ri,{type:"info",className:"wpqt-mb-3 wpqt-text-center",children:r})}),0===d.length&&(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center",children:i}),(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-mt-3 wpqt-flex wpqt-justify-center",children:(0,n.jsx)(Ui,{isLoading:m,refreshComemnts:q})}),l&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsxs)("div",{className:"wpqt-w-2/3 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(hn,{rowsCount:3,value:p,onChange:e=>h(e),className:"wpqt-mb-4 wpqt-w-full"}),(0,n.jsx)(la,{text:"Add comment",loading:f,onClick:()=>Li(this,void 0,void 0,(function*(){if(!p)return;k(!0);const e=yield c(p);e&&(u((t=>t?[e,...t]:[e])),h("")),k(!1)})),icon:(0,n.jsx)(Ii.A,{className:"wpqt-icon-blue wpqt-size-5"})})]})}),d.length>0&&(0,n.jsxs)("div",{className:"wpqt-mb-[28px] wpqt-mt-[56px] wpqt-logs-grid",children:[(0,n.jsx)(Ci,{title:(0,o.__)("Author","quicktasker")}),(0,n.jsx)(Ci,{title:(0,o.__)("Date","quicktasker")}),(0,n.jsx)(Ci,{title:(0,o.__)("Text","quicktasker")}),d.map((e=>s(e)))]})]})}function Ui({isLoading:e,refreshComemnts:t}){return(0,n.jsx)(n.Fragment,{children:e?(0,n.jsx)(Xs,{width:"32",height:"32"}):(0,n.jsx)(Di.A,{className:"wpqt-icon-blue wpqt-size-8 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:t})})}function Fi({item:e}){const{convertToWPTimezone:t}=Dn(),s=null===e.author_name&&null===e.author_id;return(0,n.jsxs)(n.Fragment,{children:[!s&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,n.jsx)("div",{className:"wpqt-text-center",children:"wp-user"===e.author_type?(0,o.__)("Admin","quicktasker"):(0,o.__)("QuickTasker","quicktasker")})]}),s&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:(0,o.__)("Unknown","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-text-center",children:(0,o.__)("Author not found","quicktasker")})]}),(0,n.jsx)("div",{children:t(e.created_at)}),(0,n.jsx)("div",{children:e.text})]})}var Ki=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function $i({taskId:e}){return(0,n.jsx)(Mi,{typeId:e,fetchData:()=>Ki(this,void 0,void 0,(function*(){try{return(yield Wt(e,Ts.Task)).data}catch(e){console.error(e),i.oR.error("Failed to get log")}})),renderItem:e=>(0,n.jsx)(Ni,{log:e}),noDataMessage:"No logs available"})}var zi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Gi(){return{addComment:(e,t,s,a)=>zi(this,void 0,void 0,(function*(){try{const n=yield Ht(e,t,s,a);return i.oR.success((0,o.__)("Comment added","quicktasker")),n.data.newComment}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add comment","quicktasker"))}}))}}var Vi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Bi({taskId:e}){const{addComment:t}=Gi();return(0,n.jsx)(Mi,{typeId:e,fetchData:()=>Vi(this,void 0,void 0,(function*(){try{return(yield Bt(e,Ts.Task,!0)).data}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>Vi(this,void 0,void 0,(function*(){const a=yield t(e,Ts.Task,!0,s);if(a)return a})),renderItem:e=>(0,n.jsx)(Fi,{item:e}),noDataMessage:"No comments available",enableAdd:!0})}var Hi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Wi({taskId:e}){const{addComment:t}=Gi();return(0,n.jsx)(Mi,{typeId:e,fetchData:()=>Hi(this,void 0,void 0,(function*(){try{return(yield Bt(e,Ts.Task,!1)).data}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>Hi(this,void 0,void 0,(function*(){const a=yield t(e,Ts.Task,!1,s);if(a)return a})),renderItem:e=>(0,n.jsx)(Fi,{item:e}),noDataMessage:"No comments available",enableAdd:!0})}function Qi({task:e}){const t=[(0,o.__)("Logs","quicktasker"),(0,o.__)("Private comments","quicktasker"),(0,o.__)("Public comments","quicktasker")];return(0,n.jsx)(Ti,{tabs:t,tabsContent:[(0,n.jsx)($i,{taskId:e.id},3),(0,n.jsx)(Bi,{taskId:e.id},1),(0,n.jsx)(Wi,{taskId:e.id},2)]})}var Yi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ji(){return{getUplaods:(e,t)=>Yi(this,void 0,void 0,(function*(){try{const s=yield function(e,t){const s=new URLSearchParams({entity_id:e,entity_type:t});return zt()({path:`/wpqt/v1/uploads?${s.toString()}`,method:"GET"})}(e,t);return{data:s.data,error:null}}catch(e){return console.error(e),{data:null,error:e}}})),uploadFile:e=>Yi(this,void 0,void 0,(function*(){try{const t=yield function(e){return zt()({path:"/wpqt/v1/uploads",method:"POST",body:e})}(e);return i.oR.success((0,o.__)("File uploaded successfully","quicktasker")),{data:t.data,error:null}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to upload a file","quicktasker")),{data:null,error:e}}})),deleteUpload:e=>Yi(this,void 0,void 0,(function*(){try{const t=yield function(e){return zt()({path:`/wpqt/v1/uploads/${e}`,method:"DELETE"})}(e);return i.oR.success((0,o.__)("File deleted successfully","quicktasker")),{data:t.data,error:null}}catch(e){return console.error(e),i.oR.error((0,o.__)("Failed to delete a file","quicktasker")),{data:null,error:e}}})),checkFileExists:e=>Yi(this,void 0,void 0,(function*(){try{return(yield fetch(e,{method:"HEAD"})).ok}catch(e){return!1}}))}}var Xi=s(2944),Zi=s(4015);function eo({upload:e,menuBtnClasses:t=""}){const{state:{taskUploadsURL:s}}=(0,a.useContext)(nn),i=`${s}/${e.upload_uuid}/${e.file_name}`;return(0,n.jsx)(ii,{menuBtnClasses:`wpqt-inline-flex ${t}`,anchor:"top",menuBtn:()=>(0,n.jsx)(Zi.A,{className:"wpqt-size-5 wpqt-icon-blue"}),children:(0,n.jsxs)("div",{children:[(0,n.jsx)(to,{title:(0,o.__)("File name","quicktasker"),children:e.file_name}),(0,n.jsx)(to,{title:(0,o.__)("File link","quicktasker"),children:(0,n.jsx)("a",{href:i,target:"_blank",rel:"noreferrer",children:i})}),(0,n.jsx)(to,{title:(0,o.__)("Created at","quicktasker"),children:e.created_at}),(0,n.jsx)(to,{title:(0,o.__)("Created by","quicktasker"),children:e.uploader_name})]})})}function to({title:e,children:t}){return(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-uppercase",children:e}),(0,n.jsx)("div",{children:t})]})}var so=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ao({upload:e}){const{state:{isUserAllowedToDelete:t,taskUploadsURL:s}}=(0,a.useContext)(nn),{uploadDispatch:r}=(0,a.useContext)(Ya),[c,l]=(0,a.useState)(!1),{checkFileExists:d,deleteUpload:u}=Ji(),p=`${s}/${e.upload_uuid}/${e.file_name}`,h=(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-4 wpqt-justify-end wpqt-items-center",children:[(0,n.jsx)("a",{href:p,download:!0,onClick:()=>so(this,void 0,void 0,(function*(){(yield d(p))||i.oR.error((0,o.__)("File was not found","quicktasker"))})),className:"focus:wpqt-shadow-none",children:(0,n.jsx)(Xi.A,{className:"wpqt-icon-blue wpqt-size-5 :hover:wpqt-text-blue-800 wpqt-cursor-pointer"})}),(0,n.jsx)(eo,{upload:e}),t&&(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-5 :hover:wpqt-text-red-800 wpqt-cursor-pointer",onClick:()=>so(this,void 0,void 0,(function*(){l(!0);const{data:t}=yield u(e.id);t&&r({type:Ot,payload:e.id}),l(!1)}))})]});return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3 wpqt-main-border wpqt-p-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold",children:e.file_name}),c?(0,n.jsx)(ea,{ovalSize:"22",className:"!wpqt-items-end"}):h]})}var no=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function io({entityId:e,entityType:t}){const{uploadDispatch:s}=(0,a.useContext)(Ya),[r,c]=(0,a.useState)(null),[l,d]=(0,a.useState)(!1),{uploadFile:u}=Ji(),p=(0,a.useRef)(null);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:[(0,n.jsxs)("div",{className:"wpqt-max-w-[300px]",children:[(0,o.sprintf)((0,o.__)("Select file to upload (Max size: %d MB)","quicktasker"),Mt/1024/1024),(0,n.jsx)("br",{}),(0,o.__)("Allowed characters in file name: Latin letters, numbers, underscores, hyphens, and dots.","quicktasker")]}),(0,n.jsx)("input",{type:"file",onChange:e=>{if(e.target.files){const t=e.target.files[0];if(t.size>Mt)return void i.oR.error((0,o.sprintf)((0,o.__)("File size exceeds the maximum limit of %d MB","quicktasker"),Mt));if(!Ut.test(t.name))return void i.oR.error((0,o.__)("Invalid file name","quicktasker"));if(0===t.size)return void i.oR.error((0,o.__)("The selected file is empty","quicktasker"));c(t)}},ref:p,accept:Lt.join(",")}),r&&(0,n.jsx)(ta,{btnText:(0,o.__)("Upload","quicktasker"),loading:l,onClick:()=>no(this,void 0,void 0,(function*(){const a=(()=>{if(!r)return null;const s=new FormData;return s.append("file_to_upload",r),s.append("entity_id",e),s.append("entity_type",t),s})();if(a){d(!0);const{data:e}=yield u(a);e&&(s({type:At,payload:e.upload}),c(null),p.current&&(p.current.value="")),d(!1)}}))})]})}function oo({entityId:e,entityType:t}){const{state:{uploads:s},uploadDispatch:r}=(0,a.useContext)(Ya),[c,l]=(0,a.useState)(!0),{getUplaods:d}=Ji(),u=()=>{return s=this,a=void 0,c=function*(){l(!0);const{data:s,error:a}=yield d(e,t);l(!1),s&&s.uploads&&r({type:St,payload:s.uploads}),a&&i.oR.error((0,o.__)("Failed to fetch uploads","quicktasker"))},new((n=void 0)||(n=Promise))((function(e,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(i,o)}r((c=c.apply(s,a||[])).next())}));var s,a,n,c};return(0,a.useEffect)((()=>{u()}),[]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2",children:[(0,n.jsx)(io,{entityId:e,entityType:t}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-flex-wrap wpqt-items-start",children:c?(0,n.jsx)(ea,{ovalSize:"24"}):s.map((e=>(0,n.jsx)(ao,{upload:e},e.id)))})]})}var ro=s(303);function co({checked:e,handleChange:t,id:s,dataTestId:a}){return(0,n.jsx)(ro.A,{onChange:t,checked:e,uncheckedIcon:!1,checkedIcon:!1,height:20,width:44,id:s,"data-testid":a})}function lo({initialValue:e,task:t,onEditTaskCompleted:s}){const[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(e),{editTask:u}=ys();return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)(co,{checked:l,handleChange:e=>{return a=this,n=void 0,l=function*(){d(e),c(!0);const{success:a,task:n}=yield u(t.id,{free_for_all:e});c(!1),a&&n?(s(n),i.oR.success((0,o.__)("Free for all updated","quicktasker"))):d(!e)},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof r?a:new r((function(e){e(a)}))).then(s,i)}o((l=l.apply(a,n||[])).next())}));var a,n,r,l}}),r&&(0,n.jsx)(ea,{ovalSize:"20"})]})}var uo=s(4461);function po({initialValue:e,task:t,onEditTaskCompleted:s}){const[r,c]=(0,a.useState)(null),[l,d]=(0,a.useState)(!1),{editTask:u}=ys(),{convertUTCDateTimeToWPTimezone:p}=Dn();(0,a.useEffect)((()=>{const t=e?p(e):null;c(t)}),[e]);const h=e=>{return a=this,n=void 0,p=function*(){const a=r,n=e?Sn()(e).utc().format("YYYY-MM-DD HH:mm:ss"):"";c(e),d(!0);const{success:l,task:p}=yield u(t.id,{due_date:n});d(!1),l&&p?(s(p),i.oR.success((0,o.__)("Due date updated","quicktasker"))):c(a)},new((l=void 0)||(l=Promise))((function(e,t){function s(e){try{o(p.next(e))}catch(e){t(e)}}function i(e){try{o(p.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof l?a:new l((function(e){e(a)}))).then(s,i)}o((p=p.apply(a,n||[])).next())}));var a,n,l,p};return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)(uo.A,{onChange:e=>{h(e)},value:r,format:"y-MM-dd HH:mm"}),l&&(0,n.jsx)(ea,{ovalSize:"20"})]})}var ho=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const mo=({deleteTask:e,onEditTaskCompleted:t})=>{const{state:{taskToEdit:s,taskModalSettings:r},modalDispatch:c}=(0,a.useContext)(Ks),{state:{isUserAllowedToDelete:l}}=(0,a.useContext)(nn),{state:{activePipeline:d},fetchAndSetPipelineData:u}=(0,a.useContext)(xs),[p]=(0,a.useState)(!1),[h,m]=(0,a.useState)([]),{archiveTask:w,editTask:f}=ys(),{loading1:k,setLoading1:q,loading2:x,setLoading2:_}=tn(),g=null==s?void 0:s.is_archived;return(0,a.useEffect)((()=>{s&&m(s.assigned_labels)}),[s]),s?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,n.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-6",children:[(0,n.jsxs)("div",{className:"wpqt-mb-2 wpqt-grid wpqt-grid-cols-1 wpqt-gap-10 md:wpqt-grid-cols-[1fr_0.7fr]",children:[(0,n.jsxs)(oa,{children:[(0,n.jsx)(ra,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(dn,{value:s.name,wrapperClassName:"wpqt-w-full",className:"wpqt-w-full",onChange:e=>ho(void 0,void 0,void 0,(function*(){const{success:a,task:n}=yield f(s.id,{name:e});a&&n&&(t(n),i.oR.success((0,o.__)("Task name updated","quicktasker")))}))})}),(0,n.jsx)(ra,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(mn,{value:s.description,className:"wpqt-w-full",onChange:e=>ho(void 0,void 0,void 0,(function*(){const{success:a,task:n}=yield f(s.id,{description:e});a&&n&&(t(n),i.oR.success((0,o.__)("Task description updated","quicktasker")))}))})}),(0,n.jsx)(ra,{label:(0,o.__)("Assigned users","quicktasker"),children:(0,n.jsx)(yi,{task:s,onUserAdd:e=>{c({type:Q,payload:e})},onUserDelete:e=>{c({type:Y,payload:e})}})}),(0,n.jsx)(ra,{label:(0,o.__)("Labels","quicktasker"),children:(0,n.jsx)(qi,{task:Object.assign(Object.assign({},s),{assigned_labels:h}),labelSelected:e=>{m((t=>[...t,e]))},labelDeselected:e=>{m((t=>t.filter((t=>t.id!==e))))},labelDeleted:e=>{m((t=>t.filter((t=>t.id!==e))))}})}),(0,n.jsx)(ra,{label:(0,o.__)("Free for all task","quicktasker"),description:(0,o.__)("When enabled, users have the ability to self-assign or unassign this task.","quicktasker"),children:(0,n.jsx)(lo,{task:s,initialValue:s.free_for_all,onEditTaskCompleted:t})}),(0,n.jsx)(ra,{label:(0,o.__)("Due date","quicktasker"),children:(0,n.jsx)(po,{initialValue:s.due_date||"",task:s,onEditTaskCompleted:t})}),r.allowToMarkTaskAsDone&&(0,n.jsx)(wo,{taskId:s.id,isCompleted:s.is_done})]}),(0,n.jsx)("div",{children:(0,n.jsx)(ei,{entityId:s.id,entityType:cn.Task})})]}),(0,n.jsx)(ra,{label:(0,o.__)("File attachment","quicktasker"),children:(0,n.jsx)(oo,{entityId:s.id,entityType:ln.TASK})}),(0,n.jsx)("div",{className:"wpqt-mt-7 md:wpqt-pr-3",children:(0,n.jsx)(Qi,{task:s})})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[g&&(0,n.jsx)(la,{icon:(0,n.jsx)(ma.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Restore task","quicktasker"),loading:p,onClick:()=>ho(void 0,void 0,void 0,(function*(){c({type:F}),c({type:ce,payload:{taskToRestore:s}})}))}),!g&&(0,n.jsx)(ti,{confirmMessage:(0,o.__)("Are you sure you want to archive this task?","quicktasker"),onConfirm:()=>{_(!0),w(s.id,(()=>{c({type:F}),u(d.id),_(!1)}))},children:({onClick:e})=>(0,n.jsx)(la,{icon:(0,n.jsx)(Xa.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("Archive task","quicktasker"),loading:x,onClick:e})}),l&&(0,n.jsx)(ti,{onConfirm:()=>ho(void 0,void 0,void 0,(function*(){q(!0),yield e(s),c({type:F}),q(!1)})),children:({onClick:e})=>(0,n.jsx)(la,{icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete task","quicktasker"),loading:k,onClick:e})})]})]})}):null};function wo({isCompleted:e,taskId:t}){const{modalDispatch:s}=(0,a.useContext)(Ks),{dispatch:i}=(0,a.useContext)(xs),[r,c]=(0,a.useState)(!1),{changeTaskDoneStatus:l}=ys();return(0,n.jsx)(ra,{label:e?(0,o.__)("Task completed","quicktasker"):(0,o.__)("Task not completed","quicktasker"),children:r?(0,n.jsx)(Xs,{width:"24",height:"24"}):(0,n.jsx)(en.A,{onClick:()=>ho(this,void 0,void 0,(function*(){c(!0),yield l(t,!e,(e=>{s({type:E,payload:{done:e}}),i({type:E,payload:{taskId:t,done:e}})})),c(!1)})),className:`wpqt-size-6 ${e?"wpqt-icon-green":"wpqt-text-gray-300"} wpqt-cursor-pointer`})})}var fo=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ko({deleteTaskCallback:e}){const{state:{taskModalOpen:t}}=(0,a.useContext)(Ks),{deleteTask:s}=ys(),{closeModal:i,handleSuccess:o}=Ha(F);return(0,n.jsx)(na,{modalOpen:t,closeModal:i,size:"xl",children:(0,n.jsx)(Ja,{children:(0,n.jsx)(mo,{deleteTask:t=>fo(this,void 0,void 0,(function*(){s(t.id,(()=>{e&&e(t)}))})),onEditTaskCompleted:e=>{o(q,e,Ba.ACTIVE_PIPELINE)}})})})}function qo({text:e=(0,o.__)("No results found","quicktasker")}){return(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-center wpqt-text-xl",children:e})}var xo=s(3033),_o=s(587);function go({className:e,onClick:t,title:s,description:a,children:i,dropdown:o,titleClassName:r="",style:c={}}){const l=void 0!==o;return(0,n.jsxs)("div",{className:(0,pn.$)("wpqt-relative wpqt-flex wpqt-flex-col wpqt-rounded wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-4",l&&"wpqt-pr-[24px]",e),style:c,onClick:t,children:[(0,n.jsxs)("div",{className:"wpqt-mb-3",children:[(0,n.jsx)("div",{className:`wpqt-text-lg ${r}`,children:s}),a&&(0,n.jsx)("div",{className:"wpqt-italic wpqt-text-gray-500",children:a})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-h-full",children:i}),l&&(0,n.jsx)("div",{className:"wpqt-absolute wpqt-right-2 wpqt-top-1 wpqt-z-10",children:o})]})}var vo=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function jo({task:e,onDoneStatusChange:t,className:s=""}){const{changeTaskDoneStatus:i}=ys(),[o,r]=(0,a.useState)(!1),c=e.is_done,l=s=>vo(this,void 0,void 0,(function*(){r(!0),yield i(e.id,s,(s=>{t(e.id,s)})),r(!1)}));return o?(0,n.jsx)(ea,{ovalSize:"24",className:"wpqt-mt-auto"}):(0,n.jsx)("div",{className:`wpqt-flex wpqt-justify-center wpqt-mt-auto ${s}`,children:c?(0,n.jsx)(en.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)},"data-testid":"check-icon"}):(0,n.jsx)(en.A,{className:"wpqt-size-6 wpqt-text-gray-300",onClick:e=>{e.stopPropagation(),l(!0)},"data-testid":"check-icon"})})}function bo({label:e,value:t,valueClassName:s="",valueLink:a,icon:i,onClick:o=()=>{},className:r="",labelClassName:c=""}){return(0,n.jsxs)("div",{className:`wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center ${r}`,onClick:o,children:[i&&i,(0,n.jsx)("div",{className:c,children:t?`${e}:`:e}),(0,n.jsx)("div",{className:`${s}`,children:a?(0,n.jsx)("a",{href:a,target:"_blank",className:"wpqt-text-qtTextBlue wpqt-no-underline",rel:"noreferrer",onClick:e=>e.stopPropagation(),children:t}):t})]})}var yo=s(6436),Eo=s(72),To=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function So({task:e}){const{state:{isUserAllowedToDelete:t}}=(0,a.useContext)(nn),{archiveDispatch:s}=(0,a.useContext)(Ps),{deleteTask:i}=ys(),{modalDispatch:r}=(0,a.useContext)(Ks),[c,l]=(0,a.useState)(!1);return(0,n.jsxs)(ii,{menuBtn:({active:e})=>(0,n.jsx)(oi,{isActive:e,IconComponent:yo.A}),children:[(0,n.jsx)(ri,{text:(0,o.__)("View task","quicktasker"),icon:(0,n.jsx)(Eo.A,{className:"wpqt-icon-blue wpqt-size-4"})}),(0,n.jsx)(ri,{text:(0,o.__)("Restore task","quicktasker"),icon:(0,n.jsx)(ma.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:t=>To(this,void 0,void 0,(function*(){t.stopPropagation(),r({type:ce,payload:{taskToRestore:e}})}))}),t&&(0,n.jsx)(ri,{text:(0,o.__)("Delete","quicktasker"),loading:c,icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>To(this,void 0,void 0,(function*(){t.stopPropagation(),l(!0),yield i(e.id,(()=>{s({type:xe,payload:e.id})})),l(!1)})),className:"!wpqt-mb-0"})]})}function Ao({task:e}){const{modalDispatch:t}=(0,a.useContext)(Ks),{archiveDispatch:s}=(0,a.useContext)(Ps),{convertToWPTimezone:i}=Dn(),r=e.due_date?i(e.due_date):null;return(0,n.jsxs)(go,{title:e.name,description:e.description,dropdown:(0,n.jsx)(So,{task:e}),className:"wpqt-cursor-pointer",onClick:()=>{t({type:U,payload:{taskToEdit:e}})},children:[(0,n.jsx)(bo,{label:(0,o.__)("Board","quicktasker"),value:e.pipeline_name?e.pipeline_name:(0,o.__)("Board is deleted!","quicktasker"),icon:(0,n.jsx)(xo.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsxs)("div",{className:"wpqt-mt-2 wpqt-mb-2 wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:[(0,n.jsx)(yi,{menuBtnClasses:"wpqt-self-start",task:e,onUserAdd:t=>{s({type:ge,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{s({type:ve,payload:{taskId:e.id,user:t}})}}),(0,n.jsx)(qi,{task:e})]}),r&&(0,n.jsx)(bo,{label:(0,o.__)("Due date","quicktasker"),value:r,icon:(0,n.jsx)(_o.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(jo,{task:e,onDoneStatusChange:(e,t)=>{s({type:je,payload:{taskId:e,done:t}})}})]})}function Oo(){const{state:{archivedTasks:e,archiveLoading:t}}=(0,a.useContext)(Ps);return t?(0,n.jsx)(ea,{className:"wpqt-h-[200px]"}):e&&0===e.length?(0,n.jsx)(qo,{text:(0,o.__)("No match","quicktasker")}):e?(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"wpqt-card-grid",children:e.map((e=>(0,n.jsx)(Ao,{task:e},e.id)))})}):null}function No(){const{archiveDispatch:e}=(0,a.useContext)(Ps);return(0,n.jsxs)("div",{children:[(0,n.jsx)(Fa,{}),(0,n.jsx)(Oo,{}),(0,n.jsx)(ko,{editTaskCallback:t=>{e({type:be,payload:t})},deleteTaskCallback:t=>{e({type:xe,payload:t.id})}})]})}function Co(){const{modalDispatch:e}=(0,a.useContext)(Ks);return(0,n.jsx)(Rs,{children:(0,n.jsx)(Oa,{children:(0,n.jsxs)(Na,{children:[(0,n.jsx)(d,{description:(0,o.__)("Archived tasks management page.","quicktasker"),icon:(0,n.jsx)(l.A,{className:"wpqt-icon-gray wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{e({type:re,payload:!0})}}),children:(0,o.__)("Archive","quicktasker")}),(0,n.jsx)(No,{}),(0,n.jsx)(ha,{}),(0,n.jsx)(Ea,{})]})})})}const Io=(e,t)=>{var s,a;switch(t.type){case ht:{const s=t.payload.automations;return Object.assign(Object.assign({},e),{automations:s})}case mt:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case wt:{const n=t.payload,i=null!==(a=null===(s=e.automations)||void 0===s?void 0:s.filter((e=>e.id!==n)))&&void 0!==a?a:null;return Object.assign(Object.assign({},e),{automations:i})}case kt:{const s=e.automations?e.automations.map((e=>e.id===t.payload.id?Object.assign(Object.assign({},e),{active:t.payload.active}):e)):null;return Object.assign(Object.assign({},e),{automations:s})}case ft:{const s=t.payload,a=e.automations?[...e.automations,s]:[s];return Object.assign(Object.assign({},e),{automations:a})}default:return e}},Do={[os.ARCHIVE_TASK]:(0,o.__)("Archive task","quicktasker"),[os.ASSIGN_USER]:(0,o.__)("Assign user","quickkasker"),[os.NEW_ENTITY_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[os.DELETED_ENTITY_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[os.TASK_ASSIGNED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[os.TASK_UNASSIGNED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[os.TASK_PUBLIC_COMMENT_ADDED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[os.TASK_PRIVATE_COMMENT_ADDED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[os.TASK_FILE_UPLOADED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[os.TASK_FILE_DELETED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[os.CREATE_TASK]:(0,o.__)("Create task","quicktasker"),[os.SEND_SLACK_MESSAGE]:(0,o.__)("Send Slack message","quicktasker")},Po={[ns.Task]:(0,o.__)("Task","quicktasker"),[ns.Stage]:(0,o.__)("Stage","quicktasker"),[ns.PIPELINE]:(0,o.__)("Board","quicktasker"),[ns.quicktasker]:"Quicktasker",[ns.WOOCOMMERCE_ORDER]:(0,o.__)("WooCommerce Order","quicktasker"),[ns.SEATREG_BOOKING]:(0,o.__)("SeatReg Booking","quicktasker")},Ro={[ts.TASK_DONE]:(0,o.__)("Task marked as done","quicktasker"),[ts.Task_NOT_DONE]:(0,o.__)("Task marked as not done","quicktasker"),[ts.TASK_CREATED]:(0,o.__)("Task created","quicktasker"),[ts.TASK_DELETED]:(0,o.__)("Task deleted","quicktasker"),[ts.TASK_ASSIGNED]:(0,o.__)("Task assigned","quicktasker"),[ts.TASK_UNASSIGNED]:(0,o.__)("Task unassigned","quicktasker"),[ts.TASK_PUBLIC_COMMENT_ADDED]:(0,o.__)("Public comment added","quicktasker"),[ts.TASK_PRIVATE_COMMENT_ADDED]:(0,o.__)("Private comment added","quicktasker"),[ts.TASK_FILE_UPLOADED]:(0,o.__)("File attached","quicktasker"),[ts.TASK_FILE_DELETED]:(0,o.__)("Attached file deleted","quicktasker"),[ss.WOOCOMMERCE_ORDER_ADDED]:(0,o.__)("Order added","quicktasker"),[as.SEATREG_BOOKING_CREATED]:(0,o.__)("Booking created","quicktasker"),[as.SEATREG_BOOKING_APPROVED]:(0,o.__)("Booking gets approved state","quicktasker"),[as.SEATREG_BOOKING_PENDING]:(0,o.__)("Booking gets pending state","quicktasker"),[as.SEATREG_BOOKING_APPROVED_VIA_MANAGER]:(0,o.__)("Booking gets approved state manually with booking manager","quicktasker"),[as.SEATREG_BOOKING_PENDING_VIA_MANAGER]:(0,o.__)("Booking gets pending state manually with booking manager","quicktasker")},Lo=(ss.WOOCOMMERCE_ORDER_ADDED,(0,o.__)("Order added","quicktasker"),{[ts.TASK_DONE]:[{id:os.ARCHIVE_TASK},{id:os.SEND_SLACK_MESSAGE,requireMetaData:!0}],[ts.Task_NOT_DONE]:[{id:os.ARCHIVE_TASK}],[ts.TASK_CREATED]:[{id:os.ASSIGN_USER,requireAutomationTarget:!0,requireAutomationTargetType:!0},{id:os.NEW_ENTITY_EMAIL,requireMetaData:!0},{id:os.SEND_SLACK_MESSAGE,requireMetaData:!0}],[ts.TASK_DELETED]:[{id:os.DELETED_ENTITY_EMAIL,requireMetaData:!0},{id:os.SEND_SLACK_MESSAGE,requireMetaData:!0}],[ts.TASK_ASSIGNED]:[{id:os.TASK_ASSIGNED_EMAIL,requireMetaData:!0},{id:os.SEND_SLACK_MESSAGE,requireMetaData:!0}],[ts.TASK_UNASSIGNED]:[{id:os.TASK_UNASSIGNED_EMAIL,requireMetaData:!0},{id:os.SEND_SLACK_MESSAGE,requireMetaData:!0}],[ts.TASK_PUBLIC_COMMENT_ADDED]:[{id:os.TASK_PUBLIC_COMMENT_ADDED_EMAIL,requireMetaData:!0},{id:os.SEND_SLACK_MESSAGE,requireMetaData:!0}],[ts.TASK_PRIVATE_COMMENT_ADDED]:[{id:os.TASK_PRIVATE_COMMENT_ADDED_EMAIL,requireMetaData:!0},{id:os.SEND_SLACK_MESSAGE,requireMetaData:!0}],[ts.TASK_FILE_UPLOADED]:[{id:os.TASK_FILE_UPLOADED_EMAIL,requireMetaData:!0}],[ts.TASK_FILE_DELETED]:[{id:os.TASK_FILE_DELETED_EMAIL,requireMetaData:!0}]}),Mo={[ss.WOOCOMMERCE_ORDER_ADDED]:[{id:os.CREATE_TASK}]},Uo={[as.SEATREG_BOOKING_CREATED]:[{id:os.CREATE_TASK}],[as.SEATREG_BOOKING_APPROVED]:[{id:os.CREATE_TASK}],[as.SEATREG_BOOKING_PENDING]:[{id:os.CREATE_TASK}],[as.SEATREG_BOOKING_APPROVED_VIA_MANAGER]:[{id:os.CREATE_TASK}],[as.SEATREG_BOOKING_PENDING_VIA_MANAGER]:[{id:os.CREATE_TASK}]},Fo={[ns.Task]:Lo,[ns.WOOCOMMERCE_ORDER]:Mo,[ns.SEATREG_BOOKING]:Uo};const Ko={automations:null,loading:!0},$o=(0,a.createContext)({state:Ko,pipelineAutomationsDispatch:()=>{}}),zo=({children:e,pipelineId:t})=>{const[s,r]=(0,a.useReducer)(Io,Ko),c=()=>{return e=void 0,s=void 0,n=function*(){try{r({type:mt,payload:!0});const s=yield function(e){return zt()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"GET",headers:Gt()})}(t);r({type:ht,payload:{automations:(e=s.data.automations,e.map((e=>Object.assign(Object.assign({},e),{active:"1"===e.active,verify_success:"1"===e.verify_success}))))}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load board automations","quicktasker"))}finally{r({type:mt,payload:!1})}var e},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n};return(0,a.useEffect)((()=>{c()}),[]),(0,n.jsx)($o.Provider,{value:{state:s,pipelineAutomationsDispatch:r},children:e})};function Go(){const{state:{automations:e,loading:t}}=(0,a.useContext)($o);return{automations:e,loading:t}}var Vo=s(8046),Bo=s(1226);const Ho={automationTarget:null,automationTrigger:null,automationAction:null,automationActionTargetId:null,automationActionTargetType:null,metaData:null};function Wo(e,t){switch(t.type){case"SET_TARGET":return Object.assign(Object.assign({},e),{automationTarget:t.payload,automationTrigger:null,automationAction:null});case"SET_TRIGGER":return Object.assign(Object.assign({},e),{automationTrigger:t.payload,automationAction:null});case"SET_ACTION":return Object.assign(Object.assign({},e),{automationAction:t.payload});case"RESET":return Ho;case xt:return Object.assign(Object.assign({},e),{automationActionTargetId:t.payload.automationActionTargetId,automationActionTargetType:t.payload.automationActionTargetType});case qt:return Object.assign(Object.assign({},e),{metaData:t.payload});case _t:return Ho;case gt:return Object.assign(Object.assign({},Ho),{automationTarget:e.automationTarget});case vt:return Object.assign(Object.assign({},Ho),{automationTarget:e.automationTarget,automationTrigger:e.automationTrigger});default:return e}}const Qo=()=>{const{state:{users:e,wpUsers:t}}=(0,a.useContext)(Ga);return{getUser:(s,a)=>a===Kt.QUICKTASKER?e.find((e=>e.id===s)):a===Kt.WP_USER?t.find((e=>e.id===s)):void 0,combinedUsers:(0,a.useMemo)((()=>[...e,...t]),[e,t])}};function Yo({actionTargetId:e,actionTargetType:t}){if(null===e||null===t)return null;const{getUser:s}=Qo();if(t===is.QUICKTASKER||t===is.WP_USER||null!==e){const a=cs(t);if(a){const t=s(e,a);return(0,n.jsx)("div",{className:"wpqt-text-center",children:(null==t?void 0:t.name)||(0,o.__)("User not found","quicktasker")})}}return null}var Jo=s(7613);function Xo({value:e,label:t,onClick:s=()=>{},className:a=""}){return(0,n.jsx)("div",{className:`wpqt-inline-flex wpqt-text-center wpqt-font-semibold wpqt-rounded-xl wpqt-px-4 wpqt-py-2 wpqt-border wpqt-border-solid wpqt-cursor-pointer wpqt-border-qtBorder ${a}`,onClick:()=>{s(e)},children:t})}function Zo({children:e,title:t}){return(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-base wpqt-mb-4 wpqt-text-center",children:t}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-gap-3 wpqt-flex-wrap",children:e})]})}function er({automationDispatch:e,automation:t}){if(!t.automationTarget||!t.automationTrigger)return null;const s=t.automationTarget,a=t.automationTrigger,i=Fo[s],r=i&&a in i?i[a]:[];return(0,n.jsx)(Zo,{title:(0,o.__)("Step 3. Select action","quicktasker"),children:r.map((t=>(0,n.jsx)(Xo,{value:t.id,label:Do[t.id],onClick:()=>{e({type:"SET_ACTION",payload:t})}},t.id)))})}function tr({quickTaskerUsers:e,wpUsers:t,assignUser:s}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,n.jsx)(vi,{sectionTitle:(0,o.__)("Assign a quicktasker","quicktasker"),users:e,onItemSelect:s,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No quicktaskers available to assign","quicktasker")}),(0,n.jsx)(vi,{sectionTitle:(0,o.__)("Assign a WordPress user","quicktasker"),users:t,onItemSelect:s,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No WordPress users with required permissions available to assign","quicktasker")})]})}function sr({automationAction:e,onUserAdd:t=()=>{},quickTaskerUserTargets:s=[],wpUserTargets:a=[],menuBtnClasses:i=""}){const o=[...s,...a].length>0;return(0,n.jsx)(ii,{menuBtnClasses:`wpqt-inline-flex ${i}`,anchor:"bottom start",menuBtn:()=>(0,n.jsx)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:(0,n.jsx)(xi.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`})}),children:e===os.ASSIGN_USER&&(0,n.jsx)(tr,{quickTaskerUsers:s,wpUsers:a,assignUser:t})})}const ar=[os.ASSIGN_USER];function nr({automationDispatch:e,automation:t}){var s;const{state:{users:i,wpUsers:r}}=(0,a.useContext)(Ga),c=null===(s=t.automationAction)||void 0===s?void 0:s.id,l=void 0!==c&&ar.includes(c);return(0,n.jsx)(Zo,{title:(0,o.__)("Step 4. Select action target","quicktasker"),children:l&&(0,n.jsx)(sr,{automationAction:c,quickTaskerUserTargets:i,wpUserTargets:r,onUserAdd:t=>{e({type:xt,payload:{automationActionTargetId:t.id,automationActionTargetType:t.user_type}})}})})}var ir=s(4476);const or=ir.z.string().email({message:"Invalid email address"});function rr({setAutomationMeta:e}){const[t,s]=(0,a.useState)(""),[i,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(e=>{try{or.parse(e),r(!0)}catch(e){r(!1)}})(t)}),[t]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-justify-center wpqt-items-center",children:[(0,n.jsx)(Ri,{type:"info",children:(0,o.__)("Make sure your website is configured to send out emails","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)("label",{htmlFor:"automation-meta-email-input",children:(0,o.__)("Email will be sent to","quicktasker")}),(0,n.jsx)(Ra,{inputId:"automation-meta-email-input",value:t,onChange:s,wrapperClassName:"!wpqt-mb-0"}),!i&&(0,n.jsx)("div",{className:"wpqt-text-red-500",children:(0,o.__)("Invalid email address","quicktasker")})]}),(0,n.jsx)(ta,{btnText:(0,o.__)("Set email","quicktasker"),onClick:()=>{i&&e(t)}})]})}const cr=ir.z.string().url({message:"Invalid URL"}).refine((e=>e.startsWith("https://hooks.slack.com/services/")),{message:"Invalid Slack webhook URL"}),lr=function({setAutomationMeta:e}){const[t,s]=(0,a.useState)(""),[i,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(e=>{try{cr.parse(e),r(!0)}catch(e){r(!1)}})(t)}),[t]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-justify-center wpqt-items-center",children:[(0,n.jsxs)(Ri,{type:"info",children:[(0,o.__)("Make sure your have configured your Slack webhook URL.","quicktasker"),(0,n.jsx)("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",rel:"noopener noreferrer",className:"wpqt-text-blue-500 hover:underline wpqt-ml-1",children:(0,o.__)("Read more about Slack webhooks.","quicktasker")})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)("label",{htmlFor:"automation-meta-slack-webhook-input",children:(0,o.__)("Slack webhook URL","quicktasker")}),(0,n.jsx)(Ra,{inputId:"automation-meta-slack-webhook-input",value:t,onChange:s,wrapperClassName:"!wpqt-mb-0"}),!i&&(0,n.jsx)("div",{className:"wpqt-text-red-500",children:(0,o.__)("Invalid Slack webhook","quicktasker")})]}),(0,n.jsx)(ta,{btnText:(0,o.__)("Set webhook URL","quicktasker"),onClick:()=>{i&&e(t)}})]})};function dr({automationCreationState:e,automationDispatch:t}){var s;const a=null===(s=null==e?void 0:e.automationAction)||void 0===s?void 0:s.id,i=a===os.NEW_ENTITY_EMAIL||a===os.DELETED_ENTITY_EMAIL||a===os.TASK_ASSIGNED_EMAIL||a===os.TASK_UNASSIGNED_EMAIL||a===os.TASK_PUBLIC_COMMENT_ADDED_EMAIL||a===os.TASK_PRIVATE_COMMENT_ADDED_EMAIL||a===os.TASK_FILE_UPLOADED_EMAIL||a===os.TASK_FILE_DELETED_EMAIL,o=a===os.SEND_SLACK_MESSAGE,r=e=>{t({type:qt,payload:e})};return i?(0,n.jsx)(rr,{setAutomationMeta:r}):o?(0,n.jsx)(lr,{setAutomationMeta:r}):null}function ur({automationDispatch:e}){const t=Object.keys(Fo).map((e=>({value:e,label:Po[e]||e})));return(0,n.jsx)(Zo,{title:(0,o.__)("Step 1. Select a target","quicktasker"),children:t.map((({value:t,label:s})=>(0,n.jsx)(Xo,{value:t,label:s,onClick:()=>{e({type:"SET_TARGET",payload:t})}},t)))})}function pr({automationDispatch:e,automation:t}){if(!t.automationTarget)return null;const s=t.automationTarget,a=Object.keys(Fo[s]).map((e=>({value:e,label:Ro[e]||e})));return(0,n.jsx)(Zo,{title:(0,o.__)("Step 2. Select a trigger","quicktasker"),children:a.map((({value:t,label:s})=>(0,n.jsx)(Xo,{value:t,label:s,onClick:()=>{e({type:"SET_TRIGGER",payload:t})}},t)))})}var hr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function mr({automation:e,automationDispatch:t,createAutomation:s}){const[i,r]=(0,a.useState)(!1);return null===e.automationTarget?(0,n.jsx)(ur,{automationDispatch:t}):null===e.automationTrigger?(0,n.jsx)(pr,{automationDispatch:t,automation:e}):null===e.automationAction?(0,n.jsx)(er,{automationDispatch:t,automation:e}):e.automationAction&&e.automationAction.requireAutomationTarget&&e.automationAction.requireAutomationTargetType&&(null===e.automationActionTargetType||null===e.automationActionTargetId)?(0,n.jsx)(nr,{automationDispatch:t,automation:e}):e.automationAction.requireMetaData&&!e.metaData?(0,n.jsx)(dr,{automationCreationState:e,automationDispatch:t}):(0,n.jsx)(la,{text:(0,o.__)("Create automation","quicktasker"),icon:(0,n.jsx)(Jo.ltU,{className:"wpqt-size-6"}),onClick:()=>hr(this,void 0,void 0,(function*(){r(!0),yield s(),r(!1)})),loading:i})}var wr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function fr({pipelineId:e}){const{pipelineAutomationsDispatch:t,state:{loading:s,automations:i}}=(0,a.useContext)($o),[r,c]=(0,a.useReducer)(Wo,Ho),{createAutomation:l}=js(),d=null!==r.automationActionTargetId&&null!==r.automationActionTargetType,u=null!==r.metaData,p="wpqt-px-3 wpqt-min-w-[60px] wpqt-cursor-pointer",h="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1";return s?null:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3 wpqt-mb-8",children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-3 wpqt-p-4 wpqt-justify-center wpqt-items-center",children:[(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-start"}),(0,n.jsx)(go,{title:(0,o.__)("Target","quicktasker"),className:p,titleClassName:h,onClick:()=>{c({type:_t})},children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTarget?Po[r.automationTarget]:(0,n.jsx)(kr,{})})}),(0,n.jsx)(Vo.A,{className:"wpqt-icon-blue wpqt-size-6"}),(0,n.jsx)(go,{title:(0,o.__)("Trigger","quicktasker"),className:p,titleClassName:h,onClick:()=>{c({type:gt})},children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTrigger?Ro[r.automationTrigger]:(0,n.jsx)(kr,{})})}),(0,n.jsx)(Vo.A,{className:"wpqt-icon-blue wpqt-size-6"}),(0,n.jsx)(go,{title:(0,o.__)("Action","quicktasker"),className:p,titleClassName:h,onClick:()=>{c({type:vt})},children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center wpqt-items-center",children:[r.automationAction?Do[r.automationAction.id]:(0,n.jsx)(kr,{}),d&&(0,n.jsx)(Yo,{actionTargetId:r.automationActionTargetId,actionTargetType:r.automationActionTargetType}),u&&(0,n.jsx)("div",{children:r.metaData})]})})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(mr,{automation:r,automationDispatch:c,createAutomation:()=>wr(this,void 0,void 0,(function*(){yield l(e,r,((e,s)=>{e&&s&&(c({type:"RESET"}),t({type:ft,payload:s}))}))}))})})]})}function kr(){return(0,n.jsx)(Bo.A,{className:"wpqt-size-7 wpqt-text-gray-300"})}var qr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function xr({automation:e,className:t="",titleClassName:s=""}){const{deleteAutomation:i,updateAutomationActiveStatus:r}=js(),{pipelineAutomationsDispatch:c}=(0,a.useContext)($o),[l,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1);return(0,n.jsx)(go,{title:(0,o.__)("Controls","quicktasker"),className:`${t} wpqt-ml-6`,titleClassName:s,children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3 wpqt-justify-center",children:[(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-1 wpqt-justify-center wpqt-items-center wpqt-h-[40px]",children:u?(0,n.jsx)(ea,{ovalSize:"32"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Active","quicktasker")}),(0,n.jsx)(co,{checked:e.active,handleChange:t=>qr(this,void 0,void 0,(function*(){p(!0);const s=yield r(e.pipeline_id,e.id,t);p(!1),s.success&&c({type:kt,payload:{id:e.id,active:t}})}))})]})}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-2",children:(0,n.jsx)(la,{loading:l,icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-5"}),onClick:()=>qr(this,void 0,void 0,(function*(){d(!0),yield i(e.pipeline_id,e.id,(t=>{t&&c({type:wt,payload:e.id})})),d(!1)})),text:(0,o.__)("Delete","quicktasker")})})]})})}function _r({automation:e}){const t="wpqt-px-3 wpqt-pt-1 wpqt-min-w-[60px] wpqt-cursor-default",s="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1",a=null!==e.automation_action_target_id&&null!==e.automation_action_target_type,i=null!==e.metadata;return(0,n.jsxs)("div",{className:"wpqt-flex",children:[(0,n.jsxs)("div",{className:"wpqt-flex-1 wpqt-flex wpqt-p-4 wpqt-items-center wpqt-justify-center wpqt-gap-3",children:[(0,n.jsx)(go,{title:(0,o.__)("Target","quicktasker"),className:t,titleClassName:s,children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:Po[e.target_type]})}),(0,n.jsx)(Vo.A,{className:"wpqt-icon-blue wpqt-size-6"}),(0,n.jsx)(go,{title:(0,o.__)("Trigger","quicktasker"),className:t,titleClassName:s,children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:Ro[e.automation_trigger]})}),(0,n.jsx)(Vo.A,{className:"wpqt-icon-blue wpqt-size-6"}),(0,n.jsx)(go,{title:(0,o.__)("Action","quicktasker"),className:t,titleClassName:s,children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center wpqt-items-center",children:[Do[e.automation_action],a&&(0,n.jsx)(Yo,{actionTargetId:e.automation_action_target_id,actionTargetType:e.automation_action_target_type}),i&&(0,n.jsx)("div",{children:e.metadata})]})})]}),(0,n.jsx)(xr,{automation:e,className:`${t}`,titleClassName:s})]})}function gr(){const{state:{automations:e}}=(0,a.useContext)($o);return e&&0!==e.length?(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-6 wpqt-mx-auto wpqt-max-w-7xl",children:e.map((e=>(0,n.jsx)(_r,{automation:e},e.id)))}):null}function vr(){const{automations:e}=Go(),t=(null==e?void 0:e.length)||0;return 0===t?(0,n.jsx)("p",{children:(0,o.__)("There are no automations created for this board.","quicktasker")}):(0,n.jsx)("p",{children:(0,o.sprintf)((0,o.__)("There are %d automations created for this board.","quicktasker"),t)})}function jr({pipelineId:e}){const{loading:t}=Go();return t?(0,n.jsx)(ea,{ovalSize:"24"}):(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:(0,o.__)("Created automations","quicktasker")}),(0,n.jsx)(vr,{}),(0,n.jsx)(gr,{}),(0,n.jsx)("h2",{children:(0,o.__)("Create a new automation","quicktasker")}),(0,n.jsx)("p",{children:(0,o.__)("Follow the steps to create a new automation.","quicktasker")}),(0,n.jsx)(fr,{pipelineId:e})]})}function br({pipelineId:e}){return(0,n.jsx)(zo,{pipelineId:e,children:(0,n.jsxs)(Na,{children:[(0,n.jsx)(d,{description:(0,o.__)("Set up automated processes to help manage your board.","quicktasker"),children:(0,o.__)("Board automations","quicktasker")}),(0,n.jsx)(jr,{pipelineId:e})]})})}const yr=()=>{const{state:{pluginURL:e}}=(0,a.useContext)(nn);return(0,n.jsxs)(Na,{children:[(0,n.jsx)(d,{description:(0,o.__)("Info about the plugin.","quicktasker"),children:(0,o.__)("About","quicktasker")}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:["Thank you for your interest in the QuickTasker project. For any suggestions or concerns, please write to"," ",(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://wordpress.org/support/plugin/quicktasker/",children:"support forum."})]}),(0,n.jsxs)("p",{children:["For some reading material about the plugin, you can check out the"," ",(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",href:e+"help/index.html",children:"plugin guide."})]}),(0,n.jsxs)("p",{children:["Source code is available on"," ",(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://github.com/SiimKirjanen/quicktasker",children:"GitHub"})]})]})]})},Er=({filterSettings:e,setFilterSettings:t})=>{const{state:{pipelines:s}}=(0,a.useContext)(ka),[i,r]=(0,a.useState)(e),c=(0,n.jsx)(Ua,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"log-search",children:(0,n.jsx)(Ra,{inputId:"log-search",value:i.search,onChange:e=>{r(Object.assign(Object.assign({},i),{search:e}))}})}),l=(0,n.jsx)(la,{text:(0,o.__)("Apply filter","quicktasker"),icon:(0,n.jsx)(Ca.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:()=>t(i)});return(0,n.jsxs)(Ma,{title:(0,o.__)("Logs filtering","quicktasker"),searchChildren:c,applyFilterChildren:l,children:[(0,n.jsx)(Ua,{title:(0,o.__)("Type","quicktasker"),children:(0,n.jsx)(ja,{allSelector:!1,selectedOptionValue:i.type,options:[{label:(0,o.__)("All types","quicktasker"),value:Sr.All},{label:(0,o.__)("Board","quicktasker"),value:Sr.Pipeline},{label:(0,o.__)("Task","quicktasker"),value:Sr.Task}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{type:e,typeId:""}))}})}),i.type===Sr.Pipeline&&(0,n.jsx)(Ua,{title:(0,o.__)("Board","quicktasker"),children:(0,n.jsx)(ja,{allSelector:!0,selectedOptionValue:i.typeId,options:s.map((e=>({label:e.name,value:e.id}))),onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{typeId:e}))}})}),(0,n.jsx)(Ua,{title:(0,o.__)("Created by","quicktasker"),children:(0,n.jsx)(ja,{allSelector:!1,selectedOptionValue:i.createdBy,options:[{label:(0,o.__)("Everyone","quicktasker"),value:Or.All},{label:(0,o.__)("Admin","quicktasker"),value:Or.Admin},{label:"QuickTasker",value:Or.Quicktasker},{label:(0,o.__)("Automation","quicktasker"),value:Or.Automation},{label:(0,o.__)("Import","quicktasker"),value:Or.Import},{label:(0,o.__)("System","quicktasker"),value:Or.System}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{createdBy:e}))}})}),(0,n.jsx)(Ua,{title:(0,o.__)("Number of logs","quicktasker"),children:(0,n.jsx)(ja,{allSelector:!1,selectedOptionValue:i.numberOfLogs,options:[{label:(0,o.__)("Show 100","quicktasker"),value:Cr.Hundred},{label:(0,o.__)("Show 200","quicktasker"),value:Cr.TwoHundred},{label:"Show 500",value:Cr.FiveHundred},{label:"Show all",value:Cr.All}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{numberOfLogs:e}))}})}),(0,n.jsx)(Ua,{title:(0,o.__)("Order","quicktasker"),children:(0,n.jsx)(ja,{allSelector:!1,selectedOptionValue:i.order,options:[{label:(0,o.__)("Ascending","quicktasker"),value:Nr.Asc},{label:(0,o.__)("Descending","quicktasker"),value:Nr.Desc}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{order:e}))}})}),(0,n.jsx)(Ua,{title:(0,o.__)("Status","quicktasker"),children:(0,n.jsx)(ja,{allSelector:!1,selectedOptionValue:i.status,options:[{label:(0,o.__)("All","quicktasker"),value:Ir.All},{label:(0,o.__)("Success","quicktasker"),value:Ir.Success},{label:(0,o.__)("Error","quicktasker"),value:Ir.Error}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{status:e}))}})})]})},Tr=({logs:e,loading:t})=>t?(0,n.jsx)(ea,{ovalSize:"64",className:"wpqt-mt-12"}):0===e.length?(0,n.jsx)(qo,{text:(0,o.__)("No logs found","quicktasker")}):(0,n.jsxs)("div",{className:"wpqt-logs-page-grid",children:[(0,n.jsx)(Ci,{title:(0,o.__)("Author","quicktasker")}),(0,n.jsx)(Ci,{title:(0,o.__)("Created at","quicktasker")}),(0,n.jsx)(Ci,{title:(0,o.__)("Status","quicktasker")}),(0,n.jsx)(Ci,{title:(0,o.__)("Text","quicktasker")}),e.map((e=>(0,n.jsx)(Ni,{log:e,showStatus:!0},e.id)))]});var Sr,Ar,Or;!function(e){e.Pipeline="pipeline",e.Stage="stage",e.Task="task",e.Webhook="webhook",e.All="all"}(Sr||(Sr={})),function(e){e.Success="success",e.Error="error"}(Ar||(Ar={})),function(e){e.Admin="admin",e.Quicktasker="quicktasker_user",e.Automation="automation",e.Import="import",e.System="system",e.All="all"}(Or||(Or={}));var Nr,Cr,Ir,Dr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};!function(e){e.Asc="ASC",e.Desc="DESC"}(Nr||(Nr={})),function(e){e.Hundred="100",e.TwoHundred="200",e.FiveHundred="500",e.All="all"}(Cr||(Cr={})),function(e){e.All="all",e.Success="success",e.Error="error"}(Ir||(Ir={}));const Pr=()=>{const[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)({numberOfLogs:Cr.Hundred,type:Sr.All,typeId:"",createdBy:Or.All,order:Nr.Desc,search:"",status:Ir.All}),[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!0);(0,a.useEffect)((()=>{l&&(u(),d(!1))}),[s,l]);const u=()=>Dr(void 0,void 0,void 0,(function*(){try{c(!0);const e=Object.assign({},s);e.numberOfLogs===Cr.All&&delete e.numberOfLogs,e.type===Sr.All&&delete e.type,""===e.typeId&&delete e.typeId,e.createdBy===Or.All&&delete e.createdBy,e.status===Ir.All&&delete e.status;const a=yield Qt(e);t(a.data)}catch(e){console.error(e),i.oR.error("Failed to fetch logs")}finally{c(!1)}}));return(0,n.jsxs)("div",{children:[(0,n.jsx)(Er,{filterSettings:s,setFilterSettings:e=>Dr(void 0,void 0,void 0,(function*(){o(e),d(!0)}))}),(0,n.jsx)(Tr,{logs:e,loading:r})]})},Rr=()=>(0,n.jsxs)(Na,{children:[(0,n.jsx)(d,{description:(0,o.__)("The logs page where you can see all logs and filter them.","quicktasker"),children:(0,o.__)("Logs","quicktasker")}),(0,n.jsx)(Pr,{})]});function Lr({infoTitle:e,infoDescription:t,infoTitleClick:s,children:a}){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-items-center wpqt-justify-center",children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-1",children:[e&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2 "+(s?"wpqt-cursor-pointer":""),onClick:s||void 0,children:(0,n.jsx)("p",{className:"wpqt-m-0 wpqt-font-semibold wpqt-text-lg",children:e})}),(0,n.jsx)("p",{children:t}),a]})})}function Mr({overviewFilter:e,onCreationDateChange:t,onDoneDateChange:s}){const a=e=>e instanceof Date?Sn()(e).format("YYYY-MM-DD"):"";return(0,n.jsx)("div",{children:(0,n.jsxs)(Ma,{title:(0,o.__)("Statistics filtering","quicktasker"),titleClassName:"wpqt-text-center",childrenClassName:"wpqt-gap-6 wpqt-justify-center",searchChildren:null,children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task creation date","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("(Filter tasks that have creation date equal or bigger than)","quicktasker")})]}),(0,n.jsx)(uo.A,{onChange:e=>{const s=a(e);t(s)},value:e.taskCreationDate,format:"y-MM-dd",id:"taskCreationDate"})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task done date","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("(Filter tasks that have done date equal or smaller than)","quicktasker")})]}),(0,n.jsx)(uo.A,{onChange:e=>{const t=a(e);s(t)},value:e.taskDoneDate,format:"y-MM-dd",id:"taskCreationDate"})]})]})})}var Ur=s(2298);function Fr(e){const t=e.slice(1).some((e=>e[1]>0));return e.length>1&&t}function Kr({text:e}){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-items-center wpqt-h-[400px] wpqt-w-[500px] wpqt-font-semibold",children:e})}function $r({pipelineOverviewData:e,options:t,width:s}){var a,i;const r=[["Archived tasks","Task Count"],["Archived tasks",parseInt(null!==(a=null==e?void 0:e.archivedTasksCount)&&void 0!==a?a:"0")||0],["Not archived tasks",parseInt(null!==(i=null==e?void 0:e.notArchivedTasksCount)&&void 0!==i?i:"0")||0]];return Fr(r)?(0,n.jsx)(Ur.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Archived tasks"}),width:s,height:"400px"}):(0,n.jsx)(Kr,{text:(0,o.__)("Not enough data to display archived tasks chart","quicktasker")})}function zr({pipelineOverviewData:e,options:t,width:s}){var a;const i=[["Stage","Task Count"],...null!==(a=null==e?void 0:e.stages.map((e=>[e.name,parseInt(e.tasksCount)||0])))&&void 0!==a?a:[]];return Fr(i)?(0,n.jsx)(Ur.t1,{chartType:"PieChart",data:i,options:Object.assign(Object.assign({},t),{title:"Task distribution by stages"}),width:s,height:"400px"}):(0,n.jsx)(Kr,{text:(0,o.__)("Not enough data to display task distribution by stages chart","quicktasker")})}function Gr({pipelineOverviewData:e,options:t,width:s}){var a,i;const r=[["Task status","Task Count"],["Done",parseInt(null!==(a=null==e?void 0:e.doneTasksCount)&&void 0!==a?a:"0")||0],["Not Done",parseInt(null!==(i=null==e?void 0:e.notDoneTasksCount)&&void 0!==i?i:"0")||0]];return Fr(r)?(0,n.jsx)(Ur.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Task status"}),width:s,height:"400px"}):(0,n.jsx)(Kr,{text:(0,o.__)("Not enough data to display task status chart","quicktasker")})}var Vr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Br={legend:{position:"left",alignment:"center",textStyle:{color:"#233238",fontSize:14}}};function Hr({pipeline:e,overviewFilter:t}){const[s,i]=(0,a.useState)(null),[o,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(()=>{Vr(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e,t){const s=new URLSearchParams({taskStartDate:t.taskCreationDate||"",taskDoneDate:t.taskDoneDate||"",taskAssignees:t.taskAssignees.join(",")});return zt()({path:`/wpqt/v1/pipelines/${e}/overview?${s.toString()}`,method:"GET",headers:Gt()})}(e.id,t);i(s.data)}catch(e){console.error(e)}finally{r(!1)}}))})()}),[e.id,t]),o||!s?(0,n.jsx)(ea,{ovalSize:"48"}):(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-wrap wpqt-justify-center xl:wpqt-justify-start",children:[(0,n.jsx)(zr,{pipelineOverviewData:s,options:Br,width:"500px"}),(0,n.jsx)(Gr,{pipelineOverviewData:s,options:Br,width:"500px"}),(0,n.jsx)($r,{pipelineOverviewData:s,options:Br,width:"500px"})]})}function Wr({pipeline:e}){const[t,s]=(0,a.useState)({taskCreationDate:null,taskDoneDate:null,taskAssignees:[]});return(0,n.jsxs)("div",{children:[(0,n.jsx)(Mr,{overviewFilter:t,onCreationDateChange:e=>{s(Object.assign(Object.assign({},t),{taskCreationDate:e}))},onDoneDateChange:e=>{s(Object.assign(Object.assign({},t),{taskDoneDate:e}))}}),(0,n.jsx)(Hr,{pipeline:e,overviewFilter:t})]})}function Qr(){const{state:{pipelines:e}}=(0,a.useContext)(ka),t=e.map((e=>e.name)),s=e.map((e=>(0,n.jsx)(Wr,{pipeline:e},e.id)));return(0,n.jsx)(Na,{children:s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{description:(0,o.__)("Get overview of the tasks.","quicktasker"),children:(0,o.__)("Overview","quicktasker")}),(0,n.jsx)(Ti,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]}):(0,n.jsx)(Lr,{infoTitle:(0,o.__)("No overview to display","quicktasker"),infoDescription:(0,o.__)("You need to first create a board to see the overview.","quicktasker")})})}function Yr(){const{state:{activePipeline:e}}=(0,a.useContext)(xs),t=null==e?void 0:e.id,s=()=>(null==e?void 0:e.stages)||[],n=e=>{const t=s();let a=null;return t?(t.forEach((t=>{t.tasks&&!a&&t.tasks.find((t=>t.id===e))&&(a=t)})),a):null},i=(0,a.useMemo)((()=>{const e=s();return e?e.map((e=>({label:e.name,value:e.id}))):[]}),[e]),o=(0,a.useMemo)((()=>{const e=s(),t=[];return e?(e.forEach((e=>{e.tasks&&t.push(...e.tasks)})),t):t}),[e]),r=null==e?void 0:e.settings;return{getActivePipelineStages:s,getActivePipelinStageTasksLength:e=>{const t=s();if(!t)return 0;const a=t.find((t=>t.id===e));return a&&a.tasks?a.tasks.length:0},getTaskStage:n,getTaskOrderInStage:e=>{const t=n(e);if(!t||!t.tasks)return null;const s=t.tasks.findIndex((t=>t.id===e));return-1!==s?s:null},activePipelineTasks:o,activePipelineSettings:r,isTaskOnLastStage:e=>{const t=s();if(!t)return!1;const a=n(e);if(!a)return!1;const i=t[t.length-1];return a.id===i.id},stageOptions:i,activePipelineId:t}}const Jr=(e,t)=>{switch(t.type){case L:{const{id:s,type:a}=t.payload;return Object.assign(Object.assign({},e),{userFilter:{id:s,type:a}})}case R:return Object.assign(Object.assign({},e),{stageIdFilter:t.payload});case M:return Object.assign(Object.assign({},e),{searchText:t.payload});default:return e}},Xr={stageIdFilter:"",userFilter:{id:null,type:null},searchText:""},Zr=(0,a.createContext)({state:Xr,taskViewDispatch:()=>{}}),ec=({children:e})=>{const[t,s]=(0,a.useReducer)(Jr,Xr);return(0,n.jsx)(Zr.Provider,{value:{state:t,taskViewDispatch:s},children:e})};function tc(){const{state:{stageIdFilter:e,userFilter:t,searchText:s},taskViewDispatch:i}=(0,a.useContext)(Zr),{stageOptions:r}=Yr(),{combinedUsers:c}=Qo(),l=c.map((e=>({value:`${e.id}:${e.user_type}`,label:`${e.name} (${ls[e.user_type]})`}))),d=t.id&&t.type?`${t.id}:${t.type}`:"";return(0,n.jsxs)(Ma,{title:(0,o.__)("Filter tasks","quicktasker"),searchChildren:(0,n.jsx)(Ua,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"task-view-search",children:(0,n.jsx)(Ra,{inputId:"task-view-search",value:s,onChange:e=>{i({type:M,payload:e})}})}),children:[(0,n.jsx)(Ua,{title:(0,o.__)("Stage","quicktasker"),children:(0,n.jsx)(ja,{id:"task-view-stage-filter",allSelectorLabel:(0,o.__)("All stages","quicktasker"),selectedOptionValue:e,options:r,onSelectionChange:e=>{i({type:R,payload:e})}})}),(0,n.jsx)(Ua,{title:(0,o.__)("Assigned user","quicktasker"),children:(0,n.jsx)(ja,{id:"task-view-assigned-user-filter",allSelectorLabel:(0,o.__)("All users","quicktasker"),selectedOptionValue:d,options:l,onSelectionChange:e=>{const[t,s]=e.split(":");i({type:L,payload:{id:t,type:s}})}})})]})}var sc,ac,nc=s(9879),ic=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function oc(e){return e.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")}function rc(e){const t=[];let s="",a=!1;for(let n=0;n<e.length;n++){const i=e[n];'"'===i?a&&n+1<e.length&&'"'===e[n+1]?(s+='"',n++):a=!a:","!==i||a?s+=i:(t.push(s.trim()),s="")}return t.push(s.trim()),t}function cc(){return"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}!function(e){e.ADD_CARD="addCard",e.UPDATE_CARD="updateCard",e.Comment_CARD="commentCard"}(sc||(sc={})),function(e){e.TRELLO="TRELLO-IMPORT",e.ASANA="ASANA-IMPORT",e.PIPEDRIVE="PIPEDRIVE-IMPORT",e.QUICKTASKER="QUICKTASKER-IMPORT"}(ac||(ac={}));const lc={pipelineName:"",pipelineDescription:"",stages:[],tasks:[],labels:[],sourcePipelines:[],taskComments:[]},dc=e=>{switch(e){case ac.TRELLO:return(0,o.__)("Import from Trello.","quicktasker");case ac.ASANA:return(0,o.__)("Import from Asana.","quicktasker");case ac.PIPEDRIVE:return(0,o.__)("Import from Pipedrive.","quicktasker");case ac.QUICKTASKER:return(0,o.__)("Import from QuickTasker.","quicktasker");default:return(0,o.__)("Select import source","quicktasker")}},uc=e=>{switch(e){case ac.TRELLO:return(0,o.__)("Export your Trello board as JSON format and use it for import.","quicktasker");case ac.ASANA:return(0,o.__)("Export your Asana project as JSON format and use it for import","quicktasker");case ac.PIPEDRIVE:return(0,o.__)("Export your Pipedrive deals as CSV format and use it for import. Please note that generated CSV file column headers should be in English.","quicktasker");case ac.QUICKTASKER:return(0,o.__)("Import your QuickTasker board from JSON format.","quicktasker");default:return(0,o.__)("Select an import source to get started","quicktasker")}};function pc({importData:e,importDataFilter:t,selectedImportSource:s,onNameChange:a,onDescriptionChange:i,onImportDataFilterChange:r,validation:c}){const l=function(e){const t={supportsArchiveTaskToggle:!1,supportTaskCustomFieldsToggle:!1,supportTaskCommentsToggle:!1,allowSourceSelection:!1};switch(e){case ac.PIPEDRIVE:return Object.assign(Object.assign({},t),{supportsArchiveTaskToggle:!0,allowSourceSelection:!0});case ac.TRELLO:return Object.assign(Object.assign({},t),{supportsArchiveTaskToggle:!0,supportTaskCommentsToggle:!0});case ac.ASANA:return Object.assign(Object.assign({},t),{supportsArchiveTaskToggle:!0});case ac.QUICKTASKER:return Object.assign(Object.assign({},t),{supportsArchiveTaskToggle:!0,supportTaskCustomFieldsToggle:!0,supportTaskCommentsToggle:!0});default:return t}}(s);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3 wpqt-mb-3",children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-1",children:[(0,n.jsx)(hc,{title:(0,o.__)("Board name","quicktasker")}),(0,n.jsx)(Ra,{value:e.pipelineName,onChange:a,wrapperClassName:"wpqt-w-[200px] !wpqt-mb-0",className:"wpqt-w-full wpqt-mb-0"}),c.pipelineNameExists&&(0,n.jsx)("div",{className:"wpqt-text-red-500 wpqt-text-sm",children:(0,o.__)("This board name already exists.","quicktasker")})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-1",children:[(0,n.jsx)(hc,{title:(0,o.__)("Board description","quicktasker")}),(0,n.jsx)(hn,{value:e.pipelineDescription,onChange:i,rowsCount:2,className:"!wpqt-w-[200px] !wpqt-mb-0"})]}),l.supportsArchiveTaskToggle&&(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-2 wpqt-w-[200px]",children:[(0,n.jsx)(hc,{title:(0,o.__)("Import archived tasks?","quicktasker")}),(0,n.jsx)(co,{checked:t.includeArchivedTasks,handleChange:()=>{r(Object.assign(Object.assign({},t),{includeArchivedTasks:!t.includeArchivedTasks}))},dataTestId:"import-archived-tasks-toggle"})]}),l.supportTaskCustomFieldsToggle&&(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-2 wpqt-w-[200px]",children:[(0,n.jsx)(hc,{title:(0,o.__)("Import task custom fields?","quicktasker")}),(0,n.jsx)(co,{checked:t.includeTaskCustomFields,handleChange:()=>{r(Object.assign(Object.assign({},t),{includeTaskCustomFields:!t.includeTaskCustomFields}))},dataTestId:"import-task-custom-fields-toggle"})]}),l.supportTaskCommentsToggle&&(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-2 wpqt-w-[200px]",children:[(0,n.jsx)(hc,{title:(0,o.__)("Import task comments?","quicktasker")}),(0,n.jsx)(co,{checked:t.includeTaskComments,handleChange:()=>{r(Object.assign(Object.assign({},t),{includeTaskComments:!t.includeTaskComments}))},dataTestId:"import-task-comments-toggle"})]}),l.allowSourceSelection&&(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-start wpqt-gap-2 wpqt-w-[200px]",children:[(0,n.jsx)(hc,{title:(0,o.__)("Filter by source","quicktasker")}),e.sourcePipelines.map((e=>{const s=t.sourcePipelinesFilter.some((t=>t.id===e.id)),a=`source-${e.id}`;return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)("label",{htmlFor:a,children:e.name}),(0,n.jsx)("input",{type:"checkbox",value:e.name,id:a,checked:s,onChange:()=>{let a;a=s?t.sourcePipelinesFilter.filter((t=>t.id!==e.id)):[...t.sourcePipelinesFilter,e],r(Object.assign(Object.assign({},t),{sourcePipelinesFilter:a}))}})]},e.id)}))]})]})}function hc({title:e}){return(0,n.jsx)("div",{className:"wpqt-font-semibold",children:e})}function mc({importData:e}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-2",children:[(0,n.jsxs)("div",{children:[(0,o.__)("Number of tasks","quicktasker"),":"," ",(0,n.jsxs)("span",{className:"wpqt-font-semibold",children:[e.tasks.length," (",(0,o.__)("archived","quicktasker")," ",e.tasks.filter((e=>e.archived)).length,")"]})]}),(0,n.jsxs)("div",{children:[(0,o.__)("Number of task comments","quicktasker"),":"," ",(0,n.jsx)("span",{className:"wpqt-font-semibold",children:e.taskComments.length})]}),(0,n.jsxs)("div",{children:[(0,o.__)("Number of stages","quicktasker"),":"," ",(0,n.jsx)("span",{className:"wpqt-font-semibold",children:e.stages.length})]}),(0,n.jsxs)("div",{children:[(0,o.__)("Number of labels","quicktasker"),":"," ",(0,n.jsx)("span",{className:"wpqt-font-semibold"}),e.labels.length]})]})}var wc=s(9197);const fc=s.p+"images/icon-80x80.78f40056.png";function kc({selectedImportSource:e,handleImportSourceChange:t}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2",children:[(0,n.jsx)("div",{"data-testid":"trello-container",className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(e===ac.TRELLO?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>t(ac.TRELLO),children:(0,n.jsx)(wc.IK4,{className:"wpqt-size-6 wpqt-trello-blue","data-testid":"trello-icon"})}),(0,n.jsx)("div",{"data-testid":"asana-container",className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(e===ac.ASANA?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>t(ac.ASANA),children:(0,n.jsx)(En.OpO,{className:"wpqt-size-6 wpqt-asana-pink","data-testid":"asana-icon"})}),(0,n.jsx)("div",{"data-testid":"pipedrive-container",className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(e===ac.PIPEDRIVE?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>t(ac.PIPEDRIVE),children:(0,n.jsx)(Jo.nad,{className:"wpqt-size-6 wpqt-pipedrive-green","data-testid":"pipedrive-icon"})}),(0,n.jsx)("div",{"data-testid":"quicktasker-container",className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(e===ac.QUICKTASKER?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>t(ac.QUICKTASKER),children:(0,n.jsx)("img",{src:fc,className:"wpqt-size-6","data-testid":"quicktasker-icon"})})]})}const qc={includeArchivedTasks:!0,includeTaskComments:!1,includeTaskCustomFields:!0,sourcePipelinesFilter:[]};function xc(){const{state:{pipelineImportModalOpen:e},modalDispatch:t}=(0,a.useContext)(Ks),{pipelinesDispatch:s,checkIfPipelineNameExists:r}=xa(),{fetchAndSetPipelineData:c}=(0,a.useContext)(xs),[l,d]=(0,a.useState)(ac.TRELLO),[u,p]=(0,a.useState)(null),[h,m]=(0,a.useState)(Object.assign({},qc)),[w,f]=(0,a.useState)(null),[k,q]=(0,a.useState)(!1),x=(0,a.useRef)(null),{importPipeline:g}=function(){return{importPipeline:(e,t)=>ic(this,void 0,void 0,(function*(){try{const s=yield function(e,t){return zt()({path:"/wpqt/v1/import",method:"POST",data:{source:e,data:t},headers:Gt()})}(e,t);return{success:!0,data:s.data}}catch(e){return console.error(e),i.oR.error((0,o.__)("Import failed","quicktasker")),{success:!1,error:e}}}))}}(),v=(0,a.useMemo)((()=>!!(null==u?void 0:u.pipelineName)&&r(u.pipelineName)),[null==u?void 0:u.pipelineName]),j=w&&!v,b=()=>{p(null),f(null),m(Object.assign({},qc))};return(0,a.useEffect)((()=>{if(u){const e=u.tasks.filter((e=>h.includeArchivedTasks||!e.archived)),t=new Set(e.map((e=>e.taskId))),s=h.includeTaskComments?u.taskComments.filter((e=>t.has(e.taskId))):[];h.includeTaskCustomFields||e.forEach((e=>{e.customFields=[]}));const a=Object.assign(Object.assign({},u),{tasks:e,taskComments:s});h.sourcePipelinesFilter.length>0&&(a.tasks=a.tasks.filter((e=>h.sourcePipelinesFilter.some((t=>e.sourcePipeline&&t.id===e.sourcePipeline.id)))),a.stages=a.stages.filter((e=>h.sourcePipelinesFilter.some((t=>e.sourcePipeline.id===t.id))))),f(a)}}),[u,h]),(0,n.jsx)(na,{modalOpen:e,closeModal:()=>{t({type:oe}),b()},children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-4",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Import board","quicktasker")}),(0,n.jsx)(kc,{selectedImportSource:l,handleImportSourceChange:e=>{d(e),b()}}),(0,n.jsxs)("div",{className:"wpqt-text-center wp-mb-4",children:[(0,n.jsx)("p",{className:"wpqt-my-0",children:dc(l)}),(0,n.jsx)("p",{className:"wpqt-my-0",children:uc(l)})]}),!u&&(0,n.jsx)(la,{text:(0,o.__)("Select import file","quicktasker"),onClick:()=>{x.current&&x.current.click()},icon:(0,n.jsx)(nc.t76,{className:"wpqt-size-5 wpqt-text-blue-500"})}),u&&(0,n.jsx)(pc,{importData:u,importDataFilter:h,validation:{pipelineNameExists:v},selectedImportSource:l,onNameChange:e=>{p((t=>t?Object.assign(Object.assign({},t),{pipelineName:e}):t))},onDescriptionChange:e=>{p((t=>t?Object.assign(Object.assign({},t),{pipelineDescription:e}):t))},onImportDataFilterChange:m}),w&&(0,n.jsx)(mc,{importData:w}),j&&(0,n.jsx)(la,{text:(0,o.__)("Start import","quicktasker"),onClick:()=>{return e=this,a=void 0,r=function*(){if(!w||v)return;q(!0);const{data:e}=yield g(l,w);e&&(s({type:_,payload:e.pipeline}),yield c(e.pipeline.id),b(),t({type:oe}),i.oR.success((0,o.__)("Board imported","quicktasker"))),q(!1)},new((n=void 0)||(n=Promise))((function(t,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(i,o)}c((r=r.apply(e,a||[])).next())}));var e,a,n,r},loading:k}),(0,n.jsx)("input",{type:"file",ref:x,id:"import-upload",className:"wpqt-hidden",accept:(()=>{switch(l){case ac.PIPEDRIVE:return".csv";case ac.TRELLO:case ac.ASANA:case ac.QUICKTASKER:default:return".json"}})(),onChange:e=>{var t,s;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){const e=new FileReader,t=null===(s=a.name.split(".").pop())||void 0===s?void 0:s.toLowerCase();e.onload=e=>{var s,a;try{let n,r;switch(n="csv"===t?function(e){if(!e||"string"!=typeof e)return[];const t=e.split("\n").filter((e=>""!==e.trim()));if(0===t.length)return[];const s=rc(t[0]).map(oc),a=[];for(let e=1;e<t.length;e++){const n=rc(t[e]);if(0===n.length)continue;const i={};for(let e=0;e<s.length;e++)i[s[e]]=e<n.length?n[e]:"";a.push(i)}return a}(null===(s=e.target)||void 0===s?void 0:s.result):JSON.parse(null===(a=e.target)||void 0===a?void 0:a.result),l){case ac.TRELLO:{const e=function(e){if(!e||"object"!=typeof e)return"Import data is missing or not an object";const t=e;if(!t.name)return"Missing board name";if(!t.cards)return"Missing cards array";if(!t.lists)return"Missing lists array";if(!t.labels)return"Missing labels array";if(!Array.isArray(t.cards))return"Cards property is not an array";if(!Array.isArray(t.lists))return"Lists property is not an array";if(!Array.isArray(t.labels))return"Labels property is not an array";if(t.lists.length>0&&!t.lists.some((e=>!e.closed)))return"All lists are closed, at least one open list is required";for(const e of t.cards){if(!e.id)return`Card missing ID: ${JSON.stringify(e).substring(0,100)}...`;if(!e.name)return`Card missing name: ${e.id}`;if(!e.idList)return`Card missing list ID: ${e.id}`;if(!Array.isArray(e.labels))return`Card labels is not an array: ${e.id}`}for(const e of t.lists){if(!e.id)return`List missing ID: ${JSON.stringify(e).substring(0,100)}...`;if(!e.name)return`List missing name: ${e.id}`;if("boolean"!=typeof e.closed)return`List closed status is not boolean: ${e.id}`}for(const e of t.labels){if(!e.id)return`Label missing ID: ${JSON.stringify(e).substring(0,100)}...`;if(!e.name&&""!==e.name)return`Label missing name: ${e.id}`;if(!e.color)return`Label missing color: ${e.id}`}return!0}(n);if(!0!==e)return void i.oR.error(`${(0,o.__)("Invalid Trello import","quicktasker")}: ${e}`);r=function(e){const t=[{name:e.name,id:e.id}],s=e.actions.filter((e=>e.type===sc.Comment_CARD));return{pipelineName:e.name,pipelineDescription:e.desc,stages:e.lists.filter((e=>!e.closed)).map((t=>({stageName:t.name,stageDescription:"",stageId:t.id,sourcePipeline:{name:e.name,id:e.id}}))),tasks:e.cards.map((t=>{var s,a;return{taskId:t.id,taskName:t.name,taskDescription:"",stageId:t.idList,archived:t.closed,assignedLabels:t.labels.map((e=>({labelName:e.name,labelId:e.id,color:e.color}))),dueDate:t.due?t.due:null,taskCompletedAt:t.dateCompleted?t.dateCompleted:null,taskFocusColor:null!==(a=null===(s=t.cover)||void 0===s?void 0:s.color)&&void 0!==a?a:null,sourcePipeline:{name:e.name,id:e.id},customFields:[]}})),labels:e.labels.map((e=>({labelName:e.name,labelId:e.id,color:e.color}))),sourcePipelines:t,taskComments:s.map((e=>{var t,s,a;return{commentId:e.id,taskId:null!==(s=null===(t=e.data.card)||void 0===t?void 0:t.id)&&void 0!==s?s:"",createdAt:e.date,commentText:null!==(a=e.data.text)&&void 0!==a?a:"",authorId:e.idMemberCreator,isAuthorAdmin:!1,isPrivate:!0}}))}}(n);break}case ac.ASANA:{const e=function(e){if(!e||"object"!=typeof e)return"Import data is missing or not an object";const t=e;if(!t.data)return"Missing data array";if(!Array.isArray(t.data))return"Data property is not an array";if(0===t.data.length)return"Data array is empty";for(const e of t.data){if(!e.gid)return`Task missing GID: ${JSON.stringify(e).substring(0,100)}...`;if(!e.name)return`Task missing name: ${e.gid}`;if("boolean"!=typeof e.completed)return`Task completed status is not boolean: ${e.gid}`;if(!Array.isArray(e.projects))return`Task projects is not an array: ${e.gid}`;if(0===e.projects.length)return`Task has no projects: ${e.gid}`;if(!Array.isArray(e.memberships))return`Task memberships is not an array: ${e.gid}`;if(!Array.isArray(e.tags))return`Task tags is not an array: ${e.gid}`;for(const t of e.projects){if(!t.gid)return`Project missing GID in task ${e.gid}`;if(!t.name)return`Project missing name in task ${e.gid}`}for(const t of e.memberships){if(!t.project)return`Membership missing project in task ${e.gid}`;if(!t.section)return`Membership missing section in task ${e.gid}`;const s=t.project,a=t.section;if(!s.gid)return`Membership project missing GID in task ${e.gid}`;if(!s.name)return`Membership project missing name in task ${e.gid}`;if(!a.gid)return`Membership section missing GID in task ${e.gid}`;if(!a.name)return`Membership section missing name in task ${e.gid}`}for(const t of e.tags){if(!t.gid)return`Tag missing GID in task ${e.gid}`;if(!t.name)return`Tag missing name in task ${e.gid}`}}return!0}(n);if(!0!==e)return void i.oR.error(`${(0,o.__)("Invalid Asana import","quicktasker")}: ${e}`);r=function(e){if(!e.data||0===e.data.length)return Object.assign({},lc);const t=e.data[0].projects[0].gid,s=e.data[0].projects[0].name,a=new Map,n=new Map,i=[{name:s,id:t}];e.data.forEach((e=>{e.memberships.forEach((e=>{if(e.project.gid===t){const t=e.section;a.has(t.gid)||a.set(t.gid,t)}})),e.tags.forEach((e=>{n.has(e.gid)||n.set(e.gid,e)}))}));const o=Array.from(a.values()).map((e=>({stageId:e.gid,stageName:e.name,stageDescription:"",sourcePipeline:{name:s,id:t}}))),r=Array.from(n.values()).map((e=>({labelId:e.gid,labelName:e.name||"",color:Rt}))),c=e.data.map((e=>{var a;const n=e.memberships.find((e=>e.project.gid===t)),i=(null==n?void 0:n.section.gid)||(null===(a=o[0])||void 0===a?void 0:a.stageId)||"";return{taskId:e.gid,taskName:e.name,taskDescription:"",stageId:i,archived:e.completed,dueDate:e.due_at||e.due_on||null,taskCompletedAt:e.completed_at||null,assignedLabels:e.tags.map((e=>({labelName:e.name,labelId:e.gid,color:Rt}))),taskFocusColor:null,sourcePipeline:{name:s,id:t},customFields:[]}}));return{pipelineName:s,pipelineDescription:"",stages:o,tasks:c,labels:r,sourcePipelines:i,taskComments:[]}}(n);break}case ac.PIPEDRIVE:{const e=function(e){if(!e||!Array.isArray(e))return"Import data is missing or not an array";if(0===e.length)return"Deals array is empty";for(const t of e){if(!t.title)return`Deal missing title: ${JSON.stringify(t).substring(0,100)}...`;if(!t.stage)return`Deal missing stage: ${t.title||"Unknown"}`;if(!t.status)return`Deal missing status: ${t.title||"Unknown"}`;const e=String(t.status).toLowerCase();if(!["open","won","lost","deleted"].includes(e))return`Invalid deal status: ${e} for deal: ${t.title||"Unknown"}`;if(void 0!==t.label&&null!==t.label&&"string"!=typeof t.label)return`Deal label must be a string: ${t.title||"Unknown"}`;if(void 0!==t.expected_close_date&&null!==t.expected_close_date&&"string"!=typeof t.expected_close_date)return`Deal expected_close_date must be a string or null: ${t.title||"Unknown"}`;if(void 0!==t.deal_closed_on&&null!==t.deal_closed_on&&"string"!=typeof t.deal_closed_on)return`Deal deal_closed_on must be a string or null: ${t.title||"Unknown"}`}const t=new Set;for(const s of e)s.stage&&"string"==typeof s.stage&&t.add(s.stage);return 0!==t.size||"No valid stages found in deals"}(n);if(!0!==e)return void i.oR.error(`${(0,o.__)("Invalid Pipedrive import","quicktasker")}: ${e}`);r=function(e){if(!e)return Object.assign({},lc);const t=new Map,s=new Map,a=new Map;e.forEach((e=>{e.pipeline&&!a.has(e.pipeline)&&a.set(e.pipeline,{name:e.pipeline,id:cc()})})),e.forEach((e=>{e.stage&&!t.has(e.stage)&&t.set(e.stage,{stageId:cc(),stageName:e.stage,stageDescription:"",sourcePipeline:a.get(e.pipeline)||{name:"",id:cc()}}),e.label&&e.label.split(",").map((e=>e.trim())).filter(Boolean).forEach((e=>{e&&!s.has(e)&&s.set(e,{labelId:cc(),labelName:e,color:Rt})}))}));const n=Array.from(t.values()).map((e=>({stageId:e.stageId,stageName:e.stageName,stageDescription:"",sourcePipeline:{name:e.sourcePipeline.name,id:e.sourcePipeline.id}}))),i=Array.from(s.values()).map((e=>({labelId:e.labelId,labelName:e.labelName,color:e.color}))),o=Array.from(a.values()).map((e=>({name:e.name,id:e.id}))),r=e.map((e=>{var i;const o=t.get(e.stage),r=e.status.toLocaleLowerCase(),c=[];let l=null;if(e.label&&e.label.split(",").map((e=>e.trim())).filter(Boolean).forEach((e=>{const t=s.get(e);t&&c.push({labelId:t.labelId,labelName:t.labelName,color:t.color})})),e.pipeline){const t=a.get(e.pipeline);t&&(l={name:t.name,id:t.id})}return{taskId:e.id,taskName:e.title,taskDescription:"",stageId:o?o.stageId:(null===(i=n[0])||void 0===i?void 0:i.stageId)||"",archived:"lost"===r||"deleted"===r,assignedLabels:c,dueDate:e.expected_close_date||null,taskFocusColor:null,taskCompletedAt:"won"===r&&e.deal_closed_on||null,sourcePipeline:l,customFields:[]}}));return{pipelineName:"",pipelineDescription:"",stages:n,tasks:r,labels:i,sourcePipelines:o,taskComments:[]}}(n);break}case ac.QUICKTASKER:{const e=function(e){if(!e||"object"!=typeof e)return"Invalid import data: Not a valid object";const t=e;if(!t.pipelineName)return"Pipeline name is required";if(!Array.isArray(t.stages))return"Stages must be an array";for(let e=0;e<t.stages.length;e++){const s=t.stages[e];if(!s.stageName||"string"!=typeof s.stageName||!s.stageName.trim())return`Stage #${e+1} is missing a name`;if(void 0===s.stageId||null===s.stageId)return`Stage #${e+1} is missing an ID`}if(t.tasks&&Array.isArray(t.tasks))for(let e=0;e<t.tasks.length;e++){const s=t.tasks[e];if(!s.taskName||"string"!=typeof s.taskName||!s.taskName.trim())return`Task #${e+1} is missing a name`;if(void 0===s.stageId||null===s.stageId)return`Task #${e+1} is missing a stage ID`;if(!t.stages.some((e=>e.stageId==s.stageId)))return`Task "${s.taskName}" references a stage ID that does not exist in the import data`;if(s.assignedLabels&&Array.isArray(s.assignedLabels))for(let e=0;e<s.assignedLabels.length;e++){const t=s.assignedLabels[e];if(void 0===t.labelId||null===t.labelId||!t.labelName)return`Task "${s.taskName}" has an invalid label at position ${e+1}`}if(s.customFields&&Array.isArray(s.customFields))for(let e=0;e<s.customFields.length;e++)if(!s.customFields[e].task_id)return`Task "${s.taskName}" has a custom field without task_id`}if(t.labels&&Array.isArray(t.labels))for(let e=0;e<t.labels.length;e++){const s=t.labels[e];if(!s.labelName||"string"!=typeof s.labelName||!s.labelName.trim())return`Label #${e+1} is missing a name`;if(void 0===s.labelId||null===s.labelId)return`Label #${e+1} is missing an ID`;if(!s.color||"string"!=typeof s.color||!s.color.trim())return`Label "${s.labelName||e+1}" is missing a color`}return!0}(n);if(!0!==e)return void i.oR.error(`${(0,o.__)("Invalid Quicktasker import","quicktasker")}: ${e}`);r=n;break}default:throw new Error("Unsupported import source")}p(r)}catch(e){console.error("Error parsing import file:",e),i.oR.error((0,o.__)("Failed to parse import file","quicktasker"))}},e.readAsText(a)}}})]})})}function _c(){const{state:{moveTaskModalOpen:e,taskToEdit:t},modalDispatch:s}=(0,a.useContext)(Ks),{dispatch:i}=(0,a.useContext)(xs),{getActivePipelineStages:r,getActivePipelinStageTasksLength:c,getTaskStage:l,getTaskOrderInStage:d}=Yr(),{moveTask:u}=ys(),[p,h]=(0,a.useState)(0),[w,f]=(0,a.useState)(""),[k,q]=(0,a.useState)(!1),x=c(w),_=Array.from({length:x+1},((e,t)=>({value:t.toString(),label:(t+1).toString()}))),g=r().map((e=>({value:e.id,label:e.name}))),v=()=>{s({type:Z})};return(0,a.useEffect)((()=>{if(t){const e=l(t.id),s=d(t.id);e&&null!==s&&(f(e.id),h(s))}}),[t]),(0,n.jsx)(na,{modalOpen:e,closeModal:v,children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,n.jsx)("h2",{children:(0,o.__)("Change task location on board","quicktasker")}),(0,n.jsx)("label",{htmlFor:"move-task-stage-selection",children:(0,o.__)("Select stage","quicktasker")}),(0,n.jsx)(ja,{id:"move-task-stage-selection",allSelector:!1,selectedOptionValue:w,options:g,onSelectionChange:e=>{f(e),h(0)}}),(0,n.jsx)("label",{htmlFor:"move-task-order-selection",children:(0,o.__)("Select order","quicktasker")}),(0,n.jsx)(ja,{id:"move-task-order-selection",allSelector:!1,selectedOptionValue:String(p),options:_,onSelectionChange:e=>h(Number(e))}),(0,n.jsx)(ta,{btnText:(0,o.__)("Apply","quicktasker"),loading:k,onClick:()=>{return e=this,s=void 0,n=function*(){if(!t)return;const e=l(t.id),s=d(t.id);e&&null!==s&&(q(!0),yield u(t.id,w,p,(t=>{t&&(i({type:m,payload:{source:{droppableId:e.id,index:s},destination:{droppableId:w,index:p}}}),v())})),q(!1))},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n}})]})})}const gc=(0,a.forwardRef)((({addPipeline:e,modalSaving:t},s)=>{const[i,r]=(0,a.useState)(""),[c,l]=(0,a.useState)(""),d=()=>{r(""),l("")};return(0,a.useImperativeHandle)(s,(()=>({clearContent:d}))),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(oa,{children:[(0,n.jsx)(ra,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(Ra,{isAutoFocus:!0,value:i,onChange:e=>r(e),className:"wpqt-w-full",wrapperClassName:"wpqt-w-full"})}),(0,n.jsx)(ra,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(hn,{rowsCount:3,value:c,onChange:e=>l(e),className:"wpqt-w-full"})})]}),(0,n.jsx)(ca,{onSave:()=>{e(i,c)},loading:t,saveBtnText:(0,o.__)("Add board","quicktasker")})]})}));var vc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function jc(){return{deletePipeline:(e,t)=>vc(this,void 0,void 0,(function*(){try{const s=yield function(e){return zt()({path:`/wpqt/v1/pipelines/${e}`,method:"DELETE",headers:Gt()})}(e);t&&t(s.data.deletedPipelineId,s.data.pipelineIdToLoad)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete board","quicktasker"))}})),addPipeline:(e,t,s,a)=>vc(this,void 0,void 0,(function*(){try{const a=yield(n=e,r=t,zt()({path:"/wpqt/v1/pipelines",method:"POST",data:{name:n,description:r},headers:Gt()}));i.oR.success((0,o.__)("Board created successfully","quicktasker")),s&&s(a.data)}catch(e){i.oR.error((0,o.__)("Failed to create a board","quicktasker")),a&&a(e)}var n,r})),editPipeline:(e,t)=>vc(this,void 0,void 0,(function*(){try{const s=yield function(e,t){return zt()({path:`/wpqt/v1/pipelines/${e}`,method:"PATCH",data:t,headers:Gt()})}(e,t);return i.oR.success((0,o.__)("Board updated successfully","quicktasker")),{success:!0,pipeline:s.data}}catch(e){return i.oR.error((0,o.__)("Failed to update board","quicktasker")),{success:!1,error:e}}}))}}function bc(){const{state:{newPipelineModalOpen:e}}=(0,a.useContext)(Ks),{fetchAndSetPipelineData:t}=(0,a.useContext)(xs),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=Ha(B),{addPipeline:d}=jc();return(0,n.jsx)(na,{modalOpen:e,closeModal:r,size:"sm",children:(0,n.jsx)(gc,{ref:o,addPipeline:(e,s)=>{return a=this,n=void 0,u=function*(){i(!0),yield d(e,s,(e=>{c(_,e,Ba.PIPELINES),t(e.id),r()}),(e=>{l(e)}))},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{r(u.next(e))}catch(e){t(e)}}function i(e){try{r(u.throw(e))}catch(e){t(e)}}function r(t){var a;t.done?e(t.value):(a=t.value,a instanceof o?a:new o((function(e){e(a)}))).then(s,i)}r((u=u.apply(a,n||[])).next())}));var a,n,o,u},modalSaving:s,setModalSaving:i})})}var yc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Ec=({onPipelineEditSuccess:e})=>{const{state:{pipelineToEdit:t},modalDispatch:s}=(0,a.useContext)(Ks),{fetchAndSetPipelineData:r,dispatch:c}=(0,a.useContext)(xs),{pipelinesDispatch:l}=(0,a.useContext)(ka),{editPipeline:d}=jc(),{deletePipeline:u}=jc(),{loading1:p,setLoading1:h}=tn();return t?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,n.jsx)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:(0,n.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-6 md:wpqt-grid-cols-[1fr_0.7fr]",children:[(0,n.jsxs)(oa,{children:[(0,n.jsx)(ra,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(dn,{isAutoFocus:!0,value:t.name,wrapperClassName:"wpqt-w-full",className:"wpqt-w-full",onChange:s=>yc(void 0,void 0,void 0,(function*(){const{success:a,pipeline:n}=yield d(t.id,{name:s});a&&n&&e(n)}))})}),(0,n.jsx)(ra,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(mn,{value:t.description||"",className:"wpqt-w-full",onChange:s=>yc(void 0,void 0,void 0,(function*(){const{success:a,pipeline:n}=yield d(t.id,{description:s});a&&n&&e(n)}))})})]}),(0,n.jsx)(ei,{entityId:t.id,entityType:cn.Pipeline})]})}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:(0,n.jsx)(ti,{onConfirm:()=>{t&&(h(!0),u(t.id,((e,t)=>{s({type:B}),h(!1),i.oR.success((0,o.__)("Board deleted","quicktasker")),l({type:T,payload:e}),null!==t?(l({type:v,payload:t}),r(t)):c({type:S})})))},confirmMessage:(0,o.__)("Are you sure you want to delete this board?","quicktasker"),children:({onClick:e})=>(0,n.jsx)(la,{icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:p,text:(0,o.__)("Delete board","quicktasker"),onClick:e})})})]})}):null};function Tc(){const{state:{pipelineModalOpen:e}}=(0,a.useContext)(Ks),{closeModal:t,handleSuccess:s}=Ha(B);return(0,n.jsx)(na,{modalOpen:e,closeModal:t,size:"xl",children:(0,n.jsx)(Ec,{onPipelineEditSuccess:e=>{s(g,e,Ba.ACTIVE_PIPELINE),s(g,e,Ba.PIPELINES)}})})}function Sc(e){switch(e){case Us.PDF:return(0,o.__)("Export as PDF","quicktasker");case Us.JSON:return(0,o.__)("Export as JSON","quicktasker");default:return(0,o.__)("Export","quicktasker")}}var Ac=s(6973);function Oc(){const{modalDispatch:e,state:{taskExportModalSettings:t}}=(0,a.useContext)(Ks);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2",children:[(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(t.selectedMethod===Us.PDF?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>e({type:ne,payload:{selectedMethod:Us.PDF}}),"data-testid":"task-export-pdf-icon",children:(0,n.jsx)(wc.uNb,{className:"wpqt-size-5 wpqt-pdf-red"})}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-p-1 wpqt-rounded-lg wpqt-border-none wpqt-cursor-pointer "+(t.selectedMethod===Us.JSON?"wpqt-border wpqt-border-blue-500 !wpqt-border-solid":""),onClick:()=>e({type:ne,payload:{selectedMethod:Us.JSON}}),"data-testid":"task-export-json-icon",children:(0,n.jsx)(Ac.Qio,{className:"wpqt-size-5"})})]})}function Nc({pipelineId:e}){const{state:{taskExportModalOpen:t,taskExportModalSettings:s},modalDispatch:i}=(0,a.useContext)(Ks),{state:{siteURL:r}}=(0,a.useContext)(nn),[c,l]=(0,a.useState)(""),[d,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(!0);return(0,n.jsx)(na,{modalOpen:t,closeModal:()=>{i({type:ae})},size:"md",children:(0,n.jsxs)("form",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3 wpqt-items-center",action:r,target:"_blank",method:"GET",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Tasks export","quicktasker")}),(0,n.jsx)(Oc,{}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(ga,{labelFor:"export-search-filter",children:(0,o.__)("Filter by task name and desription","quicktasker")}),(0,n.jsx)(Ra,{value:c,onChange:l,inputId:"export-search-filter",name:"task_search",wrapperClassName:"wpqt-mb-0"})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(ga,{labelFor:"export-include-archive-filter",children:(0,o.__)("Include board archived tasks","quicktasker")}),(0,n.jsx)(co,{checked:d,handleChange:u,id:"export-include-archive-filter"})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(ga,{labelFor:"export-include-archive-filter",children:(0,o.__)("Include board custom fields","quicktasker")}),(0,n.jsx)(co,{checked:p,handleChange:h,id:"export-include-task-custom-fields-filter"})]}),(0,n.jsx)(ta,{btnText:Sc(s.selectedMethod),type:zs.SUBMIT}),e&&(0,n.jsx)("input",{type:"hidden",name:"pipeline_id",value:e}),(0,n.jsx)("input",{type:"hidden",name:"wpqt-page",value:`${s.selectedMethod}-export`}),(0,n.jsx)("input",{type:"hidden",name:"include_archive",value:d?"1":"0"}),(0,n.jsx)("input",{type:"hidden",name:"include_custom_fields",value:p?"1":"0"})]})})}var Cc=s(9919),Ic=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Dc=(0,a.forwardRef)((({editStage:e,addStage:t,stageModalSaving:s},i)=>{const{state:{stageToEdit:r}}=(0,a.useContext)(Ks),[c,l]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),p=!!r;(0,a.useEffect)((()=>{r&&(l(r.name),u(r.description))}),[r]);const h=()=>{l(""),u("")};return(0,a.useImperativeHandle)(i,(()=>({clearContent:h}))),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ia,{children:p?(0,o.__)("Edit Stage","quicktasker"):(0,o.__)("Add Stage","quicktasker")}),(0,n.jsxs)(oa,{children:[(0,n.jsx)(ra,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(Ra,{isAutoFocus:!0,value:c,onChange:e=>l(e)})}),(0,n.jsx)(ra,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(hn,{rowsCount:3,value:d,onChange:e=>u(e)})})]}),(0,n.jsx)(ca,{onSave:()=>{p?e(Object.assign(Object.assign({},r),{name:c,description:d})):t(c,d)},loading:s,saveBtnText:p?(0,o.__)("Save","quicktasker"):(0,o.__)("Add stage","quicktasker")})]})}));var Pc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Rc(){const{state:{stageModalOpen:e,targetPipelineId:t}}=(0,a.useContext)(Ks),{modalSaving:s,setModalSaving:r,modalContentRef:c,closeModal:l,handleSuccess:d,handleError:u}=Ha($),{editStage:p,addStage:h}=function(){return{editStage:(e,t,s)=>Ic(this,void 0,void 0,(function*(){try{const s=yield function(e){return zt()({path:`/wpqt/v1/stages/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description},headers:Gt()})}(e);i.oR.success((0,o.__)("Stage updated successfully","quicktasker")),t&&t(s.data)}catch(e){i.oR.error((0,o.__)("Failed to update stage","quicktasker")),s&&s(e)}})),addStage:(e,t,s,a,n)=>Ic(this,void 0,void 0,(function*(){try{const n=yield(r=e,c=t,l=s,zt()({path:"/wpqt/v1/stages",method:"POST",data:{pipelineId:r,name:c,description:l},headers:Gt()}));i.oR.success((0,o.__)("Stage created successfully","quicktasker")),a&&a(n.data)}catch(e){i.oR.error((0,o.__)("Failed to create stage","quicktasker")),n&&n(e)}var r,c,l}))}}();return(0,n.jsx)(na,{modalOpen:e,closeModal:l,children:(0,n.jsx)(Dc,{ref:c,editStage:e=>Pc(this,void 0,void 0,(function*(){r(!0),yield p(e,(e=>{d(x,e,Ba.ACTIVE_PIPELINE),l()}),(e=>{u(e)}))})),addStage:(e,s)=>Pc(this,void 0,void 0,(function*(){try{r(!0),yield h(t,e,s,(e=>{d(f,{stage:Object.assign(Object.assign({},e),{tasks:[]})},Ba.ACTIVE_PIPELINE),l()}))}catch(e){u(e)}})),stageModalSaving:s,stageTaskModalSaving:r})})}var Lc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Mc(){const{state:{taskColorModalOpen:e,taskToEdit:t},modalDispatch:s}=(0,a.useContext)(Ks),{dispatch:i}=(0,a.useContext)(xs),{updateTaskFocusColor:r}=ys(),[c,l]=(0,a.useState)(It),[d,u]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{t&&t.task_focus_color&&l(t.task_focus_color)}),[t]),(0,n.jsx)(na,{modalOpen:e,closeModal:()=>{s({type:te})},size:"sm",children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-4 wpqt-items-center",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:(0,o.__)("Task focus color","quicktasker")}),(0,n.jsx)(li.A,{color:c||void 0,disableAlpha:!0,onChange:e=>{l(e.hex)}}),(0,n.jsx)(ta,{btnText:(0,o.__)("Apply changes","quicktasker"),onClick:()=>Lc(this,void 0,void 0,(function*(){if(!t)return;u(!0);const{success:e}=yield r(t.id,c);u(!1),e&&i({type:P,payload:{taskId:t.id,color:c}})})),loading:d}),(0,n.jsx)(ta,{buttonStyleType:Gs.DANGER,btnText:(0,o.__)("Reset color","quicktasker"),onClick:()=>{l(It)}})]})})}var Uc=s(1609);function Fc({pipelineId:e,stagesLength:t=0}){const{modalDispatch:s}=(0,a.useContext)(Ks),i=()=>{return t=this,a=void 0,i=function*(){s({type:K,payload:{targetPipelineId:e}})},new((n=void 0)||(n=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,a||[])).next())}));var t,a,n,i};return 0===t?(0,n.jsx)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-w-full wpqt-items-center wpqt-justify-center",children:(0,n.jsxs)("div",{className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-gap-y-1 wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,n.jsx)(xn.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,n.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add first stage","quicktasker")})]})}):(0,n.jsxs)("div",{className:"wpqt-main-border wpqt-mb-3 wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-self-start wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,n.jsx)(xn.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,n.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add stage","quicktasker")})]})}var Kc=s(5575),$c=s(6304),zc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Gc({stage:e}){var t,s,r,c;const{dispatch:d,state:{activePipeline:u},fetchAndSetPipelineData:p}=(0,a.useContext)(xs),{modalDispatch:h}=(0,a.useContext)(Ks),{state:{isUserAllowedToDelete:m}}=(0,a.useContext)(nn),[w,f]=(0,a.useState)(null),[q,x]=(0,a.useState)(!1),[_,g]=(0,a.useState)(!1),v=null!==(s=null===(t=null==u?void 0:u.stages)||void 0===t?void 0:t.length)&&void 0!==s?s:0,j=null!==(c=null===(r=e.tasks)||void 0===r?void 0:r.length)&&void 0!==c?c:0,b=+e.stage_order,y=b>0&&b<v,E=b!==v-1,T=t=>zc(this,void 0,void 0,(function*(){try{f(t),yield function(e,t){return zt()({path:`/wpqt/v1/stages/${e}/move`,method:"PATCH",data:{direction:t},headers:Gt()})}(e.id,t),yield p(u.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move the stage","quicktasker"))}finally{f(null)}}));return(0,n.jsxs)(ii,{menuBtn:({active:e})=>(0,n.jsx)(oi,{isActive:e,IconComponent:l.A}),children:[y&&(0,n.jsx)(ri,{text:(0,o.__)("Move left","quicktasker"),loading:"left"===w,icon:(0,n.jsx)(Kc.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:e=>{e.preventDefault(),T("left")}}),E&&(0,n.jsx)(ri,{text:(0,o.__)("Move right","quicktasker"),loading:"right"===w,icon:(0,n.jsx)($c.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:e=>{e.preventDefault(),T("right")}}),(0,n.jsx)(ri,{text:(0,o.__)("Edit stage","quicktasker"),icon:(0,n.jsx)(pi.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:()=>{h({type:z,payload:{stageToEdit:e}})}}),(0,n.jsx)(ti,{onConfirm:()=>zc(this,void 0,void 0,(function*(){try{x(!0),yield(t=e.id,zt()({path:`/wpqt/v1/stages/${t}/archive-tasks`,method:"PATCH",headers:Gt()})),yield p(u.id),i.oR.success((0,o.sprintf)((0,o.__)("Archived all %s tasks","quicktasker"),e.name))}catch(t){console.error(t),i.oR.error((0,o.sprintf)((0,o.__)("Failed to archive stage %s tasks","quicktasker"),e.name))}finally{x(!1)}var t})),confirmMessage:(0,o.__)("Are you sure you want to archive all tasks on the stage?","quicktasker"),children:({onClick:t})=>(0,n.jsx)(ri,{text:(0,o.__)("Archive all stage tasks","quicktasker"),icon:(0,n.jsx)(Xa.A,{className:"wpqt-icon-blue wpqt-size-4"}),loading:q,onClick:t,disabled:0===j,id:`item-dropdown-${e.id}-archive`,tooltipText:0===j?(0,o.__)("No tasks to archive on the stage","quicktasker"):void 0})}),m&&(0,n.jsx)(ri,{text:(0,o.__)("Delete stage","quicktasker"),icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:_,onClick:()=>zc(this,void 0,void 0,(function*(){try{g(!0),yield(t=e.id,zt()({path:`/wpqt/v1/stages/${t}`,method:"DELETE",data:{stageId:t},headers:Gt()})),d({type:k,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a stage","quicktasker"))}finally{g(!1)}var t})),disabled:j>0,className:"!wpqt-mb-0",id:`item-dropdown-${e.id}`,tooltipText:j>0?(0,o.__)("Stage can be deleted when there are no tasks on it","quicktasker"):void 0})]})}var Vc=s(1578),Bc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Hc({stageId:e}){const[t,s]=(0,a.useState)(""),[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),u=(0,a.useRef)(null),p=(0,a.useRef)(null),{state:{activePipeline:h},dispatch:m}=(0,a.useContext)(xs),{handleExecutedAutomations:f}=js();(0,a.useEffect)((()=>{const e=e=>{"Enter"===e.key&&document.activeElement===p.current&&k()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),(0,a.useEffect)((()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&q()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,a.useEffect)((()=>{var e;r&&(null===(e=p.current)||void 0===e||e.focus())}),[r]);const k=()=>Bc(this,void 0,void 0,(function*(){if(t)try{d(!0);const s=yield function(e,t,s){return zt()({path:"/wpqt/v1/tasks",method:"POST",data:{stageId:e,name:s,pipelineId:t},headers:Gt()})}(e,h.id,t);m({type:w,payload:s.data.newTask}),i.oR.success((0,o.__)("Task created","quicktasker")),q(),f(s.data.executedAutomations,s.data.newTask.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create task","quicktasker"))}finally{d(!1)}else i.oR.error((0,o.__)("Task name is required","quicktasker"))})),q=()=>{c(!1),s("")};return(0,n.jsx)("div",{ref:u,className:"wpqt-sticky wpqt-bottom-0 wpqt-z-10 wpqt-order-1 wpqt-mt-2 wpqt-flex wpqt-justify-center wpqt-bg-gray-100 wpqt-py-2",children:r?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,n.jsx)(Ra,{ref:p,value:t,onChange:e=>s(e),wrapperClassName:"!wpqt-mb-0",className:"!wpqt-mb-0"}),l?(0,n.jsx)(Xs,{width:"24",height:"24"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Vc.A,{className:"wpqt-icon-red wpqt-size-6 wpqt-cursor-pointer",onClick:q}),(0,n.jsx)(xn.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer",onClick:k})]})]}):(0,n.jsxs)("div",{onClick:()=>c(!0),className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-p-2 hover:wpqt-bg-white",children:[(0,o.__)("Add task","quicktasker"),(0,n.jsx)(xn.A,{className:"wpqt-size-6 wpqt-text-green-600"})]})})}var Wc=s(7959),Qc=s(1735),Yc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Jc({task:e}){const{modalDispatch:t}=(0,a.useContext)(Ks),{dispatch:s}=(0,a.useContext)(xs),{state:{isUserAllowedToDelete:i}}=(0,a.useContext)(nn),{deleteTask:r,archiveTask:c}=ys(),[l,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1);return(0,n.jsxs)(ii,{menuBtn:({active:e})=>(0,n.jsx)(oi,{isActive:e,IconComponent:yo.A}),children:[(0,n.jsx)(ti,{confirmMessage:(0,o.__)("Are you sure you want to archive this task?","quicktasker"),onConfirm:()=>Yc(this,void 0,void 0,(function*(){p(!0),c(e.id,(({success:t})=>{t&&s({type:A,payload:e.id}),p(!1)}))})),children:({onClick:e})=>(0,n.jsx)(ri,{text:(0,o.__)("Archive task","quicktasker"),icon:(0,n.jsx)(Xa.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:e,loading:u})}),(0,n.jsx)(ri,{text:(0,o.__)("Edit task","quicktasker"),icon:(0,n.jsx)(pi.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:U,payload:{taskToEdit:e}})}}),(0,n.jsx)(ri,{text:(0,o.__)("Color","quicktasker"),icon:(0,n.jsx)(Wc.A,{className:"wpqt-icon-orange wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:ee,payload:{task:e}})}}),(0,n.jsx)(ri,{text:(0,o.__)("Move task","quicktasker"),icon:(0,n.jsx)(Qc.zhn,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:X,payload:{task:e}})}}),i&&(0,n.jsx)(ti,{onConfirm:()=>Yc(this,void 0,void 0,(function*(){d(!0),yield r(e.id,(({success:t})=>{t&&s({type:A,payload:e.id}),d(!1)}))})),confirmMessage:(0,o.__)("Are you sure you want to delete this task?","quicktasker"),confirmButtonText:(0,o.__)("Delete","quicktasker"),children:({onClick:e})=>(0,n.jsx)(ri,{text:(0,o.__)("Delete task","quicktasker"),icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:l,onClick:e,className:"!wpqt-mb-0"})})]})}function Xc({task:e}){const{convertToWPTimezone:t}=Dn();return e.due_date?(0,n.jsxs)("div",{className:"wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,n.jsx)(_o.A,{className:`wpqt-size-5 ${function(e){const t=function(e,t){const s=new Date(e),a=new Date(t).getTime()-s.getTime(),n=Math.floor(a/1e3),i=Math.floor(n/60),o=Math.floor(i/60);return{milliseconds:a,seconds:n,minutes:i,hours:o,days:Math.floor(o/24)}}(Sn()().utc().format("YYYY-MM-DD HH:mm:ss"),e);return t.milliseconds<0?"wpqt-text-red-600":t.hours<24?"wpqt-text-amber-500":t.hours<72?"wpqt-text-yellow-500":"wpqt-icon-blue"}(e.due_date)}`}),(0,n.jsxs)("span",{className:"wpqt-font-semibold",children:[(0,o.__)("Due date","quicktasker"),":"]}),t(e.due_date)]}):null}var Zc=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function el({task:e,allowToMarkTaskAsDone:t}){const{dispatch:s}=(0,a.useContext)(xs),{changeTaskDoneStatus:i}=ys(),[o,r]=(0,a.useState)(!1),c=e.is_done,l=t=>Zc(this,void 0,void 0,(function*(){r(!0),yield i(e.id,t,(t=>{s({type:E,payload:{taskId:e.id,done:t}})})),r(!1)}));return t?o?(0,n.jsx)(ea,{ovalSize:"24"}):(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:c?(0,n.jsx)(en.A,{className:"wpqt-size-6 wpqt-icon-green hover:wpqt-icon-gray",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,n.jsx)(en.A,{className:"wpqt-size-6 wpqt-icon-gray hover:wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!0)}})}):null}function tl({task:e,index:t,onLastStage:s}){const{modalDispatch:i}=(0,a.useContext)(Ks),{state:{activePipeline:o}}=(0,a.useContext)(xs),r=!(null==o?void 0:o.settings).allow_only_last_stage_task_done||s,c=()=>{i({type:U,payload:{taskToEdit:e,taskModalSettings:{allowToMarkTaskAsDone:r}}})},l=e.task_focus_color?{borderTopColor:e.task_focus_color,borderTopWidth:Dt,borderTopStyle:Pt}:{};return(0,n.jsx)(Cc.sx,{draggableId:e.id,index:t,children:t=>(0,n.jsx)("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{children:(0,n.jsxs)("div",{className:"wpqt-relative wpqt-mx-4 wpqt-mb-2 wpqt-flex !wpqt-cursor-pointer wpqt-flex-col wpqt-gap-1 wpqt-rounded wpqt-border wpqt-border-gray-200 wpqt-bg-white wpqt-p-3 wpqt-shadow hover:wpqt-shadow-md",style:l,onClick:c,children:[(0,n.jsx)("div",{className:"wpqt-absolute wpqt-right-[12px] wpqt-top-[12px]",children:(0,n.jsx)(Jc,{task:e})}),(0,n.jsx)("div",{className:"wpqt-text-base",children:e.name}),e.description&&(0,n.jsx)("div",{className:"wpqt-text-sm wpqt-italic",children:e.description}),(0,n.jsxs)("div",{className:"wpqt-mt-2 wpqt-mb-2 wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:[(0,n.jsx)(yi,{task:e}),(0,n.jsx)(qi,{task:e})]}),(0,n.jsx)(Xc,{task:e}),(0,n.jsx)(el,{task:e,allowToMarkTaskAsDone:r})]})}))},e.id)}function sl({tasks:e}){const t=e.length;return(0,n.jsx)("span",{className:"wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-1 wpqt-text-xs",children:t})}function al({stage:e,isLastStage:t}){return(0,n.jsxs)("div",{"data-stage-id":e.id,className:"wpqt-relative wpqt-mb-3 wpqt-flex wpqt-max-h-full wpqt-w-[360px] wpqt-flex-none wpqt-flex-col wpqt-overflow-hidden wpqt-rounded-md wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-gray-100",children:[(0,n.jsxs)("div",{className:"wpqt-mb-4 wpqt-flex wpqt-flex-wrap wpqt-items-center wpqt-gap-1 wpqt-px-4 wpqt-pt-3",children:[(0,n.jsxs)("div",{className:"wpqt-mr-auto wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-text-base wpqt-leading-none",children:[e.name," ",(0,n.jsx)(sl,{tasks:e.tasks})]}),(0,n.jsx)(Gc,{stage:e}),e.description&&(0,n.jsx)("div",{className:"wpqt-w-full wpqt-flex-shrink-0 wpqt-flex-grow-0 wpqt-text-sm",children:e.description})]}),(0,n.jsx)(Cc.gL,{droppableId:e.id,children:s=>{var a;return(0,n.jsxs)("div",{ref:s.innerRef,className:"wpqt-flex wpqt-h-full wpqt-flex-col wpqt-overflow-y-auto wpqt-overflow-x-hidden",children:[null===(a=e.tasks)||void 0===a?void 0:a.map(((e,s)=>(0,n.jsx)(tl,{task:e,index:s,onLastStage:t},e.id))),s.placeholder,(0,n.jsx)(Hc,{stageId:e.id})]})}})]})}const nl=()=>{var e,t;const{state:{activePipeline:s},dispatch:r,fetchAndSetPipelineData:c}=(0,a.useContext)(xs),{isTabVisible:l}=(()=>{const[e,t]=(0,Uc.useState)(!document.hidden);return(0,Uc.useEffect)((()=>{const e=()=>{t(!document.hidden)};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[]),{isTabVisible:e}})(),{modalDispatch:d}=(0,a.useContext)(Ks);(0,a.useEffect)((()=>{const e=setInterval((()=>{s&&l&&c(s.id)}),3e4);return()=>clearInterval(e)}),[s,l]);const u=(e,t)=>{e.droppableId===t.droppableId?r({type:"REORDER_TASK",payload:{source:e,destination:t}}):r({type:m,payload:{source:e,destination:t}})},p=(0,a.useCallback)((e=>{return t=void 0,s=void 0,n=function*(){const{source:t,destination:s,draggableId:a}=e;if(s){u(t,s);try{yield Vt(a,s.droppableId,s.index)}catch(e){console.error(e),u(s,t),i.oR.error((0,o.__)("Failed to move a task","quicktasker"))}}},new((a=void 0)||(a=Promise))((function(e,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(t,s||[])).next())}));var t,s,a,n}),[s]);return s?(0,n.jsxs)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-gap-[24px] wpqt-overflow-x-auto wpqt-overflow-y-hidden",children:[(0,n.jsx)(Cc.JY,{onDragEnd:p,children:null===(e=s.stages)||void 0===e?void 0:e.map(((e,t)=>{const a=t===s.stages.length-1;return(0,n.jsx)(al,{stage:e,isLastStage:a},e.id)}))}),(0,n.jsx)(Fc,{pipelineId:s.id,stagesLength:null===(t=s.stages)||void 0===t?void 0:t.length}),(0,n.jsx)(ko,{deleteTaskCallback:()=>{s&&c(s.id)}}),(0,n.jsx)(Mc,{}),(0,n.jsx)(Rc,{})]}):(0,n.jsx)(Lr,{infoDescription:(0,o.__)("No boards found. Start by creating a board to organize and manage your tasks effectively.","quicktasker"),children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-center",children:[(0,n.jsx)(la,{text:(0,o.__)("Create a new board","quicktasker"),icon:(0,n.jsx)(xn.A,{className:"wpqt-size-6 wpqt-icon-green"}),onClick:()=>{d({type:G})}}),(0,n.jsx)("span",{children:(0,o.__)("or","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-blue-text wpqt-blue-text-hover wpqt-cursor-pointer",onClick:()=>{d({type:ie})},children:(0,o.__)("Import an existing board","quicktasker")})]})})};var il=s(8932),ol=s(247),rl=s(1203),cl=s(2496),ll=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function dl(){const{state:{activePipeline:e},fetchAndSetPipelineData:t}=(0,a.useContext)(xs),{state:{pipelines:s},pipelinesDispatch:r}=(0,a.useContext)(ka),{modalDispatch:c}=(0,a.useContext)(Ks),l=e=>ll(this,void 0,void 0,(function*(){try{yield(t=e.id,zt()({path:`/wpqt/v1/pipelines/${t}/set-primary`,method:"PATCH",headers:Gt()})),r({type:v,payload:e.id}),i.oR.success((0,o.__)("Primary board has been set successfully.","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to set primary board","quicktasker"))}var t}));return(0,n.jsxs)(ii,{menuBtnClasses:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1 wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-3",menuBtn:({active:t})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-leading-none",children:null==e?void 0:e.name}),(0,n.jsx)(rl.A,{className:"wpqt-size-4 "+(t?"wpqt-text-qtBlueHover":"")})]}),children:[(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center wpqt-font-bold",children:(0,o.__)("Change board","quicktasker")}),s.map((s=>{const a=s.is_primary,i=(null==e?void 0:e.id)===s.id;return(0,n.jsx)(ni.Dr,{children:(0,n.jsxs)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-gap-2",children:[(0,n.jsx)("div",{className:(0,pn.$)("wpqt-cursor-pointer wpqt-text-center",{"wpqt-font-bold":i}),onClick:()=>t(s.id),children:s.name}),(0,n.jsx)("div",{className:"wpqt-ml-auto",children:a?(0,n.jsx)(cl.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-blue-500"}):(0,n.jsx)(ol.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-gray-400",onClick:e=>{e.stopPropagation(),l(s)}})})]})},s.id)})),(0,n.jsx)(ni.Dr,{children:(0,n.jsx)("div",{className:"wpqt-my-4 wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:(0,n.jsx)(la,{text:(0,o.__)("Add new board","quicktasker"),onClick:()=>ll(this,void 0,void 0,(function*(){c({type:G})})),icon:(0,n.jsx)(xn.A,{className:"wpqt-size-6 wpqt-icon-green"}),className:"wpqt-bg-white hover:!wpqt-bg-gray-100"})})},"new-pipeline"),(0,n.jsx)(ni.Dr,{children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-1 wpqt-justify-center wpqt-cursor-pointer wpqt-blue-text wpqt-blue-text-hover",onClick:()=>{c({type:ie})},children:(0,o.__)("Import existing","quicktasker")})},"export-pipeline")]})}var ul=s(712);function pl(){const{navigatePage:e}={navigatePage:function(e){window.location.hash=e}},{activePipelineId:t}=Yr();return(0,n.jsx)("div",{className:"wpqt-flex wpqt-mr-2",children:(0,n.jsx)(ul.z7b,{className:"wpqt-size-5 wpqt-cursor-pointer wpqt-icon-blue",onClick:()=>{e(`#/board/${t}/automations`)}})})}function hl(){const{modalDispatch:e}=(0,a.useContext)(Ks),t=t=>{e({type:se,payload:{selectedMethod:t}})};return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-mr-5 wpqt-gap-2",children:[(0,n.jsx)(wc.uNb,{className:"wpqt-size-5 wpqt-pdf-red wpqt-cursor-pointer","data-testid":"task-export-pdf-icon",onClick:()=>{t(Us.PDF)}}),(0,n.jsx)(Ac.Qio,{className:"wpqt-size-5 wpqt-cursor-pointer","data-testid":"task-export-pdf-json-icon",onClick:()=>{t(Us.JSON)}})]})}function ml(){const{state:{activePipeline:e,loading:t},fetchAndSetPipelineData:s}=(0,a.useContext)(xs),{modalDispatch:i}=(0,a.useContext)(Ks);return e?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-py-5",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)("div",{className:"wpqt-text-lg wpqt-font-semibold",children:e.name}),(0,n.jsx)(l.A,{className:"wpqt-text-gray-400 wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{e&&i({type:V,payload:{pipelineToEdit:e}})}})]}),e.description&&(0,n.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,n.jsxs)("div",{className:"wpqt-ml-auto wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,n.jsx)(pl,{}),(0,n.jsx)(hl,{}),(0,n.jsx)(wl,{}),t?(0,n.jsx)(Xs,{width:"24",height:"24"}):(0,n.jsx)(Di.A,{className:"wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover","data-testid":"refresh-icon",onClick:()=>s(e.id)}),(0,n.jsx)(dl,{})]})]}):null}function wl(){const{state:{view:e},dispatch:t}=(0,a.useContext)(xs);return(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-1 wpqt-items-center wpqt-cursor-pointer wpqt-text-blue-400 wpqt-text-base :hover:wpqt-text-blue-600",onClick:()=>{t({type:O,payload:e===hs.PIPELINE?hs.TASK:hs.PIPELINE})},children:e===hs.PIPELINE?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(il.A,{className:"wpqt-size-5 wpqt-text-blue-400"}),(0,o.__)("Switch to Task view","quicktasker")]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(xo.A,{className:"wpqt-size-5 wpqt-text-blue-400"}),(0,o.__)("Switch to Board view","quicktasker")]})})}function fl(){const{modalDispatch:e}=(0,a.useContext)(Ks),{activePipelineTasks:t,activePipelineSettings:s,isTaskOnLastStage:i}=Yr(),{taskViewFilter:r}=(()=>{const{state:{stageIdFilter:e,userFilter:t,searchText:s}}=(0,a.useContext)(Zr);return{taskViewFilter:a=>{var n,i,o,r;const c=!e||a.stage_id===e,l=!t.id||!t.type||t.type===Kt.QUICKTASKER&&(null===(n=a.assigned_users)||void 0===n?void 0:n.some((e=>e.id===t.id)))||t.type===Kt.WP_USER&&(null===(i=a.assigned_wp_users)||void 0===i?void 0:i.some((e=>e.id===t.id))),d=!s||a.name.toLowerCase().includes(s.toLowerCase())||null!==(r=null===(o=a.description)||void 0===o?void 0:o.toLowerCase().includes(s.toLowerCase()))&&void 0!==r&&r;return c&&l&&d}}})(),c=t.filter(r);return 0===c.length?(0,n.jsx)(qo,{text:(0,o.__)("No tasks","quictasker")}):(0,n.jsxs)("div",{className:"wpqt-card-grid",children:[c.map((t=>{const a=i(t.id),o=!s.allow_only_last_stage_task_done||a,r=t.task_focus_color?{borderTopColor:t.task_focus_color,borderTopWidth:Dt,borderTopStyle:Pt}:{};return(0,n.jsxs)(go,{className:"wpqt-cursor-pointer",style:r,title:t.name,description:t.description,dropdown:(0,n.jsx)(Jc,{task:t}),onClick:()=>{e({type:U,payload:{taskToEdit:t,taskModalSettings:{allowToMarkTaskAsDone:o}}})},children:[(0,n.jsxs)("div",{className:"wpqt-mt-2 wpqt-mb-2 wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:[(0,n.jsx)(yi,{task:t}),(0,n.jsx)(qi,{task:t})]}),(0,n.jsx)(Xc,{task:t}),(0,n.jsx)(el,{task:t,allowToMarkTaskAsDone:o})]},t.id)})),(0,n.jsx)(ko,{}),(0,n.jsx)(Mc,{})]})}const kl=()=>(0,n.jsx)(_s,{children:(0,n.jsx)(Oa,{children:(0,n.jsx)(ql,{})})}),ql=()=>{const{state:{view:e,activePipeline:t}}=(0,a.useContext)(xs),s=e===hs.PIPELINE;return(0,n.jsxs)(Na,{children:[(0,n.jsx)(ml,{}),s?(0,n.jsx)(nl,{}):(0,n.jsxs)(ec,{children:[(0,n.jsx)(tc,{}),(0,n.jsx)(fl,{})]}),(0,n.jsx)(bc,{}),(0,n.jsx)(Tc,{}),(0,n.jsx)(_c,{}),(0,n.jsx)(Nc,{pipelineId:(null==t?void 0:t.id)||null}),(0,n.jsx)(xc,{})]})};var xl=s(6197),_l=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function gl(){return{saveCustomUserPageStyles:(e,t)=>_l(this,void 0,void 0,(function*(){try{const a=yield(s=e,zt()({path:"/wpqt/v1/settings/user-page-custom-styles",method:"PATCH",data:{styles:s},headers:Gt()}));t&&t(a.data),i.oR.success((0,o.__)("Custom user page styles saved successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to save custom user page styles","quicktasker"))}var s})),saveTaskCompletionDoneSetting:(e,t,s)=>_l(this,void 0,void 0,(function*(){try{yield function(e,t){return zt()({path:`/wpqt/v1/pipelines/${e}/settings/task-completion-done-restriction`,method:"PATCH",data:{allow_task_completion_only_on_last_stage:t},headers:Gt()})}(e,t),s&&s(t)}catch(e){s&&s(!t),console.error(e),i.oR.error((0,o.__)("Failed to save setting","quicktasker"))}}))}}const vl=({children:e,title:t,description:s})=>(0,n.jsxs)("div",{className:"wpqt-mb-5",children:[(0,n.jsx)("h3",{className:"wpqt-mb-1",children:t}),(0,n.jsx)("p",{children:s}),e]});const jl=()=>{const{state:{userPageCustomStyles:e},appDispatch:t}=(0,a.useContext)(nn),[s,i]=(0,a.useState)(""),[r,c]=(0,a.useState)(!1),{saveCustomUserPageStyles:l}=gl();return(0,a.useEffect)((()=>{i(e)}),[e]),(0,n.jsxs)(vl,{title:(0,o.__)("Custom style","quicktasker"),description:(0,o.__)("Add custom CSS rules for user tasks page.","quicktasker"),children:[(0,n.jsx)(hn,{value:s,onChange:i,colsCount:40}),(0,n.jsx)(la,{text:(0,o.__)("Save","quicktasker"),loading:r,onClick:()=>{return e=void 0,a=void 0,i=function*(){c(!0),yield l(s,(e=>{t({type:Fe,payload:e})})),c(!1)},new((n=void 0)||(n=Promise))((function(t,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(e,a||[])).next())}));var e,a,n,i},icon:(0,n.jsx)(xl.RZ0,{className:"wpqt-icon-blue wpqt-size-4"})})]})};var bl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function yl({allow_only_last_stage_task_done:e,pipelineId:t}){const[s,i]=(0,a.useState)(e),[r,c]=(0,a.useState)(!1),{saveTaskCompletionDoneSetting:l}=gl();return(0,n.jsx)(vl,{title:(0,o.__)("Restrict Task Completion","quicktasker"),description:(0,o.__)("Allow to mark task as done only on board last stage. By default, task can be marked as done on any stage. Will apply also to QuickTasker page.","quicktasker"),children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,n.jsx)(co,{checked:s,handleChange:e=>bl(this,void 0,void 0,(function*(){i(e),c(!0),yield l(t,e,(e=>{i(e)})),c(!1)}))}),r&&(0,n.jsx)(Xs,{width:"20",height:"20"})]})})}var El=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Tl(){return{createWebhook:function(e,t,s,a,n){return El(this,void 0,void 0,(function*(){try{const i=yield function(e,t,s,a,n){return zt()({path:`/wpqt/v1/pipelines/${e}/webhooks`,method:"POST",data:{target_type:t,target_action:s,webhook_url:a,webhook_confirm:n},headers:Gt()})}(e,t,s,a,n);return{success:!0,webhook:i.data.webhook}}catch(e){return console.error("Error creating webhook:",e),i.oR.error((0,o.__)("Failed to create webhook","quicktasker")),{success:!1,webhook:null}}}))},editWebhook:function(e,t){return El(this,void 0,void 0,(function*(){try{const s=yield function(e,t){return zt()({path:`/wpqt/v1/webhooks/${e}`,method:"PATCH",data:t,headers:Gt()})}(e,t);return{success:!0,webhook:s.data.webhook}}catch(e){return console.error("Error editing webhook:",e),i.oR.error((0,o.__)("Failed to edit webhook","quicktasker")),{success:!1,webhook:null}}}))},deleteWebhook:function(e){return El(this,void 0,void 0,(function*(){try{return yield function(e){return zt()({path:`/wpqt/v1/webhooks/${e}`,method:"DELETE",headers:Gt()})}(e),i.oR.success((0,o.__)("Webhook deleted successfully","quicktasker")),{success:!0}}catch(e){return console.error("Error deleting webhook:",e),i.oR.error((0,o.__)("Failed to delete webhook","quicktasker")),{success:!1}}}))}}}const Sl=(e,t)=>{switch(t.type){case jt:return Object.assign(Object.assign({},e),{webhooks:t.payload.webhooks});case bt:return Object.assign(Object.assign({},e),{loading:t.payload});case Et:return Object.assign(Object.assign({},e),{webhooks:[...e.webhooks,t.payload.webhook]});case yt:return Object.assign(Object.assign({},e),{webhooks:e.webhooks.filter((e=>e.id!==t.payload.webhookId))});case Tt:{const{webhookId:s,webhookData:a}=t.payload;return Object.assign(Object.assign({},e),{webhooks:e.webhooks.map((e=>e.id===s?Object.assign(Object.assign({},e),a):e))})}default:return e}};var Al,Ol;!function(e){e.TASK="task"}(Al||(Al={})),function(e){e.CREATE="created",e.UPDATE="updated",e.DELETE="deleted",e.STAGE_CHANGED="stage-changed",e.ARCHIVED="archived",e.RESTORED_ARCHIVED="restored-archived",e.COMPLETED="completed",e.NOT_COMPLETED="not-completed",e.ASSIGNED="assigned",e.UNASSIGNED="unassigned",e.COMMENT_ADDED="comment-added",e.LABEL_ADDED="label-added",e.LABEL_REMOVED="label-removed",e.FILE_ADDED="file-added",e.FILE_REMOVED="file-removed"}(Ol||(Ol={}));const Nl=e=>Object.assign(Object.assign({},e),{webhook_confirm:"1"===e.webhook_confirm}),Cl={[Al.TASK]:[Ol.CREATE,Ol.UPDATE,Ol.DELETE,Ol.STAGE_CHANGED,Ol.COMPLETED,Ol.NOT_COMPLETED,Ol.RESTORED_ARCHIVED,Ol.COMMENT_ADDED,Ol.FILE_ADDED,Ol.FILE_REMOVED,Ol.LABEL_ADDED,Ol.LABEL_REMOVED,Ol.ASSIGNED,Ol.UNASSIGNED]};const Il={webhooks:[],loading:!0},Dl=(0,a.createContext)({state:Il,pipelineWebhooksDispatch:()=>{}}),Pl=({children:e,pipelineId:t})=>{const[s,r]=(0,a.useReducer)(Sl,Il),c=()=>{return e=void 0,s=void 0,n=function*(){try{r({type:bt,payload:!0});const s=yield function(e){return zt()({path:`/wpqt/v1/pipelines/${e}/webhooks`,method:"GET",headers:Gt()})}(t);r({type:jt,payload:{webhooks:(e=s.data.webhooks,e.map(Nl))}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load board webhooks","quicktasker"))}finally{r({type:bt,payload:!1})}var e},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n};return(0,a.useEffect)((()=>{c()}),[]),(0,n.jsx)(Dl.Provider,{value:{state:s,pipelineWebhooksDispatch:r},children:e})};function Rl(){const{state:{webhooks:e,loading:t},pipelineWebhooksDispatch:s}=(0,a.useContext)(Dl);return{webhooks:e,loading:t,pipelineWebhooksDispatch:s}}const Ll=ir.z.string().url({message:"Invalid URL"});var Ml=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ul({pipelineId:e}){var t;const[s,r]=(0,a.useState)(Al.TASK),[c,l]=(0,a.useState)(Ol.CREATE),[d,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(""),[m,w]=(0,a.useState)(!1),[f,k]=(0,a.useState)({urlValid:!0,urlDirty:!1}),{createWebhook:q}=Tl(),{pipelineWebhooksDispatch:x}=Rl(),{modalDispatch:_}=(0,a.useContext)(Ks),g=null!==(t=Cl[s])&&void 0!==t?t:[];return(0,a.useEffect)((()=>{k((e=>Object.assign(Object.assign({},e),{urlValid:Ll.safeParse(p).success})))}),[p]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-4 wpqt-mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(ga,{labelFor:"webhook-target-type",className:"wpqt-block wpqt-mb-3",children:(0,o.__)("Select a target type","quicktasker")}),(0,n.jsx)(ja,{id:"webhook-target-type",selectedOptionValue:s,options:Object.values(Al).map((e=>({value:e,label:e}))),allSelector:!1,onSelectionChange:e=>r(e)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(ga,{labelFor:"webhook-target-action",className:"wpqt-block wpqt-mb-3",children:(0,o.__)("Select a target action","quicktasker")}),(0,n.jsx)(ja,{id:"webhook-target-action",selectedOptionValue:c,options:Object.values(g).map((e=>({value:e,label:e}))),allSelector:!1,onSelectionChange:e=>l(e)})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)(ga,{labelFor:"webhook-confirm",className:"wpqt-flex wpqt-mb-3 wpqt-gap-1","data-tooltip-id":"webhook-confirm-tooltip","data-tooltip-content":(0,o.__)("If enabled, the webhook will wait for the HTTP response. Much slower performance but better for debugging.","quicktasker"),"data-tooltip-variant":"info",children:[(0,o.__)("Confirm webhook execution","quicktasker"),(0,n.jsx)(Bo.A,{className:"wpqt-size-5"})]}),(0,n.jsx)(co,{checked:d,handleChange:u,id:"webhook-confirm"}),(0,n.jsx)(aa,{id:"webhook-confirm-tooltip"})]}),(0,n.jsxs)("div",{className:"wpqt-flex-1",children:[(0,n.jsx)(ga,{labelFor:"webhook-url",className:"wpqt-block wpqt-mb-3",children:(0,o.__)("Enter the webhook URL","quicktasker")}),(0,n.jsx)(Ra,{inputId:"webhook-url",value:p,onChange:e=>{h(e),k((e=>Object.assign(Object.assign({},e),{urlDirty:!0})))},wrapperClassName:"!wpqt-w-full !wpqt-mb-0",className:"!wpqt-w-full"}),!f.urlValid&&f.urlDirty&&(0,n.jsx)("div",{className:"wpqt-text-red-600 wpqt-mt-1",children:(0,o.__)("Please enter a valid URL","quicktasker")})]})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-end",children:(0,n.jsx)(ta,{btnText:(0,o.__)("Create Webhook","quicktasker"),onClick:function(){return Ml(this,void 0,void 0,(function*(){if(m||!f.urlValid)return;w(!0);const{success:t,webhook:a}=yield q(e,s,c,p,d);w(!1),t&&a&&(i.oR.success((0,o.__)("Webhook created successfully","quicktasker")),x({type:Et,payload:{webhook:Nl(a)}}),r(Al.TASK),l(Ol.CREATE),h(""),u(!1),k({urlValid:!0,urlDirty:!1}),Ct||_({type:pe,payload:!1}))}))},loading:m})})]})}function Fl({pipelineId:e}){const{state:{webhookCreationModalOpen:t},modalDispatch:s}=(0,a.useContext)(Ks);return(0,n.jsx)(na,{modalOpen:t,closeModal:()=>{s({type:pe,payload:!1})},size:"lg",children:(0,n.jsx)(Ul,{pipelineId:e})})}var Kl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function $l(){const{state:{webhooksLogsModalOpen:e,webhooksLogsModalSettings:t},modalDispatch:s}=(0,a.useContext)(Ks);return(0,n.jsx)(na,{modalOpen:e,closeModal:()=>s({type:we}),size:"lg",children:e&&(0,n.jsx)(zl,{settings:t})})}function zl({settings:e}){const[t,s]=(0,a.useState)(!1),[i,o]=(0,a.useState)([]),[r,c]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{e.webhookId&&(()=>{Kl(this,void 0,void 0,(function*(){if(e.webhookId){s(!0),c(!1);try{const t=yield Qt({type:Sr.Webhook,typeId:e.webhookId,order:Nr.Desc});o(t.data)}catch(e){console.error("Error fetching webhook logs:",e),c(!0)}finally{s(!1)}}}))})()}),[e.webhookId]),r?(0,n.jsx)("div",{children:"Error fetching logs"}):(0,n.jsx)(Tr,{loading:t,logs:i})}var Gl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Vl({webhookId:e}){const[t,s]=(0,a.useState)(!1),{deleteWebhook:i}=Tl(),{pipelineWebhooksDispatch:r}=Rl(),{modalDispatch:c}=(0,a.useContext)(Ks);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-w-[100px] wpqt-justify-center wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)(ta,{btnText:(0,o.__)("Logs","quicktasker"),onClick:()=>{c({type:me,payload:{webhookId:e}})}}),(0,n.jsx)(ti,{confirmMessage:(0,o.__)("Are you sure you want to delete this webhook?","quicktasker"),onConfirm:function(){return Gl(this,void 0,void 0,(function*(){s(!0);const{success:t}=yield i(e);s(!1),t&&r({type:yt,payload:{webhookId:e}})}))},children:({onClick:e})=>(0,n.jsx)(ta,{btnText:(0,o.__)("Delete","quicktasker"),buttonStyleType:Gs.DANGER,loading:t,onClick:e})})]})}var Bl=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Hl({webhook:e}){const{state:{timezone:t}}=(0,a.useContext)(nn);return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-4  wpqt-mb-4",children:[(0,n.jsx)(Wl,{name:(0,o.__)("Target","quicktasker"),value:e.target_type,className:"!wpqt-w-[100px]"}),(0,n.jsx)(Wl,{name:(0,o.__)("Action","quicktasker"),value:e.target_action,className:"!wpqt-w-[100px]"}),(0,n.jsx)(Ql,{webhook:e,name:(0,o.__)("Confirm","quicktasker"),value:e.webhook_confirm}),(0,n.jsx)(Wl,{name:(0,o.__)("URL","quicktasker"),value:e.webhook_url,className:"wpqt-w-[200px]"}),(0,n.jsx)(Wl,{name:(0,o.__)("Created","quicktasker"),value:In(e.created_at,t)}),(0,n.jsx)(Vl,{webhookId:e.id})]})}function Wl({name:e,value:t,className:s=""}){return(0,n.jsxs)("div",{className:`wpqt-flex wpqt-flex-col wpqt-w-[160px] ${s}`,children:[(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-font-semibold",children:e}),(0,n.jsx)("div",{children:t})]})}function Ql({webhook:e,name:t,value:s}){const[r,c]=(0,a.useState)(s),[l,d]=(0,a.useState)(!1),{editWebhook:u}=Tl(),{pipelineWebhooksDispatch:p}=Rl();return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-w-[160px]",children:[(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-font-semibold",children:t}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2",children:[(0,n.jsx)(co,{checked:r,handleChange:t=>Bl(this,void 0,void 0,(function*(){c(t),d(!0);const{success:s}=yield u(e.id,{webhook_confirm:t});d(!1),s?(i.oR.success((0,o.__)("Webhook updated","quicktasker")),p({type:Tt,payload:{webhookId:e.id,webhookData:{webhook_confirm:t}}})):c(!t)}))}),l&&(0,n.jsx)(ea,{ovalSize:"16"})]})]})}function Yl(){const{state:{webhooksModalOpen:e},modalDispatch:t}=(0,a.useContext)(Ks),{webhooks:s}=Rl();return(0,n.jsx)(na,{modalOpen:e,closeModal:()=>{t({type:he,payload:!1})},size:"lg",children:(0,n.jsx)(Jl,{webhooks:s})})}function Jl({webhooks:e}){const{modalDispatch:t}=(0,a.useContext)(Ks);return 0===e.length?(0,n.jsx)("h2",{children:(0,o.__)("No webhooks found.","quicktasker")}):(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-4",children:[e.map((e=>(0,n.jsx)(Hl,{webhook:e},e.id))),(0,n.jsx)("div",{className:"wpqt-flex wpqt-mt-2 wpqt-justify-end",children:(0,n.jsx)(ta,{btnText:(0,o.__)("Add new webhook","quicktasker"),onClick:function(){t({type:pe,payload:!0})}})})]})}function Xl({pipelineId:e}){const t=Ct?(0,o.__)("Send real-time board event data to external services using webhooks.","quicktasker"):(0,o.__)("Send real-time board event data to external services using webhooks. To configure more than one webhook, please upgrade to the premium version.","quicktasker");return(0,n.jsx)(Pl,{pipelineId:e,children:(0,n.jsxs)(vl,{title:(0,o.__)("Board webhooks","quicktasker"),description:t,children:[(0,n.jsx)(Zl,{}),(0,n.jsx)(Fl,{pipelineId:e}),(0,n.jsx)(Yl,{}),(0,n.jsx)($l,{})]})})}function Zl(){const{webhooks:e,loading:t}=Rl(),{modalDispatch:s}=(0,a.useContext)(Ks),i=(null==e?void 0:e.length)||0,r=Ct||i<1;return t?(0,n.jsx)(ea,{ovalSize:"24",className:"!wpqt-items-start"}):(0,n.jsxs)("div",{className:"wpqt-text-left",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:0===i?(0,n.jsx)("p",{children:(0,o.__)("There are no webhooks configured for this board.","quicktasker")}):(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,o.sprintf)((0,o.__)("There are %d webhooks configured for this board.","quicktasker"),i)}),(0,n.jsx)("div",{children:(0,n.jsx)("span",{className:"wpqt-cursor-pointer wpqt-text-blue-500 hover:wpqt-underline",onClick:()=>{s({type:he,payload:!0})},children:(0,o.__)("Manage board webhooks","quicktasker")})})]})}),r&&(0,n.jsx)("div",{children:(0,n.jsx)("span",{className:"wpqt-cursor-pointer wpqt-text-blue-500 hover:wpqt-underline",onClick:()=>{s({type:pe,payload:!0})},children:(0,o.__)("Create a new webhook","quicktasker")})})]})}var ed=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function td({pipeline:e}){const[t,s]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null);return(0,a.useEffect)((()=>{(()=>{ed(this,void 0,void 0,(function*(){try{s(!0);const a=yield(t=e.id,zt()({path:`/wpqt/v1/pipelines/${t}/settings`,method:"GET",headers:Gt()}));o(es(a.data.settings))}catch(e){console.error(e)}finally{s(!1)}var t}))})()}),[]),t?(0,n.jsx)(ea,{}):i?(0,n.jsxs)("div",{children:[(0,n.jsx)(yl,{pipelineId:e.id,allow_only_last_stage_task_done:i.allow_only_last_stage_task_done}),(0,n.jsx)(Xl,{pipelineId:e.id})]}):null}function sd(){const{state:{pipelines:e}}=(0,a.useContext)(ka),t=e.map((e=>e.name)),s=e.map((e=>(0,n.jsx)(td,{pipeline:e},e.id)));return(0,n.jsx)("div",{children:(0,n.jsx)(Ti,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})})}const ad=()=>(0,n.jsxs)(Na,{children:[(0,n.jsx)(d,{description:(0,o.__)("Manage settings, preferences, and configurations.","quicktasker"),children:(0,o.__)("Settings","quicktasker")}),(0,n.jsx)(jl,{}),(0,n.jsx)(sd,{})]});function nd(){const{state:{siteURL:e,publicUserPageId:t}}=(0,a.useContext)(nn);return{userPage:e+`/wpqt?page=${t}&page_id=wpqt`}}function id(){const{userPage:e}=nd();return(0,n.jsxs)(Na,{children:[(0,n.jsx)(d,{description:(0,o.__)("Lets you manage assigned tasks on separate page.","quicktasker"),children:(0,o.__)("User app","quicktasker")}),(0,n.jsx)("div",{children:(0,n.jsx)("a",{onClick:t=>{t.preventDefault(),window.open(e,"_blank")},href:"",children:(0,o.__)("Open your user page","quicktasker")})})]})}var od=s(1548),rd=s(1266),cd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ld(){return{createUser:(e,t,s)=>cd(this,void 0,void 0,(function*(){try{const r=yield(a=e,n=t,zt()({path:"/wpqt/v1/users",method:"POST",data:{name:a,description:n},headers:Gt()}));s&&s(r.data),i.oR.success((0,o.__)("User created successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User creation failed. Please try again","quicktasker"))}var a,n})),editUser:(e,t)=>cd(this,void 0,void 0,(function*(){try{const s=yield function(e,t){return zt()({path:`/wpqt/v1/users/${e}`,method:"PATCH",data:t,headers:Gt()})}(e,t);return{success:!0,user:s.data}}catch(e){return console.error(e),i.oR.error((0,o.__)("User edit failed. Please try again","quicktasker")),{success:!1}}})),changeUserStatus:(e,t,s)=>cd(this,void 0,void 0,(function*(){try{const a=yield function(e,t){return zt()({path:`/wpqt/v1/users/${e}/status`,method:"PATCH",data:{status:t},headers:Gt()})}(e,t);s&&s(a.data),i.oR.success((0,o.__)("User status changed successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change user status. Please try again","quicktasker"))}})),deleteUser:(e,t)=>cd(this,void 0,void 0,(function*(){try{yield function(e){return zt()({path:`/wpqt/v1/users/${e}`,method:"DELETE",headers:Gt()})}(e),t&&t(e),i.oR.success((0,o.__)("User deleted successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete user. Please try again","quicktasker"))}})),resetUserPassword:(e,t)=>cd(this,void 0,void 0,(function*(){try{yield function(e){return zt()({path:`/wpqt/v1/users/${e}/password-reset`,method:"PATCH",headers:Gt()})}(e),t&&t(e),i.oR.success((0,o.__)("User password reset successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to reset user password. Please try again","quicktasker"))}}))}}var dd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ud({data:e,changeStatus:t,changeSetUpStatus:s,changePasswordStatus:i}){const{changeUserStatus:r,deleteUser:c,resetUserPassword:l}=ld(),{userDispatch:d}=(0,a.useContext)(Ga),{loading1:u,setLoading1:p,loading2:h,setLoading2:m,loading3:w,setLoading3:f}=tn(),k=e.is_active,q=e.has_password;return(0,n.jsxs)("div",{className:"wpqt-mt-5 wpqt-flex wpqt-gap-2",children:[(0,n.jsx)(la,{icon:(0,n.jsx)(il.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${e.id}/tasks`}}),!k&&(0,n.jsx)(la,{icon:(0,n.jsx)(od.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:h,onClick:()=>dd(this,void 0,void 0,(function*(){m(!0),yield r(e.id,!0,(e=>{d({type:Pe,payload:Object.assign({},e)}),t(!0)})),m(!1)}))}),k&&(0,n.jsx)(la,{icon:(0,n.jsx)(od.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:h,onClick:()=>dd(this,void 0,void 0,(function*(){m(!0),yield r(e.id,!1,(e=>{d({type:Pe,payload:Object.assign({},e)}),t(!1)})),m(!1)}))}),q&&(0,n.jsx)(la,{icon:(0,n.jsx)(rd.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:u,text:(0,o.__)("Reset password","quicktasker"),onClick:()=>dd(this,void 0,void 0,(function*(){p(!0),yield l(e.id,(()=>{s(!1),i(!1)})),p(!1)}))}),(0,n.jsx)(la,{icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:w,text:(0,o.__)("Delete user","quicktasker"),onClick:()=>dd(this,void 0,void 0,(function*(){f(!0),yield c(e.id,(e=>{d({type:Re,payload:e}),window.location.hash="#/users"})),f(!1)}))})]})}var pd=s(8624),hd=s(3997),md=s(5028);function wd({data:e}){const{userPage:t}=nd(),{convertToWPTimezone:s}=Dn(),a=e.is_active,i=t+"&code="+e.page_hash;return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,n.jsx)(fd,{label:(0,o.__)("Name","quicktasker"),value:e.name,icon:(0,n.jsx)(pd.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(fd,{label:(0,o.__)("Created at","quicktasker"),value:s(e.created_at),icon:(0,n.jsx)(hd.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(fd,{label:(0,o.__)("Assigned tasks count","quicktasker"),value:e.assigned_tasks_count,icon:(0,n.jsx)(il.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(fd,{label:(0,o.__)("Setup completed","quicktasker"),value:e.setup_completed?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,n.jsx)(md.A,{className:"wpqt-size-5 wpqt-text-yellow-600"})}),(0,n.jsx)(fd,{label:(0,o.__)("Is active","quicktasker"),value:a?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,n.jsx)(od.A,{className:"wpqt-size-5 "+(a?"wpqt-icon-green":"wpqt-icon-red")})}),(0,n.jsx)(fd,{label:(0,o.__)("User Page","quicktasker"),value:(0,n.jsx)("a",{href:i,rel:"noreferrer",target:"_blank",children:i}),icon:(0,n.jsx)(Eo.A,{className:"wpqt-size-5 wpqt-icon-blue"})})]})}function fd({label:e,value:t,icon:s}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[s,(0,n.jsxs)("span",{className:"wpqt-font-semibold",children:[e,": "]}),(0,n.jsx)("span",{children:t})]})}var kd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function qd({userId:e}){const{loadingDispatch:t}=(0,a.useContext)(fs),[s,r]=(0,a.useState)(null);return(0,a.useEffect)((()=>{(()=>{kd(this,void 0,void 0,(function*(){try{t({type:Ke,payload:!0});const a=yield function(e){return zt()({path:`/wpqt/v1/users/${e}/extended`,method:"GET",headers:Gt()})}(e);r((s=a.data,Object.assign(Object.assign({},s),{is_active:"1"===s.is_active})))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to get user data. Please try again","quicktasker"))}finally{t({type:Ke,payload:!1})}var s}))})()}),[]),(0,n.jsx)(Na,{children:s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{description:(0,o.__)("User details","quicktasker"),children:s.name}),(0,n.jsx)(wd,{data:s}),(0,n.jsx)(ud,{data:s,changeStatus:e=>kd(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{is_active:e}):t))})),changeSetUpStatus:e=>kd(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{setup_completed:e}):t))})),changePasswordStatus:e=>kd(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{has_password:e}):t))}))})]})})}s(8987);const xd=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active||!0===e.is_active}),_d=(e,t)=>{var s;switch(t.type){case $e:return Object.assign(Object.assign({},e),{sessionsSearchValue:null!==(s=t.payload)&&void 0!==s?s:""});case ze:{const s=t.payload.map(xd);return Object.assign(Object.assign({},e),{userSessions:s})}case Ge:{const{sessionId:s,status:a}=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_active:a}):e))})}case Ve:{const s=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.filter((e=>e.id!==s))})}default:return e}};var gd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const vd={loading:!0,sessionsSearchValue:"",userSessions:[]},jd=(0,a.createContext)({state:vd,usersSessionDispatch:()=>{},loadUserSessions:()=>gd(void 0,void 0,void 0,(function*(){}))}),bd=({children:e})=>{const[t,s]=(0,a.useReducer)(_d,vd),{loadingDispatch:r}=(0,a.useContext)(fs);(0,a.useEffect)((()=>{c()}),[]);const c=()=>gd(void 0,void 0,void 0,(function*(){try{r({type:Ke,payload:!0});const e=yield zt()({path:"/wpqt/v1/users/sessions",method:"GET",headers:Gt()});s({type:ze,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user sessions","quicktasker"))}finally{r({type:Ke,payload:!1})}}));return(0,n.jsx)(jd.Provider,{value:{state:t,usersSessionDispatch:s,loadUserSessions:c},children:e})};function yd(){const{state:{sessionsSearchValue:e},usersSessionDispatch:t}=(0,a.useContext)(jd);return(0,n.jsx)(Ma,{title:(0,o.__)("Session filtering","quicktasker"),searchChildren:(0,n.jsx)(Ua,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"session-search",children:(0,n.jsx)(Ra,{inputId:"session-search",value:e,onChange:e=>{t({type:$e,payload:e})}})})})}const Ed=()=>{const{state:{sessionsSearchValue:e}}=(0,a.useContext)(jd);return{filterSessions:t=>t.user_name.toLowerCase().includes(e.toLowerCase())||t.user_description&&t.user_description.toLowerCase().includes(e.toLowerCase())}};var Td=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Sd({session:e}){const{usersSessionDispatch:t}=(0,a.useContext)(jd),{state:{isUserAllowedToDelete:s}}=(0,a.useContext)(nn),{convertToWPTimezone:r}=Dn(),c=e.is_active,l=s=>Td(this,void 0,void 0,(function*(){try{yield function(e,t){return zt()({path:`/wpqt/v1/users/sessions/${e}/status`,method:"PATCH",data:{status:t},headers:Gt()})}(e.id,s),t({type:Ge,payload:{sessionId:e.id,status:s}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change session status","quicktasker"))}}));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:e.user_name}),(0,n.jsx)("div",{className:"wpqt-italic",children:e.user_description})]}),(0,n.jsx)("div",{children:r(e.created_at_utc)}),(0,n.jsx)("div",{children:r(e.expires_at_utc)}),(0,n.jsx)("div",{className:c?"wpqt-text-qtTextGreen":"wpqt-text-qtTextRed",children:c?(0,o.__)("On","quicktasker"):(0,o.__)("Off","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-4",children:[c?(0,n.jsx)(Rn,{icon:(0,n.jsx)(od.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",title:(0,o.__)("Turn session off","quicktasker")}),onClick:()=>l(!1)}):(0,n.jsx)(Rn,{icon:(0,n.jsx)(od.A,{className:"wpqt-icon-green wpqt-size-5 wpqt-cursor-pointer",title:(0,o.__)("Turn session on","quicktasker")}),onClick:()=>l(!0)}),s&&(0,n.jsx)(ti,{onConfirm:()=>Td(this,void 0,void 0,(function*(){try{yield(s=e.id,zt()({path:`/wpqt/v1/users/sessions/${s}`,method:"DELETE",headers:Gt()})),t({type:Ve,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete session","quicktasker"))}var s})),children:({onClick:e})=>(0,n.jsx)(Rn,{icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",title:(0,o.__)("Delete session","quicktasker")}),onClick:e})})]})]})}function Ad(){const{state:{userSessions:e}}=(0,a.useContext)(jd),{filterSessions:t}=Ed(),s=e.filter(t);return 0===s.length?(0,n.jsx)(qo,{text:(0,o.__)("No sessions found","quicktasker")}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-mb-4 wpqt-grid wpqt-grid-cols-5 wpqt-font-bold",children:[(0,n.jsx)("div",{children:(0,o.__)("Session owner","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Created at","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Expires at","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Status","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Actions","quicktasker")})]}),(0,n.jsx)("div",{className:"wpqt-grid wpqt-grid-cols-5 wpqt-items-center wpqt-gap-y-4",children:s.map((e=>(0,n.jsx)(Sd,{session:e},e.id)))})]})}function Od(){return(0,n.jsx)(bd,{children:(0,n.jsx)(Na,{children:(0,n.jsx)(Nd,{})})})}function Nd(){const{state:{userSessions:e}}=(0,a.useContext)(jd);return e.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{children:(0,o.__)("Quicktasker sessions","quicktasker")}),(0,n.jsx)(yd,{}),(0,n.jsx)(Ad,{})]}):(0,n.jsx)(Lr,{infoTitle:(0,o.__)("No sessions","quicktasker"),infoDescription:(0,o.__)("No QuickTasker sessions found","quicktasker")})}function Cd(){const{state:{usersSearchValue:e},userDispatch:t}=(0,a.useContext)(Ga);return(0,n.jsx)(Ma,{title:(0,o.__)("User filtering","quicktasker"),searchChildren:(0,n.jsx)(Ua,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"user-search",children:(0,n.jsx)(Ra,{inputId:"user-search",value:e,onChange:e=>{t({type:De,payload:e})}})})})}var Id=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Dd({userId:e}){return(0,n.jsx)(Mi,{typeId:e,fetchData:()=>Id(this,void 0,void 0,(function*(){try{return(yield Wt(e,Ts.User)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load log","quicktasker"))}})),renderItem:e=>(0,n.jsx)(Ni,{log:e}),noDataMessage:(0,o.__)("No logs available","quicktasker")})}var Pd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Rd({userId:e}){return(0,n.jsx)(Mi,{typeId:e,fetchData:()=>Pd(this,void 0,void 0,(function*(){try{return(yield Bt(e,Kt.QUICKTASKER,!0)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load private comments","quicktasker"))}})),onAdd:t=>Pd(this,void 0,void 0,(function*(){try{return(yield Ht(e,Kt.QUICKTASKER,!0,t)).data.newComment}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add private comment","quicktasker"))}})),renderItem:e=>(0,n.jsx)(Fi,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),enableAdd:!0})}var Ld=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Md({userId:e}){const{addComment:t}=Gi();return(0,n.jsx)(Mi,{typeId:e,fetchData:()=>Ld(this,void 0,void 0,(function*(){try{return(yield Bt(e,Kt.QUICKTASKER,!1)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load comments","quicktasker"))}})),onAdd:s=>Ld(this,void 0,void 0,(function*(){const a=yield t(e,Kt.QUICKTASKER,!1,s);if(a)return a})),renderItem:e=>(0,n.jsx)(Fi,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),enableAdd:!0})}function Ud({user:e}){const t=[(0,o.__)("Logs","quicktasker"),(0,o.__)("Private comments","quicktasker"),(0,o.__)("Public comments","quicktasker")];return(0,n.jsx)(Ti,{tabs:t,tabsContent:[(0,n.jsx)(Dd,{userId:e.id},3),(0,n.jsx)(Rd,{userId:e.id},1),(0,n.jsx)(Md,{userId:e.id},2)]})}var Fd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Kd=({onEditUserCompleted:e})=>{const{state:{userToEdit:t},modalDispatch:s}=(0,a.useContext)(Ks),{state:{isUserAllowedToDelete:i}}=(0,a.useContext)(nn),[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),{changeUserStatus:u,deleteUser:p,resetUserPassword:h,editUser:m}=ld(),{userDispatch:w}=(0,a.useContext)(Ga),{loading1:f,setLoading1:k,loading2:q,setLoading2:x,loading3:_,setLoading3:g}=tn();return(0,a.useEffect)((()=>{t&&(c(t.is_active),d(t.has_password))}),[t]),t?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,n.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-6",children:[(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-10 md:wpqt-grid-cols-[1fr_0.7fr]",children:[(0,n.jsx)("div",{children:(0,n.jsxs)(oa,{children:[(0,n.jsx)(ra,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(dn,{isAutoFocus:!0,value:t.name,wrapperClassName:"wpqt-w-full",className:"wpqt-w-full",onChange:s=>Fd(void 0,void 0,void 0,(function*(){const{success:a,user:n}=yield m(t.id,{name:s});a&&n&&e(n)}))})}),(0,n.jsx)(ra,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(mn,{value:t.description,className:"wpqt-w-full",onChange:s=>Fd(void 0,void 0,void 0,(function*(){const{success:a,user:n}=yield m(t.id,{description:s});a&&n&&e(n)}))})})]})}),(0,n.jsx)(ei,{entityId:t.id,entityType:cn.QUICKTASKER})]}),(0,n.jsx)("div",{className:"wpqt-mt-7",children:(0,n.jsx)(Ud,{user:t})})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,n.jsx)(la,{icon:(0,n.jsx)(pd.A,{className:"wpqt-icon-blue wpqt-size-4"}),text:(0,o.__)("User details","quicktasker"),onClick:()=>{window.location.hash=`#/users/${t.id}`,s({type:H})}}),(0,n.jsx)(la,{icon:(0,n.jsx)(il.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${t.id}/tasks`,s({type:H})}}),l&&(0,n.jsx)(la,{icon:(0,n.jsx)(rd.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Reset password","quicktasker"),loading:f,onClick:()=>Fd(void 0,void 0,void 0,(function*(){k(!0),yield h(t.id,(()=>{w({type:Me,payload:t.id}),d(!1)})),k(!1)}))}),!r&&(0,n.jsx)(la,{icon:(0,n.jsx)(od.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:q,onClick:()=>Fd(void 0,void 0,void 0,(function*(){x(!0),yield u(t.id,!0,(e=>{w({type:Pe,payload:Object.assign({},e)}),c(!0)})),x(!1)}))}),r&&(0,n.jsx)(la,{icon:(0,n.jsx)(od.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:q,onClick:()=>Fd(void 0,void 0,void 0,(function*(){x(!0),yield u(t.id,!1,(e=>{w({type:Pe,payload:Object.assign({},e)}),c(!1)})),x(!1)}))}),i&&(0,n.jsx)(ti,{confirmMessage:(0,o.__)("Are you sure you want to delete this user?","quicktasker"),onConfirm:()=>Fd(void 0,void 0,void 0,(function*(){g(!0),yield p(t.id,(e=>{w({type:Re,payload:e}),s({type:H})})),g(!1)})),containerClassName:"wpqt-flex",children:({onClick:e})=>(0,n.jsx)(la,{icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete user","quicktasker"),loading:_,onClick:e,className:"wpqt-w-full"})})]})]})}):null};function $d(){const{state:{userModalOpen:e}}=(0,a.useContext)(Ks),{closeModal:t,handleSuccess:s}=Ha(H);return(0,n.jsx)(na,{modalOpen:e,closeModal:t,size:"xl",children:(0,n.jsx)(Kd,{onEditUserCompleted:e=>{s(Pe,e,Ba.USER)}})})}function zd(){const{state:{userSettingsModalOpen:e},modalDispatch:t}=(0,a.useContext)(Ks);return(0,n.jsx)(na,{modalOpen:e,closeModal:()=>t({type:J,payload:!1}),size:"md",children:(0,n.jsx)("div",{children:(0,n.jsx)(ei,{entityId:"null",entityType:cn.Users})})})}var Gd=s(8316),Vd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Bd(){const[e,t]=(0,a.useState)(!1),[s,r]=(0,a.useState)(""),[c,l]=(0,a.useState)(""),{userDispatch:d}=(0,a.useContext)(Ga),{createUser:u}=ld(),p=()=>{r(""),l(""),t(!1)};return(0,n.jsx)("div",{className:"wpqt-mb-6",children:e?(0,n.jsxs)("div",{className:"wpqt-w-1/4",children:[(0,n.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User name","quicktasker")}),(0,n.jsx)(Ra,{value:s,onChange:r,className:"wpqt-w-full"}),(0,n.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User description","quicktasker")}),(0,n.jsx)(hn,{value:c,onChange:l,className:"wpqt-w-full"}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,n.jsx)(la,{text:(0,o.__)("Cancel","quicktasker"),onClick:p,icon:(0,n.jsx)(Qs.A,{className:"wpqt-icon-red wpqt-size-5"})}),(0,n.jsx)(la,{text:(0,o.__)("Add","quicktasker"),onClick:()=>Vd(this,void 0,void 0,(function*(){s?yield u(s,c,(e=>{d({type:Ie,payload:e}),p()})):i.oR.error("User name is required")})),icon:(0,n.jsx)(Gd.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]}):(0,n.jsx)(la,{text:(0,o.__)("Add QuickTasker","quicktasker"),onClick:()=>t(!0),icon:(0,n.jsx)(Gd.A,{className:"wpqt-icon-green wpqt-size-5"})})})}const Hd=()=>{const{state:{usersSearchValue:e}}=(0,a.useContext)(Ga);return{filterUsers:t=>t.name.toLowerCase().includes(e.toLowerCase())||t.description&&t.description.toLowerCase().includes(e.toLowerCase())}};var Wd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Qd({user:e}){const{modalDispatch:t}=(0,a.useContext)(Ks),{userDispatch:s}=(0,a.useContext)(Ga),{changeUserStatus:i,deleteUser:r,resetUserPassword:c}=ld(),[l,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1),w=e.is_active,f=t=>Wd(this,void 0,void 0,(function*(){m(!0),yield i(e.id,t,(()=>{s({type:Le,payload:{userId:e.id,isActive:t}})})),m(!1)}));return(0,n.jsxs)(ii,{menuBtn:({active:e})=>(0,n.jsx)(oi,{isActive:e,IconComponent:yo.A}),children:[(0,n.jsx)(ri,{text:(0,o.__)("User details","quicktasker"),icon:(0,n.jsx)(pd.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,n.jsx)(ri,{text:(0,o.__)("User tasks","quicktasker"),icon:(0,n.jsx)(il.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}/tasks`}}),(0,n.jsx)(ri,{text:(0,o.__)("Edit user","quicktasker"),icon:(0,n.jsx)(pi.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:W,payload:e})}}),e.has_password&&(0,n.jsx)(ri,{text:(0,o.__)("Reset password","quicktasker"),loading:l,icon:(0,n.jsx)(rd.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Wd(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield c(e.id,(()=>{s({type:Me,payload:e.id})})),d(!1)}))}),w&&(0,n.jsx)(ri,{text:(0,o.__)("Disable user","quicktasker"),loading:h,icon:(0,n.jsx)(od.A,{className:"wpqt-icon-red wpqt-size-4"}),className:"!wpqt-mb-0",onClick:e=>{e.stopPropagation(),f(!1)}}),!w&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ri,{text:(0,o.__)("Activate user","quicktasker"),loading:h,icon:(0,n.jsx)(od.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:e=>{e.stopPropagation(),f(!0)}}),(0,n.jsx)(ri,{text:(0,o.__)("Delete user","quicktasker"),loading:u,icon:(0,n.jsx)(Za.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Wd(this,void 0,void 0,(function*(){t.stopPropagation(),p(!0),yield r(e.id,(e=>{s({type:Re,payload:e})})),p(!1)}))})]})]})}function Yd({user:e}){const{userPage:t}=nd(),{modalDispatch:s}=(0,a.useContext)(Ks),i=e.is_active,r=t+"&code="+e.page_hash;return(0,n.jsxs)(go,{title:e.name,description:e.description,dropdown:(0,n.jsx)(Qd,{user:e}),onClick:()=>{s({type:W,payload:e})},className:"wpqt-cursor-pointer",children:[(0,n.jsx)(bo,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("Open user page","quicktasker"),icon:(0,n.jsx)(Eo.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:e=>{e.stopPropagation(),window.open(r,"_blank")}}),(0,n.jsx)(bo,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("View user details","quicktasker"),icon:(0,n.jsx)(Eo.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,n.jsx)(bo,{label:(0,o.__)("Status","quicktasker"),value:i?(0,o.__)("Active","quicktasker"):(0,o.__)("Disabled","quicktasker"),valueClassName:i?"wpqt-text-qtTextGreen wpqt-font-bold":"wpqt-text-qtTextRed wpqt-font-bold",icon:(0,n.jsx)(od.A,{className:"wpqt-size-5 "+(i?"wpqt-icon-green":"wpqt-icon-red")})})]})}function Jd(){const{state:{users:e}}=(0,a.useContext)(Ga),{filterUsers:t}=Hd(),s=e.filter(t);return e&&0===e.length?(0,n.jsx)(qo,{text:(0,o.__)("No users found","quicktasker")}):s&&0===s.length?(0,n.jsx)(qo,{}):(0,n.jsx)("div",{className:"wpqt-card-grid",children:s.map((e=>(0,n.jsx)(Yd,{user:e},e.id)))})}function Xd(){return(0,n.jsxs)("div",{children:[(0,n.jsx)(Bd,{}),(0,n.jsx)(Cd,{}),(0,n.jsx)(Jd,{}),(0,n.jsx)(zd,{}),(0,n.jsx)($d,{})]})}var Zd=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};var eu=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function tu({user:e}){const[t,s]=(0,a.useState)({quicktasker_admin_role:"quicktasker_admin_role"in e.allcaps,quicktasker_admin_role_allow_delete:"quicktasker_admin_role_allow_delete"in e.allcaps,quicktasker_admin_role_manage_users:"quicktasker_admin_role_manage_users"in e.allcaps,quicktasker_admin_role_manage_settings:"quicktasker_admin_role_manage_settings"in e.allcaps,quicktasker_admin_role_manage_archive:"quicktasker_admin_role_manage_archive"in e.allcaps,quicktasker_access_user_page_app:"quicktasker_access_user_page_app"in e.allcaps}),[i,r]=(0,a.useState)(!1),{updateWPUserCapabilities:c}=function(){return{updateWPUserCapabilities:(e,t,s,a)=>Zd(this,void 0,void 0,(function*(){try{yield function(e,t){return zt()({path:`/wpqt/v1/wp-users/${e}/capabilities`,method:"PATCH",data:{quicktasker_admin_role:t.quicktasker_admin_role,quicktasker_admin_role_allow_delete:t.quicktasker_admin_role_allow_delete,quicktasker_admin_role_manage_users:t.quicktasker_admin_role_manage_users,quicktasker_admin_role_manage_settings:t.quicktasker_admin_role_manage_settings,quicktasker_admin_role_manage_archive:t.quicktasker_admin_role_manage_archive,quicktasker_access_user_page_app:t.quicktasker_access_user_page_app},headers:Gt()})}(e,t),s&&s()}catch(e){a&&a(e)}}))}}(),l=(a,n)=>eu(this,void 0,void 0,(function*(){if(i)return;r(!0);const o=Object.assign({},t),l=Object.assign(Object.assign({},t),{[n]:a});s(l),yield c(e.id,l,(()=>{}),(()=>{s(o)})),r(!1)}));return(0,n.jsxs)(go,{title:e.name,description:e.description,children:[(0,n.jsx)(bo,{label:(0,o.__)("Role","quicktasker"),value:Array.isArray(e.roles)?e.roles.join(", "):""}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to admin areas","quicktasker")}),(0,n.jsx)(co,{checked:t.quicktasker_admin_role,handleChange:e=>{l(e,"quicktasker_admin_role")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to users page","quicktasker")}),(0,n.jsx)(co,{checked:t.quicktasker_admin_role_manage_users,handleChange:e=>{l(e,"quicktasker_admin_role_manage_users")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to settings page","quicktasker")}),(0,n.jsx)(co,{checked:t.quicktasker_admin_role_manage_settings,handleChange:e=>{l(e,"quicktasker_admin_role_manage_settings")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to archive page","quicktasker")}),(0,n.jsx)(co,{checked:t.quicktasker_admin_role_manage_archive,handleChange:e=>{l(e,"quicktasker_admin_role_manage_archive")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Allow to delete resources","quicktasker")}),(0,n.jsx)(co,{checked:t.quicktasker_admin_role_allow_delete,handleChange:e=>{l(e,"quicktasker_admin_role_allow_delete")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Allow access to user page app","quicktasker")}),(0,n.jsx)(co,{checked:t.quicktasker_access_user_page_app,handleChange:e=>{l(e,"quicktasker_access_user_page_app")}})]}),i&&(0,n.jsx)(ea,{ovalSize:"24"})]})}var su=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function au(){const[e,t]=(0,a.useState)(null),[s,i]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(()=>{su(this,void 0,void 0,(function*(){try{i(!0);const s=yield(e=Os.Other,zt()({path:`/wpqt/v1/wp-users?type=${encodeURIComponent(e)}`,method:"GET",headers:Gt()}));t(s.data)}catch(e){console.error(e)}finally{i(!1)}var e}))})()}),[]),s||null===e?(0,n.jsx)(ea,{ovalSize:"48"}):0===e.length?(0,n.jsx)(qo,{text:(0,o.__)("No non-admin WordPress users found","quicktasker")}):(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Displaying non-admin WordPress users.","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-card-grid",children:e.map((e=>(0,n.jsx)(tu,{user:e},e.id)))})]})}function nu(){const{updateUsers:e}=(0,a.useContext)(Ga),{loadingDispatch:t}=(0,a.useContext)(fs),{modalDispatch:s}=(0,a.useContext)(Ks),i=[(0,n.jsx)(Xd,{},0),(0,n.jsx)(au,{},1)];return(0,a.useEffect)((()=>{(()=>{var s,a,n,i;s=this,a=void 0,i=function*(){t({type:Ke,payload:!0}),yield e(),t({type:Ke,payload:!1})},new((n=void 0)||(n=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function r(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(s,a||[])).next())}))})()}),[]),(0,n.jsxs)(Na,{children:[(0,n.jsx)(d,{description:(0,o.__)("Manage QuickTaskers and WordPress users. This plugin supports three types of users: WordPress admins, other WordPress users, and QuickTaskers. WordPress admins have full access to all admin areas. Other WordPress users do not have any access by default but can be granted if needed. QuickTaskers are separate users who do not have admin access but can manage tasks through a mobile-friendly webpage.","quicktasker"),icon:(0,n.jsx)(l.A,{className:"wpqt-icon-gray wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{s({type:J,payload:!0})}}),children:(0,o.__)("Users","quicktasker")}),(0,n.jsx)(Ti,{tabs:["QuickTaskers","WordPress users"],tabsContent:i,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}const iu=(e,t)=>{switch(t.type){case Be:{const s=t.payload.map(ds);return Object.assign(Object.assign({},e),{tasks:s})}case We:{const s=t.payload;return Object.assign(Object.assign({},e),{tasks:e.tasks.filter((e=>e.id!==s))})}case Qe:{const s=t.payload,a=e.tasks.map((e=>e.id===s.id?ds(s):e));return Object.assign(Object.assign({},e),{tasks:a})}case He:{const s=t.payload;return Object.assign(Object.assign({},e),{searchValue:s})}case Ye:{const s=t.payload;return Object.assign(Object.assign({},e),{filteredPipelineId:s})}case Je:{const{taskId:s,user:a}=t.payload,n=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Xt(a)?[a,...e.assigned_users]:e.assigned_users,assigned_wp_users:Zt(a)?[a,...e.assigned_wp_users]:e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{tasks:n})}case Xe:{const{taskId:s,user:a}=t.payload,n=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Xt(a)?e.assigned_users.filter((e=>e.id!==a.id)):e.assigned_users,assigned_wp_users:Zt(a)?e.assigned_wp_users.filter((e=>e.id!==a.id)):e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{tasks:n})}case Ze:{const{taskId:s,done:a}=t.payload,n=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:a}):e));return Object.assign(Object.assign({},e),{tasks:n})}default:return e}};var ou=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const ru={tasks:[],searchValue:"",filteredPipelineId:""},cu=(0,a.createContext)({state:ru,userTasksDispatch:()=>{},fetchAndSetUserTasks:()=>ou(void 0,void 0,void 0,(function*(){}))}),lu=({children:e,userId:t})=>{const[s,r]=(0,a.useReducer)(iu,ru),{loadingDispatch:c}=(0,a.useContext)(fs);(0,a.useEffect)((()=>{l()}),[]);const l=()=>ou(void 0,void 0,void 0,(function*(){try{c({type:Ke,payload:!0});const e=yield function(e){return zt()({path:`/wpqt/v1/users/${e}/tasks`,method:"GET",headers:Gt()})}(t);r({type:Be,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user tasks","quicktasker"))}finally{c({type:Ke,payload:!1})}}));return(0,n.jsx)(cu.Provider,{value:{state:s,userTasksDispatch:r,fetchAndSetUserTasks:l},children:e})};function du(){const{state:{searchValue:e,filteredPipelineId:t},userTasksDispatch:s}=(0,a.useContext)(cu);return(0,n.jsx)(Ma,{title:(0,o.__)("Filter tasks","quicktasker"),searchChildren:(0,n.jsx)(Ua,{title:(0,o.__)("Search","quicktasker"),labelIdFor:"user-tasks-search",children:(0,n.jsx)(Ra,{inputId:"user-tasks-search",value:e,onChange:e=>{s({type:He,payload:e})},className:"!wpqt-mb-0"})}),children:(0,n.jsx)(Ua,{title:(0,o.__)("Board","quicktasker"),children:(0,n.jsx)(La,{selectedOptionValue:t,selectionChange:e=>{s({type:Ye,payload:e})}})})})}var uu=s(7028),pu=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function hu({taskId:e,onUnAssignTask:t}){const[s,i]=(0,a.useState)(!1);return(0,n.jsx)(ii,{menuBtn:({active:e})=>(0,n.jsx)(oi,{isActive:e,IconComponent:yo.A}),children:(0,n.jsx)(ri,{text:(0,o.__)("Unassign from task","quicktasker"),loading:s,icon:(0,n.jsx)(uu.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:s=>pu(this,void 0,void 0,(function*(){s.stopPropagation(),i(!0),yield t(e),i(!1)})),className:"!wpqt-mb-0"})})}const mu=()=>{const{state:{searchValue:e,filteredPipelineId:t}}=(0,a.useContext)(cu);return{filterTasks:s=>{const a=s.name&&s.name.toLowerCase().includes(e.toLowerCase())||s.description&&s.description.toLowerCase().includes(e.toLowerCase()),n=!t||s.pipeline_id===t;return a&&n}}};var wu=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function fu({userId:e}){var t;const{filterTasks:s}=mu(),{modalDispatch:i}=(0,a.useContext)(Ks),{state:{tasks:r},userTasksDispatch:c}=(0,a.useContext)(cu),{removeTaskFromUser:l}=ys(),d=null!==(t=null==r?void 0:r.filter(s))&&void 0!==t?t:[],u=t=>wu(this,void 0,void 0,(function*(){yield l(e,t,(()=>{c({type:We,payload:t})}))}));return r&&0===r.length?(0,n.jsx)(qo,{text:(0,o.__)("User has no tasks","quicktasker")}):d&&0===d.length?(0,n.jsx)(qo,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-card-grid",children:d.map((e=>(0,n.jsxs)(go,{className:"wpqt-cursor-pointer",title:e.name,description:e.description,dropdown:(0,n.jsx)(hu,{taskId:e.id,onUnAssignTask:u}),onClick:()=>{i({type:U,payload:{taskToEdit:e}})},children:[(0,n.jsx)("div",{className:"wpqt-mt-2 wpqt-mb-2 wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-items-start",children:(0,n.jsx)(yi,{task:e,onUserAdd:t=>{c({type:Je,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{c({type:Xe,payload:{taskId:e.id,user:t}})}})}),(0,n.jsx)(jo,{task:e,onDoneStatusChange:(e,t)=>{c({type:Ze,payload:{taskId:e,done:t}})}})]},e.id)))}),(0,n.jsx)(ko,{editTaskCallback:e=>{c({type:Qe,payload:e})}})]})}function ku({userId:e}){return(0,n.jsx)(lu,{userId:e,children:(0,n.jsxs)(Na,{children:[(0,n.jsx)(d,{description:(0,o.__)("Tasks assigned to user","quicktasker"),children:(0,o.__)("User tasks","quicktasker")}),(0,n.jsx)(du,{}),(0,n.jsx)(fu,{userId:e})]})})}const qu=()=>{const{page:e,hash:t}=xu();if("wp-quick-tasks"===e){const e=t.match(/^#\/users\/(\d+)\/tasks$/);if(e){const t=e[1];return(0,n.jsx)(ku,{userId:t})}const s=t.match(/^#\/users\/(\d+)$/);if(s){const e=s[1];return(0,n.jsx)(qd,{userId:e})}const a=t.match(/^#\/board\/(\d+)\/automations$/);if(a){const e=a[1];return(0,n.jsx)(br,{pipelineId:e})}switch(t){case"#/users":return(0,n.jsx)(nu,{});case"#/overview":return(0,n.jsx)(Qr,{});case"#/archive":return(0,n.jsx)(Co,{});case"#/user-sessions":return(0,n.jsx)(Od,{});case"#/logs":return(0,n.jsx)(Rr,{});case"#/settings":return(0,n.jsx)(ad,{});case"#/guide":return(0,n.jsx)(yr,{});case"#/user-page-link":return(0,n.jsx)(id,{});default:return(0,n.jsx)(kl,{})}}},xu=()=>({page:new URLSearchParams(window.location.search).get("page"),hash:window.location.hash}),_u=function(){const e=(()=>{const[e,t]=(0,a.useState)(qu());return(0,a.useEffect)((()=>{const e=()=>{t(qu()),(()=>{const{page:e,hash:t}=xu();if("wp-quick-tasks"!==e)return;const s=document.querySelectorAll("#toplevel_page_wp-quick-tasks .wp-submenu li");s.forEach((e=>e.classList.remove("wpqt-current")));const a={"#/users":"#/users","#/overview":"#/overview","#/archive":"#/archive","#/user-sessions":"#/user-sessions","#/user-page-link":"#/user-page-link","#/logs":"#/logs","#/settings":"#/settings","#/guide":"#/guide",default:""};let n=a.default;void 0!==a[t]?n=a[t]:/^#\/users(\/\d+)?(\/tasks)?$/.test(t)&&(n="#/users"),s.forEach((e=>{const t=e.querySelector("a");t&&t.getAttribute("href")&&t.getAttribute("href")===`admin.php?page=wp-quick-tasks${n}`&&e.classList.add("wpqt-current")}))})()};return e(),window.addEventListener("popstate",e),window.addEventListener("hashchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("hashchange",e)}}),[]),e})();return(0,n.jsx)(c,{children:(0,n.jsx)(on,{children:(0,n.jsx)(Va,{children:(0,n.jsx)($s,{children:(0,n.jsx)(qa,{children:(0,n.jsxs)(ks,{children:[e,(0,n.jsx)(i.N9,{position:"bottom-right",className:"wpqt-z-[999999]"})]})})})})})})};(0,a.render)((0,n.jsx)(_u,{}),document.getElementById("wpqt-app"))},1609:e=>{e.exports=window.React},5795:e=>{e.exports=window.ReactDOM},790:e=>{e.exports=window.ReactJSXRuntime}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}};return a[e].call(s.exports,s,s.exports,i),s.exports}i.m=a,e=[],i.O=(t,s,a,n)=>{if(!s){var o=1/0;for(d=0;d<e.length;d++){for(var[s,a,n]=e[d],r=!0,c=0;c<s.length;c++)(!1&n||o>=n)&&Object.keys(i.O).every((e=>i.O[e](s[c])))?s.splice(c--,1):(r=!1,n<o&&(o=n));if(r){e.splice(d--,1);var l=a();void 0!==l&&(t=l)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,a,n]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var n=Object.create(null);i.r(n);var o={};t=t||[null,s({}),s([]),s(s)];for(var r=2&a&&e;"object"==typeof r&&!~t.indexOf(r);r=s(r))Object.getOwnPropertyNames(r).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(n,o),n},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=524,(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");if(s.length)for(var a=s.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=s[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={524:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var a,n,[o,r,c]=s,l=0;if(o.some((t=>0!==e[t]))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(c)var d=c(i)}for(t&&t(s);l<o.length;l++)n=o[l],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(d)},s=globalThis.webpackChunkquicktasker=globalThis.webpackChunkquicktasker||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.nc=void 0;var o=i.O(void 0,[96],(()=>i(9623)));o=i.O(o)})();