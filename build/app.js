(()=>{"use strict";var e,t,s,n={313:(e,t,s)=>{const n=window.wp.element;var a=s(790),i=s(9571);const o=window.wp.i18n;class r extends n.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){var e;return this.state.hasError?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-h-screen wpqt-items-center wpqt-justify-center wpqt-text-center wpqt-text-lg",children:[(0,o.__)("Something went wrong. Please refresh the page.","quicktasker"),(0,a.jsx)("br",{}),null===(e=this.state.error)||void 0===e?void 0:e.message]}):this.props.children}}const c=r;function l({children:e,description:t=null,icon:s=null}){return(0,a.jsx)("div",{className:"wpqt-mb-6 wpqt-inline-grid wpqt-grid-cols-[auto_auto] wpqt-items-center wpqt-gap-2",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{children:[e,s&&(0,a.jsx)("span",{className:"wpqt-ml-1 wpqt-align-middle",children:s})]}),t&&(0,a.jsx)("div",{children:t})]})})}const d=window.wp.apiFetch;var u=s.n(d);function p(){return{"Content-Type":"application/json","X-WPQT-API-Nonce":window.wpqt.apiNonce}}function h(e,t,s){return u()({path:`/wpqt/v1/tasks/${e}/move`,method:"PATCH",data:{stageId:t,order:s},headers:p()})}function w(e,t,s){const n=new URLSearchParams({typeId:e,type:t,isPrivate:s.toString()}).toString();return u()({path:`/wpqt/v1/comments?${n}`,method:"GET",headers:p()})}function v(e,t,s,n){return u()({path:"/wpqt/v1/comments",data:{comment:n,typeId:e,type:t,isPrivate:s},method:"POST",headers:p()})}function m(e,t){const s=new URLSearchParams({typeId:e,type:t});return u()({path:`/wpqt/v1/logs?${s.toString()}`,method:"GET",headers:p()})}function q(e,t,s){return u()({path:`/wpqt/v1/users/${e}/tasks/${t}`,method:"DELETE",data:{user_type:s},headers:p()})}function x(e,t,s){const n=new URLSearchParams({entityId:e,entityType:t,active:String(s)});return u()({path:`/wpqt/v1/custom-fields?${n.toString()}`,method:"GET",headers:p()})}const f="SET_LOADING",g="SET_PIPELINE",k="MOVE_TASK",_="ADD_TASK",j="ADD_STAGE",y="DELETE_STAGE",b="EDIT_TASK",T="EDIT_STAGE",S="ADD_PIPELINE",C="EDIT_PIPELINE",A="SET_PRIMARY",N="SET_PIPELINES",O="ADD_USER_TO_TASK",E="REMOVE_USER_FROM_TASK",P="CHANGE_TASK_DONE_STATUS",I="REMOVE_PIPELINE",D="REMOVE_ACTIVE_PIPELINE",R="REMOVE_TASK",U="OPEN_EDIT_TASK_MODAL",L="CLOSE_TASK_MODAL",M="OPEN_NEW_STAGE_MODAL",F="CLOSE_STAGE_MODAL",z="OPEN_STAGE_EDIT_MODAL",$="OPEN_NEW_PIPELINE_MODAL",V="OPEN_EDIT_PIPELINE_MODAL",H="CLOSE_PIPELINE_EDIT_MODAL",K="CLOSE_USER_MODAL",G="OPEN_EDIT_USER_MODAL",B="ADD_ASSIGNED_USER_TO_EDITING_TASK",W="REMOVE_ASSIGNED_USER_FROM_EDITING_TASK",Q="CHANGE_USER_SETTINGS_MODAL_OPEN",Y="OPEN_MOVE_TASK_MODAL",X="CLOSE_MOVE_TASK_MODAL",J="SET_ARCHIVE_TASKS",Z="SET_ARCHIVE_SEARCH_VALUE",ee="SET_ARCHIVE_FILTERED_PIPELINE",te="REMOVE_ARCHIVED_TASK",se="ADD_ASSIGNED_USER_TO_ARCHIVED_TASK",ne="REMOVE_ASSINGED_USER_FROM_ARCHIVED_TASK",ae="CHANGE_ARCHIVED_TASK_DONE_STATUS",ie="EDIT_ARCHIVED_TASK",oe="CHANGE_ARCHIVE_TASK_DONE_FILTER",re="SET_USERS",ce="SET_WP_USERS",le="ADD_USER",de="SET_USERS_SEARCH_VALUE",ue="EDIT_USER",pe="DELETE_USER",he="CHANGE_USER_STATUS",we="RESET_PASSWORD",ve="INIT_APP_STATE",me="SET_CUSTOM_USER_PAGE_STYLES",qe="SET_FULL_PAGE_LOADING",xe="SET_USER_SESSIONS_SEARCH_VALUE",fe="SET_USER_SESSIONS",ge="CHANGE_USER_SESSION_STATUS",ke="DELETE_USER_SESSION",_e="SET_USER_TASKS",je="SET_USER_TASKS_SEARCH_VALUE",ye="REMOVE_USER_TASK",be="EDIT_USER_TASK",Te="SET_USER_TASKS_FILTERED_PIPELINE",Se="ADD_ASSIGNED_USER_TO_USER_TASK",Ce="REMOVE_ASSIGNED_USER_FROM_USER_TASK",Ae="CHANGE_USER_TASK_DONE_STATUS",Ne="SET_CUSTOM_FIELDS",Oe="ADD_CUSTOM_FIELD",Ee="DELETE_CUSTOM_FIELD",Pe="SET_CUSTOM_FIELD_LOADING",Ie="SET_CUSTOM_FIELD_INITIAL_DATA",De="SET_PIPELINE_AUTOMATIONS",Re="SET_PIPELINE_AUTOMATIONS_LOADING",Ue="REMOVE_PIPELINE_AUTOMATION",Le="ADD_PIPELINE_AUTOMATION",Me=!1;var Fe,ze,$e,Ve,He;function Ke(e){return!e.user_type||e.user_type===Fe.QUICKTASKER}function Ge(e){return e.user_type===Fe.WP_USER}!function(e){e.QUICKTASKER="quicktasker",e.WP_USER="wp-user"}(Fe||(Fe={})),function(e){e.TASK_DONE="task-done",e.Task_NOT_DONE="task-not-done",e.TASK_CREATED="task-created"}(ze||(ze={})),function(e){e.PIPELINE="pipeline",e.Stage="stage",e.Task="task",e.quicktasker="quicktasker"}($e||($e={})),function(e){e.PIPELINE="pipeline",e.STAGE="stage",e.TASK="task",e.QUICKTASKER="quicktasker",e.WP_USER="wp-user"}(Ve||(Ve={})),function(e){e.ARCHIVE_TASK="archive-task",e.ASSIGN_USER="assign-user",e.NEW_ENTITY_EMAIL="new-entity-email"}(He||(He={}));const Be=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active,has_password:"1"===e.has_password}),We=e=>{switch(e){case Ve.QUICKTASKER:return Fe.QUICKTASKER;case Ve.WP_USER:return Fe.WP_USER;default:return null}},Qe=e=>Object.assign(Object.assign({},e),{task_order:Number(e.task_order),free_for_all:"1"===e.free_for_all,is_archived:"1"===e.is_archived,is_done:"1"===e.is_done,assigned_users:e.assigned_users?e.assigned_users.map((e=>Object.assign({},Be(e)))):[]}),Ye=(e,t)=>{var s,n,a,i,o;switch(t.type){case J:{const s=t.payload;return Object.assign(Object.assign({},e),{archivedTasks:s.map(Qe)})}case Z:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveSearchValue:s})}case ee:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveFilteredPipelineId:s})}case te:{const n=(null!==(s=e.archivedTasks)&&void 0!==s?s:[]).filter((e=>e.id!==t.payload));return Object.assign(Object.assign({},e),{archivedTasks:n})}case se:{const{taskId:s,user:a}=t.payload,i=(null!==(n=e.archivedTasks)&&void 0!==n?n:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Ke(a)?[a,...e.assigned_users]:e.assigned_users,assigned_wp_users:Ge(a)?[a,...e.assigned_wp_users]:e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case ne:{const{taskId:s,user:n}=t.payload,i=(null!==(a=e.archivedTasks)&&void 0!==a?a:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Ke(n)?e.assigned_users.filter((e=>e.id!==n.id)):e.assigned_users,assigned_wp_users:Ge(n)?e.assigned_wp_users.filter((e=>e.id!==n.id)):e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case ae:{const{taskId:s,done:n}=t.payload,a=(null!==(i=e.archivedTasks)&&void 0!==i?i:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{archivedTasks:a})}case ie:{const s=t.payload,n=(null!==(o=e.archivedTasks)&&void 0!==o?o:[]).map((e=>e.id===s.id?Qe(s):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case oe:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskDoneFilter:s})}default:return e}};var Xe,Je,Ze,et;!function(e){e.Task="task",e.User="user"}(Xe||(Xe={})),function(e){e.System="system",e.Admin="admin",e.WPQTUser="quicktasker_user",e.Automation="automation"}(Je||(Je={})),function(e){e.All="all",e.Completed="completed",e.NotCompleted="not completed"}(Ze||(Ze={})),function(e){e.Admin="administrator",e.Other="other"}(et||(et={}));const tt=(e,t)=>{if(t.type===qe){const s=t.payload;return Object.assign(Object.assign({},e),{fullPageLoading:s})}return e},st={fullPageLoading:!1},nt=(0,n.createContext)({state:st,loadingDispatch:()=>{}}),at=({children:e})=>{const[t,s]=(0,n.useReducer)(tt,st);return(0,a.jsx)(nt.Provider,{value:{state:t,loadingDispatch:s},children:e})};const it={archivedTasks:null,archiveLoading:!1,archiveSearchValue:"",archiveFilteredPipelineId:"",archiveTaskDoneFilter:Ze.All},ot=(0,n.createContext)({state:it,archiveDispatch:()=>{}}),rt=({children:e})=>{const[t,s]=(0,n.useReducer)(Ye,it),{loadingDispatch:r}=(0,n.useContext)(nt);(0,n.useEffect)((()=>{c()}),[]);const c=()=>{return e=void 0,t=void 0,a=function*(){try{r({type:qe,payload:!0});const{data:e}=yield u()({path:"/wpqt/v1/tasks/archived",method:"GET",headers:p()});s({type:J,payload:e})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch archived tasks","quicktasker"))}finally{r({type:qe,payload:!1})}},new((n=void 0)||(n=Promise))((function(s,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}));var e,t,n,a};return(0,a.jsx)(ot.Provider,{value:{state:t,archiveDispatch:s},children:e})};var ct=s(6061);function lt({width:e="80",height:t="80",className:s="",color:n="#1d4ed8",secondaryColor:i="#2563eb"}){return(0,a.jsx)(ct.BM,{visible:!0,height:t,width:e,color:n,secondaryColor:i,ariaLabel:"oval-loading",wrapperStyle:{},wrapperClass:s})}function dt(){return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-flex-col wpqt-items-center wpqt-justify-center",children:(0,a.jsx)(lt,{})})}function ut({className:e,ovalSize:t}){const s=t?{width:t,height:t}:{};return(0,a.jsx)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center ${e}`,children:(0,a.jsx)(lt,Object.assign({},s))})}function pt({children:e}){const{state:{fullPageLoading:t}}=(0,n.useContext)(nt);return(0,a.jsx)("div",{className:"wpqt-pr-4",children:t?(0,a.jsx)(dt,{}):e})}var ht=s(2912);const wt=e=>Object.assign(Object.assign({},e),{allow_only_last_stage_task_done:"1"===e.allow_only_last_stage_task_done}),vt=e=>Object.assign(Object.assign({},e),{stage_order:Number(e.stage_order),tasks:(e.tasks||[]).map((e=>Object.assign({},Qe(e))))}),mt=(e,t)=>{var s;switch(t.type){case N:{const s=t.payload,n=e=>Object.assign({},vt(e)),a=e=>{var t;return Object.assign(Object.assign({},e),{stages:null===(t=e.stages)||void 0===t?void 0:t.map(n),settings:e.settings?wt(e.settings):void 0,is_primary:"1"===e.is_primary})};return Object.assign(Object.assign({},e),{pipelines:s.map(a)})}case S:{const n=t.payload,a=e=>Object.assign({},vt(e)),i=Object.assign(Object.assign({},n),{stages:null===(s=n.stages)||void 0===s?void 0:s.map(a),settings:n.settings?wt(n.settings):void 0,is_primary:!1});return Object.assign(Object.assign({},e),{pipelines:[...e.pipelines,i]})}case A:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>Object.assign(Object.assign({},e),{is_primary:e.id===s})))})}case C:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>e.id===s.id?s:e))})}case I:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.filter((e=>e.id!==s))})}default:return e}},qt={pipelines:[]},xt=(0,n.createContext)({state:qt,pipelinesDispatch:()=>{}}),ft=({children:e})=>{const[t,s]=(0,n.useReducer)(mt,qt);return(0,n.useEffect)((()=>{const e=window.wpqt.initialPipelines;s({type:N,payload:e})}),[]),(0,a.jsx)(xt.Provider,{value:{state:t,pipelinesDispatch:s},children:e})};var gt=s(3482);function kt({options:e,selectedOptionValue:t,onSelectionChange:s,allSelector:n=!0,className:i="",id:o}){return(0,a.jsxs)(gt.l,{id:o,value:t,onChange:e=>{const t=e.target.value;s(t)},className:`!wpqt-rounded-lg !wpqt-border !wpqt-border-solid !wpqt-border-qtBorder !wpqt-px-2 !wpqt-pr-6 !wpqt-py-1 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`,children:[n&&(0,a.jsx)("option",{value:"",children:"All boards"}),e.map((e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value)))]})}function _t({selectedOptionValue:e,selectionChange:t,extraOptions:s=[]}){const{state:{pipelines:i}}=(0,n.useContext)(xt),o=(0,n.useMemo)((()=>i.map((e=>({value:e.id,label:e.name})))),[i]);return(0,a.jsx)(kt,{options:[...o,...s],selectedOptionValue:e,onSelectionChange:t})}function jt({children:e,title:t,childrenClassName:s="",titleClassName:n=""}){return(0,a.jsxs)("div",{className:"wpqt-mb-8",children:[(0,a.jsx)("div",{className:`wpqt-mb-2 wpqt-text-base ${n}`,children:t}),(0,a.jsx)("div",{className:`wpqt-flex wpqt-gap-2 wpqt-items-center ${s}`,children:e})]})}function yt(){const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s},archiveDispatch:i}=(0,n.useContext)(ot);return(0,a.jsxs)(jt,{title:(0,o.__)("Archive filtering","quicktasker"),children:[(0,a.jsx)(ht.p,{type:"text",value:e,onChange:e=>{i({type:Z,payload:e.target.value})}}),(0,a.jsx)(_t,{selectedOptionValue:t,selectionChange:e=>{i({type:ee,payload:e})},extraOptions:[{value:"DELETED",label:(0,o.__)("DELETED","quicktasker")}]}),(0,a.jsx)(kt,{allSelector:!1,selectedOptionValue:s,options:[{label:(0,o.__)("All status","quicktasker"),value:Ze.All},{label:(0,o.__)("Completed","quicktasker"),value:Ze.Completed},{label:(0,o.__)("Not completed","quicktasker"),value:Ze.NotCompleted}],onSelectionChange:e=>{const t=(e=>{switch(e){case Ze.All:return Ze.All;case Ze.Completed:return Ze.Completed;case Ze.NotCompleted:return Ze.NotCompleted;default:throw new Error(`Invalid selection: ${e}`)}})(e);i({type:oe,payload:t})}})]})}const bt=(e,t)=>{var s,n,a,i,o,r,c,l,d,u;switch(t.type){case f:return Object.assign(Object.assign({},e),{loading:t.payload});case g:{const s=t.payload,n=(s.stages||[]).map((e=>Object.assign({},vt(e)))),a=s.settings?wt(s.settings):void 0;return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},s),{stages:n,settings:a,is_primary:"1"===s.is_primary})})}case k:{if(!e.activePipeline||!e.activePipeline.stages)return e;const s=((e,t,s)=>{const n=[...e],a=n.find((e=>e.id===t.droppableId)),i=n.find((e=>e.id===s.droppableId));if((null==a?void 0:a.tasks)&&(null==i?void 0:i.tasks)){const[e]=a.tasks.splice(t.index,1);i.tasks.splice(s.index,0,e)}return n})(e.activePipeline.stages,t.payload.source,t.payload.destination);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:s})})}case"REORDER_TASK":{const{source:a,destination:i}=t.payload,o=i.droppableId,r=i.index;if(!e.activePipeline)return e;const c=null===(s=e.activePipeline.stages)||void 0===s?void 0:s.find((e=>e.id===o));if(!c||!c.tasks)return e;const l=((e,t,s)=>{const n=[...e],[a]=n.splice(t,1);return n.splice(s,0,a),n})(c.tasks,a.index,r),d=null===(n=e.activePipeline.stages)||void 0===n?void 0:n.map((e=>e.id===o?Object.assign(Object.assign({},e),{tasks:l}):e));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:d})})}case _:{const s=Qe(t.payload);return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(a=e.activePipeline.stages)||void 0===a?void 0:a.map((e=>e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:[...e.tasks||[],s]}):e))})}):e}case b:{const s=Qe(t.payload);if(!e.activePipeline)return e;const n=null===(i=e.activePipeline.stages)||void 0===i?void 0:i.map((e=>{var t;return e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s.id?s:e))}):e}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case j:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:[...e.activePipeline.stages||[],s]})}):e}case T:{const s=t.payload;if(!e.activePipeline)return e;const n=e=>e.id===s.id?Object.assign(Object.assign({},e),{name:s.name,description:s.description}):e,a=null===(o=e.activePipeline.stages)||void 0===o?void 0:o.map(n);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case y:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(r=e.activePipeline.stages)||void 0===r?void 0:r.filter((e=>e.id!==s))})}):e}case O:{const{taskId:s,user:n}=t.payload;if(!e.activePipeline)return e;const a=null===(c=e.activePipeline.stages)||void 0===c?void 0:c.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{if(e.id===s){const t=Ke(n)?[n,...e.assigned_users||[]]:e.assigned_users||[],s=Ge(n)?[n,...e.assigned_wp_users||[]]:e.assigned_wp_users||[];return Object.assign(Object.assign({},e),{assigned_users:t,assigned_wp_users:s})}return e}));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case E:{const{taskId:s,userId:n,userType:a}=t.payload;if(!e.activePipeline)return e;const i=null===(l=e.activePipeline.stages)||void 0===l?void 0:l.map((e=>{var t;const i=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{var t,i;return e.id===s?Object.assign(Object.assign({},e),{assigned_users:a===Fe.QUICKTASKER?null===(t=e.assigned_users)||void 0===t?void 0:t.filter((e=>e.id!==n)):e.assigned_users,assigned_wp_users:a===Fe.WP_USER?null===(i=e.assigned_wp_users)||void 0===i?void 0:i.filter((e=>e.id!==n)):e.assigned_wp_users}):e}));return Object.assign(Object.assign({},e),{tasks:i})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:i})})}case C:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{name:s.name,description:s.description,is_primary:"1"===s.is_primary})}):e}case P:{const{taskId:s,done:n}=t.payload;if(!e.activePipeline)return e;const a=null===(d=e.activePipeline.stages)||void 0===d?void 0:d.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case D:return Object.assign(Object.assign({},e),{activePipeline:null});case R:{const s=t.payload;if(!e.activePipeline)return e;const n=null===(u=e.activePipeline.stages)||void 0===u?void 0:u.map((e=>{var t;return Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.filter((e=>e.id!==s))})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}default:return e}};const Tt={loading:!1,activePipeline:null},St=(0,n.createContext)({state:Tt,dispatch:()=>{},fetchAndSetPipelineData:()=>Promise.resolve()}),Ct=({children:e})=>{const[t,s]=(0,n.useReducer)(bt,Tt),{loadingDispatch:r}=(0,n.useContext)(nt);(0,n.useEffect)((()=>{const e=window.wpqt.initialActivePipelineId;e&&l(e,!0)}),[]);const c=(e,t)=>{t?r({type:qe,payload:e}):s({type:f,payload:e})},l=(e,...t)=>{return n=void 0,a=[e,...t],l=function*(e,t=!1){try{c(!0,t);const{data:{pipeline:n}}=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,headers:p()})}(e);s({type:g,payload:n})}catch(e){console.error(e),i.oR.error((0,o.__)("Unable to load the board. Please try again later.","quicktasker"))}finally{c(!1,t)}},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,i)}o((l=l.apply(n,a||[])).next())}));var n,a,r,l};return(0,a.jsx)(St.Provider,{value:{state:t,dispatch:s,fetchAndSetPipelineData:l},children:e})};var At=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Nt={[He.ARCHIVE_TASK]:(0,o.__)("Task archived by automation","quicktasker"),[He.ASSIGN_USER]:(0,o.__)("User assigned by automation","quicktasker"),[He.NEW_ENTITY_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker")};function Ot(){const{dispatch:e}=(0,n.useContext)(St),t=e=>{e&&e.forEach((e=>{const t=Nt[e.automation_action]||`Automation executed: ${e.automation_action}`;i.oR.info(t)}))},s=(t,s)=>{t&&s&&t.forEach((t=>{if(t.automation_action===He.ARCHIVE_TASK&&e({type:R,payload:s}),t.automation_action===He.ASSIGN_USER){const a=t.executionResult;!a||!(n=a)||"object"!=typeof n||n.user_type&&n.user_type!==Fe.QUICKTASKER&&n.user_type!==Fe.WP_USER||e({type:O,payload:{taskId:s,user:a}})}var n}))};return{displayAutomationMessages:t,handleExecutedAnimationsResults:s,handleExecutedAutomations:(e,n)=>{0!==e.length&&(s(e,n),t(e))},createAutomation:(e,t,s)=>At(this,void 0,void 0,(function*(){try{const n=yield function(e,t){var s;return u()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"POST",data:{automationTargetId:null,automationTarget:t.automationTarget,automationTrigger:t.automationTrigger,automationAction:null===(s=t.automationAction)||void 0===s?void 0:s.id,automationActionTargetId:t.automationActionTargetId,automationActionTargetType:t.automationActionTargetType,automationMetadata:t.metaData},headers:p()})}(e,t);i.oR.success((0,o.__)("Automation created","quicktasker")),s&&s(!0,n.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create automation","quicktasker")),s&&s(!1,null)}})),deleteAutomation:(e,t,s)=>At(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/pipelines/${e}/automations/${t}`,method:"DELETE",headers:p()})}(e,t),i.oR.success((0,o.__)("Automation deleted","quicktasker")),s&&s(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete automation","quicktasker")),s&&s(!1)}}))}}var Et=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Pt=()=>{const{handleExecutedAutomations:e}=Ot(),{displayErrorMessages:t}=function(){return{displayErrorMessages:e=>{return t=this,s=void 0,a=function*(){if(e.messages&&Array.isArray(e.messages)&&e.messages.length>0){const t=e.messages.join(", ");i.oR.error(t)}},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a}}}();return{deleteTask:(e,t)=>Et(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}`,method:"DELETE",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task deleted","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a task","quicktasker"))}})),archiveTask:(e,t)=>Et(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task archived","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to archive a task","quicktasker"))}})),restoreArchivedTask:(e,t)=>Et(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive-restore`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task restored","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore a task","quicktasker"))}})),removeTaskFromUser:(e,t,s)=>Et(void 0,void 0,void 0,(function*(){try{yield q(e,t,Fe.QUICKTASKER),s&&s(),i.oR.success((0,o.__)("Task has been unassigned","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Task unassignment failed. Try again","quicktasker"))}})),changeTaskDoneStatus:(s,n,a)=>Et(void 0,void 0,void 0,(function*(){try{const t=n?(0,o.__)("Task marked as completed","quicktasker"):(0,o.__)("Task marked as incomplete","quicktasker"),r=yield function(e,t){return u()({path:`/wpqt/v1/tasks/${e}/done`,method:"PATCH",data:{done:t},headers:p()})}(s,n);a&&a(n),i.oR.success(t),e(r.data.executedAutomations,s)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change task status","quicktasker")),t(e)}})),moveTask:(e,t,s,n)=>Et(void 0,void 0,void 0,(function*(){try{yield h(e,t,s),i.oR.success((0,o.__)("Task moved","quicktasaker")),n&&n(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a task","quicktasker")),n&&n(!1)}}))}},It=()=>Object.assign({},Rt),Dt=(e,t)=>{var s,n,a,i,o,r,c,l,d,u,p,h,w,v,m,q;switch(t.type){case U:{const{taskToEdit:s,taskModalSettings:n}=t.payload;return Object.assign(Object.assign({},e),{taskModalOpen:!0,taskToEdit:s,targetStageId:s.stage_id,taskModalSettings:Object.assign(Object.assign({},e.taskModalSettings),n)})}case L:return It();case B:{const d=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:Ke(d)?[d,...null!==(n=null===(s=e.taskToEdit)||void 0===s?void 0:s.assigned_users)&&void 0!==n?n:[]]:null!==(i=null===(a=e.taskToEdit)||void 0===a?void 0:a.assigned_users)&&void 0!==i?i:[],assigned_wp_users:Ge(d)?[d,...null!==(r=null===(o=e.taskToEdit)||void 0===o?void 0:o.assigned_wp_users)&&void 0!==r?r:[]]:null!==(l=null===(c=e.taskToEdit)||void 0===c?void 0:c.assigned_wp_users)&&void 0!==l?l:[]})})}case W:{const s=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:Ke(s)?(null!==(u=null===(d=e.taskToEdit)||void 0===d?void 0:d.assigned_users)&&void 0!==u?u:[]).filter((e=>e.id!==s.id)):null!==(h=null===(p=e.taskToEdit)||void 0===p?void 0:p.assigned_users)&&void 0!==h?h:[],assigned_wp_users:Ge(s)?(null!==(v=null===(w=e.taskToEdit)||void 0===w?void 0:w.assigned_wp_users)&&void 0!==v?v:[]).filter((e=>e.id!==s.id)):null!==(q=null===(m=e.taskToEdit)||void 0===m?void 0:m.assigned_wp_users)&&void 0!==q?q:[]})})}case M:{const{targetPipelineId:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,targetPipelineId:s})}case z:{const{stageToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,stageToEdit:s})}case F:return It();case $:return Object.assign(Object.assign({},e),{newPipelineModalOpen:!0});case V:{const{pipelineToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{pipelineModalOpen:!0,pipelineToEdit:s})}case H:return It();case"OPEN_ARCHIVE_TASK_MODAL":{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskModalOpen:!0,archiveModalTask:s})}case"CLOSE_ARCHIVE_TASK_MODAL":return It();case"OPEN_NEW_USER_MODAL":return Object.assign(Object.assign({},e),{userModalOpen:!0});case G:{const s=t.payload;return Object.assign(Object.assign({},e),{userModalOpen:!0,userToEdit:s})}case K:return It();case Q:return t.payload?Object.assign(Object.assign({},e),{userSettingsModalOpen:!0}):It();case"CHANGE_TASK_DONE_STATUS":{const{done:s}=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{is_done:s})})}case Y:{const{task:s}=t.payload;return Object.assign(Object.assign({},e),{moveTaskModalOpen:!0,taskToEdit:s})}case X:return It();default:return e}},Rt={taskModalOpen:!1,targetStageId:"",taskToEdit:null,taskModalSettings:{allowToMarkTaskAsDone:!0},moveTaskModalOpen:!1,stageModalOpen:!1,stageToEdit:null,targetPipelineId:"",pipelineModalOpen:!1,newPipelineModalOpen:!1,pipelineToEdit:null,archiveTaskModalOpen:!1,archiveModalTask:null,userModalOpen:!1,userToEdit:null,userSettingsModalOpen:!1},Ut=(0,n.createContext)({state:Rt,modalDispatch:()=>{}}),Lt=({children:e})=>{const[t,s]=(0,n.useReducer)(Dt,Rt);return(0,a.jsx)(Ut.Provider,{value:{state:t,modalDispatch:s},children:e})},Mt=(e,t)=>{switch(t.type){case re:{const s=t.payload.map(Be);return Object.assign(Object.assign({},e),{users:s})}case ce:{const s=t.payload.map((e=>Object.assign(Object.assign({},e),{id:String(e.id)})));return Object.assign(Object.assign({},e),{wpUsers:s})}case le:{const s=t.payload,n=Be(s);return Object.assign(Object.assign({},e),{users:[...e.users,n]})}case ue:{const s=t.payload,n=Be(s),a=e.users.map((e=>e.id===n.id?n:e));return Object.assign(Object.assign({},e),{users:a})}case he:{const{isActive:s,userId:n}=t.payload,a=e.users.map((e=>e.id===n?Object.assign(Object.assign({},e),{is_active:s}):e));return Object.assign(Object.assign({},e),{users:a})}case we:{const s=t.payload,n=e.users.map((e=>e.id===s?Object.assign(Object.assign({},e),{has_password:!1}):e));return Object.assign(Object.assign({},e),{users:n})}case pe:{const s=t.payload,n=e.users.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{users:n})}case de:{const s=t.payload;return Object.assign(Object.assign({},e),{usersSearchValue:s})}default:return e}};var Ft=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const zt={users:[],wpUsers:[],usersSearchValue:""},$t=(0,n.createContext)({state:zt,userDispatch:()=>{},updateUsers:()=>Ft(void 0,void 0,void 0,(function*(){}))}),Vt=({children:e})=>{const[t,s]=(0,n.useReducer)(Mt,zt);return(0,n.useEffect)((()=>{const e=window.wpqt.initialUsers,t=window.wpqt.initialWPUsers;s({type:re,payload:e}),s({type:ce,payload:t})}),[]),(0,a.jsx)($t.Provider,{value:{state:t,userDispatch:s,updateUsers:()=>Ft(void 0,void 0,void 0,(function*(){try{const e=yield u()({path:"/wpqt/v1/users",method:"GET",headers:p()});s({type:re,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch users","quicktasker"))}}))},children:e})};var Ht;!function(e){e.ACTIVE_PIPELINE="ACTIVE_PIPELINE",e.PIPELINES="PIPELINES",e.USER="USER"}(Ht||(Ht={}));const Kt=e=>{const[t,s]=(0,n.useState)(!1),a=(0,n.useRef)(null),{modalDispatch:i}=(0,n.useContext)(Ut),{dispatch:o}=(0,n.useContext)(St),{pipelinesDispatch:r}=(0,n.useContext)(xt),{userDispatch:c}=(0,n.useContext)($t),l=()=>{i({type:e}),d()},d=()=>{a.current&&a.current.clearContent()};return{modalSaving:t,setModalSaving:s,modalContentRef:a,closeModal:l,handleSuccess:(e,t,n)=>{let a;switch(n){case Ht.PIPELINES:a=r;break;case Ht.ACTIVE_PIPELINE:a=o;break;case Ht.USER:a=c;break;default:a=o}s(!1),a({type:e,payload:t}),l()},handleError:e=>{s(!1),console.error(e)}}};var Gt,Bt=s(2922),Wt=s(6053),Qt=s(9828),Yt=s(540),Xt=s(4576),Jt=s(6197),Zt=s(5138),es=s(7008);function ts({id:e}){return(0,a.jsx)(es.m_,{id:e,className:"wpqt-bg-red-600",children:(0,a.jsx)("span",{children:"Tooltip content"})})}function ss({onClick:e=()=>{},btnText:t,className:s,type:n=Gt.BUTTON,disabled:i=!1,loading:o=!1}){return(0,a.jsx)(Zt.$,{disabled:i||o,className:`wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-transparent wpqt-bg-blue-500 wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-text-white wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 focus:wpqt-ring-blue-800 enabled:hover:wpqt-bg-blue-600 ${s}`,onClick:e,type:n,children:o?(0,a.jsx)(lt,{width:"24",height:"24",color:"#ffffff",secondaryColor:"#ffffff"}):t})}function ns({icon:e,text:t,onClick:s=()=>{},className:n,tooltipId:i,tooltipText:o,loading:r=!1}){const c=o&&i,l=c?{"data-tooltip-id":i,"data-tooltip-content":o,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-main-border wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-bg-gray-100 wpqt-p-2 hover:wpqt-bg-white ${n}`,onClick:s,children:[e,t||r?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center wpqt-relative",children:[t&&(0,a.jsx)("span",{className:"wpqt-whitespace-nowrap "+(r?"wpqt-invisible":""),children:t}),r&&(0,a.jsx)(lt,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]}):null,c&&(0,a.jsx)(ts,{id:i})]}))}function as({icon:e,onClick:t=()=>{},className:s,loading:n=!1}){return(0,a.jsxs)("div",{className:`wpqt-main-border wpqt-p-1 wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-bg-gray-100 hover:wpqt-bg-white ${s}`,onClick:t,children:[(0,a.jsx)("div",{className:"wpqt-flex wpqt-items-center "+(n?"wpqt-invisible":""),children:e}),n&&(0,a.jsx)(lt,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]})}function is({modalOpen:e,closeModal:t,children:s,size:n="sm"}){return(0,a.jsxs)(Bt.lG,{open:e,as:"div",className:"wpqt-relative wpqt-z-9999 focus:wpqt-outline-none",onClose:t,children:[(0,a.jsx)(Bt.Xi,{className:"wpqt-fixed wpqt-inset-0 wpqt-bg-black/40"}),(0,a.jsx)("div",{className:"wpqt-fixed wpqt-inset-0 wpqt-z-10 wpqt-w-screen wpqt-overflow-y-auto",children:(0,a.jsx)("div",{className:"wpqt-mt-[8vh] wpqt-flex wpqt-justify-center",children:(0,a.jsxs)(Bt.Lj,{transition:!0,className:`data-[closed]:wpqt-transform-[wpqt-scale(95%)] wpqt-relative wpqt-mt-[20px] wpqt-w-4/5 ${{sm:"wpqt-max-w-sm",md:"wpqt-max-w-lg",lg:"wpqt-max-w-4xl",xl:"wpqt-max-w-6xl"}[n]} wpqt-rounded-xl wpqt-bg-white wpqt-p-8 wpqt-backdrop-blur-2xl wpqt-duration-300 wpqt-ease-out data-[closed]:wpqt-opacity-0`,children:[(0,a.jsx)("div",{className:"wpqt-group wpqt-absolute wpqt-right-[-20px] wpqt-top-[-20px] wpqt-flex wpqt-h-[40px] wpqt-w-[40px] wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-rounded-full wpqt-border wpqt-border-solid wpqt-bg-white wpqt-text-qtBorder",onClick:t,children:(0,a.jsx)(Xt.A,{className:"wpqt-icon-blue group-hover:wpqt-icon-red wpqt-size-5"})}),s]})})})]})}function os({children:e}){return(0,a.jsx)(Bt.L3,{as:"div",className:"wpqt-text-base/7 wpqt-font-medium wpqt-text-black",children:e})}function rs({children:e}){return(0,a.jsx)(Wt.L,{children:e})}function cs({label:e,children:t,tooltipId:s,tooltipText:n}){const i=s&&n,o=i?{"data-tooltip-id":s,"data-tooltip-content":n,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info","data-tooltip-place":"top-end"}:{};return(0,a.jsxs)(Qt.D,{className:"wpqt-mb-3",children:[(0,a.jsx)(Yt.JU,Object.assign({className:"wpqt-mb-2 wpqt-block wpqt-text-sm/6 wpqt-font-medium"},o,{children:e})),t,i&&(0,a.jsx)(ts,{id:s})]})}function ls({onSave:e,saveBtnText:t,loading:s=!1}){return(0,a.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-justify-end",children:(0,a.jsx)(ns,{text:t,loading:s,icon:(0,a.jsx)(Jt.RZ0,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:e})})}!function(e){e.BUTTON="button",e.SUBMIT="submit",e.RESET="reset"}(Gt||(Gt={}));var ds=s(1489),us=s(8448),ps=s(8176),hs=s(1052);function ws(){const[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)(!1),[i,o]=(0,n.useState)(!1);return{loading1:e,loading2:s,setLoading1:t,setLoading2:a,loading3:i,setLoading3:o}}const vs=(e,t)=>{switch(t.type){case"SET_SITE_URL":{const s=t.payload;return Object.assign(Object.assign({},e),{siteURL:s})}case ve:{const{siteURL:s,publicUserPageId:n,timezone:a,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r}=t.payload;return Object.assign(Object.assign({},e),{siteURL:s,publicUserPageId:n,timezone:a,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r})}case me:{const s=t.payload;return Object.assign(Object.assign({},e),{userPageCustomStyles:s})}default:return e}},ms={siteURL:"",pluginURL:"",publicUserPageId:"",is_customFields:!1,timezone:"",isUserAllowedToDelete:!1,userPageCustomStyles:""},qs=(0,n.createContext)({state:ms,appDispatch:()=>{}}),xs=({children:e})=>{const[t,s]=(0,n.useReducer)(vs,ms);return(0,n.useEffect)((()=>{const e=window.wpqt.siteURL,t=window.wpqt.publicUserPageId,n=window.wpqt.timezone,a="1"===window.wpqt.isUserAllowedToDelete,i=window.wpqt.userPageCustomStyles,o=window.wpqt.pluginURL;s({type:ve,payload:{siteURL:e,publicUserPageId:t,timezone:n,isUserAllowedToDelete:a,userPageCustomStyles:i,pluginURL:o}})}),[]),(0,a.jsx)(qs.Provider,{value:{state:t,appDispatch:s},children:e})};var fs,gs,ks;!function(e){e.Text="text",e.Select="select",e.Checkbox="checkbox",e.Radio="radio",e.Datetime="datetime",e.File="file"}(fs||(fs={})),function(e){e.User="user",e.Pipeline="pipeline",e.Users="users",e.Task="task"}(gs||(gs={})),function(e){e.TEXT="text",e.PASSWORD="password"}(ks||(ks={}));const _s=(0,n.forwardRef)((({value:e,onChange:t,isAutoFocus:s,className:n="",wrapperClassName:i="",disabled:o=!1,type:r=ks.TEXT,loading:c=!1,inputId:l},d)=>(0,a.jsxs)("div",{className:`wpqt-inline-block wpqt-relative wpqt-mb-3 ${i}`,children:[(0,a.jsx)(ht.p,{ref:d,autoFocus:s,className:`wpqt-block wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${n}`,value:e,disabled:o,onChange:e=>t(e.target.value),type:r,id:l}),c&&(0,a.jsx)(lt,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"})]})));var js=s(1062),ys=s(4164);function bs({value:e,onChange:t,rowsCount:s=3,className:n}){return(0,a.jsx)(js.T,{className:(0,ys.$)("wpqt-border-1 wpqt-mb-3 wpqt-block wpqt-resize-none wpqt-rounded-lg wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6",`focus:wpqt-shadow-none focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${n}`),rows:s,value:e,onChange:e=>t(e.target.value)})}var Ts=s(303);function Ss({checked:e,handleChange:t}){return(0,a.jsx)(Ts.A,{onChange:t,checked:e,uncheckedIcon:!1,checkedIcon:!1,height:20,width:44})}const Cs=(e,t)=>{switch(t.type){case Pe:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case Ie:{const{entityId:s,entityType:n}=t.payload;return Object.assign(Object.assign({},e),{entityId:s,entityType:n})}case Ne:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:s})}case Oe:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:[...e.customFields,s]})}case Ee:{const s=t.payload,n=e.customFields.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{customFields:n})}default:return e}};const As={customFields:[],loading:!0,entityId:"",entityType:null},Ns=(0,n.createContext)({state:As,customFieldsDispatch:()=>{},fetchCustomFields:()=>{}}),Os=({children:e,entityId:t,entityType:s})=>{const[r,c]=(0,n.useReducer)(Cs,As);(0,n.useEffect)((()=>{l()}),[]),(0,n.useEffect)((()=>{c({type:Ie,payload:{entityType:s,entityId:t}})}),[s,t]);const l=()=>{return e=void 0,n=void 0,r=function*(){try{c({type:Pe,payload:!0});const e=yield x(t,s,!0);c({type:Ne,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch custom fields","quicktasker"))}finally{c({type:Pe,payload:!1})}},new((a=void 0)||(a=Promise))((function(t,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}));var e,n,a,r};return(0,a.jsx)(Ns.Provider,{value:{state:r,customFieldsDispatch:c,fetchCustomFields:l},children:e})};function Es({title:e,description:t,className:s=""}){return(0,a.jsxs)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center wpqt-h-full ${s}`,children:[(0,a.jsx)("h2",{className:"wpqt-font-semibold",children:e}),(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-4",children:t}),(0,a.jsx)("div",{className:"wpqt-text-blue-500 wpqt-font-semibold",children:(0,a.jsx)("a",{href:"https://payhip.com/b/84TLC",target:"_blank",rel:"noreferrer",children:(0,o.__)("Get the premium version","quicktasker")})})]})}var Ps=s(9197),Is=s(2767),Ds=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Rs(){return{addCustomField:(e,t,s,n,a,r)=>Ds(this,void 0,void 0,(function*(){try{const i=yield function(e,t,s,n,a){return u()({path:"/wpqt/v1/custom-fields",method:"POST",data:{entityId:e,entityType:t,type:s,name:n,description:a},headers:p()})}(e,t,s,n,a);r&&r(i.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add a custom field","quicktasker"))}})),markCustomFieldAsDeleted:(e,t)=>Ds(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/custom-fields/${e}`,method:"DELETE",headers:p()})}(e),t&&t()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to mark custom field as deleted","quicktasker"))}})),restoreCustomField:(e,t)=>Ds(this,void 0,void 0,(function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/custom-fields/${e}/restore`,method:"PATCH",headers:p()})}(e);i.oR.success((0,o.__)("Custom field restored","quicktasker")),t&&t(s.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore custom field","quicktasker"))}})),updateCustomFieldValue:(e,t,s,n,a)=>Ds(this,void 0,void 0,(function*(){try{yield function(e,t,s,n){return u()({path:`/wpqt/v1/custom-fields/${e}/value`,method:"PATCH",data:{value:t,entityId:String(s),entityType:n},headers:p()})}(e,t,s,n),a&&a()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to update custom field value","quicktasker"))}}))}}var Us=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ls({description:e}){const[t,s]=(0,n.useState)(""),[i,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(fs.Text),{addCustomField:p}=Rs(),{state:{entityId:h,entityType:w},customFieldsDispatch:v}=(0,n.useContext)(Ns),[m,q]=(0,n.useState)(!1),x=[{value:fs.Text,label:"Text"},{value:fs.Checkbox,label:"Checkbox"}];return(0,a.jsxs)("div",{className:"wpqt-mb-6 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)("h2",{children:(0,o.__)("Custom Fields","quicktasker")}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:e}),c&&(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Name","quicktasker")}),(0,a.jsx)(_s,{value:t,onChange:s})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Description","quicktasker")}),(0,a.jsx)(bs,{value:i,onChange:r})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Type","quicktasker")}),(0,a.jsx)(kt,{selectedOptionValue:d,options:x,onSelectionChange:e=>{u(e)},allSelector:!1})]})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,a.jsx)(ns,{text:c?(0,o.__)("Cancel","quicktasker"):(0,o.__)("Add new custom field","quicktasker"),onClick:()=>l(!c),icon:c?(0,a.jsx)(Ps.A,{className:"wpqt-icon-red wpqt-size-5"}):(0,a.jsx)(Is.A,{className:"wpqt-icon-green wpqt-size-5"})}),c&&(0,a.jsx)(ns,{text:(0,o.__)("Add","quicktasker"),onClick:()=>Us(this,void 0,void 0,(function*(){h&&w?(q(!0),yield p(h,w,d,t,i,(e=>{v({type:Oe,payload:e}),s(""),r(""),u(fs.Text),l(!1)})),q(!1)):console.error("Entity ID or Entity Type is missing")})),loading:m,icon:(0,a.jsx)(Is.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]})}var Ms=s(72),Fs=s(2601),zs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function $s({data:e,onSave:t,locationOfCustomFields:s,onDelete:i,actionLoading:r}){const{state:{isUserAllowedToDelete:c}}=(0,n.useContext)(qs),l=e.entity_type===s,d=s===gs.Task||s===gs.User,u=e.entity_type===gs.Pipeline?"board":e.entity_type;return r?(0,a.jsx)(ut,{ovalSize:"24"}):(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-gap-2",children:[d&&(0,a.jsx)(ns,{onClick:t,icon:(0,a.jsx)(Fs.A,{className:"wpqt-icon-green wpqt-size-4"}),tooltipId:`custom-field-${e.id}-update`,tooltipText:(0,o.__)("Edit custom field value","quicktasker")}),c&&(0,a.jsx)(ns,Object.assign({onClick:()=>zs(this,void 0,void 0,(function*(){l&&i()})),className:l?"":"!wpqt-cursor-not-allowed",icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-4"})},!l&&{tooltipId:`custom-field-${e.id}-delete`,tooltipText:(0,o.sprintf)((0,o.__)("This custom field is inherited from %s settings and can't be deleted here","quicktasker"),u)}))]})}var Vs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Hs({data:e}){const[t,s]=(0,n.useState)(""),{state:{entityType:i,entityId:o},customFieldsDispatch:r}=(0,n.useContext)(Ns),{updateCustomFieldValue:c,markCustomFieldAsDeleted:l}=Rs(),[d,u]=(0,n.useState)(!1);let p;switch((0,n.useEffect)((()=>{e.value&&s(e.value)}),[e.value]),e.type){case fs.Text:p=(0,a.jsx)(Ks,{data:e,value:t,onChange:s});break;case fs.Checkbox:p=(0,a.jsx)(Gs,{data:e,value:t,onChange:s})}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{}),p,(0,a.jsx)($s,{data:e,locationOfCustomFields:i,onSave:()=>Vs(this,void 0,void 0,(function*(){i===gs.User||i===gs.Task?(u(!0),yield c(e.id,t,o,i),u(!1)):console.error("Invalid entity type for saving custom field value")})),onDelete:()=>Vs(this,void 0,void 0,(function*(){u(!0),yield l(e.id,(()=>{r({type:Ee,payload:e.id})})),u(!1)})),actionLoading:d})]})}function Ks({data:e,value:t,onChange:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center",children:[(0,a.jsx)(Bs,{name:e.name,description:e.description}),(0,a.jsx)(_s,{value:t,onChange:s})]})}function Gs({data:e,value:t,onChange:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)(Bs,{name:e.name,description:e.description}),(0,a.jsx)("input",{type:"checkbox",checked:"true"===t,className:"!wpqt-block",onChange:e=>s(e.target.checked?"true":"false")})]})}function Bs({name:e,description:t=""}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-mb-1 wpqt-text-base wpqt-font-semibold",children:e}),t&&(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-italic",children:t})]})}function Ws(){const{state:{loading:e,customFields:t}}=(0,n.useContext)(Ns),[s,i]=(0,n.useState)(!1);return e?(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(lt,{width:"36",height:"36"})}):t&&0===t.length?(0,a.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No related custom fields created","quicktasker")}):s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-my-4 wpqt-grid wpqt-grid-cols-[100px_1fr_100px] wpqt-items-center wpqt-gap-3",children:t.map((e=>(0,a.jsx)(Hs,{data:e},e.id)))}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(ns,{text:(0,o.__)("Hide custom fields","quicktasker"),onClick:()=>i(!1),icon:(0,a.jsx)(Ms.A,{className:"wpqt-icon-red wpqt-size-5"})})})]}):(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(ns,{text:(0,o.__)("Show custom fields","quicktasker"),onClick:()=>i(!0),icon:(0,a.jsx)(Ms.A,{className:"wpqt-icon-blue wpqt-size-5"})})})}var Qs=s(5066);const Ys={[gs.Pipeline]:(0,o.__)("Board","quicktasker"),[gs.Task]:(0,o.__)("Task","quicktasker"),[gs.User]:(0,o.__)("User","quicktasker"),[gs.Users]:(0,o.__)("Global users","quicktasker")};var Xs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Js({customField:e,refreshDeletedFields:t}){const{customFieldsDispatch:s}=(0,n.useContext)(Ns),[i,r]=(0,n.useState)(!1),{restoreCustomField:c}=Rs();return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Name:","quicktasker")})," ",e.name]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Description:","quicktasker")})," ",e.description]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Level:","quicktasker")})," ",Ys[e.entity_type]]}),(0,a.jsx)("div",{children:(0,a.jsx)(as,{onClick:()=>Xs(this,void 0,void 0,(function*(){r(!0),yield c(e.id,(e=>{s({type:Oe,payload:e}),t()})),r(!1)})),loading:i,icon:(0,a.jsx)(Qs.HCd,{className:"wpqt-icon-green wpqt-size-5"})})})]})}var Zs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function en(){const[e,t]=(0,n.useState)(!1),[s,r]=(0,n.useState)(!0),[c,l]=(0,n.useState)(null),{state:{entityId:d,entityType:u}}=(0,n.useContext)(Ns);(0,n.useEffect)((()=>{e&&p()}),[e]);const p=()=>Zs(this,void 0,void 0,(function*(){if(d&&u)try{r(!0);const e=yield x(d,u,!1);l(e.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load deleted custom fields","quicktasker"))}finally{r(!1)}else console.error("Entity ID or Entity Type is missing")}));return(0,a.jsxs)("div",{className:"wpqt-my-3 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)("h2",{children:(0,o.__)("Custom Field recovery","quicktasker")}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:(0,o.__)("Deleted custom field by accident? No worries! You can recover it here.","quicktasker")}),e&&(0,a.jsx)("div",{className:"wpqt-mb-3",children:s?(0,a.jsx)(ut,{ovalSize:"36"}):c&&0===c.length?(0,a.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No deleted custom fields","quicktasker")}):c&&c.length>0?(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:c.map((e=>(0,a.jsx)(Js,{customField:e,refreshDeletedFields:p},e.id)))}):null}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:(0,a.jsx)(ns,{text:e?(0,o.__)("Close recovery","quicktasker"):(0,o.__)("Open recovery","quicktasker"),onClick:()=>t(!e),icon:(0,a.jsx)(Qs.HCd,{className:"wpqt-icon-green wpqt-size-5"})})})]})}const tn={[gs.User]:(0,o.__)("Add user-specific custom fields. If you want to add custom fields to all users, please go to users settings.","quicktasker"),[gs.Users]:(0,o.__)("Add custom fields to all users. If you want to add custom fields to a specific user only, please go to that user settings.","quicktasker"),[gs.Pipeline]:(0,o.__)("Add board level custom fields.","quicktasker"),[gs.Task]:(0,o.__)("Add task-specific custom fields. If you want to add custom fields to all tasks in this board, please go to board settings.","quicktasker")},sn={[gs.User]:(0,o.__)("Custom fields applied to this user, including both user-specific and global users fields.","quicktasker"),[gs.Users]:(0,o.__)("Global user custom field are applied to all users.","quicktasker"),[gs.Pipeline]:(0,o.__)("Board level fields are applied to all tasks in this board.","quicktasker"),[gs.Task]:(0,o.__)("Custom fields applied to this task, including both task-specific and board-level fields.","quicktasker")},nn={[gs.User]:(0,o.__)("User custom fields","quicktasker"),[gs.Users]:(0,o.__)("Global users custom fields","quicktasker"),[gs.Pipeline]:(0,o.__)("Board custom fields","quicktasker"),[gs.Task]:(0,o.__)("Task custom fields","quicktasker")};function an({entityId:e,entityType:t}){const{state:{is_customFields:s}}=(0,n.useContext)(qs),i=tn[t],r=nn[t],c=sn[t];return(0,a.jsx)(a.Fragment,{children:s?(0,a.jsx)("div",{children:(0,a.jsxs)(Os,{entityId:e,entityType:t,children:[(0,a.jsx)(Ls,{description:i}),(0,a.jsx)("h2",{className:"wpqt-text-center",children:r}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:c}),(0,a.jsx)(Ws,{}),(0,a.jsx)(en,{})]})}):(0,a.jsx)(Es,{title:(0,o.__)("Custom fields","quicktasker"),description:(0,o.__)("Premium feature to create and manage custom data fields. Allows to add extra data to tasks and users.","quicktasker")})})}var on=s(2792),rn=s(2185);function cn({children:e,menuBtn:t,menuBtnClasses:s="",anchor:n="bottom end"}){return(0,a.jsxs)(rn.W1,{children:[(0,a.jsx)(rn.IU,{as:"div",className:`wpqt-cursor-pointer ${s}`,onClick:e=>e.stopPropagation(),children:({active:e})=>(0,a.jsx)(a.Fragment,{children:t({active:e})})}),(0,a.jsx)(rn.c,{anchor:n,transition:!0,className:"wpqt-z-20 wpqt-origin-top wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-white wpqt-p-4 wpqt-transition wpqt-duration-200 wpqt-ease-out data-[closed]:wpqt-scale-95 data-[closed]:wpqt-opacity-0",children:e})]})}function ln({isActive:e,IconComponent:t}){return(0,a.jsx)(t,{className:"wpqt-size-6 wpqt-text-gray-400 hover:wpqt-text-qtBlueHover "+(e?"wpqt-text-qtBlueHover":"")})}function dn({text:e,onClick:t,icon:s,className:n,disabled:i=!1,id:o="",tooltipText:r="",loading:c=!1}){const l=""!==r&&""!==o?{"data-tooltip-id":o,"data-tooltip-content":r,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsx)(rn.Dr,{children:(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-relative ${i?"wpqt-cursor-not-allowed wpqt-line-through":"wpqt-cursor-pointer hover:wpqt-underline"} ${n}`,onClick:e=>{!i&&t&&t(e)},children:[s,(0,a.jsx)("span",{className:c?"wpqt-invisible":"",children:e}),c&&(0,a.jsx)(lt,{width:"16",height:"16",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-y-center wpqt-transform-x-center"}),(0,a.jsx)(ts,{id:o})]}))})}var un=s(6797),pn=s(4403);function hn({sectionTitle:e,onItemSelect:t=()=>{},users:s=[],ActionIcon:n=pn.A,actionIconClasses:i,noUsersText:o}){return(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-text-lg",children:e}),s.map(((e,s)=>{var o;return(0,a.jsxs)("div",{onClick:s=>{s.stopPropagation(),t(e)},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-px-2 wpqt-py-1 hover:wpqt-bg-gray-100",children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,a.jsx)("div",{children:e.name}),(0,a.jsx)("div",{className:"wpqt-italic",children:e.description}),Ge(e)&&(0,a.jsx)("div",{children:null===(o=e.roles)||void 0===o?void 0:o.join(",")})]}),(0,a.jsx)(n,{className:`wpqt-ml-auto wpqt-size-5 ${i}`})]},s)})),0===s.length&&(0,a.jsx)("div",{children:o})]})}var wn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function vn({task:e,onUserAdd:t,onUserDelete:s}){const{state:{users:r,wpUsers:c}}=(0,n.useContext)($t),{dispatch:l}=(0,n.useContext)(St),[d,h]=(0,n.useState)(!1),w=r.filter((t=>{var s;return!(null!==(s=e.assigned_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))})),v=c.filter((t=>{var s;return!(null!==(s=e.assigned_wp_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))})),m=s=>wn(this,void 0,void 0,(function*(){try{h(!0);const n=s.user_type;yield function(e,t,s){return u()({path:`/wpqt/v1/users/${e}/tasks/${t}`,method:"POST",data:{user_type:s},headers:p()})}(s.id,e.id,n),l({type:O,payload:{taskId:e.id,user:s}}),t(s)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to assign user","quicktasker"))}finally{h(!1)}})),x=t=>wn(this,void 0,void 0,(function*(){try{h(!0);const n=t.user_type;yield q(t.id,e.id,n),l({type:E,payload:{taskId:e.id,userId:t.id,userType:n}}),s(t)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to remove user","quicktasker"))}finally{h(!1)}}));return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,a.jsx)(hn,{sectionTitle:(0,o.__)("Assigned quicktaskers","quicktasker"),users:e.assigned_users,onItemSelect:x,ActionIcon:un.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No quicktaskers assigned","quicktasker")}),(0,a.jsx)(hn,{sectionTitle:(0,o.__)("Assigned WordPress users","quicktasker"),users:e.assigned_wp_users,onItemSelect:x,ActionIcon:un.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No WordPress users assigned","quicktasker")}),(0,a.jsx)(hn,{sectionTitle:(0,o.__)("Assign a quicktasker","quicktasker"),users:w,onItemSelect:m,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No quicktaskers available to assign","quicktasker")}),(0,a.jsx)(hn,{sectionTitle:(0,o.__)("Assign a WordPress user","quicktasker"),users:v,onItemSelect:m,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No WordPress users with required permissions available to assign","quicktasker")}),d&&(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(lt,{width:"30",height:"30"})})]})}function mn({task:e,onUserAdd:t=()=>{},onUserDelete:s=()=>{},menuBtnClasses:n=""}){const i=[...e.assigned_users||[],...e.assigned_wp_users||[]],o=i.length>0;return(0,a.jsx)(cn,{menuBtnClasses:`wpqt-inline-flex ${n}`,anchor:"bottom start",menuBtn:()=>(0,a.jsxs)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:[(0,a.jsx)(on.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`}),o&&(0,a.jsx)("div",{children:i.map(((e,t)=>(0,a.jsxs)("span",{children:[e.name,t<i.length-1&&", "]},t)))})]}),children:(0,a.jsx)(vn,{task:e,onUserAdd:t,onUserDelete:s})})}var qn=s(1848);function xn({tabs:e,tabsContent:t,tabClassName:s="",tabListClassName:n=""}){return(0,a.jsxs)(qn.fu,{children:[(0,a.jsx)(qn.wb,{className:`wpqt-mb-6 wpqt-flex wpqt-border-0 wpqt-border-b wpqt-border-solid wpqt-border-b-gray-300 ${n}`,children:e.map((e=>(0,a.jsx)(fn,{className:s,children:e},e)))}),(0,a.jsx)(qn.T2,{children:t.map(((e,t)=>(0,a.jsx)(gn,{children:e},t)))})]})}function fn({children:e,className:t}){return(0,a.jsx)(qn.oz,{as:"div",className:`wpqt-flex-1 wpqt-cursor-pointer wpqt-p-1 wpqt-pb-[10px] wpqt-text-center wpqt-text-lg data-[selected]:wpqt-border-b-2 data-[selected]:wpqt-border-l-0 data-[selected]:wpqt-border-r-0 data-[selected]:wpqt-border-t-0 data-[selected]:wpqt-border-solid data-[selected]:wpqt-border-b-blue-500 ${t}`,children:e})}function gn({children:e}){return(0,a.jsx)(qn.Kp,{children:e})}var kn=s(4353),_n=s.n(kn),jn=s(8569),yn=s.n(jn),bn=s(3826),Tn=s.n(bn);_n().extend(Tn()),_n().extend(yn());const Sn=()=>{const{state:{timezone:e}}=(0,n.useContext)(qs);return{convertToWPTimezone:t=>((e,t)=>{try{return _n().utc(e).tz(t).format("MMMM D, YYYY HH:mm")}catch(t){return console.error("Error: ",t),e+" (UTC)"}})(t,e)}},Cn={[Je.Admin]:(0,o.__)("Admin","quicktasker"),[Je.Automation]:(0,o.__)("Automation","quicktasker"),[Je.System]:(0,o.__)("System","quicktasker"),[Je.WPQTUser]:"Quicktasker"},An=({log:e})=>{const{convertToWPTimezone:t}=Sn(),s=Cn[e.created_by];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,a.jsx)("div",{className:"wpqt-text-center",children:s})]}),(0,a.jsx)("div",{children:e.text}),(0,a.jsx)("div",{children:t(e.created_at)})]})};var Nn=s(3338),On=s(3211),En=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Pn({typeId:e,fetchData:t,renderItem:s,noDataMessage:i,explanation:o,onAdd:r=()=>En(this,void 0,void 0,(function*(){})),enableAdd:c=!1}){const[l,d]=(0,n.useState)(null),[u,p]=(0,n.useState)(""),[h,w]=(0,n.useState)(!0),[v,m]=(0,n.useState)(!1);(0,n.useEffect)((()=>{q()}),[e]);const q=()=>En(this,void 0,void 0,(function*(){w(!0);const e=yield t();e&&d(e),w(!1)}));return null===l?(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(lt,{width:"30",height:"30"})}):(0,a.jsxs)("div",{children:[o&&(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center wpqt-font-semibold",children:o}),0===l.length&&(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center",children:i}),l.length>0&&(0,a.jsx)("div",{className:"wpqt-mb-[28px] wpqt-mt-[56px] wpqt-logs-grid",children:l.map((e=>s(e)))}),(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-justify-center",children:(0,a.jsx)(In,{isLoading:h,refreshComemnts:q})}),c&&(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsxs)("div",{className:"wpqt-w-2/3",children:[(0,a.jsx)(bs,{rowsCount:3,value:u,onChange:e=>p(e),className:"wpqt-mb-4 wpqt-w-full"}),(0,a.jsx)(ns,{text:"Add comment",loading:v,onClick:()=>En(this,void 0,void 0,(function*(){m(!0);const e=yield r(u);e&&(d((t=>t?[...t,e]:[e])),p("")),m(!1)})),className:"wpqt-float-right",icon:(0,a.jsx)(Nn.A,{className:"wpqt-icon-blue wpqt-size-5"})})]})})]})}function In({isLoading:e,refreshComemnts:t}){return(0,a.jsx)(a.Fragment,{children:e?(0,a.jsx)(lt,{width:"32",height:"32"}):(0,a.jsx)(On.A,{className:"wpqt-icon-blue wpqt-size-8 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:t})})}function Dn({item:e}){const{convertToWPTimezone:t}=Sn();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,a.jsx)("div",{className:"wpqt-text-center",children:e.is_admin_comment?(0,o.__)("Admin","quicktasker"):(0,o.__)("QuickTasker","quicktasker")})]}),(0,a.jsx)("div",{children:e.text}),(0,a.jsx)("div",{children:t(e.created_at)})]})}var Rn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Un({taskId:e}){return(0,a.jsx)(Pn,{typeId:e,fetchData:()=>Rn(this,void 0,void 0,(function*(){try{return(yield m(e,Xe.Task)).data}catch(e){console.error(e),i.oR.error("Failed to get log")}})),renderItem:e=>(0,a.jsx)(An,{log:e}),noDataMessage:"No logs available",explanation:"Logs can be seen only by WordPress users (with required permissions)"})}var Ln=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Mn(){return{addComment:(e,t,s,n)=>Ln(this,void 0,void 0,(function*(){try{const a=yield v(e,t,s,n);return i.oR.success((0,o.__)("Comment added","quicktasker")),a.data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add comment","quicktasker"))}}))}}const Fn=e=>Object.assign(Object.assign({},e),{is_admin_comment:"1"===e.is_admin_comment});var zn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function $n({taskId:e}){const{addComment:t}=Mn();return(0,a.jsx)(Pn,{typeId:e,fetchData:()=>zn(this,void 0,void 0,(function*(){try{return(yield w(e,Xe.Task,!0)).data.map(Fn)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>zn(this,void 0,void 0,(function*(){const n=yield t(e,Xe.Task,!0,s);if(n)return Fn(n)})),renderItem:e=>(0,a.jsx)(Dn,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed only by WordPress users (with required permissions).",enableAdd:!0})}var Vn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Hn({taskId:e}){const{addComment:t}=Mn();return(0,a.jsx)(Pn,{typeId:e,fetchData:()=>Vn(this,void 0,void 0,(function*(){try{return(yield w(e,Xe.Task,!1)).data.map(Fn)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>Vn(this,void 0,void 0,(function*(){const n=yield t(e,Xe.Task,!1,s);if(n)return Fn(n)})),renderItem:e=>(0,a.jsx)(Dn,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed by WordPress users (with required permissions) and QuickTasker users who have been assigned to the task.",enableAdd:!0})}function Kn({task:e}){return(0,a.jsx)(xn,{tabs:["Private comments","Public comments","Logs"],tabsContent:[(0,a.jsx)($n,{taskId:e.id},1),(0,a.jsx)(Hn,{taskId:e.id},2),(0,a.jsx)(Un,{taskId:e.id},3)]})}var Gn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Bn=(0,n.forwardRef)((({taskModalSaving:e,editTask:t,deleteTask:s},i)=>{const{state:{taskToEdit:r,taskModalSettings:c},modalDispatch:l}=(0,n.useContext)(Ut),{state:{isUserAllowedToDelete:d}}=(0,n.useContext)(qs),{state:{activePipeline:u},fetchAndSetPipelineData:p}=(0,n.useContext)(St),{archiveDispatch:h}=(0,n.useContext)(ot),[w,v]=(0,n.useState)(""),[m,q]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),{archiveTask:g,restoreArchivedTask:k}=Pt(),{loading1:_,setLoading1:j,loading2:y,setLoading2:b}=ws(),T=null==r?void 0:r.is_archived,S=null!==(null==r?void 0:r.pipeline_name);(0,n.useEffect)((()=>{r&&(v(r.name),q(r.description),f(r.free_for_all))}),[r]);const C=()=>{v(""),q("")};return(0,n.useImperativeHandle)(i,(()=>({clearContent:C}))),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,a.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsxs)(rs,{children:[(0,a.jsx)(cs,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(_s,{isAutoFocus:!0,value:w,onChange:e=>v(e)})}),(0,a.jsx)(cs,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(bs,{rowsCount:3,value:m,onChange:e=>q(e)})}),(0,a.jsx)(cs,{label:(0,o.__)("Assigned users","quicktasker"),children:(0,a.jsx)(mn,{task:r,onUserAdd:e=>{l({type:B,payload:e})},onUserDelete:e=>{l({type:W,payload:e})}})}),(0,a.jsx)(cs,{label:(0,o.__)("Free for all task","quicktasker"),tooltipId:`free-for-all-${r.id}-tooltip`,tooltipText:(0,o.__)("When enabled, all QuickTasker users have the ability to self-assign or unassign this task.","quicktasker"),children:(0,a.jsx)(Ss,{checked:x,handleChange:f})}),c.allowToMarkTaskAsDone&&(0,a.jsx)(Wn,{taskId:r.id,isCompleted:r.is_done})]}),(0,a.jsx)("div",{children:(0,a.jsx)(an,{entityId:r.id,entityType:gs.Task})})]}),(0,a.jsx)("div",{className:"wpqt-mt-7 md:wpqt-pr-3",children:(0,a.jsx)(Kn,{task:r})})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[T&&S&&(0,a.jsx)(ns,{icon:(0,a.jsx)(ds.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Restore task","quicktasker"),onClick:()=>{k(r.id,(()=>{l({type:L}),h({type:te,payload:r.id})}))}}),!T&&(0,a.jsx)(ns,{icon:(0,a.jsx)(us.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("Archive task","quicktasker"),loading:y,onClick:()=>{b(!0),g(r.id,(()=>{l({type:L}),p(u.id),b(!1)}))}}),d&&(0,a.jsx)(ns,{icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete task","quicktasker"),loading:_,onClick:()=>Gn(void 0,void 0,void 0,(function*(){j(!0),yield s(r),l({type:L}),j(!1)}))})]})]}),(0,a.jsx)(ls,{onSave:()=>{r&&t(Object.assign(Object.assign({},r),{name:w,description:m,free_for_all:x}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));function Wn({isCompleted:e,taskId:t}){const{modalDispatch:s}=(0,n.useContext)(Ut),{dispatch:i}=(0,n.useContext)(St),[r,c]=(0,n.useState)(!1),{changeTaskDoneStatus:l}=Pt();return(0,a.jsx)(cs,{label:e?(0,o.__)("Task completed","quicktasker"):(0,o.__)("Task not completed","quicktasker"),children:r?(0,a.jsx)(lt,{width:"24",height:"24"}):(0,a.jsx)(hs.A,{onClick:()=>Gn(this,void 0,void 0,(function*(){c(!0),yield l(t,!e,(e=>{s({type:P,payload:{done:e}}),i({type:P,payload:{taskId:t,done:e}})})),c(!1)})),className:`wpqt-size-6 ${e?"wpqt-icon-green":"wpqt-text-gray-300"} wpqt-cursor-pointer`})})}var Qn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Yn({editTaskCallback:e,deleteTaskCallback:t}){const{state:{taskModalOpen:s}}=(0,n.useContext)(Ut),{deleteTask:i}=Pt(),{modalSaving:o,setModalSaving:r,modalContentRef:c,closeModal:l,handleSuccess:d,handleError:h}=Kt(L);return(0,a.jsx)(is,{modalOpen:s,closeModal:l,size:"xl",children:(0,a.jsx)(Bn,{ref:c,editTask:t=>Qn(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e){return u()({path:`/wpqt/v1/tasks/${e.id}`,method:"PATCH",data:{id:e.id,name:e.name,description:e.description,freeForAll:e.free_for_all},headers:p()})}(t);d(b,s.data,Ht.ACTIVE_PIPELINE),e&&e(s.data)}catch(e){h(e)}})),deleteTask:e=>Qn(this,void 0,void 0,(function*(){i(e.id,(()=>{t&&t(e)}))})),taskModalSaving:o})})}function Xn({text:e=(0,o.__)("No results found","quicktasker")}){return(0,a.jsx)("div",{className:"wpqt-font-semibold wpqt-text-center wpqt-text-xl",children:e})}const Jn=()=>{const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s}}=(0,n.useContext)(ot);return{filterArchive:n=>{const a=n.name.toLowerCase().includes(e.toLowerCase())||n.description&&n.description.toLowerCase().includes(e.toLowerCase()),i=!t||("DELETED"===t?null===n.pipeline_name:n.pipeline_id===t),o=s===Ze.All||s===Ze.Completed&&n.is_done||s===Ze.NotCompleted&&!n.is_done;return a&&i&&o}}};var Zn=s(3033);function ea({className:e,onClick:t,title:s,description:n,children:i,dropdown:o,titleClassName:r=""}){const c=void 0!==o;return(0,a.jsxs)("div",{className:(0,ys.$)("wpqt-relative wpqt-flex wpqt-flex-col wpqt-rounded wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-4",c&&"wpqt-pr-[24px]",e),onClick:t,children:[(0,a.jsxs)("div",{className:"wpqt-mb-3",children:[(0,a.jsx)("div",{className:`wpqt-text-lg ${r}`,children:s}),n&&(0,a.jsx)("div",{className:"wpqt-italic wpqt-text-gray-500",children:n})]}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-h-full",children:i}),c&&(0,a.jsx)("div",{className:"wpqt-absolute wpqt-right-2 wpqt-top-1 wpqt-z-10",children:o})]})}var ta=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function sa({task:e,onDoneStatusChange:t,className:s=""}){const{changeTaskDoneStatus:i}=Pt(),[o,r]=(0,n.useState)(!1),c=e.is_done,l=s=>ta(this,void 0,void 0,(function*(){r(!0),yield i(e.id,s,(s=>{t(e.id,s)})),r(!1)}));return o?(0,a.jsx)(ut,{ovalSize:"24",className:"wpqt-mt-auto"}):(0,a.jsx)("div",{className:`wpqt-flex wpqt-justify-center wpqt-mt-auto ${s}`,children:c?(0,a.jsx)(hs.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,a.jsx)(hs.A,{className:"wpqt-size-6 wpqt-text-gray-300",onClick:e=>{e.stopPropagation(),l(!0)}})})}function na({label:e,value:t,valueClassName:s="",valueLink:n,icon:i,onClick:o=()=>{},className:r="",labelClassName:c=""}){return(0,a.jsxs)("div",{className:`wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center ${r}`,onClick:o,children:[i&&i,(0,a.jsx)("div",{className:c,children:t?`${e}:`:e}),(0,a.jsx)("div",{className:`${s}`,children:n?(0,a.jsx)("a",{href:n,target:"_blank",className:"wpqt-text-qtTextBlue wpqt-no-underline",rel:"noreferrer",onClick:e=>e.stopPropagation(),children:t}):t})]})}var aa=s(6436),ia=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function oa({task:e}){const{state:{isUserAllowedToDelete:t}}=(0,n.useContext)(qs),{archiveDispatch:s}=(0,n.useContext)(ot),{deleteTask:i,restoreArchivedTask:o}=Pt(),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),u=null!==e.pipeline_name;return(0,a.jsxs)(cn,{menuBtn:({active:e})=>(0,a.jsx)(ln,{isActive:e,IconComponent:aa.A}),children:[(0,a.jsx)(dn,{text:"View task",icon:(0,a.jsx)(Ms.A,{className:"wpqt-icon-blue wpqt-size-4"})}),(0,a.jsx)(dn,{text:"Restore task",loading:r,icon:(0,a.jsx)(ds.A,{className:"wpqt-icon-green wpqt-size-4"}),disabled:!u,id:`restore-task-${e.id}-dropdown-item`,tooltipText:"Task cannot be restored because the board has been deleted.",onClick:t=>ia(this,void 0,void 0,(function*(){t.stopPropagation(),c(!0),yield o(e.id,(()=>{s({type:te,payload:e.id})})),c(!1)}))}),t&&(0,a.jsx)(dn,{text:"Delete",loading:l,icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>ia(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield i(e.id,(()=>{s({type:te,payload:e.id})})),d(!1)})),className:"!wpqt-mb-0"})]})}function ra({task:e}){const{modalDispatch:t}=(0,n.useContext)(Ut),{archiveDispatch:s}=(0,n.useContext)(ot);return(0,a.jsxs)(ea,{title:e.name,description:e.description,dropdown:(0,a.jsx)(oa,{task:e}),className:"wpqt-cursor-pointer",onClick:()=>{t({type:U,payload:{taskToEdit:e}})},children:[(0,a.jsx)(na,{label:(0,o.__)("Board","quicktasker"),value:e.pipeline_name?e.pipeline_name:(0,o.__)("Board is deleted!","quicktasker"),icon:(0,a.jsx)(Zn.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(mn,{menuBtnClasses:"wpqt-self-start",task:e,onUserAdd:t=>{s({type:se,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{s({type:ne,payload:{taskId:e.id,user:t}})}}),(0,a.jsx)(sa,{task:e,onDoneStatusChange:(e,t)=>{s({type:ae,payload:{taskId:e,done:t}})}})]})}function ca(){var e;const{state:{archivedTasks:t=[]}}=(0,n.useContext)(ot),{filterArchive:s}=Jn(),i=null!==(e=null==t?void 0:t.filter(s))&&void 0!==e?e:[];return t&&0===t.length?(0,a.jsx)(Xn,{text:(0,o.__)("No tasks archived","quicktasker")}):i&&0===i.length?(0,a.jsx)(Xn,{}):(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"wpqt-card-grid",children:i.map((e=>(0,a.jsx)(ra,{task:e},e.id)))})})}function la(){const{state:{archivedTasks:e},archiveDispatch:t}=(0,n.useContext)(ot);return e?(0,a.jsxs)("div",{children:[(0,a.jsx)(yt,{}),(0,a.jsx)(ca,{}),(0,a.jsx)(Yn,{editTaskCallback:e=>{t({type:ie,payload:e})},deleteTaskCallback:e=>{t({type:te,payload:e.id})}})]}):(0,a.jsx)(ut,{className:"wpqt-h-[200px]"})}function da(){return(0,a.jsx)(rt,{children:(0,a.jsxs)(pt,{children:[(0,a.jsx)(l,{description:(0,o.__)("Archived tasks management page.","quicktasker"),children:(0,o.__)("Archive","quicktasker")}),(0,a.jsx)(la,{})]})})}const ua=()=>{const{state:{pluginURL:e}}=(0,n.useContext)(qs);return(0,a.jsxs)(pt,{children:[(0,a.jsx)(l,{description:(0,o.__)("Reading material about QuickTasker features and usage.","quicktasker"),children:(0,o.__)("Guide","quicktasker")}),(0,a.jsx)("div",{children:(0,a.jsx)("a",{target:"_blank",rel:"noreferrer",href:e+"help/index.html",children:(0,o.__)("View Guide","quicktasker")})})]})};var pa=s(4175);const ha=({filterSettings:e,setFilterSettings:t})=>{const{state:{pipelines:s}}=(0,n.useContext)(xt),[i,r]=(0,n.useState)(e);return(0,a.jsxs)(jt,{title:(0,o.__)("Logs filtering","quicktasker"),children:[(0,a.jsx)(kt,{allSelector:!1,selectedOptionValue:i.type,options:[{label:(0,o.__)("All types","quicktasker"),value:va.All},{label:(0,o.__)("Board","quicktasker"),value:va.Pipeline},{label:(0,o.__)("Stage","quicktasker"),value:va.Stage},{label:(0,o.__)("Task","quicktasker"),value:va.Task}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{type:e,typeId:""}))}}),i.type===va.Pipeline&&(0,a.jsx)(kt,{allSelector:!0,selectedOptionValue:i.typeId,options:s.map((e=>({label:e.name,value:e.id}))),onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{typeId:e}))}}),(0,a.jsx)(kt,{allSelector:!1,selectedOptionValue:i.createdBy,options:[{label:(0,o.__)("Everyone","quicktasker"),value:ma.All},{label:(0,o.__)("Admin","quicktasker"),value:ma.Admin},{label:"QuickTasker",value:ma.Quicktasker}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{createdBy:e}))}}),(0,a.jsx)(kt,{allSelector:!1,selectedOptionValue:i.numberOfLogs,options:[{label:(0,o.__)("Show 100","quicktasker"),value:xa.Hundred},{label:(0,o.__)("Show 200","quicktasker"),value:xa.TwoHundred},{label:"Show 500",value:xa.FiveHundred},{label:"Show all",value:xa.All}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{numberOfLogs:e}))}}),(0,a.jsx)(kt,{allSelector:!1,selectedOptionValue:i.order,options:[{label:(0,o.__)("ASC","quicktasker"),value:qa.Asc},{label:(0,o.__)("DESC","quicktasker"),value:qa.Desc}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{order:e}))}}),(0,a.jsx)(ns,{text:(0,o.__)("Apply filter","quicktasker"),icon:(0,a.jsx)(pa.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:()=>t(i)})]})},wa=({logs:e,loading:t})=>t?(0,a.jsx)(ut,{ovalSize:"64",className:"wpqt-mt-12"}):0===e.length?(0,a.jsx)(Xn,{text:(0,o.__)("No logs found","quicktasker")}):(0,a.jsx)("div",{className:"wpqt-logs-grid",children:e.map((e=>(0,a.jsx)(An,{log:e},e.id)))});var va,ma,qa,xa,fa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};!function(e){e.Pipeline="pipeline",e.Stage="stage",e.Task="task",e.All="all"}(va||(va={})),function(e){e.Admin="admin",e.Quicktasker="quicktasker_user",e.All="all"}(ma||(ma={})),function(e){e.Asc="asc",e.Desc="desc"}(qa||(qa={})),function(e){e.Hundred="100",e.TwoHundred="200",e.FiveHundred="500",e.All="all"}(xa||(xa={}));const ga=()=>{const[e,t]=(0,n.useState)([]),[s,o]=(0,n.useState)({numberOfLogs:xa.Hundred,type:va.All,typeId:"",createdBy:ma.All,order:qa.Desc}),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!0);(0,n.useEffect)((()=>{l&&(h(),d(!1))}),[s,l]);const h=()=>fa(void 0,void 0,void 0,(function*(){try{c(!0);const e=Object.assign({},s);e.numberOfLogs===xa.All&&delete e.numberOfLogs,e.type===va.All&&delete e.type,""===e.typeId&&delete e.typeId,e.createdBy===ma.All&&delete e.createdBy;const n=yield function(e){const t=new URLSearchParams(Object.entries(e).reduce(((e,[t,s])=>(e[t]=String(s),e)),{}));return u()({path:`/wpqt/v1/global-logs?${t.toString()}`,method:"GET",headers:p()})}(e);t(n.data)}catch(e){console.error(e),i.oR.error("Failed to fetch logs")}finally{c(!1)}}));return(0,a.jsxs)("div",{children:[(0,a.jsx)(ha,{filterSettings:s,setFilterSettings:e=>fa(void 0,void 0,void 0,(function*(){o(e),d(!0)}))}),(0,a.jsx)(wa,{logs:e,loading:r})]})},ka=()=>(0,a.jsxs)(pt,{children:[(0,a.jsx)(l,{description:(0,o.__)("The logs page where you can see all logs and filter them.","quicktasker"),children:(0,o.__)("Logs","quicktasker")}),(0,a.jsx)(ga,{})]});var _a=s(6708);function ja({overviewFilter:e,onCreationDateChange:t,onDoneDateChange:s}){const n=e=>e instanceof Date?_n()(e).format("YYYY-MM-DD"):"";return(0,a.jsx)("div",{children:(0,a.jsxs)(jt,{title:(0,o.__)("Statistics filtering","quicktasker"),titleClassName:"wpqt-text-center",childrenClassName:"wpqt-gap-6 wpqt-justify-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task creation date","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("(Filter tasks that have creation date equal or bigger than)","quicktasker")})]}),(0,a.jsx)(_a.A,{onChange:e=>{const s=n(e);t(s)},value:e.taskCreationDate,format:"y-MM-dd",id:"taskCreationDate"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task done date","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("(Filter tasks that have done date equal or smaller than)","quicktasker")})]}),(0,a.jsx)(_a.A,{onChange:e=>{const t=n(e);s(t)},value:e.taskDoneDate,format:"y-MM-dd",id:"taskCreationDate"})]})]})})}var ya=s(2298);function ba(e){const t=e.slice(1).some((e=>e[1]>0));return e.length>1&&t}function Ta({text:e}){return(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-items-center wpqt-h-[400px] wpqt-w-[500px] wpqt-font-semibold",children:e})}function Sa({pipelineOverviewData:e,options:t,width:s}){var n,i;const r=[["Archived tasks","Task Count"],["Archived tasks",parseInt(null!==(n=null==e?void 0:e.archivedTasksCount)&&void 0!==n?n:"0")||0],["Not archived tasks",parseInt(null!==(i=null==e?void 0:e.notArchivedTasksCount)&&void 0!==i?i:"0")||0]];return ba(r)?(0,a.jsx)(ya.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Archived tasks"}),width:s,height:"400px"}):(0,a.jsx)(Ta,{text:(0,o.__)("Not enough data to display archived tasks chart","quicktasker")})}function Ca({pipelineOverviewData:e,options:t,width:s}){var n;const i=[["Stage","Task Count"],...null!==(n=null==e?void 0:e.stages.map((e=>[e.name,parseInt(e.tasksCount)||0])))&&void 0!==n?n:[]];return ba(i)?(0,a.jsx)(ya.t1,{chartType:"PieChart",data:i,options:Object.assign(Object.assign({},t),{title:"Task distribution by stages"}),width:s,height:"400px"}):(0,a.jsx)(Ta,{text:(0,o.__)("Not enough data to display task distribution by stages chart","quicktasker")})}function Aa({pipelineOverviewData:e,options:t,width:s}){var n,i;const r=[["Task status","Task Count"],["Done",parseInt(null!==(n=null==e?void 0:e.doneTasksCount)&&void 0!==n?n:"0")||0],["Not Done",parseInt(null!==(i=null==e?void 0:e.notDoneTasksCount)&&void 0!==i?i:"0")||0]];return ba(r)?(0,a.jsx)(ya.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Task status"}),width:s,height:"400px"}):(0,a.jsx)(Ta,{text:(0,o.__)("Not enough data to display task status chart","quicktasker")})}var Na=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Oa={legend:{position:"left",alignment:"center",textStyle:{color:"#233238",fontSize:14}}};function Ea({pipeline:e,overviewFilter:t}){const[s,i]=(0,n.useState)(null),[o,r]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{(()=>{Na(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e,t){const s=new URLSearchParams({taskStartDate:t.taskCreationDate||"",taskDoneDate:t.taskDoneDate||"",taskAssignees:t.taskAssignees.join(",")});return u()({path:`/wpqt/v1/pipelines/${e}/overview?${s.toString()}`,method:"GET",headers:p()})}(e.id,t);i(s.data)}catch(e){console.error(e)}finally{r(!1)}}))})()}),[e.id,t]),o||!s?(0,a.jsx)(ut,{ovalSize:"48"}):(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-wrap wpqt-justify-center xl:wpqt-justify-start",children:[(0,a.jsx)(Ca,{pipelineOverviewData:s,options:Oa,width:"500px"}),(0,a.jsx)(Aa,{pipelineOverviewData:s,options:Oa,width:"500px"}),(0,a.jsx)(Sa,{pipelineOverviewData:s,options:Oa,width:"500px"})]})}function Pa({pipeline:e}){const[t,s]=(0,n.useState)({taskCreationDate:null,taskDoneDate:null,taskAssignees:[]});return(0,a.jsxs)("div",{children:[(0,a.jsx)(ja,{overviewFilter:t,onCreationDateChange:e=>{s(Object.assign(Object.assign({},t),{taskCreationDate:e}))},onDoneDateChange:e=>{s(Object.assign(Object.assign({},t),{taskDoneDate:e}))}}),(0,a.jsx)(Ea,{pipeline:e,overviewFilter:t})]})}function Ia(){const{state:{pipelines:e}}=(0,n.useContext)(xt),t=e.map((e=>e.name)),s=e.map((e=>(0,a.jsx)(Pa,{pipeline:e},e.id)));return(0,a.jsxs)(pt,{children:[(0,a.jsx)(l,{description:(0,o.__)("Get overview of the tasks.","quicktasker"),children:(0,o.__)("Overview","quicktasker")}),(0,a.jsx)(xn,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}const Da=(0,n.forwardRef)((({addPipeline:e,modalSaving:t},s)=>{const[i,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(""),d=()=>{r(""),l("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:d}))),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(rs,{children:[(0,a.jsx)(cs,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(_s,{isAutoFocus:!0,value:i,onChange:e=>r(e)})}),(0,a.jsx)(cs,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(bs,{rowsCount:3,value:c,onChange:e=>l(e)})})]}),(0,a.jsx)(ls,{onSave:()=>{e(i,c)},loading:t,saveBtnText:(0,o.__)("Add board","quicktasker")})]})}));function Ra(){const{state:{newPipelineModalOpen:e}}=(0,n.useContext)(Ut),{fetchAndSetPipelineData:t}=(0,n.useContext)(St),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=Kt(H);return(0,a.jsx)(is,{modalOpen:e,closeModal:r,children:(0,a.jsx)(Da,{ref:o,addPipeline:(e,s)=>{return n=this,a=void 0,r=function*(){try{i(!0);const o=yield(n=e,a=s,u()({path:"/wpqt/v1/pipelines",method:"POST",data:{name:n,description:a},headers:p()}));c(S,o.data,Ht.PIPELINES),t(o.data.id)}catch(e){l(e)}var n,a},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{c(r.next(e))}catch(e){t(e)}}function i(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,i)}c((r=r.apply(n,a||[])).next())}));var n,a,o,r},modalSaving:s,setModalSaving:i})})}function Ua(){return{deletePipeline:(e,t)=>{return s=this,n=void 0,r=function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,method:"DELETE",headers:p()})}(e);t&&t(s.data.deletedPipelineId,s.data.pipelineIdToLoad)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete board","quicktasker"))}},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{c(r.next(e))}catch(e){t(e)}}function o(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(i,o)}c((r=r.apply(s,n||[])).next())}));var s,n,a,r}}}const La=(0,n.forwardRef)((({editPipeline:e,modalSaving:t},s)=>{const{state:{pipelineToEdit:r},modalDispatch:c}=(0,n.useContext)(Ut),{fetchAndSetPipelineData:l,dispatch:d}=(0,n.useContext)(St),{pipelinesDispatch:u}=(0,n.useContext)(xt),{deletePipeline:p}=Ua(),[h,w]=(0,n.useState)(""),[v,m]=(0,n.useState)(""),{loading1:q,setLoading1:x}=ws();(0,n.useEffect)((()=>{r&&(w(r.name),m(r.description||""))}),[r]);const f=()=>{w(""),m("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:f}))),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsx)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:(0,a.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsxs)(rs,{children:[(0,a.jsx)(cs,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(_s,{isAutoFocus:!0,value:h,onChange:e=>w(e)})}),(0,a.jsx)(cs,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(bs,{rowsCount:3,value:v,onChange:e=>m(e)})})]}),(0,a.jsx)(an,{entityId:r.id,entityType:gs.Pipeline})]})}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:(0,a.jsx)(ns,{icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:q,text:(0,o.__)("Delete board","quicktasker"),onClick:()=>{r&&(x(!0),p(r.id,((e,t)=>{c({type:H}),x(!1),i.oR.success((0,o.__)("Board deleted","quicktasker")),u({type:I,payload:e}),null!==t?(u({type:A,payload:t}),l(t)):d({type:D})})))}})})]}),(0,a.jsx)(ls,{onSave:()=>{r&&e(Object.assign(Object.assign({},r),{name:h,description:v}))},loading:t,saveBtnText:(0,o.__)("Save","quicktasker")})]}):null}));function Ma(){const{state:{pipelineModalOpen:e}}=(0,n.useContext)(Ut),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r,handleError:c}=Kt(H);return(0,a.jsx)(is,{modalOpen:e,closeModal:o,size:"xl",children:(0,a.jsx)(La,{ref:i,editPipeline:e=>{return t=this,n=void 0,i=function*(){try{s(!0);const t=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description,is_primary:e.is_primary},headers:p()})}(e);r(C,t.data,Ht.ACTIVE_PIPELINE)}catch(e){c(e)}},new((a=void 0)||(a=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,n||[])).next())}));var t,n,a,i},modalSaving:t,setModalSaving:s})})}var Fa=s(9919);function za(){const{state:{moveTaskModalOpen:e,taskToEdit:t},modalDispatch:s}=(0,n.useContext)(Ut),{dispatch:i}=(0,n.useContext)(St),{getActivePipelineStages:r,getActivePipelinStageTasksLength:c,getTaskStage:l,getTaskOrderInStage:d}=function(){const{state:{activePipeline:e}}=(0,n.useContext)(St),t=()=>(null==e?void 0:e.stages)||[],s=e=>{const s=t();let n=null;return s?(s.forEach((t=>{t.tasks&&!n&&t.tasks.find((t=>t.id===e))&&(n=t)})),n):null};return{getActivePipelineStages:t,getActivePipelinStageTasksLength:e=>{const s=t();if(!s)return 0;const n=s.find((t=>t.id===e));return n&&n.tasks?n.tasks.length:0},getTaskStage:s,getTaskOrderInStage:e=>{const t=s(e);if(!t||!t.tasks)return null;const n=t.tasks.findIndex((t=>t.id===e));return-1!==n?n:null}}}(),{moveTask:u}=Pt(),[p,h]=(0,n.useState)(0),[w,v]=(0,n.useState)(""),[m,q]=(0,n.useState)(!1),x=c(w),f=Array.from({length:x+1},((e,t)=>({value:t.toString(),label:(t+1).toString()}))),g=r().map((e=>({value:e.id,label:e.name}))),_=()=>{s({type:X})};return(0,n.useEffect)((()=>{if(t){const e=l(t.id),s=d(t.id);e&&null!==s&&(v(e.id),h(s))}}),[t]),(0,a.jsx)(is,{modalOpen:e,closeModal:_,children:(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,a.jsx)("h2",{children:(0,o.__)("Change task location on board","quicktasker")}),(0,a.jsx)("label",{htmlFor:"move-task-stage-selection",children:(0,o.__)("Select stage","quicktasker")}),(0,a.jsx)(kt,{id:"move-task-stage-selection",allSelector:!1,selectedOptionValue:w,options:g,onSelectionChange:e=>{v(e),h(0)}}),(0,a.jsx)("label",{htmlFor:"move-task-order-selection",children:(0,o.__)("Select order","quicktasker")}),(0,a.jsx)(kt,{id:"move-task-order-selection",allSelector:!1,selectedOptionValue:String(p),options:f,onSelectionChange:e=>h(Number(e))}),(0,a.jsx)(ss,{btnText:(0,o.__)("Apply","quicktasker"),loading:m,onClick:()=>{return e=this,s=void 0,a=function*(){if(!t)return;const e=l(t.id),s=d(t.id);e&&null!==s&&(q(!0),yield u(t.id,w,p,(t=>{t&&(i({type:k,payload:{source:{droppableId:e.id,index:s},destination:{droppableId:w,index:p}}}),_())})),q(!1))},new((n=void 0)||(n=Promise))((function(t,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(e,s||[])).next())}));var e,s,n,a}})]})})}const $a=(0,n.forwardRef)((({editStage:e,addStage:t,stageModalSaving:s},i)=>{const{state:{stageToEdit:r}}=(0,n.useContext)(Ut),[c,l]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),p=!!r;(0,n.useEffect)((()=>{r&&(l(r.name),u(r.description))}),[r]);const h=()=>{l(""),u("")};return(0,n.useImperativeHandle)(i,(()=>({clearContent:h}))),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(os,{children:p?(0,o.__)("Edit Stage","quicktasker"):(0,o.__)("Add Stage","quicktasker")}),(0,a.jsxs)(rs,{children:[(0,a.jsx)(cs,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(_s,{isAutoFocus:!0,value:c,onChange:e=>l(e)})}),(0,a.jsx)(cs,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(bs,{rowsCount:3,value:d,onChange:e=>u(e)})})]}),(0,a.jsx)(ls,{onSave:()=>{p?e(Object.assign(Object.assign({},r),{name:c,description:d})):t(c,d)},loading:s,saveBtnText:p?(0,o.__)("Save","quicktasker"):(0,o.__)("Add stage","quicktasker")})]})}));var Va=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ha(){const{state:{stageModalOpen:e,targetPipelineId:t}}=(0,n.useContext)(Ut),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=Kt(F);return(0,a.jsx)(is,{modalOpen:e,closeModal:r,children:(0,a.jsx)($a,{ref:o,editStage:e=>Va(this,void 0,void 0,(function*(){try{i(!0);const t=yield function(e){return u()({path:`/wpqt/v1/stages/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description},headers:p()})}(e);c(T,t.data,Ht.ACTIVE_PIPELINE)}catch(e){l(e)}})),addStage:(e,s)=>Va(this,void 0,void 0,(function*(){try{i(!0);const r=yield(n=t,a=e,o=s,u()({path:"/wpqt/v1/stages",method:"POST",data:{pipelineId:n,name:a,description:o},headers:p()}));c(j,Object.assign(Object.assign({},r.data),{tasks:[]}),Ht.ACTIVE_PIPELINE)}catch(e){l(e)}var n,a,o})),stageModalSaving:s,stageTaskModalSaving:i})})}function Ka({pipelineId:e,stagesLength:t=0}){const{modalDispatch:s}=(0,n.useContext)(Ut),i=()=>{return t=this,n=void 0,i=function*(){s({type:M,payload:{targetPipelineId:e}})},new((a=void 0)||(a=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,n||[])).next())}));var t,n,a,i};return 0===t?(0,a.jsx)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-w-full wpqt-items-center wpqt-justify-center",children:(0,a.jsxs)("div",{className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-gap-y-1 wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,a.jsx)(Is.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,a.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add first stage","quicktasker")})]})}):(0,a.jsxs)("div",{className:"wpqt-main-border wpqt-mb-3 wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-self-start wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,a.jsx)(Is.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,a.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add stage","quicktasker")})]})}function Ga(){const{modalDispatch:e}=(0,n.useContext)(Ut);return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-items-center wpqt-justify-center",children:(0,a.jsxs)("div",{onClick:()=>{return t=this,s=void 0,a=function*(){e({type:$})},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:[(0,a.jsx)(Is.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer"}),(0,a.jsx)("span",{children:(0,o.__)("Add your first Board","quicktasker")})]})})}var Ba=s(12),Wa=s(5575),Qa=s(6304),Ya=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Xa({stage:e}){var t,s,r,c;const{dispatch:l,state:{activePipeline:d},fetchAndSetPipelineData:h}=(0,n.useContext)(St),{modalDispatch:w}=(0,n.useContext)(Ut),{state:{isUserAllowedToDelete:v}}=(0,n.useContext)(qs),[m,q]=(0,n.useState)(!1),[x,f]=(0,n.useState)(!1),[g,k]=(0,n.useState)(!1),_=null!==(s=null===(t=null==d?void 0:d.stages)||void 0===t?void 0:t.length)&&void 0!==s?s:0,j=null!==(c=null===(r=e.tasks)||void 0===r?void 0:r.length)&&void 0!==c?c:0,b=+e.stage_order,T=b>0&&b<_,S=b!==_-1,C=t=>Ya(this,void 0,void 0,(function*(){try{q(!0),yield function(e,t){return u()({path:`/wpqt/v1/stages/${e}/move`,method:"PATCH",data:{direction:t},headers:p()})}(e.id,t),yield h(d.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a stage","quicktasker"))}finally{q(!1)}}));return(0,a.jsxs)(cn,{menuBtn:({active:e})=>(0,a.jsx)(ln,{isActive:e,IconComponent:Ba.A}),children:[T&&(0,a.jsx)(dn,{text:(0,o.__)("Move left","quicktasker"),loading:m,icon:(0,a.jsx)(Wa.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>C("left")}),S&&(0,a.jsx)(dn,{text:(0,o.__)("Move right","quicktasker"),loading:m,icon:(0,a.jsx)(Qa.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>C("right")}),(0,a.jsx)(dn,{text:(0,o.__)("Edit stage","quicktasker"),icon:(0,a.jsx)(Fs.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:()=>{w({type:z,payload:{stageToEdit:e}})}}),(0,a.jsx)(dn,{text:(0,o.__)("Archive all stage tasks","quicktasker"),icon:(0,a.jsx)(us.A,{className:"wpqt-icon-blue wpqt-size-4"}),loading:x,onClick:()=>Ya(this,void 0,void 0,(function*(){try{f(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}/archive-tasks`,method:"PATCH",headers:p()})),yield h(d.id),i.oR.success((0,o.sprintf)((0,o.__)("Archived all %s tasks","quicktasker"),e.name))}catch(t){console.error(t),i.oR.error((0,o.sprintf)((0,o.__)("Failed to archive stage %s tasks","quicktasker"),e.name))}finally{f(!1)}var t})),disabled:0===j,id:`item-dropdown-${e.id}-archive`,tooltipText:0===j?(0,o.__)("No tasks to archive on the stage","quicktasker"):void 0}),v&&(0,a.jsx)(dn,{text:(0,o.__)("Delete stage","quicktasker"),icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:g,onClick:()=>Ya(this,void 0,void 0,(function*(){try{k(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}`,method:"DELETE",data:{stageId:t},headers:p()})),l({type:y,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a stage","quicktasker"))}finally{k(!1)}var t})),disabled:j>0,className:"!wpqt-mb-0",id:`item-dropdown-${e.id}`,tooltipText:(0,o.__)("Stage can be deleted when there are no tasks on it","quicktasker")})]})}var Ja=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Za({stageId:e}){const[t,s]=(0,n.useState)(""),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),h=(0,n.useRef)(null),w=(0,n.useRef)(null),{state:{activePipeline:v},dispatch:m}=(0,n.useContext)(St),{handleExecutedAutomations:q}=Ot();(0,n.useEffect)((()=>{const e=e=>{"Enter"===e.key&&document.activeElement===w.current&&x()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),(0,n.useEffect)((()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&f()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,n.useEffect)((()=>{var e;r&&(null===(e=w.current)||void 0===e||e.focus())}),[r]);const x=()=>Ja(this,void 0,void 0,(function*(){if(t)try{d(!0);const s=yield function(e,t,s){return u()({path:"/wpqt/v1/tasks",method:"POST",data:{stageId:e,name:s,pipelineId:t},headers:p()})}(e,v.id,t);m({type:_,payload:s.data.newTask}),i.oR.success((0,o.__)("Task created","quicktasker")),f(),q(s.data.executedAutomations,s.data.newTask.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create task","quicktasker"))}finally{d(!1)}else i.oR.error((0,o.__)("Task name is required","quicktasker"))})),f=()=>{c(!1),s("")};return(0,a.jsx)("div",{ref:h,className:"wpqt-sticky wpqt-bottom-0 wpqt-z-10 wpqt-order-1 wpqt-mt-2 wpqt-flex wpqt-justify-center wpqt-bg-gray-100 wpqt-py-2",children:r?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,a.jsx)(_s,{ref:w,value:t,onChange:e=>s(e),wrapperClassName:"!wpqt-mb-0",className:"!wpqt-mb-0"}),l?(0,a.jsx)(lt,{width:"24",height:"24"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ps.A,{className:"wpqt-icon-red wpqt-size-6 wpqt-cursor-pointer",onClick:f}),(0,a.jsx)(Is.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer",onClick:x})]})]}):(0,a.jsxs)("div",{onClick:()=>c(!0),className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-p-2 hover:wpqt-bg-white",children:[(0,o.__)("Add task","quicktasker"),(0,a.jsx)(Is.A,{className:"wpqt-size-6 wpqt-text-green-600"})]})})}var ei=s(1735),ti=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function si({task:e}){const{modalDispatch:t}=(0,n.useContext)(Ut),{state:{activePipeline:s},fetchAndSetPipelineData:i}=(0,n.useContext)(St),{state:{isUserAllowedToDelete:r}}=(0,n.useContext)(qs),{deleteTask:c,archiveTask:l}=Pt(),[d,u]=(0,n.useState)(!1);return(0,a.jsxs)(cn,{menuBtn:({active:e})=>(0,a.jsx)(ln,{isActive:e,IconComponent:aa.A}),children:[(0,a.jsx)(dn,{text:(0,o.__)("Archive task","quicktasker"),icon:(0,a.jsx)(us.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),l(e.id,(()=>{i(s.id)}))}}),(0,a.jsx)(dn,{text:(0,o.__)("Edit task","quicktasker"),icon:(0,a.jsx)(Fs.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:U,payload:{taskToEdit:e}})}}),(0,a.jsx)(dn,{text:(0,o.__)("Move task","quicktasker"),icon:(0,a.jsx)(ei.zhn,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:Y,payload:{task:e}})}}),r&&(0,a.jsx)(dn,{text:(0,o.__)("Delete task","quicktasker"),icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:d,onClick:t=>ti(this,void 0,void 0,(function*(){t.stopPropagation(),u(!0),yield c(e.id,(()=>{i(s.id)})),u(!1)})),className:"!wpqt-mb-0"})]})}var ni=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ai({task:e,index:t,onLastStage:s}){const{modalDispatch:i}=(0,n.useContext)(Ut),{state:{activePipeline:o}}=(0,n.useContext)(St),r=!(null==o?void 0:o.settings).allow_only_last_stage_task_done||s,c=()=>{i({type:U,payload:{taskToEdit:e,taskModalSettings:{allowToMarkTaskAsDone:r}}})};return(0,a.jsx)(Fa.sx,{draggableId:e.id,index:t,children:t=>(0,a.jsxs)("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:"wpqt-relative wpqt-mx-4 wpqt-mb-2 wpqt-flex !wpqt-cursor-pointer wpqt-flex-col wpqt-gap-1 wpqt-rounded wpqt-border wpqt-border-gray-200 wpqt-bg-white wpqt-p-3 wpqt-shadow hover:wpqt-shadow-md",onClick:c,children:[(0,a.jsx)("div",{className:"wpqt-absolute wpqt-right-[12px] wpqt-top-[12px]",children:(0,a.jsx)(si,{task:e})}),(0,a.jsx)("div",{className:"wpqt-text-base",children:e.name}),e.description&&(0,a.jsx)("div",{className:"wpqt-text-sm wpqt-italic",children:e.description}),(0,a.jsx)("div",{className:"wpqt-mt-2",children:(0,a.jsx)(mn,{task:e})}),(0,a.jsx)(ii,{task:e,allowToMarkTaskAsDone:r})]}))},e.id)}function ii({task:e,allowToMarkTaskAsDone:t}){const{dispatch:s}=(0,n.useContext)(St),{changeTaskDoneStatus:i}=Pt(),[o,r]=(0,n.useState)(!1),c=e.is_done,l=t=>ni(this,void 0,void 0,(function*(){r(!0),yield i(e.id,t,(t=>{s({type:P,payload:{taskId:e.id,done:t}})})),r(!1)}));return t?o?(0,a.jsx)(ut,{ovalSize:"24"}):(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:c?(0,a.jsx)(hs.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,a.jsx)(hs.A,{className:"wpqt-size-6 wpqt-icon-gray",onClick:e=>{e.stopPropagation(),l(!0)}})}):null}function oi({tasks:e}){const t=e.length;return(0,a.jsx)("span",{className:"wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-1 wpqt-text-xs",children:t})}function ri({stage:e,isLastStage:t}){return(0,a.jsxs)("div",{"data-stage-id":e.id,className:"wpqt-relative wpqt-mb-3 wpqt-flex wpqt-max-h-full wpqt-w-[360px] wpqt-flex-none wpqt-flex-col wpqt-overflow-hidden wpqt-rounded-md wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-gray-100",children:[(0,a.jsxs)("div",{className:"wpqt-mb-4 wpqt-flex wpqt-flex-wrap wpqt-items-center wpqt-gap-1 wpqt-px-4 wpqt-pt-3",children:[(0,a.jsxs)("div",{className:"wpqt-mr-auto wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-text-base wpqt-leading-none",children:[e.name," ",(0,a.jsx)(oi,{tasks:e.tasks})]}),(0,a.jsx)(Xa,{stage:e}),e.description&&(0,a.jsx)("div",{className:"wpqt-w-full wpqt-flex-shrink-0 wpqt-flex-grow-0 wpqt-text-sm",children:e.description})]}),(0,a.jsx)(Fa.gL,{droppableId:e.id,children:s=>{var n;return(0,a.jsxs)("div",{ref:s.innerRef,className:"wpqt-flex wpqt-h-full wpqt-flex-col wpqt-overflow-y-auto wpqt-overflow-x-hidden",children:[null===(n=e.tasks)||void 0===n?void 0:n.map(((e,s)=>(0,a.jsx)(ai,{task:e,index:s,onLastStage:t},e.id))),s.placeholder,(0,a.jsx)(Za,{stageId:e.id})]})}})]})}const ci=()=>{var e,t;const{state:{activePipeline:s},dispatch:r,fetchAndSetPipelineData:c}=(0,n.useContext)(St);(0,n.useEffect)((()=>{const e=setInterval((()=>{s&&c(s.id)}),3e4);return()=>clearInterval(e)}),[s]);const l=(e,t)=>{e.droppableId===t.droppableId?r({type:"REORDER_TASK",payload:{source:e,destination:t}}):r({type:k,payload:{source:e,destination:t}})},d=(0,n.useCallback)((e=>{return t=void 0,s=void 0,a=function*(){const{source:t,destination:s,draggableId:n}=e;if(s){l(t,s);try{yield h(n,s.droppableId,s.index)}catch(e){console.error(e),l(s,t),i.oR.error((0,o.__)("Failed to move a task","quicktasker"))}}},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a}),[s]);return s?(0,a.jsxs)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-gap-[24px] wpqt-overflow-x-auto wpqt-overflow-y-hidden",children:[(0,a.jsx)(Fa.JY,{onDragEnd:d,children:null===(e=s.stages)||void 0===e?void 0:e.map(((e,t)=>{const n=t===s.stages.length-1;return(0,a.jsx)(ri,{stage:e,isLastStage:n},e.id)}))}),(0,a.jsx)(Ka,{pipelineId:s.id,stagesLength:null===(t=s.stages)||void 0===t?void 0:t.length}),(0,a.jsx)(Yn,{deleteTaskCallback:()=>{s&&c(s.id)}}),(0,a.jsx)(za,{}),(0,a.jsx)(Ha,{})]}):(0,a.jsx)(Ga,{})};var li=s(247),di=s(1203),ui=s(2496),pi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function hi(){const{state:{activePipeline:e},fetchAndSetPipelineData:t}=(0,n.useContext)(St),{state:{pipelines:s},pipelinesDispatch:r}=(0,n.useContext)(xt),{modalDispatch:c}=(0,n.useContext)(Ut),l=e=>pi(this,void 0,void 0,(function*(){try{yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/set-primary`,method:"PATCH",headers:p()})),r({type:A,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to set primary board","quicktasker"))}var t}));return(0,a.jsxs)(cn,{menuBtnClasses:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1 wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-3",menuBtn:({active:t})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-leading-none",children:null==e?void 0:e.name}),(0,a.jsx)(di.A,{className:"wpqt-size-4 "+(t?"wpqt-text-qtBlueHover":"")})]}),children:[(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center wpqt-font-bold",children:(0,o.__)("Change board","quicktasker")}),s.map((s=>{const n=s.is_primary,i=(null==e?void 0:e.id)===s.id;return(0,a.jsx)(rn.Dr,{children:(0,a.jsxs)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-gap-2",children:[(0,a.jsx)("div",{className:(0,ys.$)("wpqt-cursor-pointer wpqt-text-center",{"wpqt-font-bold":i}),onClick:()=>t(s.id),children:s.name}),(0,a.jsx)("div",{className:"wpqt-ml-auto",children:n?(0,a.jsx)(ui.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-blue-500"}):(0,a.jsx)(li.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-gray-400",onClick:e=>{e.stopPropagation(),l(s)}})})]})},s.id)})),(0,a.jsx)(rn.Dr,{children:(0,a.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:(0,a.jsx)(ns,{text:(0,o.__)("Add new board","quicktasker"),onClick:()=>pi(this,void 0,void 0,(function*(){c({type:$})})),icon:(0,a.jsx)(Is.A,{className:"wpqt-size-6 wpqt-icon-green"}),className:"wpqt-bg-white hover:!wpqt-bg-gray-100"})})},"new-pipeline")]})}function wi(){const{state:{activePipeline:e,loading:t},fetchAndSetPipelineData:s}=(0,n.useContext)(St),{modalDispatch:i}=(0,n.useContext)(Ut);return e?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-py-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,a.jsx)("div",{className:"wpqt-text-lg",children:e.name}),(0,a.jsx)(Ba.A,{className:"wpqt-text-gray-400 wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{e&&i({type:V,payload:{pipelineToEdit:e}})}})]}),e.description&&(0,a.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,a.jsxs)("div",{className:"wpqt-ml-auto wpqt-flex wpqt-items-center wpqt-gap-3",children:[t?(0,a.jsx)(lt,{width:"24",height:"24"}):(0,a.jsx)(On.A,{className:"wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>s(e.id)}),(0,a.jsx)(hi,{})]})]}):null}const vi=()=>(0,a.jsx)(Ct,{children:(0,a.jsxs)(pt,{children:[(0,a.jsx)(wi,{}),(0,a.jsx)(ci,{}),(0,a.jsx)(Ra,{}),(0,a.jsx)(Ma,{})]})});var mi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function qi(){return{saveCustomUserPageStyles:(e,t)=>mi(this,void 0,void 0,(function*(){try{const n=yield(s=e,u()({path:"/wpqt/v1/settings/user-page-custom-styles",method:"PATCH",data:{styles:s},headers:p()}));t&&t(n.data),i.oR.success((0,o.__)("Custom user page styles saved successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to save custom user page styles","quicktasker"))}var s})),saveTaskCompletionDoneSetting:(e,t,s)=>mi(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/pipelines/${e}/settings/task-completion-done-restriction`,method:"PATCH",data:{allow_task_completion_only_on_last_stage:t},headers:p()})}(e,t),s&&s(t)}catch(e){s&&s(!t),console.error(e),i.oR.error((0,o.__)("Failed to save setting","quicktasker"))}}))}}const xi=({children:e,title:t,description:s})=>(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-mb-5",children:[(0,a.jsx)("h3",{className:"wpqt-mb-1",children:t}),(0,a.jsx)("p",{children:s}),e]});const fi=()=>{const{state:{userPageCustomStyles:e},appDispatch:t}=(0,n.useContext)(qs),[s,i]=(0,n.useState)(""),[r,c]=(0,n.useState)(!1),{saveCustomUserPageStyles:l}=qi();return(0,n.useEffect)((()=>{i(e)}),[e]),(0,a.jsxs)(xi,{title:(0,o.__)("Custom style","quicktasker"),description:(0,o.__)("Add custom CSS rules for QuickTasker user page.","quicktasker"),children:[(0,a.jsx)(bs,{value:s,onChange:i}),(0,a.jsx)(ns,{text:(0,o.__)("Save","quicktasker"),loading:r,onClick:()=>{return e=void 0,n=void 0,i=function*(){c(!0),yield l(s,(e=>{t({type:me,payload:e})})),c(!1)},new((a=void 0)||(a=Promise))((function(t,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(e,n||[])).next())}));var e,n,a,i},icon:(0,a.jsx)(Jt.RZ0,{className:"wpqt-icon-blue wpqt-size-4"})})]})},gi=(e,t)=>{var s,n;switch(t.type){case De:{const s=t.payload.automations;return Object.assign(Object.assign({},e),{automations:s})}case Re:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case Ue:{const a=t.payload,i=null!==(n=null===(s=e.automations)||void 0===s?void 0:s.filter((e=>e.id!==a)))&&void 0!==n?n:null;return Object.assign(Object.assign({},e),{automations:i})}case Le:{const s=t.payload,n=e.automations?[...e.automations,s]:[s];return Object.assign(Object.assign({},e),{automations:n})}default:return e}};const ki={automations:null,loading:!0},_i=(0,n.createContext)({state:ki,pipelineAutomationsDispatch:()=>{}}),ji=({children:e,pipelineId:t})=>{const[s,o]=(0,n.useReducer)(gi,ki),r=()=>{return e=void 0,s=void 0,a=function*(){try{o({type:Re,payload:!0});const e=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"GET",headers:p()})}(t);o({type:De,payload:{automations:e.data.automations}})}catch(e){console.error(e),i.oR.error("Failed to load board automations")}finally{o({type:Re,payload:!1})}},new((n=void 0)||(n=Promise))((function(t,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(e,s||[])).next())}));var e,s,n,a};return(0,n.useEffect)((()=>{r()}),[]),(0,a.jsx)(_i.Provider,{value:{state:s,pipelineAutomationsDispatch:o},children:e})};var yi=s(1226),bi=s(6973);const Ti={automationTarget:null,automationTrigger:null,automationAction:null,automationActionTargetId:null,automationActionTargetType:null,metaData:null};function Si(e,t){switch(t.type){case"SET_TARGET":return Object.assign(Object.assign({},e),{automationTarget:t.payload,automationTrigger:null,automationAction:null});case"SET_TRIGGER":return Object.assign(Object.assign({},e),{automationTrigger:t.payload,automationAction:null});case"SET_ACTION":return Object.assign(Object.assign({},e),{automationAction:t.payload});case"RESET":return Ti;case"SET_ACTION_TARGET":return Object.assign(Object.assign({},e),{automationActionTargetId:t.payload.automationActionTargetId,automationActionTargetType:t.payload.automationActionTargetType});case"SET_META":return Object.assign(Object.assign({},e),{metaData:t.payload});default:return e}}const Ci={[He.ARCHIVE_TASK]:(0,o.__)("Archive task","quicktasker"),[He.ASSIGN_USER]:(0,o.__)("Assign user","quickkasker"),[He.NEW_ENTITY_EMAIL]:(0,o.__)("Send email notification","quicktasker")},Ai={[$e.Task]:(0,o.__)("Task","quicktasker"),[$e.Stage]:(0,o.__)("Stage","quicktasker"),[$e.PIPELINE]:(0,o.__)("Board","quicktasker"),[$e.quicktasker]:"Quicktasker"},Ni={[ze.TASK_DONE]:(0,o.__)("Task marked as done","quicktasker"),[ze.Task_NOT_DONE]:(0,o.__)("Task marked as not done","quicktasker"),[ze.TASK_CREATED]:(0,o.__)("Task created","quicktasker")},Oi={[ze.TASK_DONE]:[{id:He.ARCHIVE_TASK}],[ze.Task_NOT_DONE]:[{id:He.ARCHIVE_TASK}],[ze.TASK_CREATED]:[{id:He.ASSIGN_USER,requireAutomationTarget:!0,requireAutomationTargetType:!0},{id:He.NEW_ENTITY_EMAIL,requireMetaData:!0}]},Ei={[$e.Task]:Oi},Pi=()=>{const{state:{users:e,wpUsers:t}}=(0,n.useContext)($t);return{getUser:(s,n)=>n===Fe.QUICKTASKER?e.find((e=>e.id===s)):n===Fe.WP_USER?t.find((e=>e.id===s)):void 0}};function Ii({actionTargetId:e,actionTargetType:t}){if(null===e||null===t)return null;const{getUser:s}=Pi();if(t===Ve.QUICKTASKER||t===Ve.WP_USER||null!==e){const n=We(t);if(n){const t=s(e,n);return(0,a.jsx)("div",{className:"wpqt-text-center",children:(null==t?void 0:t.name)||(0,o.__)("User not found","quicktasker")})}}return null}var Di=s(7613);function Ri({value:e,label:t,onClick:s=()=>{},className:n=""}){return(0,a.jsx)("div",{className:`wpqt-inline-flex wpqt-rounded-xl wpqt-px-4 wpqt-py-1 wpqt-border wpqt-border-solid wpqt-cursor-pointer wpqt-border-qtBorder ${n}`,onClick:()=>{s(e)},children:t})}function Ui({children:e,title:t}){return(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-font-semibold wpqt-text-base wpqt-mb-4 wpqt-text-center",children:t}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-gap-3",children:e})]})}function Li({automationDispatch:e,automation:t}){if(!t.automationTarget||!t.automationTrigger)return null;const s=t.automationTarget,n=t.automationTrigger,i=Ei[s][n];return(0,a.jsx)(Ui,{title:(0,o.__)("Step 3. Select action","quicktasker"),children:i.map((t=>(0,a.jsx)(Ri,{value:t.id,label:Ci[t.id],onClick:()=>{e({type:"SET_ACTION",payload:t})}},t.id)))})}function Mi({quickTaskerUsers:e,wpUsers:t,assignUser:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,a.jsx)(hn,{sectionTitle:(0,o.__)("Assign a quicktasker","quicktasker"),users:e,onItemSelect:s,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No quicktaskers available to assign","quicktasker")}),(0,a.jsx)(hn,{sectionTitle:(0,o.__)("Assign a WordPress user","quicktasker"),users:t,onItemSelect:s,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No WordPress users with required permissions available to assign","quicktasker")})]})}function Fi({automationAction:e,onUserAdd:t=()=>{},quickTaskerUserTargets:s=[],wpUserTargets:n=[],menuBtnClasses:i=""}){const o=[...s,...n].length>0;return(0,a.jsx)(cn,{menuBtnClasses:`wpqt-inline-flex ${i}`,anchor:"bottom start",menuBtn:()=>(0,a.jsx)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:(0,a.jsx)(on.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`})}),children:e===He.ASSIGN_USER&&(0,a.jsx)(Mi,{quickTaskerUsers:s,wpUsers:n,assignUser:t})})}const zi=[He.ASSIGN_USER];function $i({automationDispatch:e,automation:t}){var s;const{state:{users:i,wpUsers:r}}=(0,n.useContext)($t),c=null===(s=t.automationAction)||void 0===s?void 0:s.id,l=void 0!==c&&zi.includes(c);return(0,a.jsx)(Ui,{title:(0,o.__)("Step 4. Select action target","quicktasker"),children:l&&(0,a.jsx)(Fi,{automationAction:c,quickTaskerUserTargets:i,wpUserTargets:r,onUserAdd:t=>{console.log("Assigning automation user"),e({type:"SET_ACTION_TARGET",payload:{automationActionTargetId:t.id,automationActionTargetType:t.user_type}})}})})}var Vi=s(4476);const Hi={success:"wpqt-bg-green-100 wpqt-border-green-400 wpqt-text-green-700",error:"wpqt-bg-red-100 wpqt-border-red-400 wpqt-text-red-700",warning:"wpqt-bg-yellow-100 wpqt-border-yellow-400 wpqt-text-yellow-700",info:"wpqt-bg-blue-100 wpqt-border-blue-400 wpqt-text-blue-700",primary:"wpqt-bg-gray-100 wpqt-border-gray-400 wpqt-text-gray-700"};function Ki({type:e="primary",className:t="",children:s}){const n=Hi[e];return(0,a.jsx)("div",{className:`wpqt-inline-flex wpqt-p-2 wpqt-border wpqt-border-solid wpqt-rounded-md ${n} ${t}`,children:s})}const Gi=Vi.z.string().email({message:"Invalid email address"});function Bi({setAutomationMeta:e}){const[t,s]=(0,n.useState)(""),[i,r]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{(e=>{try{Gi.parse(e),r(!0)}catch(e){r(!1)}})(t)}),[t]),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-justify-center wpqt-items-center",children:[(0,a.jsx)(Ki,{type:"info",children:(0,o.__)("Make sure your website is configured to send out emails","quicktasker")}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,a.jsx)("label",{htmlFor:"automation-meta-email-input",children:(0,o.__)("Email will be sent to","quicktasker")}),(0,a.jsx)(_s,{inputId:"automation-meta-email-input",value:t,onChange:s,wrapperClassName:"!wpqt-mb-0"}),!i&&(0,a.jsx)("div",{className:"wpqt-text-red-500",children:(0,o.__)("Invalid email address","quicktasker")})]}),(0,a.jsx)(ss,{btnText:(0,o.__)("Set email","quicktasker"),onClick:()=>{i&&e(t)}})]})}function Wi({automationCreationState:e,automationDispatch:t}){var s;return(null===(s=null==e?void 0:e.automationAction)||void 0===s?void 0:s.id)===He.NEW_ENTITY_EMAIL?(0,a.jsx)(Bi,{setAutomationMeta:e=>{t({type:"SET_META",payload:e})}}):null}function Qi({automationDispatch:e}){const t=Object.keys(Ei).map((e=>({value:e,label:Ai[e]||e})));return(0,a.jsx)(Ui,{title:(0,o.__)("Step 1. Select a target","quicktasker"),children:t.map((({value:t,label:s})=>(0,a.jsx)(Ri,{value:t,label:s,onClick:()=>{e({type:"SET_TARGET",payload:t})}},t)))})}function Yi({automationDispatch:e,automation:t}){if(!t.automationTarget)return null;const s=t.automationTarget,n=Object.keys(Ei[s]).map((e=>({value:e,label:Ni[e]||e})));return(0,a.jsx)(Ui,{title:(0,o.__)("Step 2. Select a trigger","quicktasker"),children:n.map((({value:t,label:s})=>(0,a.jsx)(Ri,{value:t,label:s,onClick:()=>{e({type:"SET_TRIGGER",payload:t})}},t)))})}var Xi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ji({automation:e,automationDispatch:t,createAutomation:s}){const[i,r]=(0,n.useState)(!1);return null===e.automationTarget?(0,a.jsx)(Qi,{automationDispatch:t}):null===e.automationTrigger?(0,a.jsx)(Yi,{automationDispatch:t,automation:e}):null===e.automationAction?(0,a.jsx)(Li,{automationDispatch:t,automation:e}):e.automationAction&&e.automationAction.requireAutomationTarget&&e.automationAction.requireAutomationTargetType&&(null===e.automationActionTargetType||null===e.automationActionTargetId)?(0,a.jsx)($i,{automationDispatch:t,automation:e}):e.automationAction.requireMetaData&&!e.metaData?(0,a.jsx)(Wi,{automationCreationState:e,automationDispatch:t}):(0,a.jsx)(ns,{text:(0,o.__)("Create automation","quicktasker"),icon:(0,a.jsx)(Di.ltU,{className:"wpqt-size-6"}),onClick:()=>Xi(this,void 0,void 0,(function*(){r(!0),yield s(),r(!1)})),loading:i})}var Zi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function eo({pipelineId:e}){const{pipelineAutomationsDispatch:t}=(0,n.useContext)(_i),[s,i]=(0,n.useState)(!1),[r,c]=(0,n.useReducer)(Si,Ti),{createAutomation:l}=Ot(),d=null!==r.automationActionTargetId&&null!==r.automationActionTargetType,u=null!==r.metaData,p="wpqt-px-3 wpqt-min-w-[60px] wpqt-cursor-default",h="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1",w=()=>{c({type:"RESET"})};return s?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-3 wpqt-main-border wpqt-p-4 wpqt-justify-center",children:[(0,a.jsx)(ea,{title:(0,o.__)("Target","quicktasker"),className:p,titleClassName:h,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTarget?Ai[r.automationTarget]:(0,a.jsx)(to,{})})}),(0,a.jsx)(ea,{title:(0,o.__)("Trigger","quicktasker"),className:p,titleClassName:h,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTrigger?Ni[r.automationTrigger]:(0,a.jsx)(to,{})})}),(0,a.jsx)(ea,{title:(0,o.__)("Action","quicktasker"),className:p,titleClassName:h,children:(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center wpqt-items-center",children:[r.automationAction?Ci[r.automationAction.id]:(0,a.jsx)(to,{}),d&&(0,a.jsx)(Ii,{actionTargetId:r.automationActionTargetId,actionTargetType:r.automationActionTargetType}),u&&(0,a.jsx)("div",{children:r.metaData})]})})]}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Ji,{automation:r,automationDispatch:c,createAutomation:()=>Zi(this,void 0,void 0,(function*(){yield l(e,r,((e,s)=>{e&&s&&(w(),t({type:Le,payload:s}))}))}))})}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(ns,{icon:(0,a.jsx)(bi.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Close automation creator","quicktasker"),onClick:()=>{i(!1),w()}})})]}):(0,a.jsx)("div",{children:(0,a.jsx)(ns,{icon:(0,a.jsx)(bi.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Create a new automation","quicktasker"),onClick:()=>i(!0)})})}function to(){return(0,a.jsx)(yi.A,{className:"wpqt-size-7 wpqt-text-gray-300"})}var so=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function no({automation:e}){const{pipelineAutomationsDispatch:t}=(0,n.useContext)(_i),{deleteAutomation:s}=Ot(),[i,r]=(0,n.useState)(!1),c="wpqt-px-3 wpqt-pt-1 wpqt-min-w-[60px] wpqt-cursor-default",l="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1",d=null!==e.automation_action_target_id&&null!==e.automation_action_target_type,u=null!==e.metadata;return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-3 wpqt-main-border wpqt-p-4",children:[(0,a.jsx)(ea,{title:(0,o.__)("Target","quicktasker"),className:c,titleClassName:l,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:Ai[e.target_type]})}),(0,a.jsx)(ea,{title:(0,o.__)("Trigger","quicktasker"),className:c,titleClassName:l,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:Ni[e.automation_trigger]})}),(0,a.jsx)(ea,{title:(0,o.__)("Action","quicktasker"),className:c,titleClassName:l,children:(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center wpqt-items-center",children:[Ci[e.automation_action],d&&(0,a.jsx)(Ii,{actionTargetId:e.automation_action_target_id,actionTargetType:e.automation_action_target_type}),u&&(0,a.jsx)("div",{children:e.metadata})]})}),(0,a.jsx)(ea,{title:(0,o.__)("Controls","quicktasker"),className:`${c}`,titleClassName:l,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-gap-2",children:(0,a.jsx)(ns,{loading:i,text:(0,o.__)("Delete","quicktasker"),icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-5"}),onClick:()=>so(this,void 0,void 0,(function*(){r(!0),yield s(e.pipeline_id,e.id,(s=>{s&&t({type:Ue,payload:e.id})})),r(!1)}))})})})]})}function ao(){const{state:{automations:e,loading:t}}=(0,n.useContext)(_i),[s,i]=(0,n.useState)(!1);return t?(0,a.jsx)(ut,{ovalSize:"24"}):e&&0!==e.length?s?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3 wpqt-mb-3",children:e.map((e=>(0,a.jsx)(no,{automation:e},e.id)))}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(ns,{icon:(0,a.jsx)(bi.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Hide board automations","quicktasker"),onClick:()=>i(!1)})})]}):(0,a.jsx)("div",{children:(0,a.jsx)(ns,{icon:(0,a.jsx)(bi.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Show board automations","quicktasker"),onClick:()=>i(!0)})}):(0,a.jsx)(Ki,{type:"info",children:(0,o.__)("No automations created for this board","quicktasker")})}function io({children:e}){return(0,a.jsx)(xi,{title:(0,o.__)("Board automations","quicktasker"),description:(0,o.__)("Allows to automate various tasks","quicktasker"),children:e})}function oo({pipelineId:e}){return Me?(0,a.jsx)(ji,{pipelineId:e,children:(0,a.jsxs)(io,{children:[(0,a.jsx)("div",{className:"wpqt-mb-4",children:(0,a.jsx)(ao,{})}),(0,a.jsx)("div",{children:(0,a.jsx)(eo,{pipelineId:e})})]})}):(0,a.jsx)(Es,{title:(0,o.__)("Board automations","quicktasker"),description:(0,o.__)("Premium feature to automate various tasks.","quicktasker")})}var ro=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function co({allow_only_last_stage_task_done:e,pipelineId:t}){const[s,i]=(0,n.useState)(e),[r,c]=(0,n.useState)(!1),{saveTaskCompletionDoneSetting:l}=qi();return(0,a.jsx)(xi,{title:(0,o.__)("Restrict Task Completion","quicktasker"),description:(0,o.__)("Allow to mark task as done only on board last stage. By default, task can be marked as done on any stage. Will apply also to QuickTasker page","quicktasker"),children:(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,a.jsx)(Ss,{checked:s,handleChange:e=>ro(this,void 0,void 0,(function*(){i(e),c(!0),yield l(t,e,(e=>{i(e)})),c(!1)}))}),r&&(0,a.jsx)(lt,{width:"20",height:"20"})]})})}var lo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function uo({pipeline:e}){const[t,s]=(0,n.useState)(!0),[i,o]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(()=>{lo(this,void 0,void 0,(function*(){try{s(!0);const n=yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/settings`,method:"GET",headers:p()}));o(wt(n.data.settings))}catch(e){console.error(e)}finally{s(!1)}var t}))})()}),[]),t?(0,a.jsx)(ut,{}):i?(0,a.jsxs)("div",{children:[(0,a.jsx)(co,{pipelineId:e.id,allow_only_last_stage_task_done:i.allow_only_last_stage_task_done}),(0,a.jsx)(oo,{pipelineId:e.id})]}):null}function po(){const{state:{pipelines:e}}=(0,n.useContext)(xt),t=e.map((e=>e.name)),s=e.map((e=>(0,a.jsx)(uo,{pipeline:e},e.id)));return(0,a.jsx)("div",{children:(0,a.jsx)(xn,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})})}const ho=()=>(0,a.jsxs)(pt,{children:[(0,a.jsx)(l,{description:(0,o.__)("Manage settings, preferences, and configurations.","quicktasker"),children:(0,o.__)("Settings","quicktasker")}),(0,a.jsx)(fi,{}),(0,a.jsx)(po,{})]});var wo=s(8932),vo=s(1548),mo=s(1266),qo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function xo(){return{createUser:(e,t,s)=>qo(this,void 0,void 0,(function*(){try{const r=yield(n=e,a=t,u()({path:"/wpqt/v1/users",method:"POST",data:{name:n,description:a},headers:p()}));s&&s(r.data),i.oR.success((0,o.__)("User created successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User creation failed. Please try again","quicktasker"))}var n,a})),editUser:(e,t)=>qo(this,void 0,void 0,(function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/users/${e.id}`,method:"PATCH",data:{user:e},headers:p()})}(e);t&&t(s.data),i.oR.success((0,o.__)("User edited successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User edit failed. Please try again","quicktasker"))}})),changeUserStatus:(e,t,s)=>qo(this,void 0,void 0,(function*(){try{const n=yield function(e,t){return u()({path:`/wpqt/v1/users/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e,t);s&&s(n.data),i.oR.success((0,o.__)("User status changed successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change user status. Please try again","quicktasker"))}})),deleteUser:(e,t)=>qo(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}`,method:"DELETE",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User deleted successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete user. Please try again","quicktasker"))}})),resetUserPassword:(e,t)=>qo(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}/password-reset`,method:"PATCH",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User password reset successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to reset user password. Please try again","quicktasker"))}}))}}var fo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function go({data:e,changeStatus:t,changeSetUpStatus:s,changePasswordStatus:i}){const{changeUserStatus:r,deleteUser:c,resetUserPassword:l}=xo(),{userDispatch:d}=(0,n.useContext)($t),{loading1:u,setLoading1:p,loading2:h,setLoading2:w,loading3:v,setLoading3:m}=ws(),q=e.is_active,x=e.has_password;return(0,a.jsxs)("div",{className:"wpqt-mt-5 wpqt-flex wpqt-gap-2",children:[(0,a.jsx)(ns,{icon:(0,a.jsx)(wo.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${e.id}/tasks`}}),!q&&(0,a.jsx)(ns,{icon:(0,a.jsx)(vo.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:h,onClick:()=>fo(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!0,(e=>{d({type:ue,payload:Object.assign({},e)}),t(!0)})),w(!1)}))}),q&&(0,a.jsx)(ns,{icon:(0,a.jsx)(vo.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:h,onClick:()=>fo(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!1,(e=>{d({type:ue,payload:Object.assign({},e)}),t(!1)})),w(!1)}))}),x&&(0,a.jsx)(ns,{icon:(0,a.jsx)(mo.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:u,text:(0,o.__)("Reset password","quicktasker"),onClick:()=>fo(this,void 0,void 0,(function*(){p(!0),yield l(e.id,(()=>{s(!1),i(!1)})),p(!1)}))}),(0,a.jsx)(ns,{icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:v,text:(0,o.__)("Delete user","quicktasker"),onClick:()=>fo(this,void 0,void 0,(function*(){m(!0),yield c(e.id,(e=>{d({type:pe,payload:e}),window.location.hash="#/users"})),m(!1)}))})]})}var ko=s(8624),_o=s(3997),jo=s(5028);function yo(){const{state:{siteURL:e,publicUserPageId:t}}=(0,n.useContext)(qs);return{userPage:e+`/wpqt?page=${t}&page_id=wpqt`}}function bo({data:e}){const{userPage:t}=yo(),{convertToWPTimezone:s}=Sn(),n=e.is_active,i=t+"&code="+e.page_hash;return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,a.jsx)(To,{label:(0,o.__)("Name","quicktasker"),value:e.name,icon:(0,a.jsx)(ko.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(To,{label:(0,o.__)("Created at","quicktasker"),value:s(e.created_at),icon:(0,a.jsx)(_o.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(To,{label:(0,o.__)("Assigned tasks count","quicktasker"),value:e.assigned_tasks_count,icon:(0,a.jsx)(wo.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(To,{label:(0,o.__)("Setup completed","quicktasker"),value:e.setup_completed?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,a.jsx)(jo.A,{className:"wpqt-size-5 wpqt-text-yellow-600"})}),(0,a.jsx)(To,{label:(0,o.__)("Is active","quicktasker"),value:n?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,a.jsx)(vo.A,{className:"wpqt-size-5 "+(n?"wpqt-icon-green":"wpqt-icon-red")})}),(0,a.jsx)(To,{label:(0,o.__)("User Page","quicktasker"),value:(0,a.jsx)("a",{href:i,rel:"noreferrer",target:"_blank",children:i}),icon:(0,a.jsx)(Ms.A,{className:"wpqt-size-5 wpqt-icon-blue"})})]})}function To({label:e,value:t,icon:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[s,(0,a.jsxs)("span",{className:"wpqt-font-semibold",children:[e,": "]}),(0,a.jsx)("span",{children:t})]})}var So=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Co({userId:e}){const{loadingDispatch:t}=(0,n.useContext)(nt),[s,r]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(()=>{So(this,void 0,void 0,(function*(){try{t({type:qe,payload:!0});const n=yield function(e){return u()({path:`/wpqt/v1/users/${e}/extended`,method:"GET",headers:p()})}(e);r((s=n.data,Object.assign(Object.assign({},s),{is_active:"1"===s.is_active})))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to get user data. Please try again","quicktasker"))}finally{t({type:qe,payload:!1})}var s}))})()}),[]),(0,a.jsx)(pt,{children:s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l,{description:(0,o.__)("User details","quicktasker"),children:s.name}),(0,a.jsx)(bo,{data:s}),(0,a.jsx)(go,{data:s,changeStatus:e=>So(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{is_active:e}):t))})),changeSetUpStatus:e=>So(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{setup_completed:e}):t))})),changePasswordStatus:e=>So(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{has_password:e}):t))}))})]})})}const Ao=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active}),No=(e,t)=>{var s;switch(t.type){case xe:return Object.assign(Object.assign({},e),{sessionsSearchValue:null!==(s=t.payload)&&void 0!==s?s:""});case fe:{const s=t.payload.map(Ao);return Object.assign(Object.assign({},e),{userSessions:s})}case ge:{const{sessionId:s,status:n}=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_active:n}):e))})}case ke:{const s=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.filter((e=>e.id!==s))})}default:return e}};var Oo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Eo={loading:!0,sessionsSearchValue:"",userSessions:[]},Po=(0,n.createContext)({state:Eo,usersSessionDispatch:()=>{},loadUserSessions:()=>Oo(void 0,void 0,void 0,(function*(){}))}),Io=({children:e})=>{const[t,s]=(0,n.useReducer)(No,Eo),{loadingDispatch:r}=(0,n.useContext)(nt);(0,n.useEffect)((()=>{c()}),[]);const c=()=>Oo(void 0,void 0,void 0,(function*(){try{r({type:qe,payload:!0});const e=yield u()({path:"/wpqt/v1/users/sessions",method:"GET",headers:p()});s({type:fe,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user sessions","quicktasker"))}finally{r({type:qe,payload:!1})}}));return(0,a.jsx)(Po.Provider,{value:{state:t,usersSessionDispatch:s,loadUserSessions:c},children:e})};function Do(){const{state:{sessionsSearchValue:e},usersSessionDispatch:t}=(0,n.useContext)(Po);return(0,a.jsx)(jt,{title:(0,o.__)("Session filtering","quicktasker"),children:(0,a.jsx)(_s,{value:e,onChange:e=>{t({type:xe,payload:e})}})})}const Ro=()=>{const{state:{sessionsSearchValue:e}}=(0,n.useContext)(Po);return{filterSessions:t=>t.user_name.toLowerCase().includes(e.toLowerCase())||t.user_description&&t.user_description.toLowerCase().includes(e.toLowerCase())}};var Uo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Lo({session:e}){const{usersSessionDispatch:t}=(0,n.useContext)(Po),{state:{isUserAllowedToDelete:s}}=(0,n.useContext)(qs),{convertToWPTimezone:r}=Sn(),c=e.is_active,l=s=>Uo(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/users/sessions/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e.id,s),t({type:ge,payload:{sessionId:e.id,status:s}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change session status","quicktasker"))}}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:e.user_name}),(0,a.jsx)("div",{className:"wpqt-italic",children:e.user_description})]}),(0,a.jsx)("div",{children:r(e.created_at_utc)}),(0,a.jsx)("div",{children:r(e.expires_at_utc)}),(0,a.jsx)("div",{className:c?"wpqt-text-qtTextGreen":"wpqt-text-qtTextRed",children:c?(0,o.__)("On","quicktasker"):(0,o.__)("Off","quicktasker")}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-4",children:[c?(0,a.jsx)(vo.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!1),title:(0,o.__)("Turn session off","quicktasker")}):(0,a.jsx)(vo.A,{className:"wpqt-icon-green wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!0),title:(0,o.__)("Turn session on","quicktasker")}),s&&(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",title:(0,o.__)("Delete session","quicktasker"),onClick:()=>Uo(this,void 0,void 0,(function*(){try{yield(s=e.id,u()({path:`/wpqt/v1/users/sessions/${s}`,method:"DELETE",headers:p()})),t({type:ke,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete session","quicktasker"))}var s}))})]})]})}function Mo(){const{state:{userSessions:e}}=(0,n.useContext)(Po),{filterSessions:t}=Ro(),s=e.filter(t);return 0===s.length?(0,a.jsx)(Xn,{text:(0,o.__)("No sessions found","quicktasker")}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-4 wpqt-grid wpqt-grid-cols-5 wpqt-font-bold",children:[(0,a.jsx)("div",{children:(0,o.__)("Session owner","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Created at","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Expires at","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Status","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Actions","quicktasker")})]}),(0,a.jsx)("div",{className:"wpqt-grid wpqt-grid-cols-5 wpqt-items-center wpqt-gap-y-4",children:s.map((e=>(0,a.jsx)(Lo,{session:e},e.id)))})]})}function Fo(){return(0,a.jsx)(Io,{children:(0,a.jsxs)(pt,{children:[(0,a.jsx)(l,{children:(0,o.__)("Quicktasker sessions","quicktasker")}),(0,a.jsx)(Do,{}),(0,a.jsx)(Mo,{})]})})}function zo(){const{state:{usersSearchValue:e},userDispatch:t}=(0,n.useContext)($t);return(0,a.jsx)(jt,{title:(0,o.__)("User filtering","quicktasker"),children:(0,a.jsx)(ht.p,{type:"text",value:e,onChange:e=>{t({type:de,payload:e.target.value})}})})}var $o=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Vo({userId:e}){return(0,a.jsx)(Pn,{typeId:e,fetchData:()=>$o(this,void 0,void 0,(function*(){try{return(yield m(e,Xe.User)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load log","quicktasker"))}})),renderItem:e=>(0,a.jsx)(An,{log:e}),noDataMessage:(0,o.__)("No logs available","quicktasker"),explanation:(0,o.__)("Logs can be seen only by WordPress users (with required permissions)","quicktasker")})}var Ho=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ko({userId:e}){return(0,a.jsx)(Pn,{typeId:e,fetchData:()=>Ho(this,void 0,void 0,(function*(){try{return(yield w(e,Xe.User,!0)).data.map(Fn)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load private comments","quicktasker"))}})),onAdd:t=>Ho(this,void 0,void 0,(function*(){try{const s=yield v(e,Xe.User,!0,t);return Fn(s.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add private comment","quicktasker"))}})),renderItem:e=>(0,a.jsx)(Dn,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed only by WordPress users (with required permissions).","quicktasker"),enableAdd:!0})}var Go=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Bo({userId:e}){const{addComment:t}=Mn();return(0,a.jsx)(Pn,{typeId:e,fetchData:()=>Go(this,void 0,void 0,(function*(){try{return(yield w(e,Xe.User,!1)).data.map(Fn)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load comments","quicktasker"))}})),onAdd:s=>Go(this,void 0,void 0,(function*(){const n=yield t(e,Xe.User,!1,s);if(n)return Fn(n)})),renderItem:e=>(0,a.jsx)(Dn,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed by WordPress users (with required permissions) and current QuickTasker user (in user page).","quicktasker"),enableAdd:!0})}function Wo({user:e}){const t=[(0,o.__)("Private comments","quicktasker"),(0,o.__)("Public comments","quicktasker"),(0,o.__)("Logs","quicktasker")];return(0,a.jsx)(xn,{tabs:t,tabsContent:[(0,a.jsx)(Ko,{userId:e.id},1),(0,a.jsx)(Bo,{userId:e.id},2),(0,a.jsx)(Vo,{userId:e.id},3)]})}var Qo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Yo=(0,n.forwardRef)((function({modalSaving:e,editUser:t},s){const{state:{userToEdit:i},modalDispatch:r}=(0,n.useContext)(Ut),{state:{isUserAllowedToDelete:c}}=(0,n.useContext)(qs),[l,d]=(0,n.useState)(""),[u,p]=(0,n.useState)(""),[h,w]=(0,n.useState)(!1),[v,m]=(0,n.useState)(!1),{changeUserStatus:q,deleteUser:x,resetUserPassword:f}=xo(),{userDispatch:g}=(0,n.useContext)($t),{loading1:k,setLoading1:_,loading2:j,setLoading2:y,loading3:b,setLoading3:T}=ws();(0,n.useEffect)((()=>{i&&(d(i.name),p(i.description),w(i.is_active),m(i.has_password))}),[i]);const S=()=>{d(""),p("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:S}))),i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-3 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsx)("div",{children:(0,a.jsxs)(rs,{children:[(0,a.jsx)(cs,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(_s,{isAutoFocus:!0,value:l,onChange:e=>d(e)})}),(0,a.jsx)(cs,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(bs,{rowsCount:3,value:u,onChange:e=>p(e)})})]})}),(0,a.jsx)(an,{entityId:i.id,entityType:gs.User})]}),(0,a.jsx)("div",{className:"wpqt-mt-7",children:(0,a.jsx)(Wo,{user:i})})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,a.jsx)(ns,{icon:(0,a.jsx)(ko.A,{className:"wpqt-icon-blue wpqt-size-4"}),text:(0,o.__)("User details","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}`,r({type:K})}}),(0,a.jsx)(ns,{icon:(0,a.jsx)(wo.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}/tasks`,r({type:K})}}),v&&(0,a.jsx)(ns,{icon:(0,a.jsx)(mo.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Reset password","quicktasker"),loading:k,onClick:()=>Qo(this,void 0,void 0,(function*(){_(!0),yield f(i.id,(()=>{g({type:we,payload:i.id}),m(!1)})),_(!1)}))}),!h&&(0,a.jsx)(ns,{icon:(0,a.jsx)(vo.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:j,onClick:()=>Qo(this,void 0,void 0,(function*(){y(!0),yield q(i.id,!0,(e=>{g({type:ue,payload:Object.assign({},e)}),w(!0)})),y(!1)}))}),h&&(0,a.jsx)(ns,{icon:(0,a.jsx)(vo.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:j,onClick:()=>Qo(this,void 0,void 0,(function*(){y(!0),yield q(i.id,!1,(e=>{g({type:ue,payload:Object.assign({},e)}),w(!1)})),y(!1)}))}),c&&(0,a.jsx)(ns,{icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete user","quicktasker"),loading:b,onClick:()=>Qo(this,void 0,void 0,(function*(){T(!0),yield x(i.id,(e=>{g({type:pe,payload:e}),r({type:K})})),T(!1)}))})]})]}),(0,a.jsx)(ls,{onSave:()=>{i&&t(Object.assign(Object.assign({},i),{name:l,description:u}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));var Xo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Jo(){const{state:{userModalOpen:e}}=(0,n.useContext)(Ut),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r}=Kt(K),{editUser:c}=xo();return(0,a.jsx)(is,{modalOpen:e,closeModal:o,size:"xl",children:(0,a.jsx)(Yo,{ref:i,modalSaving:t,editUser:e=>Xo(this,void 0,void 0,(function*(){s(!0),yield c(e,(e=>{r(ue,e,Ht.USER)})),s(!1)}))})})}function Zo(){const{state:{userSettingsModalOpen:e},modalDispatch:t}=(0,n.useContext)(Ut);return(0,a.jsx)(is,{modalOpen:e,closeModal:()=>t({type:Q,payload:!1}),size:"lg",children:(0,a.jsx)("div",{children:(0,a.jsx)(an,{entityId:"null",entityType:gs.Users})})})}var er=s(8316),tr=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function sr(){const[e,t]=(0,n.useState)(!1),[s,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(""),{userDispatch:d}=(0,n.useContext)($t),{createUser:u}=xo(),p=()=>{r(""),l(""),t(!1)};return(0,a.jsx)("div",{className:"wpqt-mb-6",children:e?(0,a.jsxs)("div",{className:"wpqt-w-1/4",children:[(0,a.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User name","quicktasker")}),(0,a.jsx)(_s,{value:s,onChange:r,className:"wpqt-w-full"}),(0,a.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User description","quicktasker")}),(0,a.jsx)(bs,{value:c,onChange:l,className:"wpqt-w-full"}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,a.jsx)(ns,{text:(0,o.__)("Cancel","quicktasker"),onClick:p,icon:(0,a.jsx)(Xt.A,{className:"wpqt-icon-red wpqt-size-5"})}),(0,a.jsx)(ns,{text:(0,o.__)("Add","quicktasker"),onClick:()=>tr(this,void 0,void 0,(function*(){s?yield u(s,c,(e=>{d({type:le,payload:e}),p()})):i.oR.error("User name is required")})),icon:(0,a.jsx)(er.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]}):(0,a.jsx)(ns,{text:(0,o.__)("Add QuickTasker","quicktasker"),onClick:()=>t(!0),icon:(0,a.jsx)(er.A,{className:"wpqt-icon-green wpqt-size-5"})})})}const nr=()=>{const{state:{usersSearchValue:e}}=(0,n.useContext)($t);return{filterUsers:t=>t.name.toLowerCase().includes(e.toLowerCase())||t.description&&t.description.toLowerCase().includes(e.toLowerCase())}};var ar=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ir({user:e}){const{modalDispatch:t}=(0,n.useContext)(Ut),{userDispatch:s}=(0,n.useContext)($t),{changeUserStatus:i,deleteUser:r,resetUserPassword:c}=xo(),[l,d]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),[h,w]=(0,n.useState)(!1),v=e.is_active,m=t=>ar(this,void 0,void 0,(function*(){w(!0),yield i(e.id,t,(()=>{s({type:he,payload:{userId:e.id,isActive:t}})})),w(!1)}));return(0,a.jsxs)(cn,{menuBtn:({active:e})=>(0,a.jsx)(ln,{isActive:e,IconComponent:aa.A}),children:[(0,a.jsx)(dn,{text:(0,o.__)("User details","quicktasker"),icon:(0,a.jsx)(ko.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,a.jsx)(dn,{text:(0,o.__)("User tasks","quicktasker"),icon:(0,a.jsx)(wo.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}/tasks`}}),(0,a.jsx)(dn,{text:(0,o.__)("Edit user","quicktasker"),icon:(0,a.jsx)(Fs.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:G,payload:e})}}),e.has_password&&(0,a.jsx)(dn,{text:(0,o.__)("Reset password","quicktasker"),loading:l,icon:(0,a.jsx)(mo.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>ar(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield c(e.id,(()=>{s({type:we,payload:e.id})})),d(!1)}))}),v&&(0,a.jsx)(dn,{text:(0,o.__)("Disable user","quicktasker"),loading:h,icon:(0,a.jsx)(vo.A,{className:"wpqt-icon-red wpqt-size-4"}),className:"!wpqt-mb-0",onClick:e=>{e.stopPropagation(),m(!1)}}),!v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(dn,{text:(0,o.__)("Activate user","quicktasker"),loading:h,icon:(0,a.jsx)(vo.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:e=>{e.stopPropagation(),m(!0)}}),(0,a.jsx)(dn,{text:(0,o.__)("Delete user","quicktasker"),loading:u,icon:(0,a.jsx)(ps.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>ar(this,void 0,void 0,(function*(){t.stopPropagation(),p(!0),yield r(e.id,(e=>{s({type:pe,payload:e})})),p(!1)}))})]})]})}function or({user:e}){const{userPage:t}=yo(),{modalDispatch:s}=(0,n.useContext)(Ut),i=e.is_active,r=t+"&code="+e.page_hash;return(0,a.jsxs)(ea,{title:e.name,description:e.description,dropdown:(0,a.jsx)(ir,{user:e}),onClick:()=>{s({type:G,payload:e})},className:"wpqt-cursor-pointer",children:[(0,a.jsx)(na,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("Open user page","quicktasker"),icon:(0,a.jsx)(Ms.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:e=>{e.stopPropagation(),window.open(r,"_blank")}}),(0,a.jsx)(na,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("View user details","quicktasker"),icon:(0,a.jsx)(Ms.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,a.jsx)(na,{label:(0,o.__)("Status","quicktasker"),value:i?(0,o.__)("Active","quicktasker"):(0,o.__)("Disabled","quicktasker"),valueClassName:i?"wpqt-text-qtTextGreen wpqt-font-bold":"wpqt-text-qtTextRed wpqt-font-bold",icon:(0,a.jsx)(vo.A,{className:"wpqt-size-5 "+(i?"wpqt-icon-green":"wpqt-icon-red")})})]})}function rr(){const{state:{users:e}}=(0,n.useContext)($t),{filterUsers:t}=nr(),s=e.filter(t);return e&&0===e.length?(0,a.jsx)(Xn,{text:(0,o.__)("No users found","quicktasker")}):s&&0===s.length?(0,a.jsx)(Xn,{}):(0,a.jsx)("div",{className:"wpqt-card-grid",children:s.map((e=>(0,a.jsx)(or,{user:e},e.id)))})}function cr(){return(0,a.jsxs)("div",{children:[(0,a.jsx)(sr,{}),(0,a.jsx)(zo,{}),(0,a.jsx)(rr,{}),(0,a.jsx)(Zo,{}),(0,a.jsx)(Jo,{})]})}var lr=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};var dr=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ur({user:e}){const[t,s]=(0,n.useState)({quicktasker_admin_role:"quicktasker_admin_role"in e.allcaps,quicktasker_admin_role_allow_delete:"quicktasker_admin_role_allow_delete"in e.allcaps,quicktasker_admin_role_manage_users:"quicktasker_admin_role_manage_users"in e.allcaps,quicktasker_admin_role_manage_settings:"quicktasker_admin_role_manage_settings"in e.allcaps}),[i,r]=(0,n.useState)(!1),{updateWPUserCapabilities:c}=function(){return{updateWPUserCapabilities:(e,t,s,n)=>lr(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/wp-users/${e}/capabilities`,method:"PATCH",data:{quicktasker_admin_role:t.quicktasker_admin_role,quicktasker_admin_role_allow_delete:t.quicktasker_admin_role_allow_delete,quicktasker_admin_role_manage_users:t.quicktasker_admin_role_manage_users,quicktasker_admin_role_manage_settings:t.quicktasker_admin_role_manage_settings},headers:p()})}(e,t),s&&s()}catch(e){n&&n(e)}}))}}(),l=(n,a)=>dr(this,void 0,void 0,(function*(){if(i)return;r(!0);const o=Object.assign({},t),l=Object.assign(Object.assign({},t),{[a]:n});s(l),yield c(e.id,l,(()=>{}),(()=>{s(o)})),r(!1)}));return(0,a.jsxs)(ea,{title:e.name,description:e.description,children:[(0,a.jsx)(na,{label:(0,o.__)("Role","quicktasker"),value:Array.isArray(e.roles)?e.roles.join(", "):""}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to admin areas","quicktasker")}),(0,a.jsx)(Ss,{checked:t.quicktasker_admin_role,handleChange:e=>{l(e,"quicktasker_admin_role")}})]}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to users page","quicktasker")}),(0,a.jsx)(Ss,{checked:t.quicktasker_admin_role_manage_users,handleChange:e=>{l(e,"quicktasker_admin_role_manage_users")}})]}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to settings page","quicktasker")}),(0,a.jsx)(Ss,{checked:t.quicktasker_admin_role_manage_settings,handleChange:e=>{l(e,"quicktasker_admin_role_manage_settings")}})]}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Allow to delete resources","quicktasker")}),(0,a.jsx)(Ss,{checked:t.quicktasker_admin_role_allow_delete,handleChange:e=>{l(e,"quicktasker_admin_role_allow_delete")}})]}),i&&(0,a.jsx)(ut,{ovalSize:"24"})]})}var pr=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function hr(){const[e,t]=(0,n.useState)(null),[s,i]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{(()=>{pr(this,void 0,void 0,(function*(){try{i(!0);const s=yield(e=et.Other,u()({path:`/wpqt/v1/wp-users?type=${encodeURIComponent(e)}`,method:"GET",headers:p()}));t(s.data)}catch(e){console.error(e)}finally{i(!1)}var e}))})()}),[]),s||null===e?(0,a.jsx)(ut,{ovalSize:"48"}):0===e.length?(0,a.jsx)(Xn,{text:(0,o.__)("No non-admin WordPress users found","quicktasker")}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Displaying non-admin WordPress users.","quicktasker")}),(0,a.jsx)("div",{className:"wpqt-card-grid",children:e.map((e=>(0,a.jsx)(ur,{user:e},e.id)))})]})}function wr(){const{updateUsers:e}=(0,n.useContext)($t),{loadingDispatch:t}=(0,n.useContext)(nt),{modalDispatch:s}=(0,n.useContext)(Ut),i=[(0,a.jsx)(cr,{},0),(0,a.jsx)(hr,{},1)];return(0,n.useEffect)((()=>{(()=>{var s,n,a,i;s=this,n=void 0,i=function*(){t({type:qe,payload:!0}),yield e(),t({type:qe,payload:!1})},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function r(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(s,n||[])).next())}))})()}),[]),(0,a.jsxs)(pt,{children:[(0,a.jsx)(l,{description:(0,o.__)("Manage QuickTaskers and WordPress users. This plugin supports three types of users: WordPress admins, other WordPress users, and QuickTaskers. WordPress admins have full access to all admin areas. Other WordPress users do not have any access by default but can be granted if needed. QuickTaskers are separate users who do not have admin access but can manage tasks through a mobile-friendly webpage.","quicktasker"),icon:(0,a.jsx)(Ba.A,{className:"wpqt-icon-gray wpqt-size-7 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{s({type:Q,payload:!0})}}),children:(0,o.__)("Users","quicktasker")}),(0,a.jsx)(xn,{tabs:["QuickTaskers","WordPress users"],tabsContent:i,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}const vr=(e,t)=>{switch(t.type){case _e:{const s=t.payload.map(Qe);return Object.assign(Object.assign({},e),{tasks:s})}case ye:{const s=t.payload;return Object.assign(Object.assign({},e),{tasks:e.tasks.filter((e=>e.id!==s))})}case be:{const s=t.payload,n=e.tasks.map((e=>e.id===s.id?Qe(s):e));return Object.assign(Object.assign({},e),{tasks:n})}case je:{const s=t.payload;return Object.assign(Object.assign({},e),{searchValue:s})}case Te:{const s=t.payload;return Object.assign(Object.assign({},e),{filteredPipelineId:s})}case Se:{const{taskId:s,user:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Ke(n)?[n,...e.assigned_users]:e.assigned_users,assigned_wp_users:Ge(n)?[n,...e.assigned_wp_users]:e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{tasks:a})}case Ce:{const{taskId:s,user:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Ke(n)?e.assigned_users.filter((e=>e.id!==n.id)):e.assigned_users,assigned_wp_users:Ge(n)?e.assigned_wp_users.filter((e=>e.id!==n.id)):e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{tasks:a})}case Ae:{const{taskId:s,done:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{tasks:a})}default:return e}};var mr=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const qr={tasks:[],searchValue:"",filteredPipelineId:""},xr=(0,n.createContext)({state:qr,userTasksDispatch:()=>{},fetchAndSetUserTasks:()=>mr(void 0,void 0,void 0,(function*(){}))}),fr=({children:e,userId:t})=>{const[s,r]=(0,n.useReducer)(vr,qr),{loadingDispatch:c}=(0,n.useContext)(nt);(0,n.useEffect)((()=>{l()}),[]);const l=()=>mr(void 0,void 0,void 0,(function*(){try{c({type:qe,payload:!0});const e=yield function(e){return u()({path:`/wpqt/v1/users/${e}/tasks`,method:"GET",headers:p()})}(t);r({type:_e,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user tasks","quicktasker"))}finally{c({type:qe,payload:!1})}}));return(0,a.jsx)(xr.Provider,{value:{state:s,userTasksDispatch:r,fetchAndSetUserTasks:l},children:e})};function gr(){const{state:{searchValue:e,filteredPipelineId:t},userTasksDispatch:s}=(0,n.useContext)(xr);return(0,a.jsxs)(jt,{title:(0,o.__)("Filter tasks","quicktasker"),children:[(0,a.jsx)(_s,{value:e,onChange:e=>{s({type:je,payload:e})},className:"!wpqt-mb-0"}),(0,a.jsx)(_t,{selectedOptionValue:t,selectionChange:e=>{s({type:Te,payload:e})}})]})}var kr=s(7028),_r=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function jr({taskId:e,onUnAssignTask:t}){const[s,i]=(0,n.useState)(!1);return(0,a.jsx)(cn,{menuBtn:({active:e})=>(0,a.jsx)(ln,{isActive:e,IconComponent:aa.A}),children:(0,a.jsx)(dn,{text:(0,o.__)("Unassign from task","quicktasker"),loading:s,icon:(0,a.jsx)(kr.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:s=>_r(this,void 0,void 0,(function*(){s.stopPropagation(),i(!0),yield t(e),i(!1)})),className:"!wpqt-mb-0"})})}const yr=()=>{const{state:{searchValue:e,filteredPipelineId:t}}=(0,n.useContext)(xr);return{filterTasks:s=>{const n=s.name&&s.name.toLowerCase().includes(e.toLowerCase())||s.description&&s.description.toLowerCase().includes(e.toLowerCase()),a=!t||s.pipeline_id===t;return n&&a}}};var br=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Tr({userId:e}){var t;const{filterTasks:s}=yr(),{modalDispatch:i}=(0,n.useContext)(Ut),{state:{tasks:r},userTasksDispatch:c}=(0,n.useContext)(xr),{removeTaskFromUser:l}=Pt(),d=null!==(t=null==r?void 0:r.filter(s))&&void 0!==t?t:[],u=t=>br(this,void 0,void 0,(function*(){yield l(e,t,(()=>{c({type:ye,payload:t})}))}));return r&&0===r.length?(0,a.jsx)(Xn,{text:(0,o.__)("User has no tasks","quicktasker")}):d&&0===d.length?(0,a.jsx)(Xn,{}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-card-grid",children:d.map((e=>(0,a.jsxs)(ea,{className:"wpqt-cursor-pointer",title:e.name,description:e.description,dropdown:(0,a.jsx)(jr,{taskId:e.id,onUnAssignTask:u}),onClick:()=>{i({type:U,payload:{taskToEdit:e}})},children:[(0,a.jsx)(mn,{task:e,onUserAdd:t=>{c({type:Se,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{c({type:Ce,payload:{taskId:e.id,user:t}})}}),(0,a.jsx)(sa,{task:e,onDoneStatusChange:(e,t)=>{c({type:Ae,payload:{taskId:e,done:t}})}})]},e.id)))}),(0,a.jsx)(Yn,{editTaskCallback:e=>{c({type:be,payload:e})}})]})}function Sr({userId:e}){return(0,a.jsx)(fr,{userId:e,children:(0,a.jsxs)(pt,{children:[(0,a.jsx)(l,{description:(0,o.__)("Tasks assigned to user","quicktasker"),children:(0,o.__)("User tasks","quicktasker")}),(0,a.jsx)(gr,{}),(0,a.jsx)(Tr,{userId:e})]})})}const Cr=()=>{const{page:e,hash:t}=Ar();if("wp-quick-tasks"===e){const e=t.match(/^#\/users\/(\d+)\/tasks$/);if(e){const t=e[1];return(0,a.jsx)(Sr,{userId:t})}const s=t.match(/^#\/users\/(\d+)$/);if(s){const e=s[1];return(0,a.jsx)(Co,{userId:e})}switch(t){case"#/users":return(0,a.jsx)(wr,{});case"#/overview":return(0,a.jsx)(Ia,{});case"#/archive":return(0,a.jsx)(da,{});case"#/user-sessions":return(0,a.jsx)(Fo,{});case"#/logs":return(0,a.jsx)(ka,{});case"#/settings":return(0,a.jsx)(ho,{});case"#/guide":return(0,a.jsx)(ua,{});default:return(0,a.jsx)(vi,{})}}},Ar=()=>({page:new URLSearchParams(window.location.search).get("page"),hash:window.location.hash}),Nr=function(){const e=(()=>{const[e,t]=(0,n.useState)(Cr());return(0,n.useEffect)((()=>{const e=()=>{t(Cr()),(()=>{const{page:e,hash:t}=Ar();if("wp-quick-tasks"!==e)return;const s=document.querySelectorAll("#toplevel_page_wp-quick-tasks .wp-submenu li");s.forEach((e=>e.classList.remove("wpqt-current")));const n={"#/users":"#/users","#/overview":"#/overview","#/archive":"#/archive","#/user-sessions":"#/user-sessions","#/logs":"#/logs","#/settings":"#/settings","#/guide":"#/guide",default:""};let a=n.default;void 0!==n[t]?a=n[t]:/^#\/users(\/\d+)?(\/tasks)?$/.test(t)&&(a="#/users"),s.forEach((e=>{const t=e.querySelector("a");t&&t.getAttribute("href")&&t.getAttribute("href")===`admin.php?page=wp-quick-tasks${a}`&&e.classList.add("wpqt-current")}))})()};return e(),window.addEventListener("popstate",e),window.addEventListener("hashchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("hashchange",e)}}),[]),e})();return(0,a.jsx)(c,{children:(0,a.jsx)(xs,{children:(0,a.jsx)(Vt,{children:(0,a.jsx)(Lt,{children:(0,a.jsx)(ft,{children:(0,a.jsxs)(at,{children:[e,(0,a.jsx)(i.N9,{position:"bottom-right"})]})})})})})})};(0,n.render)((0,a.jsx)(Nr,{}),document.getElementById("wpqt-app"))},1609:e=>{e.exports=window.React},5795:e=>{e.exports=window.ReactDOM},790:e=>{e.exports=window.ReactJSXRuntime}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var s=a[e]={exports:{}};return n[e].call(s.exports,s,s.exports,i),s.exports}i.m=n,e=[],i.O=(t,s,n,a)=>{if(!s){var o=1/0;for(d=0;d<e.length;d++){for(var[s,n,a]=e[d],r=!0,c=0;c<s.length;c++)(!1&a||o>=a)&&Object.keys(i.O).every((e=>i.O[e](s[c])))?s.splice(c--,1):(r=!1,a<o&&(o=a));if(r){e.splice(d--,1);var l=n();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[s,n,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);i.r(a);var o={};t=t||[null,s({}),s([]),s(s)];for(var r=2&n&&e;"object"==typeof r&&!~t.indexOf(r);r=s(r))Object.getOwnPropertyNames(r).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(a,o),a},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=524,(()=>{var e={524:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var n,a,[o,r,c]=s,l=0;if(o.some((t=>0!==e[t]))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(c)var d=c(i)}for(t&&t(s);l<o.length;l++)a=o[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(d)},s=globalThis.webpackChunkquicktasker=globalThis.webpackChunkquicktasker||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.nc=void 0;var o=i.O(void 0,[96],(()=>i(313)));o=i.O(o)})();