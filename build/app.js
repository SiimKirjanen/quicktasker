(()=>{"use strict";var e,t,s,a={7882:(e,t,s)=>{const a=window.wp.element;var n=s(790),i=s(9571);const o=window.wp.i18n;class r extends a.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){var e;return this.state.hasError?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-h-screen wpqt-items-center wpqt-justify-center wpqt-text-center wpqt-text-lg",children:[(0,o.__)("Something went wrong. Please refresh the page.","quicktasker"),(0,n.jsx)("br",{}),null===(e=this.state.error)||void 0===e?void 0:e.message]}):this.props.children}}const c=r;function l({children:e,description:t=null,icon:s=null}){return(0,n.jsx)("div",{className:"wpqt-mb-6 wpqt-inline-grid wpqt-grid-cols-[auto_auto] wpqt-items-center wpqt-gap-2",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{children:[e,s&&(0,n.jsx)("span",{className:"wpqt-ml-1 wpqt-align-middle",children:s})]}),t&&(0,n.jsx)("div",{children:t})]})})}const d=window.wp.apiFetch;var u=s.n(d);function p(){return{"Content-Type":"application/json","X-WPQT-API-Nonce":window.wpqt.apiNonce}}function h(e,t,s){return u()({path:`/wpqt/v1/tasks/${e}/move`,method:"PATCH",data:{stageId:t,order:s},headers:p()})}function w(e,t,s){const a=new URLSearchParams({typeId:e,type:t,isPrivate:s.toString()}).toString();return u()({path:`/wpqt/v1/comments?${a}`,method:"GET",headers:p()})}function m(e,t,s,a){return u()({path:"/wpqt/v1/comments",data:{comment:a,typeId:e,type:t,isPrivate:s},method:"POST",headers:p()})}function q(e,t){const s=new URLSearchParams({typeId:e,type:t});return u()({path:`/wpqt/v1/logs?${s.toString()}`,method:"GET",headers:p()})}function v(e,t,s){return u()({path:`/wpqt/v1/users/${e}/tasks/${t}`,method:"DELETE",data:{user_type:s},headers:p()})}function x(e,t,s){const a=new URLSearchParams({entityId:e,entityType:t,active:String(s)});return u()({path:`/wpqt/v1/custom-fields?${a.toString()}`,method:"GET",headers:p()})}const f="SET_LOADING",g="SET_PIPELINE",_="MOVE_TASK",k="ADD_TASK",j="ADD_STAGE",y="DELETE_STAGE",b="EDIT_TASK",T="EDIT_STAGE",S="ADD_PIPELINE",A="EDIT_PIPELINE",E="SET_PRIMARY",C="SET_PIPELINES",N="ADD_USER_TO_TASK",O="REMOVE_USER_FROM_TASK",I="CHANGE_TASK_DONE_STATUS",P="REMOVE_PIPELINE",D="REMOVE_ACTIVE_PIPELINE",R="REMOVE_TASK",U="TOGGLE_VIEW",L="SET_STAGE_FILTER",M="SET_USER_FILTER",F="OPEN_EDIT_TASK_MODAL",z="CLOSE_TASK_MODAL",K="OPEN_NEW_STAGE_MODAL",$="CLOSE_STAGE_MODAL",V="OPEN_STAGE_EDIT_MODAL",G="OPEN_NEW_PIPELINE_MODAL",H="OPEN_EDIT_PIPELINE_MODAL",B="CLOSE_PIPELINE_EDIT_MODAL",W="CLOSE_USER_MODAL",Q="OPEN_EDIT_USER_MODAL",Y="ADD_ASSIGNED_USER_TO_EDITING_TASK",X="REMOVE_ASSIGNED_USER_FROM_EDITING_TASK",J="CHANGE_USER_SETTINGS_MODAL_OPEN",Z="OPEN_MOVE_TASK_MODAL",ee="CLOSE_MOVE_TASK_MODAL",te="SET_ARCHIVE_TASKS",se="SET_ARCHIVE_SEARCH_VALUE",ae="SET_ARCHIVE_FILTERED_PIPELINE",ne="REMOVE_ARCHIVED_TASK",ie="ADD_ASSIGNED_USER_TO_ARCHIVED_TASK",oe="REMOVE_ASSINGED_USER_FROM_ARCHIVED_TASK",re="CHANGE_ARCHIVED_TASK_DONE_STATUS",ce="EDIT_ARCHIVED_TASK",le="CHANGE_ARCHIVE_TASK_DONE_FILTER",de="SET_USERS",ue="SET_WP_USERS",pe="ADD_USER",he="SET_USERS_SEARCH_VALUE",we="EDIT_USER",me="DELETE_USER",qe="CHANGE_USER_STATUS",ve="RESET_PASSWORD",xe="INIT_APP_STATE",fe="SET_CUSTOM_USER_PAGE_STYLES",ge="SET_FULL_PAGE_LOADING",_e="SET_USER_SESSIONS_SEARCH_VALUE",ke="SET_USER_SESSIONS",je="CHANGE_USER_SESSION_STATUS",ye="DELETE_USER_SESSION",be="SET_USER_TASKS",Te="SET_USER_TASKS_SEARCH_VALUE",Se="REMOVE_USER_TASK",Ae="EDIT_USER_TASK",Ee="SET_USER_TASKS_FILTERED_PIPELINE",Ce="ADD_ASSIGNED_USER_TO_USER_TASK",Ne="REMOVE_ASSIGNED_USER_FROM_USER_TASK",Oe="CHANGE_USER_TASK_DONE_STATUS",Ie="SET_CUSTOM_FIELDS",Pe="ADD_CUSTOM_FIELD",De="DELETE_CUSTOM_FIELD",Re="SET_CUSTOM_FIELD_LOADING",Ue="SET_CUSTOM_FIELD_INITIAL_DATA",Le="SET_PIPELINE_AUTOMATIONS",Me="SET_PIPELINE_AUTOMATIONS_LOADING",Fe="REMOVE_PIPELINE_AUTOMATION",ze="ADD_PIPELINE_AUTOMATION",Ke="SET_META",$e="SET_ACTION_TARGET",Ve="RESET_AUTOMATION_TO_TARGET",Ge="RESET_AUTOMATION_TO_TRIGGER",He="RESET_AUTOMATION_TO_ACTION",Be=!1;var We,Qe,Ye,Xe,Je;function Ze(e){return!e.user_type||e.user_type===We.QUICKTASKER}function et(e){return e.user_type===We.WP_USER}!function(e){e.QUICKTASKER="quicktasker",e.WP_USER="wp-user"}(We||(We={})),function(e){e.TASK_DONE="task-done",e.Task_NOT_DONE="task-not-done",e.TASK_CREATED="task-created",e.TASK_DELETED="task-deleted",e.TASK_ASSIGNED="task-assigned",e.TASK_UNASSIGNED="task-unassigned",e.TASK_PUBLIC_COMMENT_ADDED="task-public-comment-added",e.TASK_PRIVATE_COMMENT_ADDED="task-private-comment-added"}(Qe||(Qe={})),function(e){e.PIPELINE="pipeline",e.Stage="stage",e.Task="task",e.quicktasker="quicktasker"}(Ye||(Ye={})),function(e){e.PIPELINE="pipeline",e.STAGE="stage",e.TASK="task",e.QUICKTASKER="quicktasker",e.WP_USER="wp-user"}(Xe||(Xe={})),function(e){e.ARCHIVE_TASK="archive-task",e.ASSIGN_USER="assign-user",e.NEW_ENTITY_EMAIL="new-entity-email",e.DELETED_ENTITY_EMAIL="deleted-entity-email",e.TASK_ASSIGNED_EMAIL="task-assigned-email",e.TASK_UNASSIGNED_EMAIL="task-unassigned-email",e.TASK_PUBLIC_COMMENT_ADDED_EMAIL="task-public-comment-added-email",e.TASK_PRIVATE_COMMENT_ADDED_EMAIL="task-private-comment-added-email"}(Je||(Je={}));const tt=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active,has_password:"1"===e.has_password}),st=e=>{switch(e){case Xe.QUICKTASKER:return We.QUICKTASKER;case Xe.WP_USER:return We.WP_USER;default:return null}},at={[We.QUICKTASKER]:"Quicktasker",[We.WP_USER]:"WordPress User"},nt=e=>Object.assign(Object.assign({},e),{task_order:Number(e.task_order),free_for_all:"1"===e.free_for_all,is_archived:"1"===e.is_archived,is_done:"1"===e.is_done,assigned_users:e.assigned_users?e.assigned_users.map((e=>Object.assign({},tt(e)))):[]}),it=(e,t)=>{var s,a,n,i,o;switch(t.type){case te:{const s=t.payload;return Object.assign(Object.assign({},e),{archivedTasks:s.map(nt)})}case se:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveSearchValue:s})}case ae:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveFilteredPipelineId:s})}case ne:{const a=(null!==(s=e.archivedTasks)&&void 0!==s?s:[]).filter((e=>e.id!==t.payload));return Object.assign(Object.assign({},e),{archivedTasks:a})}case ie:{const{taskId:s,user:n}=t.payload,i=(null!==(a=e.archivedTasks)&&void 0!==a?a:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Ze(n)?[n,...e.assigned_users]:e.assigned_users,assigned_wp_users:et(n)?[n,...e.assigned_wp_users]:e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case oe:{const{taskId:s,user:a}=t.payload,i=(null!==(n=e.archivedTasks)&&void 0!==n?n:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Ze(a)?e.assigned_users.filter((e=>e.id!==a.id)):e.assigned_users,assigned_wp_users:et(a)?e.assigned_wp_users.filter((e=>e.id!==a.id)):e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case re:{const{taskId:s,done:a}=t.payload,n=(null!==(i=e.archivedTasks)&&void 0!==i?i:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:a}):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case ce:{const s=t.payload,a=(null!==(o=e.archivedTasks)&&void 0!==o?o:[]).map((e=>e.id===s.id?nt(s):e));return Object.assign(Object.assign({},e),{archivedTasks:a})}case le:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskDoneFilter:s})}default:return e}};var ot,rt,ct,lt;!function(e){e.Task="task",e.User="user"}(ot||(ot={})),function(e){e.System="system",e.Admin="admin",e.WPQTUser="quicktasker_user",e.Automation="automation"}(rt||(rt={})),function(e){e.All="all",e.Completed="completed",e.NotCompleted="not completed"}(ct||(ct={})),function(e){e.Admin="administrator",e.Other="other"}(lt||(lt={}));const dt=(e,t)=>{if(t.type===ge){const s=t.payload;return Object.assign(Object.assign({},e),{fullPageLoading:s})}return e},ut={fullPageLoading:!1},pt=(0,a.createContext)({state:ut,loadingDispatch:()=>{}}),ht=({children:e})=>{const[t,s]=(0,a.useReducer)(dt,ut);return(0,n.jsx)(pt.Provider,{value:{state:t,loadingDispatch:s},children:e})};const wt={archivedTasks:null,archiveLoading:!1,archiveSearchValue:"",archiveFilteredPipelineId:"",archiveTaskDoneFilter:ct.All},mt=(0,a.createContext)({state:wt,archiveDispatch:()=>{}}),qt=({children:e})=>{const[t,s]=(0,a.useReducer)(it,wt),{loadingDispatch:r}=(0,a.useContext)(pt);(0,a.useEffect)((()=>{c()}),[]);const c=()=>{return e=void 0,t=void 0,n=function*(){try{r({type:ge,payload:!0});const{data:e}=yield u()({path:"/wpqt/v1/tasks/archived",method:"GET",headers:p()});s({type:te,payload:e})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch archived tasks","quicktasker"))}finally{r({type:ge,payload:!1})}},new((a=void 0)||(a=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}));var e,t,a,n};return(0,n.jsx)(mt.Provider,{value:{state:t,archiveDispatch:s},children:e})};var vt=s(6061);function xt({width:e="80",height:t="80",className:s="",color:a="#1d4ed8",secondaryColor:i="#2563eb"}){return(0,n.jsx)(vt.BM,{visible:!0,height:t,width:e,color:a,secondaryColor:i,ariaLabel:"oval-loading",wrapperStyle:{},wrapperClass:s})}function ft(){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-flex-col wpqt-items-center wpqt-justify-center",children:(0,n.jsx)(xt,{})})}function gt({className:e,ovalSize:t}){const s=t?{width:t,height:t}:{};return(0,n.jsx)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center ${e}`,children:(0,n.jsx)(xt,Object.assign({},s))})}function _t({children:e}){const{state:{fullPageLoading:t}}=(0,a.useContext)(pt);return(0,n.jsx)("div",{className:"wpqt-pr-4",children:t?(0,n.jsx)(ft,{}):e})}var kt=s(2912);const jt=e=>Object.assign(Object.assign({},e),{allow_only_last_stage_task_done:"1"===e.allow_only_last_stage_task_done}),yt=e=>Object.assign(Object.assign({},e),{stage_order:Number(e.stage_order),tasks:(e.tasks||[]).map((e=>Object.assign({},nt(e))))}),bt=(e,t)=>{var s;switch(t.type){case C:{const s=t.payload,a=e=>Object.assign({},yt(e)),n=e=>{var t;return Object.assign(Object.assign({},e),{stages:null===(t=e.stages)||void 0===t?void 0:t.map(a),settings:e.settings?jt(e.settings):void 0,is_primary:"1"===e.is_primary})};return Object.assign(Object.assign({},e),{pipelines:s.map(n)})}case S:{const a=t.payload,n=e=>Object.assign({},yt(e)),i=Object.assign(Object.assign({},a),{stages:null===(s=a.stages)||void 0===s?void 0:s.map(n),settings:a.settings?jt(a.settings):void 0,is_primary:!1});return Object.assign(Object.assign({},e),{pipelines:[...e.pipelines,i]})}case E:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>Object.assign(Object.assign({},e),{is_primary:e.id===s})))})}case A:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>e.id===s.id?s:e))})}case P:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.filter((e=>e.id!==s))})}default:return e}},Tt={pipelines:[]},St=(0,a.createContext)({state:Tt,pipelinesDispatch:()=>{}}),At=({children:e})=>{const[t,s]=(0,a.useReducer)(bt,Tt);return(0,a.useEffect)((()=>{const e=window.wpqt.initialPipelines;s({type:C,payload:e})}),[]),(0,n.jsx)(St.Provider,{value:{state:t,pipelinesDispatch:s},children:e})};var Et=s(3482);function Ct({options:e,selectedOptionValue:t,onSelectionChange:s,allSelector:a=!0,className:i="",allSelectorLabel:o="All boards",id:r}){return(0,n.jsxs)(Et.l,{id:r,value:t,onChange:e=>{const t=e.target.value;s(t)},className:`!wpqt-rounded-lg !wpqt-border !wpqt-border-solid !wpqt-border-qtBorder !wpqt-px-2 !wpqt-pr-6 !wpqt-py-1 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`,children:[a&&(0,n.jsx)("option",{value:"",children:o}),e.map((e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value)))]})}function Nt({selectedOptionValue:e,selectionChange:t,extraOptions:s=[]}){const{state:{pipelines:i}}=(0,a.useContext)(St),o=(0,a.useMemo)((()=>i.map((e=>({value:e.id,label:e.name})))),[i]);return(0,n.jsx)(Ct,{options:[...o,...s],selectedOptionValue:e,onSelectionChange:t})}function Ot({children:e,title:t,childrenClassName:s="",titleClassName:a=""}){return(0,n.jsxs)("div",{className:"wpqt-mb-8",children:[(0,n.jsx)("div",{className:`wpqt-mb-3 wpqt-text-lg wpqt-text-center ${a}`,children:t}),(0,n.jsx)("div",{className:`wpqt-flex wpqt-gap-4 wpqt-items-center wpqt-justify-center ${s}`,children:e})]})}function It(){const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s},archiveDispatch:i}=(0,a.useContext)(mt);return(0,n.jsxs)(Ot,{title:(0,o.__)("Archive filtering","quicktasker"),children:[(0,n.jsx)(kt.p,{type:"text",value:e,onChange:e=>{i({type:se,payload:e.target.value})}}),(0,n.jsx)(Nt,{selectedOptionValue:t,selectionChange:e=>{i({type:ae,payload:e})},extraOptions:[{value:"DELETED",label:(0,o.__)("DELETED","quicktasker")}]}),(0,n.jsx)(Ct,{allSelector:!1,selectedOptionValue:s,options:[{label:(0,o.__)("All status","quicktasker"),value:ct.All},{label:(0,o.__)("Completed","quicktasker"),value:ct.Completed},{label:(0,o.__)("Not completed","quicktasker"),value:ct.NotCompleted}],onSelectionChange:e=>{const t=(e=>{switch(e){case ct.All:return ct.All;case ct.Completed:return ct.Completed;case ct.NotCompleted:return ct.NotCompleted;default:throw new Error(`Invalid selection: ${e}`)}})(e);i({type:le,payload:t})}})]})}const Pt=(e,t)=>{var s,a,n,i,o,r,c,l,d,u;switch(t.type){case f:return Object.assign(Object.assign({},e),{loading:t.payload});case g:{const s=t.payload,a=(s.stages||[]).map((e=>Object.assign({},yt(e)))),n=s.settings?jt(s.settings):void 0;return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},s),{stages:a,settings:n,is_primary:"1"===s.is_primary})})}case _:{if(!e.activePipeline||!e.activePipeline.stages)return e;const s=((e,t,s)=>{const a=[...e],n=a.find((e=>e.id===t.droppableId)),i=a.find((e=>e.id===s.droppableId));if((null==n?void 0:n.tasks)&&(null==i?void 0:i.tasks)){const[e]=n.tasks.splice(t.index,1);i.tasks.splice(s.index,0,e)}return a})(e.activePipeline.stages,t.payload.source,t.payload.destination);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:s})})}case"REORDER_TASK":{const{source:n,destination:i}=t.payload,o=i.droppableId,r=i.index;if(!e.activePipeline)return e;const c=null===(s=e.activePipeline.stages)||void 0===s?void 0:s.find((e=>e.id===o));if(!c||!c.tasks)return e;const l=((e,t,s)=>{const a=[...e],[n]=a.splice(t,1);return a.splice(s,0,n),a})(c.tasks,n.index,r),d=null===(a=e.activePipeline.stages)||void 0===a?void 0:a.map((e=>e.id===o?Object.assign(Object.assign({},e),{tasks:l}):e));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:d})})}case k:{const s=nt(t.payload);return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(n=e.activePipeline.stages)||void 0===n?void 0:n.map((e=>e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:[...e.tasks||[],s]}):e))})}):e}case b:{const s=nt(t.payload);if(!e.activePipeline)return e;const a=null===(i=e.activePipeline.stages)||void 0===i?void 0:i.map((e=>{var t;return e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s.id?s:e))}):e}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case j:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:[...e.activePipeline.stages||[],s]})}):e}case T:{const s=t.payload;if(!e.activePipeline)return e;const a=e=>e.id===s.id?Object.assign(Object.assign({},e),{name:s.name,description:s.description}):e,n=null===(o=e.activePipeline.stages)||void 0===o?void 0:o.map(a);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case y:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(r=e.activePipeline.stages)||void 0===r?void 0:r.filter((e=>e.id!==s))})}):e}case N:{const{taskId:s,user:a}=t.payload;if(!e.activePipeline)return e;const n=null===(c=e.activePipeline.stages)||void 0===c?void 0:c.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{if(e.id===s){const t=Ze(a)?[a,...e.assigned_users||[]]:e.assigned_users||[],s=et(a)?[a,...e.assigned_wp_users||[]]:e.assigned_wp_users||[];return Object.assign(Object.assign({},e),{assigned_users:t,assigned_wp_users:s})}return e}));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case O:{const{taskId:s,userId:a,userType:n}=t.payload;if(!e.activePipeline)return e;const i=null===(l=e.activePipeline.stages)||void 0===l?void 0:l.map((e=>{var t;const i=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{var t,i;return e.id===s?Object.assign(Object.assign({},e),{assigned_users:n===We.QUICKTASKER?null===(t=e.assigned_users)||void 0===t?void 0:t.filter((e=>e.id!==a)):e.assigned_users,assigned_wp_users:n===We.WP_USER?null===(i=e.assigned_wp_users)||void 0===i?void 0:i.filter((e=>e.id!==a)):e.assigned_wp_users}):e}));return Object.assign(Object.assign({},e),{tasks:i})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:i})})}case A:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{name:s.name,description:s.description,is_primary:"1"===s.is_primary})}):e}case I:{const{taskId:s,done:a}=t.payload;if(!e.activePipeline)return e;const n=null===(d=e.activePipeline.stages)||void 0===d?void 0:d.map((e=>{var t;const n=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:a}):e));return Object.assign(Object.assign({},e),{tasks:n})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case D:return Object.assign(Object.assign({},e),{activePipeline:null});case R:{const s=t.payload;if(!e.activePipeline)return e;const a=null===(u=e.activePipeline.stages)||void 0===u?void 0:u.map((e=>{var t;return Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.filter((e=>e.id!==s))})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case U:return Object.assign(Object.assign({},e),{view:t.payload});default:return e}};var Dt;!function(e){e.PIPELINE="PIPELINE-VIEW",e.TASK="TASK-VIEW"}(Dt||(Dt={}));const Rt={loading:!1,view:Dt.PIPELINE,activePipeline:null},Ut=(0,a.createContext)({state:Rt,dispatch:()=>{},fetchAndSetPipelineData:()=>Promise.resolve()}),Lt=({children:e})=>{const[t,s]=(0,a.useReducer)(Pt,Rt),{loadingDispatch:r}=(0,a.useContext)(pt);(0,a.useEffect)((()=>{const e=window.wpqt.initialActivePipelineId;e&&l(e,!0)}),[]);const c=(e,t)=>{t?r({type:ge,payload:e}):s({type:f,payload:e})},l=(e,...t)=>{return a=void 0,n=[e,...t],l=function*(e,t=!1){try{c(!0,t);const{data:{pipeline:a}}=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,headers:p()})}(e);s({type:g,payload:a})}catch(e){console.error(e),i.oR.error((0,o.__)("Unable to load the board. Please try again later.","quicktasker"))}finally{c(!1,t)}},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof r?a:new r((function(e){e(a)}))).then(s,i)}o((l=l.apply(a,n||[])).next())}));var a,n,r,l};return(0,n.jsx)(Ut.Provider,{value:{state:t,dispatch:s,fetchAndSetPipelineData:l},children:e})};var Mt=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Ft={[Je.ARCHIVE_TASK]:(0,o.__)("Task archived by automation","quicktasker"),[Je.ASSIGN_USER]:(0,o.__)("User assigned by automation","quicktasker"),[Je.NEW_ENTITY_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[Je.DELETED_ENTITY_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[Je.TASK_ASSIGNED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[Je.TASK_UNASSIGNED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[Je.TASK_PUBLIC_COMMENT_ADDED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker"),[Je.TASK_PRIVATE_COMMENT_ADDED_EMAIL]:(0,o.__)("Email notification sent by automation","quicktasker")};function zt(){const{dispatch:e}=(0,a.useContext)(Ut),t=e=>{e&&e.forEach((e=>{if(e.automation_action.includes("email"))return;const t=Ft[e.automation_action]||`Automation executed: ${e.automation_action}`;i.oR.info(t)}))},s=(t,s)=>{t&&s&&t.forEach((t=>{if(t.automation_action===Je.ARCHIVE_TASK&&e({type:R,payload:s}),t.automation_action===Je.ASSIGN_USER){const n=t.executionResult;!n||!(a=n)||"object"!=typeof a||a.user_type&&a.user_type!==We.QUICKTASKER&&a.user_type!==We.WP_USER||e({type:N,payload:{taskId:s,user:n}})}var a}))};return{displayAutomationMessages:t,handleExecutedAnimationsResults:s,handleExecutedAutomations:(e,a)=>{0!==e.length&&(s(e,a),t(e))},createAutomation:(e,t,s)=>Mt(this,void 0,void 0,(function*(){try{const a=yield function(e,t){var s;return u()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"POST",data:{automationTargetId:null,automationTarget:t.automationTarget,automationTrigger:t.automationTrigger,automationAction:null===(s=t.automationAction)||void 0===s?void 0:s.id,automationActionTargetId:t.automationActionTargetId,automationActionTargetType:t.automationActionTargetType,automationMetadata:t.metaData},headers:p()})}(e,t);i.oR.success((0,o.__)("Automation created","quicktasker")),s&&s(!0,a.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create automation","quicktasker")),s&&s(!1,null)}})),deleteAutomation:(e,t,s)=>Mt(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/pipelines/${e}/automations/${t}`,method:"DELETE",headers:p()})}(e,t),i.oR.success((0,o.__)("Automation deleted","quicktasker")),s&&s(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete automation","quicktasker")),s&&s(!1)}}))}}var Kt=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const $t=()=>{const{handleExecutedAutomations:e}=zt(),{displayErrorMessages:t}=function(){return{displayErrorMessages:e=>{return t=this,s=void 0,n=function*(){if(e.messages&&Array.isArray(e.messages)&&e.messages.length>0){const t=e.messages.join(", ");i.oR.error(t)}},new((a=void 0)||(a=Promise))((function(e,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(t,s||[])).next())}));var t,s,a,n}}}();return{deleteTask:(t,s)=>Kt(void 0,void 0,void 0,(function*(){try{const a=yield function(e){return u()({path:`/wpqt/v1/tasks/${e}`,method:"DELETE",headers:p()})}(t);s&&s(),i.oR.success((0,o.__)("Task deleted","quicktasker")),e(a.data.executedAutomations,t)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a task","quicktasker"))}})),archiveTask:(e,t)=>Kt(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task archived","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to archive a task","quicktasker"))}})),restoreArchivedTask:(e,t)=>Kt(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive-restore`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task restored","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore a task","quicktasker"))}})),removeTaskFromUser:(t,s,a)=>Kt(void 0,void 0,void 0,(function*(){try{const n=yield v(t,s,We.QUICKTASKER);i.oR.success((0,o.__)("Task has been unassigned","quicktasker")),e(n.data.executedAutomations,s),a&&a()}catch(e){console.error(e),i.oR.error((0,o.__)("Task unassignment failed. Try again","quicktasker"))}})),changeTaskDoneStatus:(s,a,n)=>Kt(void 0,void 0,void 0,(function*(){try{const t=a?(0,o.__)("Task marked as completed","quicktasker"):(0,o.__)("Task marked as incomplete","quicktasker"),r=yield function(e,t){return u()({path:`/wpqt/v1/tasks/${e}/done`,method:"PATCH",data:{done:t},headers:p()})}(s,a);n&&n(a),i.oR.success(t),e(r.data.executedAutomations,s)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change task status","quicktasker")),t(e)}})),moveTask:(e,t,s,a)=>Kt(void 0,void 0,void 0,(function*(){try{yield h(e,t,s),i.oR.success((0,o.__)("Task moved","quicktasaker")),a&&a(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a task","quicktasker")),a&&a(!1)}}))}},Vt=()=>Object.assign({},Ht),Gt=(e,t)=>{var s,a,n,i,o,r,c,l,d,u,p,h,w,m,q,v;switch(t.type){case F:{const{taskToEdit:s,taskModalSettings:a}=t.payload;return Object.assign(Object.assign({},e),{taskModalOpen:!0,taskToEdit:s,targetStageId:s.stage_id,taskModalSettings:Object.assign(Object.assign({},e.taskModalSettings),a)})}case z:return Vt();case Y:{const d=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:Ze(d)?[d,...null!==(a=null===(s=e.taskToEdit)||void 0===s?void 0:s.assigned_users)&&void 0!==a?a:[]]:null!==(i=null===(n=e.taskToEdit)||void 0===n?void 0:n.assigned_users)&&void 0!==i?i:[],assigned_wp_users:et(d)?[d,...null!==(r=null===(o=e.taskToEdit)||void 0===o?void 0:o.assigned_wp_users)&&void 0!==r?r:[]]:null!==(l=null===(c=e.taskToEdit)||void 0===c?void 0:c.assigned_wp_users)&&void 0!==l?l:[]})})}case X:{const s=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:Ze(s)?(null!==(u=null===(d=e.taskToEdit)||void 0===d?void 0:d.assigned_users)&&void 0!==u?u:[]).filter((e=>e.id!==s.id)):null!==(h=null===(p=e.taskToEdit)||void 0===p?void 0:p.assigned_users)&&void 0!==h?h:[],assigned_wp_users:et(s)?(null!==(m=null===(w=e.taskToEdit)||void 0===w?void 0:w.assigned_wp_users)&&void 0!==m?m:[]).filter((e=>e.id!==s.id)):null!==(v=null===(q=e.taskToEdit)||void 0===q?void 0:q.assigned_wp_users)&&void 0!==v?v:[]})})}case K:{const{targetPipelineId:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,targetPipelineId:s})}case V:{const{stageToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,stageToEdit:s})}case $:return Vt();case G:return Object.assign(Object.assign({},e),{newPipelineModalOpen:!0});case H:{const{pipelineToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{pipelineModalOpen:!0,pipelineToEdit:s})}case B:return Vt();case"OPEN_ARCHIVE_TASK_MODAL":{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskModalOpen:!0,archiveModalTask:s})}case"CLOSE_ARCHIVE_TASK_MODAL":return Vt();case"OPEN_NEW_USER_MODAL":return Object.assign(Object.assign({},e),{userModalOpen:!0});case Q:{const s=t.payload;return Object.assign(Object.assign({},e),{userModalOpen:!0,userToEdit:s})}case W:return Vt();case J:return t.payload?Object.assign(Object.assign({},e),{userSettingsModalOpen:!0}):Vt();case"CHANGE_TASK_DONE_STATUS":{const{done:s}=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{is_done:s})})}case Z:{const{task:s}=t.payload;return Object.assign(Object.assign({},e),{moveTaskModalOpen:!0,taskToEdit:s})}case ee:return Vt();default:return e}},Ht={taskModalOpen:!1,targetStageId:"",taskToEdit:null,taskModalSettings:{allowToMarkTaskAsDone:!0},moveTaskModalOpen:!1,stageModalOpen:!1,stageToEdit:null,targetPipelineId:"",pipelineModalOpen:!1,newPipelineModalOpen:!1,pipelineToEdit:null,archiveTaskModalOpen:!1,archiveModalTask:null,userModalOpen:!1,userToEdit:null,userSettingsModalOpen:!1},Bt=(0,a.createContext)({state:Ht,modalDispatch:()=>{}}),Wt=({children:e})=>{const[t,s]=(0,a.useReducer)(Gt,Ht);return(0,n.jsx)(Bt.Provider,{value:{state:t,modalDispatch:s},children:e})},Qt=(e,t)=>{switch(t.type){case de:{const s=t.payload.map(tt);return Object.assign(Object.assign({},e),{users:s})}case ue:{const s=t.payload.map((e=>Object.assign(Object.assign({},e),{id:String(e.id)})));return Object.assign(Object.assign({},e),{wpUsers:s})}case pe:{const s=t.payload,a=tt(s);return Object.assign(Object.assign({},e),{users:[...e.users,a]})}case we:{const s=t.payload,a=tt(s),n=e.users.map((e=>e.id===a.id?a:e));return Object.assign(Object.assign({},e),{users:n})}case qe:{const{isActive:s,userId:a}=t.payload,n=e.users.map((e=>e.id===a?Object.assign(Object.assign({},e),{is_active:s}):e));return Object.assign(Object.assign({},e),{users:n})}case ve:{const s=t.payload,a=e.users.map((e=>e.id===s?Object.assign(Object.assign({},e),{has_password:!1}):e));return Object.assign(Object.assign({},e),{users:a})}case me:{const s=t.payload,a=e.users.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{users:a})}case he:{const s=t.payload;return Object.assign(Object.assign({},e),{usersSearchValue:s})}default:return e}};var Yt=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Xt={users:[],wpUsers:[],usersSearchValue:""},Jt=(0,a.createContext)({state:Xt,userDispatch:()=>{},updateUsers:()=>Yt(void 0,void 0,void 0,(function*(){}))}),Zt=({children:e})=>{const[t,s]=(0,a.useReducer)(Qt,Xt);return(0,a.useEffect)((()=>{const e=window.wpqt.initialUsers,t=window.wpqt.initialWPUsers;s({type:de,payload:e}),s({type:ue,payload:t})}),[]),(0,n.jsx)(Jt.Provider,{value:{state:t,userDispatch:s,updateUsers:()=>Yt(void 0,void 0,void 0,(function*(){try{const e=yield u()({path:"/wpqt/v1/users",method:"GET",headers:p()});s({type:de,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch users","quicktasker"))}}))},children:e})};var es;!function(e){e.ACTIVE_PIPELINE="ACTIVE_PIPELINE",e.PIPELINES="PIPELINES",e.USER="USER"}(es||(es={}));const ts=e=>{const[t,s]=(0,a.useState)(!1),n=(0,a.useRef)(null),{modalDispatch:i}=(0,a.useContext)(Bt),{dispatch:o}=(0,a.useContext)(Ut),{pipelinesDispatch:r}=(0,a.useContext)(St),{userDispatch:c}=(0,a.useContext)(Jt),l=()=>{i({type:e}),d()},d=()=>{n.current&&n.current.clearContent()};return{modalSaving:t,setModalSaving:s,modalContentRef:n,closeModal:l,handleSuccess:(e,t,a)=>{let n;switch(a){case es.PIPELINES:n=r;break;case es.ACTIVE_PIPELINE:n=o;break;case es.USER:n=c;break;default:n=o}s(!1),n({type:e,payload:t}),l()},handleError:e=>{s(!1),console.error(e)}}};var ss,as=s(2922),ns=s(6053),is=s(9828),os=s(540),rs=s(4576),cs=s(5138),ls=s(7008);function ds({id:e}){return(0,n.jsx)(ls.m_,{id:e,className:"wpqt-bg-red-600",children:(0,n.jsx)("span",{children:"Tooltip content"})})}function us({onClick:e=()=>{},btnText:t,className:s,type:a=ss.BUTTON,disabled:i=!1,loading:o=!1}){return(0,n.jsx)(cs.$,{disabled:i||o,className:`wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-transparent wpqt-bg-blue-500 wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-text-white wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 focus:wpqt-ring-blue-800 enabled:hover:wpqt-bg-blue-600 ${s}`,onClick:e,type:a,children:o?(0,n.jsx)(xt,{width:"24",height:"24",color:"#ffffff",secondaryColor:"#ffffff"}):t})}function ps({icon:e,text:t,onClick:s=()=>{},className:a,tooltipId:i,tooltipText:o,loading:r=!1}){const c=o&&i,l=c?{"data-tooltip-id":i,"data-tooltip-content":o,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,n.jsxs)("div",Object.assign({},l,{className:`wpqt-main-border wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-bg-gray-100 wpqt-p-2 hover:wpqt-bg-white ${a}`,onClick:s,children:[e,t||r?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center wpqt-relative",children:[t&&(0,n.jsx)("span",{className:"wpqt-whitespace-nowrap "+(r?"wpqt-invisible":""),children:t}),r&&(0,n.jsx)(xt,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]}):null,c&&(0,n.jsx)(ds,{id:i})]}))}function hs({icon:e,onClick:t=()=>{},className:s,loading:a=!1}){return(0,n.jsxs)("div",{className:`wpqt-main-border wpqt-p-1 wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-bg-gray-100 hover:wpqt-bg-white ${s}`,onClick:t,children:[(0,n.jsx)("div",{className:"wpqt-flex wpqt-items-center "+(a?"wpqt-invisible":""),children:e}),a&&(0,n.jsx)(xt,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]})}function ws({modalOpen:e,closeModal:t,children:s,size:a="sm"}){return(0,n.jsxs)(as.lG,{open:e,as:"div",className:"wpqt-relative wpqt-z-9999 focus:wpqt-outline-none",onClose:t,children:[(0,n.jsx)(as.Xi,{className:"wpqt-fixed wpqt-inset-0 wpqt-bg-black/40"}),(0,n.jsx)("div",{className:"wpqt-fixed wpqt-inset-0 wpqt-z-10 wpqt-w-screen wpqt-overflow-y-auto",children:(0,n.jsx)("div",{className:"wpqt-mt-[8vh] wpqt-flex wpqt-justify-center",children:(0,n.jsxs)(as.Lj,{transition:!0,className:`data-[closed]:wpqt-transform-[wpqt-scale(95%)] wpqt-relative wpqt-mt-[20px] wpqt-w-4/5 ${{sm:"wpqt-max-w-sm",md:"wpqt-max-w-lg",lg:"wpqt-max-w-4xl",xl:"wpqt-max-w-6xl"}[a]} wpqt-rounded-xl wpqt-bg-white wpqt-p-8 wpqt-backdrop-blur-2xl wpqt-duration-300 wpqt-ease-out data-[closed]:wpqt-opacity-0`,children:[(0,n.jsx)("div",{className:"wpqt-group wpqt-absolute wpqt-right-[-20px] wpqt-top-[-20px] wpqt-flex wpqt-h-[40px] wpqt-w-[40px] wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-rounded-full wpqt-border wpqt-border-solid wpqt-bg-white wpqt-text-qtBorder",onClick:t,children:(0,n.jsx)(rs.A,{className:"wpqt-icon-blue group-hover:wpqt-icon-red wpqt-size-5"})}),s]})})})]})}function ms({children:e}){return(0,n.jsx)(as.L3,{as:"div",className:"wpqt-text-base/7 wpqt-font-medium wpqt-text-black",children:e})}function qs({children:e}){return(0,n.jsx)(ns.L,{children:e})}function vs({label:e,children:t,tooltipId:s,tooltipText:a}){const i=s&&a,o=i?{"data-tooltip-id":s,"data-tooltip-content":a,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info","data-tooltip-place":"top-end"}:{};return(0,n.jsxs)(is.D,{className:"wpqt-mb-3",children:[(0,n.jsx)(os.JU,Object.assign({className:"wpqt-mb-2 wpqt-block wpqt-text-sm/6 wpqt-font-medium"},o,{children:e})),t,i&&(0,n.jsx)(ds,{id:s})]})}function xs({onSave:e,saveBtnText:t,loading:s=!1}){return(0,n.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-justify-end",children:(0,n.jsx)(us,{btnText:t,loading:s,onClick:e})})}!function(e){e.BUTTON="button",e.SUBMIT="submit",e.RESET="reset"}(ss||(ss={}));var fs=s(1489),gs=s(8448),_s=s(8176),ks=s(1052);function js(){const[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1);return{loading1:e,loading2:s,setLoading1:t,setLoading2:n,loading3:i,setLoading3:o}}const ys=(e,t)=>{switch(t.type){case"SET_SITE_URL":{const s=t.payload;return Object.assign(Object.assign({},e),{siteURL:s})}case xe:{const{siteURL:s,publicUserPageId:a,timezone:n,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r}=t.payload;return Object.assign(Object.assign({},e),{siteURL:s,publicUserPageId:a,timezone:n,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r})}case fe:{const s=t.payload;return Object.assign(Object.assign({},e),{userPageCustomStyles:s})}default:return e}},bs={siteURL:"",pluginURL:"",publicUserPageId:"",is_customFields:!1,timezone:"",isUserAllowedToDelete:!1,userPageCustomStyles:""},Ts=(0,a.createContext)({state:bs,appDispatch:()=>{}}),Ss=({children:e})=>{const[t,s]=(0,a.useReducer)(ys,bs);return(0,a.useEffect)((()=>{const e=window.wpqt.siteURL,t=window.wpqt.publicUserPageId,a=window.wpqt.timezone,n="1"===window.wpqt.isUserAllowedToDelete,i=window.wpqt.userPageCustomStyles,o=window.wpqt.pluginURL;s({type:xe,payload:{siteURL:e,publicUserPageId:t,timezone:a,isUserAllowedToDelete:n,userPageCustomStyles:i,pluginURL:o}})}),[]),(0,n.jsx)(Ts.Provider,{value:{state:t,appDispatch:s},children:e})};var As,Es,Cs;!function(e){e.Text="text",e.Select="select",e.Checkbox="checkbox",e.Radio="radio",e.Datetime="datetime",e.File="file"}(As||(As={})),function(e){e.User="user",e.Pipeline="pipeline",e.Users="users",e.Task="task"}(Es||(Es={})),function(e){e.TEXT="text",e.PASSWORD="password"}(Cs||(Cs={}));const Ns=(0,a.forwardRef)((({value:e,onChange:t,isAutoFocus:s,className:a="",wrapperClassName:i="",disabled:o=!1,type:r=Cs.TEXT,loading:c=!1,inputId:l},d)=>(0,n.jsxs)("div",{className:`wpqt-inline-block wpqt-relative wpqt-mb-3 ${i}`,children:[(0,n.jsx)(kt.p,{ref:d,autoFocus:s,className:`wpqt-block wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${a}`,value:e,disabled:o,onChange:e=>t(e.target.value),type:r,id:l}),c&&(0,n.jsx)(xt,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"})]})));var Os=s(1062),Is=s(4164);function Ps({value:e,onChange:t,rowsCount:s=3,className:a}){return(0,n.jsx)(Os.T,{className:(0,Is.$)("wpqt-border-1 wpqt-mb-3 wpqt-block wpqt-resize-none wpqt-rounded-lg wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6",`focus:wpqt-shadow-none focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${a}`),rows:s,value:e,onChange:e=>t(e.target.value)})}var Ds=s(303);function Rs({checked:e,handleChange:t}){return(0,n.jsx)(Ds.A,{onChange:t,checked:e,uncheckedIcon:!1,checkedIcon:!1,height:20,width:44})}const Us=(e,t)=>{switch(t.type){case Re:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case Ue:{const{entityId:s,entityType:a}=t.payload;return Object.assign(Object.assign({},e),{entityId:s,entityType:a})}case Ie:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:s})}case Pe:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:[...e.customFields,s]})}case De:{const s=t.payload,a=e.customFields.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{customFields:a})}default:return e}};const Ls={customFields:[],loading:!0,entityId:"",entityType:null},Ms=(0,a.createContext)({state:Ls,customFieldsDispatch:()=>{},fetchCustomFields:()=>{}}),Fs=({children:e,entityId:t,entityType:s})=>{const[r,c]=(0,a.useReducer)(Us,Ls);(0,a.useEffect)((()=>{l()}),[]),(0,a.useEffect)((()=>{c({type:Ue,payload:{entityType:s,entityId:t}})}),[s,t]);const l=()=>{return e=void 0,a=void 0,r=function*(){try{c({type:Re,payload:!0});const e=yield x(t,s,!0);c({type:Ie,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch custom fields","quicktasker"))}finally{c({type:Re,payload:!1})}},new((n=void 0)||(n=Promise))((function(t,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(i,o)}c((r=r.apply(e,a||[])).next())}));var e,a,n,r};return(0,n.jsx)(Ms.Provider,{value:{state:r,customFieldsDispatch:c,fetchCustomFields:l},children:e})};function zs({title:e,description:t,className:s=""}){return(0,n.jsxs)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center wpqt-h-full ${s}`,children:[(0,n.jsx)("h2",{className:"wpqt-font-semibold",children:e}),(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-4",children:t}),(0,n.jsx)("div",{className:"wpqt-text-blue-500 wpqt-font-semibold",children:(0,n.jsx)("a",{href:"https://payhip.com/b/84TLC",target:"_blank",rel:"noreferrer",children:(0,o.__)("Get the premium version","quicktasker")})})]})}var Ks=s(9197),$s=s(2767),Vs=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Gs(){return{addCustomField:(e,t,s,a,n,r)=>Vs(this,void 0,void 0,(function*(){try{const i=yield function(e,t,s,a,n){return u()({path:"/wpqt/v1/custom-fields",method:"POST",data:{entityId:e,entityType:t,type:s,name:a,description:n},headers:p()})}(e,t,s,a,n);r&&r(i.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add a custom field","quicktasker"))}})),markCustomFieldAsDeleted:(e,t)=>Vs(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/custom-fields/${e}`,method:"DELETE",headers:p()})}(e),t&&t()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to mark custom field as deleted","quicktasker"))}})),restoreCustomField:(e,t)=>Vs(this,void 0,void 0,(function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/custom-fields/${e}/restore`,method:"PATCH",headers:p()})}(e);i.oR.success((0,o.__)("Custom field restored","quicktasker")),t&&t(s.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore custom field","quicktasker"))}})),updateCustomFieldValue:(e,t,s,a,n)=>Vs(this,void 0,void 0,(function*(){try{yield function(e,t,s,a){return u()({path:`/wpqt/v1/custom-fields/${e}/value`,method:"PATCH",data:{value:t,entityId:String(s),entityType:a},headers:p()})}(e,t,s,a),n&&n()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to update custom field value","quicktasker"))}}))}}var Hs=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Bs({description:e}){const[t,s]=(0,a.useState)(""),[i,r]=(0,a.useState)(""),[c,l]=(0,a.useState)(!1),[d,u]=(0,a.useState)(As.Text),{addCustomField:p}=Gs(),{state:{entityId:h,entityType:w},customFieldsDispatch:m}=(0,a.useContext)(Ms),[q,v]=(0,a.useState)(!1),x=[{value:As.Text,label:"Text"},{value:As.Checkbox,label:"Checkbox"}];return(0,n.jsxs)("div",{className:"wpqt-mb-6 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)("h2",{children:(0,o.__)("Custom Fields","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:e}),c&&(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Name","quicktasker")}),(0,n.jsx)(Ns,{value:t,onChange:s})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Description","quicktasker")}),(0,n.jsx)(Ps,{value:i,onChange:r})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Type","quicktasker")}),(0,n.jsx)(Ct,{selectedOptionValue:d,options:x,onSelectionChange:e=>{u(e)},allSelector:!1})]})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,n.jsx)(ps,{text:c?(0,o.__)("Cancel","quicktasker"):(0,o.__)("Add new custom field","quicktasker"),onClick:()=>l(!c),icon:c?(0,n.jsx)(Ks.A,{className:"wpqt-icon-red wpqt-size-5"}):(0,n.jsx)($s.A,{className:"wpqt-icon-green wpqt-size-5"})}),c&&(0,n.jsx)(ps,{text:(0,o.__)("Add","quicktasker"),onClick:()=>Hs(this,void 0,void 0,(function*(){h&&w?(v(!0),yield p(h,w,d,t,i,(e=>{m({type:Pe,payload:e}),s(""),r(""),u(As.Text),l(!1)})),v(!1)):console.error("Entity ID or Entity Type is missing")})),loading:q,icon:(0,n.jsx)($s.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]})}var Ws=s(72),Qs=s(2601),Ys=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Xs({data:e,onSave:t,locationOfCustomFields:s,onDelete:i,actionLoading:r}){const{state:{isUserAllowedToDelete:c}}=(0,a.useContext)(Ts),l=e.entity_type===s,d=s===Es.Task||s===Es.User,u=e.entity_type===Es.Pipeline?"board":e.entity_type;return r?(0,n.jsx)(gt,{ovalSize:"24"}):(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-gap-2",children:[d&&(0,n.jsx)(ps,{onClick:t,icon:(0,n.jsx)(Qs.A,{className:"wpqt-icon-green wpqt-size-4"}),tooltipId:`custom-field-${e.id}-update`,tooltipText:(0,o.__)("Edit custom field value","quicktasker")}),c&&(0,n.jsx)(ps,Object.assign({onClick:()=>Ys(this,void 0,void 0,(function*(){l&&i()})),className:l?"":"!wpqt-cursor-not-allowed",icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-4"})},!l&&{tooltipId:`custom-field-${e.id}-delete`,tooltipText:(0,o.sprintf)((0,o.__)("This custom field is inherited from %s settings and can't be deleted here","quicktasker"),u)}))]})}var Js=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Zs({data:e}){const[t,s]=(0,a.useState)(""),{state:{entityType:i,entityId:o},customFieldsDispatch:r}=(0,a.useContext)(Ms),{updateCustomFieldValue:c,markCustomFieldAsDeleted:l}=Gs(),[d,u]=(0,a.useState)(!1);let p;switch((0,a.useEffect)((()=>{e.value&&s(e.value)}),[e.value]),e.type){case As.Text:p=(0,n.jsx)(ea,{data:e,value:t,onChange:s});break;case As.Checkbox:p=(0,n.jsx)(ta,{data:e,value:t,onChange:s})}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{}),p,(0,n.jsx)(Xs,{data:e,locationOfCustomFields:i,onSave:()=>Js(this,void 0,void 0,(function*(){i===Es.User||i===Es.Task?(u(!0),yield c(e.id,t,o,i),u(!1)):console.error("Invalid entity type for saving custom field value")})),onDelete:()=>Js(this,void 0,void 0,(function*(){u(!0),yield l(e.id,(()=>{r({type:De,payload:e.id})})),u(!1)})),actionLoading:d})]})}function ea({data:e,value:t,onChange:s}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center",children:[(0,n.jsx)(sa,{name:e.name,description:e.description}),(0,n.jsx)(Ns,{value:t,onChange:s})]})}function ta({data:e,value:t,onChange:s}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(sa,{name:e.name,description:e.description}),(0,n.jsx)("input",{type:"checkbox",checked:"true"===t,className:"!wpqt-block",onChange:e=>s(e.target.checked?"true":"false")})]})}function sa({name:e,description:t=""}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-mb-1 wpqt-text-base wpqt-font-semibold",children:e}),t&&(0,n.jsx)("div",{className:"wpqt-mb-2 wpqt-italic",children:t})]})}function aa(){const{state:{loading:e,customFields:t}}=(0,a.useContext)(Ms),[s,i]=(0,a.useState)(!1);return e?(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(xt,{width:"36",height:"36"})}):t&&0===t.length?(0,n.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No related custom fields created","quicktasker")}):s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-my-4 wpqt-grid wpqt-grid-cols-[100px_1fr_100px] wpqt-items-center wpqt-gap-3",children:t.map((e=>(0,n.jsx)(Zs,{data:e},e.id)))}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(ps,{text:(0,o.__)("Hide custom fields","quicktasker"),onClick:()=>i(!1),icon:(0,n.jsx)(Ws.A,{className:"wpqt-icon-red wpqt-size-5"})})})]}):(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(ps,{text:(0,o.__)("Show custom fields","quicktasker"),onClick:()=>i(!0),icon:(0,n.jsx)(Ws.A,{className:"wpqt-icon-blue wpqt-size-5"})})})}var na=s(5066);const ia={[Es.Pipeline]:(0,o.__)("Board","quicktasker"),[Es.Task]:(0,o.__)("Task","quicktasker"),[Es.User]:(0,o.__)("User","quicktasker"),[Es.Users]:(0,o.__)("Global users","quicktasker")};var oa=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ra({customField:e,refreshDeletedFields:t}){const{customFieldsDispatch:s}=(0,a.useContext)(Ms),[i,r]=(0,a.useState)(!1),{restoreCustomField:c}=Gs();return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Name:","quicktasker")})," ",e.name]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Description:","quicktasker")})," ",e.description]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Level:","quicktasker")})," ",ia[e.entity_type]]}),(0,n.jsx)("div",{children:(0,n.jsx)(hs,{onClick:()=>oa(this,void 0,void 0,(function*(){r(!0),yield c(e.id,(e=>{s({type:Pe,payload:e}),t()})),r(!1)})),loading:i,icon:(0,n.jsx)(na.HCd,{className:"wpqt-icon-green wpqt-size-5"})})})]})}var ca=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function la(){const[e,t]=(0,a.useState)(!1),[s,r]=(0,a.useState)(!0),[c,l]=(0,a.useState)(null),{state:{entityId:d,entityType:u}}=(0,a.useContext)(Ms);(0,a.useEffect)((()=>{e&&p()}),[e]);const p=()=>ca(this,void 0,void 0,(function*(){if(d&&u)try{r(!0);const e=yield x(d,u,!1);l(e.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load deleted custom fields","quicktasker"))}finally{r(!1)}else console.error("Entity ID or Entity Type is missing")}));return(0,n.jsxs)("div",{className:"wpqt-my-3 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)("h2",{children:(0,o.__)("Custom Field recovery","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:(0,o.__)("Deleted custom field by accident? No worries! You can recover it here.","quicktasker")}),e&&(0,n.jsx)("div",{className:"wpqt-mb-3",children:s?(0,n.jsx)(gt,{ovalSize:"36"}):c&&0===c.length?(0,n.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No deleted custom fields","quicktasker")}):c&&c.length>0?(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:c.map((e=>(0,n.jsx)(ra,{customField:e,refreshDeletedFields:p},e.id)))}):null}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:(0,n.jsx)(ps,{text:e?(0,o.__)("Close recovery","quicktasker"):(0,o.__)("Open recovery","quicktasker"),onClick:()=>t(!e),icon:(0,n.jsx)(na.HCd,{className:"wpqt-icon-green wpqt-size-5"})})})]})}const da={[Es.User]:(0,o.__)("Add user-specific custom fields. If you want to add custom fields to all users, please go to users settings.","quicktasker"),[Es.Users]:(0,o.__)("Add custom fields to all users. If you want to add custom fields to a specific user only, please go to that user settings.","quicktasker"),[Es.Pipeline]:(0,o.__)("Add board level custom fields.","quicktasker"),[Es.Task]:(0,o.__)("Add task-specific custom fields. If you want to add custom fields to all tasks in this board, please go to board settings.","quicktasker")},ua={[Es.User]:(0,o.__)("Custom fields applied to this user, including both user-specific and global users fields.","quicktasker"),[Es.Users]:(0,o.__)("Global user custom field are applied to all users.","quicktasker"),[Es.Pipeline]:(0,o.__)("Board level fields are applied to all tasks in this board.","quicktasker"),[Es.Task]:(0,o.__)("Custom fields applied to this task, including both task-specific and board-level fields.","quicktasker")},pa={[Es.User]:(0,o.__)("User custom fields","quicktasker"),[Es.Users]:(0,o.__)("Global users custom fields","quicktasker"),[Es.Pipeline]:(0,o.__)("Board custom fields","quicktasker"),[Es.Task]:(0,o.__)("Task custom fields","quicktasker")};function ha({entityId:e,entityType:t}){const{state:{is_customFields:s}}=(0,a.useContext)(Ts),i=da[t],r=pa[t],c=ua[t];return(0,n.jsx)(n.Fragment,{children:s?(0,n.jsx)("div",{children:(0,n.jsxs)(Fs,{entityId:e,entityType:t,children:[(0,n.jsx)(Bs,{description:i}),(0,n.jsx)("h2",{className:"wpqt-text-center",children:r}),(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:c}),(0,n.jsx)(aa,{}),(0,n.jsx)(la,{})]})}):(0,n.jsx)(zs,{title:(0,o.__)("Custom fields","quicktasker"),description:(0,o.__)("Premium feature to create and manage custom data fields. Allows to add extra data to tasks and users.","quicktasker")})})}var wa=s(2792),ma=s(2185);function qa({children:e,menuBtn:t,menuBtnClasses:s="",anchor:a="bottom end"}){return(0,n.jsxs)(ma.W1,{children:[(0,n.jsx)(ma.IU,{as:"div",className:`wpqt-cursor-pointer ${s}`,onClick:e=>e.stopPropagation(),children:({active:e})=>(0,n.jsx)(n.Fragment,{children:t({active:e})})}),(0,n.jsx)(ma.c,{anchor:a,transition:!0,className:"wpqt-z-20 wpqt-origin-top wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-white wpqt-p-4 wpqt-transition wpqt-duration-200 wpqt-ease-out data-[closed]:wpqt-scale-95 data-[closed]:wpqt-opacity-0",children:e})]})}function va({isActive:e,IconComponent:t}){return(0,n.jsx)(t,{className:"wpqt-size-6 wpqt-text-gray-400 hover:wpqt-text-qtBlueHover "+(e?"wpqt-text-qtBlueHover":"")})}function xa({text:e,onClick:t,icon:s,className:a,disabled:i=!1,id:o="",tooltipText:r="",loading:c=!1}){const l=""!==r&&""!==o?{"data-tooltip-id":o,"data-tooltip-content":r,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,n.jsx)(ma.Dr,{children:(0,n.jsxs)("div",Object.assign({},l,{className:`wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-relative ${i?"wpqt-cursor-not-allowed wpqt-line-through":"wpqt-cursor-pointer hover:wpqt-underline"} ${a}`,onClick:e=>{!i&&t&&t(e)},children:[s,(0,n.jsx)("span",{className:c?"wpqt-invisible":"",children:e}),c&&(0,n.jsx)(xt,{width:"16",height:"16",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-y-center wpqt-transform-x-center"}),(0,n.jsx)(ds,{id:o})]}))})}var fa=s(6797),ga=s(4403);function _a({sectionTitle:e,onItemSelect:t=()=>{},users:s=[],ActionIcon:a=ga.A,actionIconClasses:i,noUsersText:o}){return(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2 wpqt-text-lg",children:e}),s.map(((e,s)=>{var o;return(0,n.jsxs)("div",{onClick:s=>{s.stopPropagation(),t(e)},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-px-2 wpqt-py-1 hover:wpqt-bg-gray-100",children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)("div",{children:e.name}),(0,n.jsx)("div",{className:"wpqt-italic",children:e.description}),et(e)&&(0,n.jsx)("div",{children:null===(o=e.roles)||void 0===o?void 0:o.join(",")})]}),(0,n.jsx)(a,{className:`wpqt-ml-auto wpqt-size-5 ${i}`})]},s)})),0===s.length&&(0,n.jsx)("div",{children:o})]})}var ka=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ja({task:e,onUserAdd:t,onUserDelete:s}){const{state:{users:r,wpUsers:c}}=(0,a.useContext)(Jt),{handleExecutedAutomations:l}=zt(),{dispatch:d}=(0,a.useContext)(Ut),[h,w]=(0,a.useState)(!1),m=r.filter((t=>{var s;return!(null!==(s=e.assigned_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))})),q=c.filter((t=>{var s;return!(null!==(s=e.assigned_wp_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))})),x=s=>ka(this,void 0,void 0,(function*(){try{w(!0);const a=s.user_type,n=yield function(e,t,s){return u()({path:`/wpqt/v1/users/${e}/tasks/${t}`,method:"POST",data:{user_type:s},headers:p()})}(s.id,e.id,a);d({type:N,payload:{taskId:e.id,user:s}}),t(s),l(n.data.executedAutomations,e.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to assign user","quicktasker"))}finally{w(!1)}})),f=t=>ka(this,void 0,void 0,(function*(){try{w(!0);const a=t.user_type,n=yield v(t.id,e.id,a);d({type:O,payload:{taskId:e.id,userId:t.id,userType:a}}),s(t),l(n.data.executedAutomations,e.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to remove user","quicktasker"))}finally{w(!1)}}));return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,n.jsx)(_a,{sectionTitle:(0,o.__)("Assigned quicktaskers","quicktasker"),users:e.assigned_users,onItemSelect:f,ActionIcon:fa.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No quicktaskers assigned","quicktasker")}),(0,n.jsx)(_a,{sectionTitle:(0,o.__)("Assigned WordPress users","quicktasker"),users:e.assigned_wp_users,onItemSelect:f,ActionIcon:fa.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No WordPress users assigned","quicktasker")}),(0,n.jsx)(_a,{sectionTitle:(0,o.__)("Assign a quicktasker","quicktasker"),users:m,onItemSelect:x,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No quicktaskers available to assign","quicktasker")}),(0,n.jsx)(_a,{sectionTitle:(0,o.__)("Assign a WordPress user","quicktasker"),users:q,onItemSelect:x,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No WordPress users with required permissions available to assign","quicktasker")}),h&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(xt,{width:"30",height:"30"})})]})}function ya({task:e,onUserAdd:t=()=>{},onUserDelete:s=()=>{},menuBtnClasses:a=""}){const i=[...e.assigned_users||[],...e.assigned_wp_users||[]],o=i.length>0;return(0,n.jsx)(qa,{menuBtnClasses:`wpqt-inline-flex ${a}`,anchor:"bottom start",menuBtn:()=>(0,n.jsxs)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:[(0,n.jsx)(wa.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`}),o&&(0,n.jsx)("div",{children:i.map(((e,t)=>(0,n.jsxs)("span",{children:[e.name,t<i.length-1&&", "]},t)))})]}),children:(0,n.jsx)(ja,{task:e,onUserAdd:t,onUserDelete:s})})}var ba=s(1848);function Ta({tabs:e,tabsContent:t,tabClassName:s="",tabListClassName:a=""}){return(0,n.jsxs)(ba.fu,{children:[(0,n.jsx)(ba.wb,{className:`wpqt-mb-6 wpqt-flex wpqt-border-0 wpqt-border-b wpqt-border-solid wpqt-border-b-gray-300 ${a}`,children:e.map((e=>(0,n.jsx)(Sa,{className:s,children:e},e)))}),(0,n.jsx)(ba.T2,{children:t.map(((e,t)=>(0,n.jsx)(Aa,{children:e},t)))})]})}function Sa({children:e,className:t}){return(0,n.jsx)(ba.oz,{as:"div",className:`wpqt-flex-1 wpqt-cursor-pointer wpqt-p-1 wpqt-pb-[10px] wpqt-text-center wpqt-text-lg data-[selected]:wpqt-border-b-2 data-[selected]:wpqt-border-l-0 data-[selected]:wpqt-border-r-0 data-[selected]:wpqt-border-t-0 data-[selected]:wpqt-border-solid data-[selected]:wpqt-border-b-blue-500 ${t}`,children:e})}function Aa({children:e}){return(0,n.jsx)(ba.Kp,{children:e})}var Ea=s(4353),Ca=s.n(Ea),Na=s(8569),Oa=s.n(Na),Ia=s(3826),Pa=s.n(Ia);Ca().extend(Pa()),Ca().extend(Oa());const Da=()=>{const{state:{timezone:e}}=(0,a.useContext)(Ts);return{convertToWPTimezone:t=>((e,t)=>{try{return Ca().utc(e).tz(t).format("MMMM D, YYYY HH:mm")}catch(t){return console.error("Error: ",t),e+" (UTC)"}})(t,e)}},Ra={[rt.Admin]:(0,o.__)("Admin","quicktasker"),[rt.Automation]:(0,o.__)("Automation","quicktasker"),[rt.System]:(0,o.__)("System","quicktasker"),[rt.WPQTUser]:"Quicktasker"},Ua=({log:e})=>{const{convertToWPTimezone:t}=Da(),s=Ra[e.created_by];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,n.jsx)("div",{className:"wpqt-text-center",children:s})]}),(0,n.jsx)("div",{children:e.text}),(0,n.jsx)("div",{children:t(e.created_at)})]})};var La=s(3338),Ma=s(3211);const Fa={success:"wpqt-bg-green-100 wpqt-border-green-400 wpqt-text-green-700",error:"wpqt-bg-red-100 wpqt-border-red-400 wpqt-text-red-700",warning:"wpqt-bg-yellow-100 wpqt-border-yellow-400 wpqt-text-yellow-700",info:"wpqt-bg-blue-100 wpqt-border-blue-400 wpqt-text-blue-700",primary:"wpqt-bg-gray-100 wpqt-border-gray-400 wpqt-text-gray-700"};function za({type:e="primary",className:t="",children:s}){const a=Fa[e];return(0,n.jsx)("div",{className:`wpqt-inline-flex wpqt-p-2 wpqt-border wpqt-border-solid wpqt-rounded-md ${a} ${t}`,children:s})}var Ka=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function $a({typeId:e,fetchData:t,renderItem:s,noDataMessage:i,explanation:o,onAdd:r=()=>Ka(this,void 0,void 0,(function*(){})),enableAdd:c=!1}){const[l,d]=(0,a.useState)(null),[u,p]=(0,a.useState)(""),[h,w]=(0,a.useState)(!0),[m,q]=(0,a.useState)(!1);(0,a.useEffect)((()=>{v()}),[e]);const v=()=>Ka(this,void 0,void 0,(function*(){w(!0);const e=yield t();e&&d(e),w(!1)}));return null===l?(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(xt,{width:"30",height:"30"})}):(0,n.jsxs)("div",{children:[o&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(za,{type:"info",className:"wpqt-mb-3 wpqt-text-center",children:o})}),0===l.length&&(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center",children:i}),(0,n.jsx)("div",{className:"wpqt-mb-3 wpqt-mt-3 wpqt-flex wpqt-justify-center",children:(0,n.jsx)(Va,{isLoading:h,refreshComemnts:v})}),c&&(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsxs)("div",{className:"wpqt-w-2/3 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,n.jsx)(Ps,{rowsCount:3,value:u,onChange:e=>p(e),className:"wpqt-mb-4 wpqt-w-full"}),(0,n.jsx)(ps,{text:"Add comment",loading:m,onClick:()=>Ka(this,void 0,void 0,(function*(){if(!u)return;q(!0);const e=yield r(u);e&&(d((t=>t?[e,...t]:[e])),p("")),q(!1)})),icon:(0,n.jsx)(La.A,{className:"wpqt-icon-blue wpqt-size-5"})})]})}),l.length>0&&(0,n.jsx)("div",{className:"wpqt-mb-[28px] wpqt-mt-[56px] wpqt-logs-grid",children:l.map((e=>s(e)))})]})}function Va({isLoading:e,refreshComemnts:t}){return(0,n.jsx)(n.Fragment,{children:e?(0,n.jsx)(xt,{width:"32",height:"32"}):(0,n.jsx)(Ma.A,{className:"wpqt-icon-blue wpqt-size-8 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:t})})}function Ga({item:e}){const{convertToWPTimezone:t}=Da();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,n.jsx)("div",{className:"wpqt-text-center",children:e.is_admin_comment?(0,o.__)("Admin","quicktasker"):(0,o.__)("QuickTasker","quicktasker")})]}),(0,n.jsx)("div",{children:e.text}),(0,n.jsx)("div",{children:t(e.created_at)})]})}var Ha=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ba({taskId:e}){return(0,n.jsx)($a,{typeId:e,fetchData:()=>Ha(this,void 0,void 0,(function*(){try{return(yield q(e,ot.Task)).data}catch(e){console.error(e),i.oR.error("Failed to get log")}})),renderItem:e=>(0,n.jsx)(Ua,{log:e}),noDataMessage:"No logs available",explanation:"Logs can be seen only by WordPress users (with required permissions)"})}var Wa=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Qa(){return{addComment:(e,t,s,a)=>Wa(this,void 0,void 0,(function*(){try{const n=yield m(e,t,s,a);return i.oR.success((0,o.__)("Comment added","quicktasker")),n.data.newComment}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add comment","quicktasker"))}}))}}const Ya=e=>Object.assign(Object.assign({},e),{is_admin_comment:"1"===e.is_admin_comment});var Xa=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ja({taskId:e}){const{addComment:t}=Qa();return(0,n.jsx)($a,{typeId:e,fetchData:()=>Xa(this,void 0,void 0,(function*(){try{return(yield w(e,ot.Task,!0)).data.map(Ya)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>Xa(this,void 0,void 0,(function*(){const a=yield t(e,ot.Task,!0,s);if(a)return Ya(a)})),renderItem:e=>(0,n.jsx)(Ga,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed only by WordPress users (with required permissions).",enableAdd:!0})}var Za=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function en({taskId:e}){const{addComment:t}=Qa();return(0,n.jsx)($a,{typeId:e,fetchData:()=>Za(this,void 0,void 0,(function*(){try{return(yield w(e,ot.Task,!1)).data.map(Ya)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>Za(this,void 0,void 0,(function*(){const a=yield t(e,ot.Task,!1,s);if(a)return Ya(a)})),renderItem:e=>(0,n.jsx)(Ga,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed by WordPress users (with required permissions) and quicktaskers (in quicktasker user page) who have been assigned to the task.",enableAdd:!0})}function tn({task:e}){return(0,n.jsx)(Ta,{tabs:["Private comments","Public comments","Logs"],tabsContent:[(0,n.jsx)(Ja,{taskId:e.id},1),(0,n.jsx)(en,{taskId:e.id},2),(0,n.jsx)(Ba,{taskId:e.id},3)]})}var sn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const an=(0,a.forwardRef)((({taskModalSaving:e,editTask:t,deleteTask:s},i)=>{const{state:{taskToEdit:r,taskModalSettings:c},modalDispatch:l}=(0,a.useContext)(Bt),{state:{isUserAllowedToDelete:d}}=(0,a.useContext)(Ts),{state:{activePipeline:u},fetchAndSetPipelineData:p}=(0,a.useContext)(Ut),{archiveDispatch:h}=(0,a.useContext)(mt),[w,m]=(0,a.useState)(""),[q,v]=(0,a.useState)(""),[x,f]=(0,a.useState)(!1),{archiveTask:g,restoreArchivedTask:_}=$t(),{loading1:k,setLoading1:j,loading2:y,setLoading2:b}=js(),T=null==r?void 0:r.is_archived,S=null!==(null==r?void 0:r.pipeline_name);(0,a.useEffect)((()=>{r&&(m(r.name),v(r.description),f(r.free_for_all))}),[r]);const A=()=>{m(""),v("")};return(0,a.useImperativeHandle)(i,(()=>({clearContent:A}))),r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,n.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,n.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,n.jsxs)(qs,{children:[(0,n.jsx)(vs,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(Ns,{isAutoFocus:!0,value:w,onChange:e=>m(e)})}),(0,n.jsx)(vs,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(Ps,{rowsCount:3,value:q,onChange:e=>v(e)})}),(0,n.jsx)(vs,{label:(0,o.__)("Assigned users","quicktasker"),children:(0,n.jsx)(ya,{task:r,onUserAdd:e=>{l({type:Y,payload:e})},onUserDelete:e=>{l({type:X,payload:e})}})}),(0,n.jsx)(vs,{label:(0,o.__)("Free for all task","quicktasker"),tooltipId:`free-for-all-${r.id}-tooltip`,tooltipText:(0,o.__)("When enabled, all QuickTasker users have the ability to self-assign or unassign this task.","quicktasker"),children:(0,n.jsx)(Rs,{checked:x,handleChange:f})}),c.allowToMarkTaskAsDone&&(0,n.jsx)(nn,{taskId:r.id,isCompleted:r.is_done})]}),(0,n.jsx)("div",{children:(0,n.jsx)(ha,{entityId:r.id,entityType:Es.Task})})]}),(0,n.jsx)("div",{className:"wpqt-mt-7 md:wpqt-pr-3",children:(0,n.jsx)(tn,{task:r})})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[T&&S&&(0,n.jsx)(ps,{icon:(0,n.jsx)(fs.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Restore task","quicktasker"),onClick:()=>{_(r.id,(()=>{l({type:z}),h({type:ne,payload:r.id})}))}}),!T&&(0,n.jsx)(ps,{icon:(0,n.jsx)(gs.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("Archive task","quicktasker"),loading:y,onClick:()=>{b(!0),g(r.id,(()=>{l({type:z}),p(u.id),b(!1)}))}}),d&&(0,n.jsx)(ps,{icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete task","quicktasker"),loading:k,onClick:()=>sn(void 0,void 0,void 0,(function*(){j(!0),yield s(r),l({type:z}),j(!1)}))})]})]}),(0,n.jsx)(xs,{onSave:()=>{r&&t(Object.assign(Object.assign({},r),{name:w,description:q,free_for_all:x}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));function nn({isCompleted:e,taskId:t}){const{modalDispatch:s}=(0,a.useContext)(Bt),{dispatch:i}=(0,a.useContext)(Ut),[r,c]=(0,a.useState)(!1),{changeTaskDoneStatus:l}=$t();return(0,n.jsx)(vs,{label:e?(0,o.__)("Task completed","quicktasker"):(0,o.__)("Task not completed","quicktasker"),children:r?(0,n.jsx)(xt,{width:"24",height:"24"}):(0,n.jsx)(ks.A,{onClick:()=>sn(this,void 0,void 0,(function*(){c(!0),yield l(t,!e,(e=>{s({type:I,payload:{done:e}}),i({type:I,payload:{taskId:t,done:e}})})),c(!1)})),className:`wpqt-size-6 ${e?"wpqt-icon-green":"wpqt-text-gray-300"} wpqt-cursor-pointer`})})}var on=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function rn({editTaskCallback:e,deleteTaskCallback:t}){const{state:{taskModalOpen:s}}=(0,a.useContext)(Bt),{deleteTask:i}=$t(),{modalSaving:o,setModalSaving:r,modalContentRef:c,closeModal:l,handleSuccess:d,handleError:h}=ts(z);return(0,n.jsx)(ws,{modalOpen:s,closeModal:l,size:"xl",children:(0,n.jsx)(an,{ref:c,editTask:t=>on(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e){return u()({path:`/wpqt/v1/tasks/${e.id}`,method:"PATCH",data:{id:e.id,name:e.name,description:e.description,freeForAll:e.free_for_all},headers:p()})}(t);d(b,s.data,es.ACTIVE_PIPELINE),e&&e(s.data)}catch(e){h(e)}})),deleteTask:e=>on(this,void 0,void 0,(function*(){i(e.id,(()=>{t&&t(e)}))})),taskModalSaving:o})})}function cn({text:e=(0,o.__)("No results found","quicktasker")}){return(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-center wpqt-text-xl",children:e})}const ln=()=>{const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s}}=(0,a.useContext)(mt);return{filterArchive:a=>{const n=a.name.toLowerCase().includes(e.toLowerCase())||a.description&&a.description.toLowerCase().includes(e.toLowerCase()),i=!t||("DELETED"===t?null===a.pipeline_name:a.pipeline_id===t),o=s===ct.All||s===ct.Completed&&a.is_done||s===ct.NotCompleted&&!a.is_done;return n&&i&&o}}};var dn=s(3033);function un({className:e,onClick:t,title:s,description:a,children:i,dropdown:o,titleClassName:r=""}){const c=void 0!==o;return(0,n.jsxs)("div",{className:(0,Is.$)("wpqt-relative wpqt-flex wpqt-flex-col wpqt-rounded wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-4",c&&"wpqt-pr-[24px]",e),onClick:t,children:[(0,n.jsxs)("div",{className:"wpqt-mb-3",children:[(0,n.jsx)("div",{className:`wpqt-text-lg ${r}`,children:s}),a&&(0,n.jsx)("div",{className:"wpqt-italic wpqt-text-gray-500",children:a})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-h-full",children:i}),c&&(0,n.jsx)("div",{className:"wpqt-absolute wpqt-right-2 wpqt-top-1 wpqt-z-10",children:o})]})}var pn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function hn({task:e,onDoneStatusChange:t,className:s=""}){const{changeTaskDoneStatus:i}=$t(),[o,r]=(0,a.useState)(!1),c=e.is_done,l=s=>pn(this,void 0,void 0,(function*(){r(!0),yield i(e.id,s,(s=>{t(e.id,s)})),r(!1)}));return o?(0,n.jsx)(gt,{ovalSize:"24",className:"wpqt-mt-auto"}):(0,n.jsx)("div",{className:`wpqt-flex wpqt-justify-center wpqt-mt-auto ${s}`,children:c?(0,n.jsx)(ks.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,n.jsx)(ks.A,{className:"wpqt-size-6 wpqt-text-gray-300",onClick:e=>{e.stopPropagation(),l(!0)}})})}function wn({label:e,value:t,valueClassName:s="",valueLink:a,icon:i,onClick:o=()=>{},className:r="",labelClassName:c=""}){return(0,n.jsxs)("div",{className:`wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center ${r}`,onClick:o,children:[i&&i,(0,n.jsx)("div",{className:c,children:t?`${e}:`:e}),(0,n.jsx)("div",{className:`${s}`,children:a?(0,n.jsx)("a",{href:a,target:"_blank",className:"wpqt-text-qtTextBlue wpqt-no-underline",rel:"noreferrer",onClick:e=>e.stopPropagation(),children:t}):t})]})}var mn=s(6436),qn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function vn({task:e}){const{state:{isUserAllowedToDelete:t}}=(0,a.useContext)(Ts),{archiveDispatch:s}=(0,a.useContext)(mt),{deleteTask:i,restoreArchivedTask:o}=$t(),[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),u=null!==e.pipeline_name;return(0,n.jsxs)(qa,{menuBtn:({active:e})=>(0,n.jsx)(va,{isActive:e,IconComponent:mn.A}),children:[(0,n.jsx)(xa,{text:"View task",icon:(0,n.jsx)(Ws.A,{className:"wpqt-icon-blue wpqt-size-4"})}),(0,n.jsx)(xa,{text:"Restore task",loading:r,icon:(0,n.jsx)(fs.A,{className:"wpqt-icon-green wpqt-size-4"}),disabled:!u,id:`restore-task-${e.id}-dropdown-item`,tooltipText:"Task cannot be restored because the board has been deleted.",onClick:t=>qn(this,void 0,void 0,(function*(){t.stopPropagation(),c(!0),yield o(e.id,(()=>{s({type:ne,payload:e.id})})),c(!1)}))}),t&&(0,n.jsx)(xa,{text:"Delete",loading:l,icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>qn(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield i(e.id,(()=>{s({type:ne,payload:e.id})})),d(!1)})),className:"!wpqt-mb-0"})]})}function xn({task:e}){const{modalDispatch:t}=(0,a.useContext)(Bt),{archiveDispatch:s}=(0,a.useContext)(mt);return(0,n.jsxs)(un,{title:e.name,description:e.description,dropdown:(0,n.jsx)(vn,{task:e}),className:"wpqt-cursor-pointer",onClick:()=>{t({type:F,payload:{taskToEdit:e}})},children:[(0,n.jsx)(wn,{label:(0,o.__)("Board","quicktasker"),value:e.pipeline_name?e.pipeline_name:(0,o.__)("Board is deleted!","quicktasker"),icon:(0,n.jsx)(dn.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(ya,{menuBtnClasses:"wpqt-self-start",task:e,onUserAdd:t=>{s({type:ie,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{s({type:oe,payload:{taskId:e.id,user:t}})}}),(0,n.jsx)(hn,{task:e,onDoneStatusChange:(e,t)=>{s({type:re,payload:{taskId:e,done:t}})}})]})}function fn(){var e;const{state:{archivedTasks:t=[]}}=(0,a.useContext)(mt),{filterArchive:s}=ln(),i=null!==(e=null==t?void 0:t.filter(s))&&void 0!==e?e:[];return t&&0===t.length?(0,n.jsx)(cn,{text:(0,o.__)("No tasks archived","quicktasker")}):i&&0===i.length?(0,n.jsx)(cn,{}):(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"wpqt-card-grid",children:i.map((e=>(0,n.jsx)(xn,{task:e},e.id)))})})}function gn(){const{state:{archivedTasks:e},archiveDispatch:t}=(0,a.useContext)(mt);return e?(0,n.jsxs)("div",{children:[(0,n.jsx)(It,{}),(0,n.jsx)(fn,{}),(0,n.jsx)(rn,{editTaskCallback:e=>{t({type:ce,payload:e})},deleteTaskCallback:e=>{t({type:ne,payload:e.id})}})]}):(0,n.jsx)(gt,{className:"wpqt-h-[200px]"})}function _n(){return(0,n.jsx)(qt,{children:(0,n.jsxs)(_t,{children:[(0,n.jsx)(l,{description:(0,o.__)("Archived tasks management page.","quicktasker"),children:(0,o.__)("Archive","quicktasker")}),(0,n.jsx)(gn,{})]})})}const kn=()=>{const{state:{pluginURL:e}}=(0,a.useContext)(Ts);return(0,n.jsxs)(_t,{children:[(0,n.jsx)(l,{description:(0,o.__)("Reading material about QuickTasker features and usage.","quicktasker"),children:(0,o.__)("Guide","quicktasker")}),(0,n.jsx)("div",{children:(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",href:e+"help/index.html",children:(0,o.__)("View Guide","quicktasker")})})]})};var jn=s(4175);const yn=({filterSettings:e,setFilterSettings:t})=>{const{state:{pipelines:s}}=(0,a.useContext)(St),[i,r]=(0,a.useState)(e);return(0,n.jsxs)(Ot,{title:(0,o.__)("Logs filtering","quicktasker"),children:[(0,n.jsx)(Ct,{allSelector:!1,selectedOptionValue:i.type,options:[{label:(0,o.__)("All types","quicktasker"),value:bn.All},{label:(0,o.__)("Board","quicktasker"),value:bn.Pipeline},{label:(0,o.__)("Stage","quicktasker"),value:bn.Stage},{label:(0,o.__)("Task","quicktasker"),value:bn.Task}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{type:e,typeId:""}))}}),i.type===bn.Pipeline&&(0,n.jsx)(Ct,{allSelector:!0,selectedOptionValue:i.typeId,options:s.map((e=>({label:e.name,value:e.id}))),onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{typeId:e}))}}),(0,n.jsx)(Ct,{allSelector:!1,selectedOptionValue:i.createdBy,options:[{label:(0,o.__)("Everyone","quicktasker"),value:Tn.All},{label:(0,o.__)("Admin","quicktasker"),value:Tn.Admin},{label:"QuickTasker",value:Tn.Quicktasker},{label:"Automation",value:Tn.Automation}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{createdBy:e}))}}),(0,n.jsx)(Ct,{allSelector:!1,selectedOptionValue:i.numberOfLogs,options:[{label:(0,o.__)("Show 100","quicktasker"),value:En.Hundred},{label:(0,o.__)("Show 200","quicktasker"),value:En.TwoHundred},{label:"Show 500",value:En.FiveHundred},{label:"Show all",value:En.All}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{numberOfLogs:e}))}}),(0,n.jsx)(Ct,{allSelector:!1,selectedOptionValue:i.order,options:[{label:(0,o.__)("ASC","quicktasker"),value:An.Asc},{label:(0,o.__)("DESC","quicktasker"),value:An.Desc}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{order:e}))}}),(0,n.jsx)(ps,{text:(0,o.__)("Apply filter","quicktasker"),icon:(0,n.jsx)(jn.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:()=>t(i)})]})};var bn,Tn;!function(e){e.Pipeline="pipeline",e.Stage="stage",e.Task="task",e.All="all"}(bn||(bn={})),function(e){e.Admin="admin",e.Quicktasker="quicktasker_user",e.Automation="automation",e.All="all"}(Tn||(Tn={}));const Sn=({logs:e,loading:t})=>t?(0,n.jsx)(gt,{ovalSize:"64",className:"wpqt-mt-12"}):0===e.length?(0,n.jsx)(cn,{text:(0,o.__)("No logs found","quicktasker")}):(0,n.jsx)("div",{className:"wpqt-logs-grid",children:e.map((e=>(0,n.jsx)(Ua,{log:e},e.id)))});var An,En,Cn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};!function(e){e.Asc="asc",e.Desc="desc"}(An||(An={})),function(e){e.Hundred="100",e.TwoHundred="200",e.FiveHundred="500",e.All="all"}(En||(En={}));const Nn=()=>{const[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)({numberOfLogs:En.Hundred,type:bn.All,typeId:"",createdBy:Tn.All,order:An.Desc}),[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!0);(0,a.useEffect)((()=>{l&&(h(),d(!1))}),[s,l]);const h=()=>Cn(void 0,void 0,void 0,(function*(){try{c(!0);const e=Object.assign({},s);e.numberOfLogs===En.All&&delete e.numberOfLogs,e.type===bn.All&&delete e.type,""===e.typeId&&delete e.typeId,e.createdBy===Tn.All&&delete e.createdBy;const a=yield function(e){const t=new URLSearchParams(Object.entries(e).reduce(((e,[t,s])=>(e[t]=String(s),e)),{}));return u()({path:`/wpqt/v1/global-logs?${t.toString()}`,method:"GET",headers:p()})}(e);t(a.data)}catch(e){console.error(e),i.oR.error("Failed to fetch logs")}finally{c(!1)}}));return(0,n.jsxs)("div",{children:[(0,n.jsx)(yn,{filterSettings:s,setFilterSettings:e=>Cn(void 0,void 0,void 0,(function*(){o(e),d(!0)}))}),(0,n.jsx)(Sn,{logs:e,loading:r})]})},On=()=>(0,n.jsxs)(_t,{children:[(0,n.jsx)(l,{description:(0,o.__)("The logs page where you can see all logs and filter them.","quicktasker"),children:(0,o.__)("Logs","quicktasker")}),(0,n.jsx)(Nn,{})]});var In=s(6708);function Pn({overviewFilter:e,onCreationDateChange:t,onDoneDateChange:s}){const a=e=>e instanceof Date?Ca()(e).format("YYYY-MM-DD"):"";return(0,n.jsx)("div",{children:(0,n.jsxs)(Ot,{title:(0,o.__)("Statistics filtering","quicktasker"),titleClassName:"wpqt-text-center",childrenClassName:"wpqt-gap-6 wpqt-justify-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task creation date","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("(Filter tasks that have creation date equal or bigger than)","quicktasker")})]}),(0,n.jsx)(In.A,{onChange:e=>{const s=a(e);t(s)},value:e.taskCreationDate,format:"y-MM-dd",id:"taskCreationDate"})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task done date","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("(Filter tasks that have done date equal or smaller than)","quicktasker")})]}),(0,n.jsx)(In.A,{onChange:e=>{const t=a(e);s(t)},value:e.taskDoneDate,format:"y-MM-dd",id:"taskCreationDate"})]})]})})}var Dn=s(2298);function Rn(e){const t=e.slice(1).some((e=>e[1]>0));return e.length>1&&t}function Un({text:e}){return(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-items-center wpqt-h-[400px] wpqt-w-[500px] wpqt-font-semibold",children:e})}function Ln({pipelineOverviewData:e,options:t,width:s}){var a,i;const r=[["Archived tasks","Task Count"],["Archived tasks",parseInt(null!==(a=null==e?void 0:e.archivedTasksCount)&&void 0!==a?a:"0")||0],["Not archived tasks",parseInt(null!==(i=null==e?void 0:e.notArchivedTasksCount)&&void 0!==i?i:"0")||0]];return Rn(r)?(0,n.jsx)(Dn.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Archived tasks"}),width:s,height:"400px"}):(0,n.jsx)(Un,{text:(0,o.__)("Not enough data to display archived tasks chart","quicktasker")})}function Mn({pipelineOverviewData:e,options:t,width:s}){var a;const i=[["Stage","Task Count"],...null!==(a=null==e?void 0:e.stages.map((e=>[e.name,parseInt(e.tasksCount)||0])))&&void 0!==a?a:[]];return Rn(i)?(0,n.jsx)(Dn.t1,{chartType:"PieChart",data:i,options:Object.assign(Object.assign({},t),{title:"Task distribution by stages"}),width:s,height:"400px"}):(0,n.jsx)(Un,{text:(0,o.__)("Not enough data to display task distribution by stages chart","quicktasker")})}function Fn({pipelineOverviewData:e,options:t,width:s}){var a,i;const r=[["Task status","Task Count"],["Done",parseInt(null!==(a=null==e?void 0:e.doneTasksCount)&&void 0!==a?a:"0")||0],["Not Done",parseInt(null!==(i=null==e?void 0:e.notDoneTasksCount)&&void 0!==i?i:"0")||0]];return Rn(r)?(0,n.jsx)(Dn.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Task status"}),width:s,height:"400px"}):(0,n.jsx)(Un,{text:(0,o.__)("Not enough data to display task status chart","quicktasker")})}var zn=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Kn={legend:{position:"left",alignment:"center",textStyle:{color:"#233238",fontSize:14}}};function $n({pipeline:e,overviewFilter:t}){const[s,i]=(0,a.useState)(null),[o,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(()=>{zn(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e,t){const s=new URLSearchParams({taskStartDate:t.taskCreationDate||"",taskDoneDate:t.taskDoneDate||"",taskAssignees:t.taskAssignees.join(",")});return u()({path:`/wpqt/v1/pipelines/${e}/overview?${s.toString()}`,method:"GET",headers:p()})}(e.id,t);i(s.data)}catch(e){console.error(e)}finally{r(!1)}}))})()}),[e.id,t]),o||!s?(0,n.jsx)(gt,{ovalSize:"48"}):(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-wrap wpqt-justify-center xl:wpqt-justify-start",children:[(0,n.jsx)(Mn,{pipelineOverviewData:s,options:Kn,width:"500px"}),(0,n.jsx)(Fn,{pipelineOverviewData:s,options:Kn,width:"500px"}),(0,n.jsx)(Ln,{pipelineOverviewData:s,options:Kn,width:"500px"})]})}function Vn({pipeline:e}){const[t,s]=(0,a.useState)({taskCreationDate:null,taskDoneDate:null,taskAssignees:[]});return(0,n.jsxs)("div",{children:[(0,n.jsx)(Pn,{overviewFilter:t,onCreationDateChange:e=>{s(Object.assign(Object.assign({},t),{taskCreationDate:e}))},onDoneDateChange:e=>{s(Object.assign(Object.assign({},t),{taskDoneDate:e}))}}),(0,n.jsx)($n,{pipeline:e,overviewFilter:t})]})}function Gn(){const{state:{pipelines:e}}=(0,a.useContext)(St),t=e.map((e=>e.name)),s=e.map((e=>(0,n.jsx)(Vn,{pipeline:e},e.id)));return(0,n.jsxs)(_t,{children:[(0,n.jsx)(l,{description:(0,o.__)("Get overview of the tasks.","quicktasker"),children:(0,o.__)("Overview","quicktasker")}),(0,n.jsx)(Ta,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}function Hn(){const{state:{activePipeline:e}}=(0,a.useContext)(Ut),t=()=>(null==e?void 0:e.stages)||[],s=e=>{const s=t();let a=null;return s?(s.forEach((t=>{t.tasks&&!a&&t.tasks.find((t=>t.id===e))&&(a=t)})),a):null},n=(0,a.useMemo)((()=>{const e=t();return e?e.map((e=>({label:e.name,value:e.id}))):[]}),[e]),i=(0,a.useMemo)((()=>{const e=t(),s=[];return e?(e.forEach((e=>{e.tasks&&s.push(...e.tasks)})),s):s}),[e]),o=null==e?void 0:e.settings;return{getActivePipelineStages:t,getActivePipelinStageTasksLength:e=>{const s=t();if(!s)return 0;const a=s.find((t=>t.id===e));return a&&a.tasks?a.tasks.length:0},getTaskStage:s,getTaskOrderInStage:e=>{const t=s(e);if(!t||!t.tasks)return null;const a=t.tasks.findIndex((t=>t.id===e));return-1!==a?a:null},activePipelineTasks:i,activePipelineSettings:o,isTaskOnLastStage:e=>{const a=t();if(!a)return!1;const n=s(e);if(!n)return!1;const i=a[a.length-1];return n.id===i.id},stageOptions:n}}const Bn=()=>{const{state:{users:e,wpUsers:t}}=(0,a.useContext)(Jt);return{getUser:(s,a)=>a===We.QUICKTASKER?e.find((e=>e.id===s)):a===We.WP_USER?t.find((e=>e.id===s)):void 0,combinedUsers:(0,a.useMemo)((()=>[...e,...t]),[e,t])}},Wn=(e,t)=>{switch(t.type){case M:{const{id:s,type:a}=t.payload;return Object.assign(Object.assign({},e),{userFilter:{id:s,type:a}})}case L:return Object.assign(Object.assign({},e),{stageIdFilter:t.payload});default:return e}},Qn={stageIdFilter:"",userFilter:{id:null,type:null}},Yn=(0,a.createContext)({state:Qn,taskViewDispatch:()=>{}}),Xn=({children:e})=>{const[t,s]=(0,a.useReducer)(Wn,Qn);return(0,n.jsx)(Yn.Provider,{value:{state:t,taskViewDispatch:s},children:e})};function Jn({children:e,labelFor:t,className:s}){return(0,n.jsx)("label",{className:`wpqt-mb-1 ${s}`,htmlFor:t,children:e})}function Zn(){const{state:{stageIdFilter:e,userFilter:t},taskViewDispatch:s}=(0,a.useContext)(Yn),{stageOptions:i}=Hn(),{combinedUsers:r}=Bn(),c=r.map((e=>({value:`${e.id}:${e.user_type}`,label:`${e.name} (${at[e.user_type]})`}))),l=t.id&&t.type?`${t.id}:${t.type}`:"";return(0,n.jsxs)(Ot,{title:(0,o.__)("Filter tasks","quicktasker"),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(Jn,{labelFor:"task-view-stage-filter",className:"wpqt-block wpqt-text-center",children:(0,o.__)("Stage","quicktasker")}),(0,n.jsx)(Ct,{id:"task-view-stage-filter",allSelectorLabel:(0,o.__)("All stages","quicktasker"),selectedOptionValue:e,options:i,onSelectionChange:e=>{s({type:L,payload:e})}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(Jn,{labelFor:"task-view-assigned-user-filter",className:"wpqt-block wpqt-text-center",children:(0,o.__)("Assigned user","quicktasker")}),(0,n.jsx)(Ct,{id:"task-view-assigned-user-filter",allSelectorLabel:(0,o.__)("All users","quicktasker"),selectedOptionValue:l,options:c,onSelectionChange:e=>{const[t,a]=e.split(":");s({type:M,payload:{id:t,type:a}})}})]})]})}function ei(){const{state:{moveTaskModalOpen:e,taskToEdit:t},modalDispatch:s}=(0,a.useContext)(Bt),{dispatch:i}=(0,a.useContext)(Ut),{getActivePipelineStages:r,getActivePipelinStageTasksLength:c,getTaskStage:l,getTaskOrderInStage:d}=Hn(),{moveTask:u}=$t(),[p,h]=(0,a.useState)(0),[w,m]=(0,a.useState)(""),[q,v]=(0,a.useState)(!1),x=c(w),f=Array.from({length:x+1},((e,t)=>({value:t.toString(),label:(t+1).toString()}))),g=r().map((e=>({value:e.id,label:e.name}))),k=()=>{s({type:ee})};return(0,a.useEffect)((()=>{if(t){const e=l(t.id),s=d(t.id);e&&null!==s&&(m(e.id),h(s))}}),[t]),(0,n.jsx)(ws,{modalOpen:e,closeModal:k,children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,n.jsx)("h2",{children:(0,o.__)("Change task location on board","quicktasker")}),(0,n.jsx)("label",{htmlFor:"move-task-stage-selection",children:(0,o.__)("Select stage","quicktasker")}),(0,n.jsx)(Ct,{id:"move-task-stage-selection",allSelector:!1,selectedOptionValue:w,options:g,onSelectionChange:e=>{m(e),h(0)}}),(0,n.jsx)("label",{htmlFor:"move-task-order-selection",children:(0,o.__)("Select order","quicktasker")}),(0,n.jsx)(Ct,{id:"move-task-order-selection",allSelector:!1,selectedOptionValue:String(p),options:f,onSelectionChange:e=>h(Number(e))}),(0,n.jsx)(us,{btnText:(0,o.__)("Apply","quicktasker"),loading:q,onClick:()=>{return e=this,s=void 0,n=function*(){if(!t)return;const e=l(t.id),s=d(t.id);e&&null!==s&&(v(!0),yield u(t.id,w,p,(t=>{t&&(i({type:_,payload:{source:{droppableId:e.id,index:s},destination:{droppableId:w,index:p}}}),k())})),v(!1))},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n}})]})})}const ti=(0,a.forwardRef)((({addPipeline:e,modalSaving:t},s)=>{const[i,r]=(0,a.useState)(""),[c,l]=(0,a.useState)(""),d=()=>{r(""),l("")};return(0,a.useImperativeHandle)(s,(()=>({clearContent:d}))),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(qs,{children:[(0,n.jsx)(vs,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(Ns,{isAutoFocus:!0,value:i,onChange:e=>r(e)})}),(0,n.jsx)(vs,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(Ps,{rowsCount:3,value:c,onChange:e=>l(e)})})]}),(0,n.jsx)(xs,{onSave:()=>{e(i,c)},loading:t,saveBtnText:(0,o.__)("Add board","quicktasker")})]})}));function si(){const{state:{newPipelineModalOpen:e}}=(0,a.useContext)(Bt),{fetchAndSetPipelineData:t}=(0,a.useContext)(Ut),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=ts(B);return(0,n.jsx)(ws,{modalOpen:e,closeModal:r,children:(0,n.jsx)(ti,{ref:o,addPipeline:(e,s)=>{return a=this,n=void 0,r=function*(){try{i(!0);const o=yield(a=e,n=s,u()({path:"/wpqt/v1/pipelines",method:"POST",data:{name:a,description:n},headers:p()}));c(S,o.data,es.PIPELINES),t(o.data.id)}catch(e){l(e)}var a,n},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{c(r.next(e))}catch(e){t(e)}}function i(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var a;t.done?e(t.value):(a=t.value,a instanceof o?a:new o((function(e){e(a)}))).then(s,i)}c((r=r.apply(a,n||[])).next())}));var a,n,o,r},modalSaving:s,setModalSaving:i})})}function ai(){return{deletePipeline:(e,t)=>{return s=this,a=void 0,r=function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,method:"DELETE",headers:p()})}(e);t&&t(s.data.deletedPipelineId,s.data.pipelineIdToLoad)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete board","quicktasker"))}},new((n=void 0)||(n=Promise))((function(e,t){function i(e){try{c(r.next(e))}catch(e){t(e)}}function o(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(i,o)}c((r=r.apply(s,a||[])).next())}));var s,a,n,r}}}const ni=(0,a.forwardRef)((({editPipeline:e,modalSaving:t},s)=>{const{state:{pipelineToEdit:r},modalDispatch:c}=(0,a.useContext)(Bt),{fetchAndSetPipelineData:l,dispatch:d}=(0,a.useContext)(Ut),{pipelinesDispatch:u}=(0,a.useContext)(St),{deletePipeline:p}=ai(),[h,w]=(0,a.useState)(""),[m,q]=(0,a.useState)(""),{loading1:v,setLoading1:x}=js();(0,a.useEffect)((()=>{r&&(w(r.name),q(r.description||""))}),[r]);const f=()=>{w(""),q("")};return(0,a.useImperativeHandle)(s,(()=>({clearContent:f}))),r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,n.jsx)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:(0,n.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,n.jsxs)(qs,{children:[(0,n.jsx)(vs,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(Ns,{isAutoFocus:!0,value:h,onChange:e=>w(e)})}),(0,n.jsx)(vs,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(Ps,{rowsCount:3,value:m,onChange:e=>q(e)})})]}),(0,n.jsx)(ha,{entityId:r.id,entityType:Es.Pipeline})]})}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:(0,n.jsx)(ps,{icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:v,text:(0,o.__)("Delete board","quicktasker"),onClick:()=>{r&&(x(!0),p(r.id,((e,t)=>{c({type:B}),x(!1),i.oR.success((0,o.__)("Board deleted","quicktasker")),u({type:P,payload:e}),null!==t?(u({type:E,payload:t}),l(t)):d({type:D})})))}})})]}),(0,n.jsx)(xs,{onSave:()=>{r&&e(Object.assign(Object.assign({},r),{name:h,description:m}))},loading:t,saveBtnText:(0,o.__)("Save","quicktasker")})]}):null}));function ii(){const{state:{pipelineModalOpen:e}}=(0,a.useContext)(Bt),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r,handleError:c}=ts(B);return(0,n.jsx)(ws,{modalOpen:e,closeModal:o,size:"xl",children:(0,n.jsx)(ni,{ref:i,editPipeline:e=>{return t=this,a=void 0,i=function*(){try{s(!0);const t=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description,is_primary:e.is_primary},headers:p()})}(e);r(A,t.data,es.ACTIVE_PIPELINE)}catch(e){c(e)}},new((n=void 0)||(n=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,a||[])).next())}));var t,a,n,i},modalSaving:t,setModalSaving:s})})}var oi=s(9919);const ri=(0,a.forwardRef)((({editStage:e,addStage:t,stageModalSaving:s},i)=>{const{state:{stageToEdit:r}}=(0,a.useContext)(Bt),[c,l]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),p=!!r;(0,a.useEffect)((()=>{r&&(l(r.name),u(r.description))}),[r]);const h=()=>{l(""),u("")};return(0,a.useImperativeHandle)(i,(()=>({clearContent:h}))),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ms,{children:p?(0,o.__)("Edit Stage","quicktasker"):(0,o.__)("Add Stage","quicktasker")}),(0,n.jsxs)(qs,{children:[(0,n.jsx)(vs,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(Ns,{isAutoFocus:!0,value:c,onChange:e=>l(e)})}),(0,n.jsx)(vs,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(Ps,{rowsCount:3,value:d,onChange:e=>u(e)})})]}),(0,n.jsx)(xs,{onSave:()=>{p?e(Object.assign(Object.assign({},r),{name:c,description:d})):t(c,d)},loading:s,saveBtnText:p?(0,o.__)("Save","quicktasker"):(0,o.__)("Add stage","quicktasker")})]})}));var ci=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function li(){const{state:{stageModalOpen:e,targetPipelineId:t}}=(0,a.useContext)(Bt),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=ts($);return(0,n.jsx)(ws,{modalOpen:e,closeModal:r,children:(0,n.jsx)(ri,{ref:o,editStage:e=>ci(this,void 0,void 0,(function*(){try{i(!0);const t=yield function(e){return u()({path:`/wpqt/v1/stages/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description},headers:p()})}(e);c(T,t.data,es.ACTIVE_PIPELINE)}catch(e){l(e)}})),addStage:(e,s)=>ci(this,void 0,void 0,(function*(){try{i(!0);const r=yield(a=t,n=e,o=s,u()({path:"/wpqt/v1/stages",method:"POST",data:{pipelineId:a,name:n,description:o},headers:p()}));c(j,Object.assign(Object.assign({},r.data),{tasks:[]}),es.ACTIVE_PIPELINE)}catch(e){l(e)}var a,n,o})),stageModalSaving:s,stageTaskModalSaving:i})})}function di({pipelineId:e,stagesLength:t=0}){const{modalDispatch:s}=(0,a.useContext)(Bt),i=()=>{return t=this,a=void 0,i=function*(){s({type:K,payload:{targetPipelineId:e}})},new((n=void 0)||(n=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,a||[])).next())}));var t,a,n,i};return 0===t?(0,n.jsx)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-w-full wpqt-items-center wpqt-justify-center",children:(0,n.jsxs)("div",{className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-gap-y-1 wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,n.jsx)($s.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,n.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add first stage","quicktasker")})]})}):(0,n.jsxs)("div",{className:"wpqt-main-border wpqt-mb-3 wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-self-start wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,n.jsx)($s.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,n.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add stage","quicktasker")})]})}function ui(){const{modalDispatch:e}=(0,a.useContext)(Bt);return(0,n.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-items-center wpqt-justify-center",children:(0,n.jsxs)("div",{onClick:()=>{return t=this,s=void 0,n=function*(){e({type:G})},new((a=void 0)||(a=Promise))((function(e,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(t,s||[])).next())}));var t,s,a,n},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)($s.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer"}),(0,n.jsx)("span",{children:(0,o.__)("Add your first Board","quicktasker")})]})})}var pi=s(12),hi=s(5575),wi=s(6304),mi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function qi({stage:e}){var t,s,r,c;const{dispatch:l,state:{activePipeline:d},fetchAndSetPipelineData:h}=(0,a.useContext)(Ut),{modalDispatch:w}=(0,a.useContext)(Bt),{state:{isUserAllowedToDelete:m}}=(0,a.useContext)(Ts),[q,v]=(0,a.useState)(!1),[x,f]=(0,a.useState)(!1),[g,_]=(0,a.useState)(!1),k=null!==(s=null===(t=null==d?void 0:d.stages)||void 0===t?void 0:t.length)&&void 0!==s?s:0,j=null!==(c=null===(r=e.tasks)||void 0===r?void 0:r.length)&&void 0!==c?c:0,b=+e.stage_order,T=b>0&&b<k,S=b!==k-1,A=t=>mi(this,void 0,void 0,(function*(){try{v(!0),yield function(e,t){return u()({path:`/wpqt/v1/stages/${e}/move`,method:"PATCH",data:{direction:t},headers:p()})}(e.id,t),yield h(d.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a stage","quicktasker"))}finally{v(!1)}}));return(0,n.jsxs)(qa,{menuBtn:({active:e})=>(0,n.jsx)(va,{isActive:e,IconComponent:pi.A}),children:[T&&(0,n.jsx)(xa,{text:(0,o.__)("Move left","quicktasker"),loading:q,icon:(0,n.jsx)(hi.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>A("left")}),S&&(0,n.jsx)(xa,{text:(0,o.__)("Move right","quicktasker"),loading:q,icon:(0,n.jsx)(wi.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>A("right")}),(0,n.jsx)(xa,{text:(0,o.__)("Edit stage","quicktasker"),icon:(0,n.jsx)(Qs.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:()=>{w({type:V,payload:{stageToEdit:e}})}}),(0,n.jsx)(xa,{text:(0,o.__)("Archive all stage tasks","quicktasker"),icon:(0,n.jsx)(gs.A,{className:"wpqt-icon-blue wpqt-size-4"}),loading:x,onClick:()=>mi(this,void 0,void 0,(function*(){try{f(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}/archive-tasks`,method:"PATCH",headers:p()})),yield h(d.id),i.oR.success((0,o.sprintf)((0,o.__)("Archived all %s tasks","quicktasker"),e.name))}catch(t){console.error(t),i.oR.error((0,o.sprintf)((0,o.__)("Failed to archive stage %s tasks","quicktasker"),e.name))}finally{f(!1)}var t})),disabled:0===j,id:`item-dropdown-${e.id}-archive`,tooltipText:0===j?(0,o.__)("No tasks to archive on the stage","quicktasker"):void 0}),m&&(0,n.jsx)(xa,{text:(0,o.__)("Delete stage","quicktasker"),icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:g,onClick:()=>mi(this,void 0,void 0,(function*(){try{_(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}`,method:"DELETE",data:{stageId:t},headers:p()})),l({type:y,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a stage","quicktasker"))}finally{_(!1)}var t})),disabled:j>0,className:"!wpqt-mb-0",id:`item-dropdown-${e.id}`,tooltipText:(0,o.__)("Stage can be deleted when there are no tasks on it","quicktasker")})]})}var vi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function xi({stageId:e}){const[t,s]=(0,a.useState)(""),[r,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),h=(0,a.useRef)(null),w=(0,a.useRef)(null),{state:{activePipeline:m},dispatch:q}=(0,a.useContext)(Ut),{handleExecutedAutomations:v}=zt();(0,a.useEffect)((()=>{const e=e=>{"Enter"===e.key&&document.activeElement===w.current&&x()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),(0,a.useEffect)((()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&f()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,a.useEffect)((()=>{var e;r&&(null===(e=w.current)||void 0===e||e.focus())}),[r]);const x=()=>vi(this,void 0,void 0,(function*(){if(t)try{d(!0);const s=yield function(e,t,s){return u()({path:"/wpqt/v1/tasks",method:"POST",data:{stageId:e,name:s,pipelineId:t},headers:p()})}(e,m.id,t);q({type:k,payload:s.data.newTask}),i.oR.success((0,o.__)("Task created","quicktasker")),f(),v(s.data.executedAutomations,s.data.newTask.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create task","quicktasker"))}finally{d(!1)}else i.oR.error((0,o.__)("Task name is required","quicktasker"))})),f=()=>{c(!1),s("")};return(0,n.jsx)("div",{ref:h,className:"wpqt-sticky wpqt-bottom-0 wpqt-z-10 wpqt-order-1 wpqt-mt-2 wpqt-flex wpqt-justify-center wpqt-bg-gray-100 wpqt-py-2",children:r?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,n.jsx)(Ns,{ref:w,value:t,onChange:e=>s(e),wrapperClassName:"!wpqt-mb-0",className:"!wpqt-mb-0"}),l?(0,n.jsx)(xt,{width:"24",height:"24"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ks.A,{className:"wpqt-icon-red wpqt-size-6 wpqt-cursor-pointer",onClick:f}),(0,n.jsx)($s.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer",onClick:x})]})]}):(0,n.jsxs)("div",{onClick:()=>c(!0),className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-p-2 hover:wpqt-bg-white",children:[(0,o.__)("Add task","quicktasker"),(0,n.jsx)($s.A,{className:"wpqt-size-6 wpqt-text-green-600"})]})})}var fi=s(1735),gi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function _i({task:e}){const{modalDispatch:t}=(0,a.useContext)(Bt),{state:{activePipeline:s},fetchAndSetPipelineData:i}=(0,a.useContext)(Ut),{state:{isUserAllowedToDelete:r}}=(0,a.useContext)(Ts),{deleteTask:c,archiveTask:l}=$t(),[d,u]=(0,a.useState)(!1);return(0,n.jsxs)(qa,{menuBtn:({active:e})=>(0,n.jsx)(va,{isActive:e,IconComponent:mn.A}),children:[(0,n.jsx)(xa,{text:(0,o.__)("Archive task","quicktasker"),icon:(0,n.jsx)(gs.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),l(e.id,(()=>{i(s.id)}))}}),(0,n.jsx)(xa,{text:(0,o.__)("Edit task","quicktasker"),icon:(0,n.jsx)(Qs.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:F,payload:{taskToEdit:e}})}}),(0,n.jsx)(xa,{text:(0,o.__)("Move task","quicktasker"),icon:(0,n.jsx)(fi.zhn,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:Z,payload:{task:e}})}}),r&&(0,n.jsx)(xa,{text:(0,o.__)("Delete task","quicktasker"),icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:d,onClick:t=>gi(this,void 0,void 0,(function*(){t.stopPropagation(),u(!0),yield c(e.id,(()=>{i(s.id)})),u(!1)})),className:"!wpqt-mb-0"})]})}var ki=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ji({task:e,allowToMarkTaskAsDone:t}){const{dispatch:s}=(0,a.useContext)(Ut),{changeTaskDoneStatus:i}=$t(),[o,r]=(0,a.useState)(!1),c=e.is_done,l=t=>ki(this,void 0,void 0,(function*(){r(!0),yield i(e.id,t,(t=>{s({type:I,payload:{taskId:e.id,done:t}})})),r(!1)}));return t?o?(0,n.jsx)(gt,{ovalSize:"24"}):(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:c?(0,n.jsx)(ks.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,n.jsx)(ks.A,{className:"wpqt-size-6 wpqt-icon-gray",onClick:e=>{e.stopPropagation(),l(!0)}})}):null}function yi({task:e,index:t,onLastStage:s}){const{modalDispatch:i}=(0,a.useContext)(Bt),{state:{activePipeline:o}}=(0,a.useContext)(Ut),r=!(null==o?void 0:o.settings).allow_only_last_stage_task_done||s,c=()=>{i({type:F,payload:{taskToEdit:e,taskModalSettings:{allowToMarkTaskAsDone:r}}})};return(0,n.jsx)(oi.sx,{draggableId:e.id,index:t,children:t=>(0,n.jsxs)("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:"wpqt-relative wpqt-mx-4 wpqt-mb-2 wpqt-flex !wpqt-cursor-pointer wpqt-flex-col wpqt-gap-1 wpqt-rounded wpqt-border wpqt-border-gray-200 wpqt-bg-white wpqt-p-3 wpqt-shadow hover:wpqt-shadow-md",onClick:c,children:[(0,n.jsx)("div",{className:"wpqt-absolute wpqt-right-[12px] wpqt-top-[12px]",children:(0,n.jsx)(_i,{task:e})}),(0,n.jsx)("div",{className:"wpqt-text-base",children:e.name}),e.description&&(0,n.jsx)("div",{className:"wpqt-text-sm wpqt-italic",children:e.description}),(0,n.jsx)("div",{className:"wpqt-mt-2",children:(0,n.jsx)(ya,{task:e})}),(0,n.jsx)(ji,{task:e,allowToMarkTaskAsDone:r})]}))},e.id)}function bi({tasks:e}){const t=e.length;return(0,n.jsx)("span",{className:"wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-1 wpqt-text-xs",children:t})}function Ti({stage:e,isLastStage:t}){return(0,n.jsxs)("div",{"data-stage-id":e.id,className:"wpqt-relative wpqt-mb-3 wpqt-flex wpqt-max-h-full wpqt-w-[360px] wpqt-flex-none wpqt-flex-col wpqt-overflow-hidden wpqt-rounded-md wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-gray-100",children:[(0,n.jsxs)("div",{className:"wpqt-mb-4 wpqt-flex wpqt-flex-wrap wpqt-items-center wpqt-gap-1 wpqt-px-4 wpqt-pt-3",children:[(0,n.jsxs)("div",{className:"wpqt-mr-auto wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-text-base wpqt-leading-none",children:[e.name," ",(0,n.jsx)(bi,{tasks:e.tasks})]}),(0,n.jsx)(qi,{stage:e}),e.description&&(0,n.jsx)("div",{className:"wpqt-w-full wpqt-flex-shrink-0 wpqt-flex-grow-0 wpqt-text-sm",children:e.description})]}),(0,n.jsx)(oi.gL,{droppableId:e.id,children:s=>{var a;return(0,n.jsxs)("div",{ref:s.innerRef,className:"wpqt-flex wpqt-h-full wpqt-flex-col wpqt-overflow-y-auto wpqt-overflow-x-hidden",children:[null===(a=e.tasks)||void 0===a?void 0:a.map(((e,s)=>(0,n.jsx)(yi,{task:e,index:s,onLastStage:t},e.id))),s.placeholder,(0,n.jsx)(xi,{stageId:e.id})]})}})]})}const Si=()=>{var e,t;const{state:{activePipeline:s},dispatch:r,fetchAndSetPipelineData:c}=(0,a.useContext)(Ut);(0,a.useEffect)((()=>{const e=setInterval((()=>{s&&c(s.id)}),3e4);return()=>clearInterval(e)}),[s]);const l=(e,t)=>{e.droppableId===t.droppableId?r({type:"REORDER_TASK",payload:{source:e,destination:t}}):r({type:_,payload:{source:e,destination:t}})},d=(0,a.useCallback)((e=>{return t=void 0,s=void 0,n=function*(){const{source:t,destination:s,draggableId:a}=e;if(s){l(t,s);try{yield h(a,s.droppableId,s.index)}catch(e){console.error(e),l(s,t),i.oR.error((0,o.__)("Failed to move a task","quicktasker"))}}},new((a=void 0)||(a=Promise))((function(e,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(t,s||[])).next())}));var t,s,a,n}),[s]);return s?(0,n.jsxs)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-gap-[24px] wpqt-overflow-x-auto wpqt-overflow-y-hidden",children:[(0,n.jsx)(oi.JY,{onDragEnd:d,children:null===(e=s.stages)||void 0===e?void 0:e.map(((e,t)=>{const a=t===s.stages.length-1;return(0,n.jsx)(Ti,{stage:e,isLastStage:a},e.id)}))}),(0,n.jsx)(di,{pipelineId:s.id,stagesLength:null===(t=s.stages)||void 0===t?void 0:t.length}),(0,n.jsx)(rn,{deleteTaskCallback:()=>{s&&c(s.id)}}),(0,n.jsx)(li,{})]}):(0,n.jsx)(ui,{})};var Ai=s(8932),Ei=s(247),Ci=s(1203),Ni=s(2496),Oi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Ii(){const{state:{activePipeline:e},fetchAndSetPipelineData:t}=(0,a.useContext)(Ut),{state:{pipelines:s},pipelinesDispatch:r}=(0,a.useContext)(St),{modalDispatch:c}=(0,a.useContext)(Bt),l=e=>Oi(this,void 0,void 0,(function*(){try{yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/set-primary`,method:"PATCH",headers:p()})),r({type:E,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to set primary board","quicktasker"))}var t}));return(0,n.jsxs)(qa,{menuBtnClasses:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1 wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-3",menuBtn:({active:t})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-leading-none",children:null==e?void 0:e.name}),(0,n.jsx)(Ci.A,{className:"wpqt-size-4 "+(t?"wpqt-text-qtBlueHover":"")})]}),children:[(0,n.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center wpqt-font-bold",children:(0,o.__)("Change board","quicktasker")}),s.map((s=>{const a=s.is_primary,i=(null==e?void 0:e.id)===s.id;return(0,n.jsx)(ma.Dr,{children:(0,n.jsxs)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-gap-2",children:[(0,n.jsx)("div",{className:(0,Is.$)("wpqt-cursor-pointer wpqt-text-center",{"wpqt-font-bold":i}),onClick:()=>t(s.id),children:s.name}),(0,n.jsx)("div",{className:"wpqt-ml-auto",children:a?(0,n.jsx)(Ni.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-blue-500"}):(0,n.jsx)(Ei.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-gray-400",onClick:e=>{e.stopPropagation(),l(s)}})})]})},s.id)})),(0,n.jsx)(ma.Dr,{children:(0,n.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:(0,n.jsx)(ps,{text:(0,o.__)("Add new board","quicktasker"),onClick:()=>Oi(this,void 0,void 0,(function*(){c({type:G})})),icon:(0,n.jsx)($s.A,{className:"wpqt-size-6 wpqt-icon-green"}),className:"wpqt-bg-white hover:!wpqt-bg-gray-100"})})},"new-pipeline")]})}function Pi(){const{state:{activePipeline:e,loading:t},fetchAndSetPipelineData:s}=(0,a.useContext)(Ut),{modalDispatch:i}=(0,a.useContext)(Bt);return e?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-py-5",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,n.jsx)("div",{className:"wpqt-text-lg",children:e.name}),(0,n.jsx)(pi.A,{className:"wpqt-text-gray-400 wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{e&&i({type:H,payload:{pipelineToEdit:e}})}})]}),e.description&&(0,n.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,n.jsxs)("div",{className:"wpqt-ml-auto wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,n.jsx)(Di,{}),t?(0,n.jsx)(xt,{width:"24",height:"24"}):(0,n.jsx)(Ma.A,{className:"wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>s(e.id)}),(0,n.jsx)(Ii,{})]})]}):null}function Di(){const{state:{view:e},dispatch:t}=(0,a.useContext)(Ut);return(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-1 wpqt-items-center wpqt-cursor-pointer wpqt-text-blue-400 wpqt-text-base :hover:wpqt-text-blue-600",onClick:()=>{t({type:U,payload:e===Dt.PIPELINE?Dt.TASK:Dt.PIPELINE})},children:e===Dt.PIPELINE?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ai.A,{className:"wpqt-size-5 wpqt-text-blue-400"}),(0,o.__)("Switch to Task view","quicktasker")]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(dn.A,{className:"wpqt-size-5 wpqt-text-blue-400"}),(0,o.__)("Switch to Board view","quicktasker")]})})}function Ri(){const{modalDispatch:e}=(0,a.useContext)(Bt),{activePipelineTasks:t,activePipelineSettings:s,isTaskOnLastStage:i}=Hn(),{taskViewFilter:r}=(()=>{const{state:{stageIdFilter:e,userFilter:t}}=(0,a.useContext)(Yn);return{taskViewFilter:s=>{var a,n;const i=!e||s.stage_id===e,o=!t.id||!t.type||t.type===We.QUICKTASKER&&(null===(a=s.assigned_users)||void 0===a?void 0:a.some((e=>e.id===t.id)))||t.type===We.WP_USER&&(null===(n=s.assigned_wp_users)||void 0===n?void 0:n.some((e=>e.id===t.id)));return i&&o}}})(),c=t.filter(r);return 0===c.length?(0,n.jsx)(cn,{text:(0,o.__)("No tasks","quictasker")}):(0,n.jsxs)("div",{className:"wpqt-card-grid",children:[c.map((t=>{const a=i(t.id),o=!s.allow_only_last_stage_task_done||a;return(0,n.jsxs)(un,{className:"wpqt-cursor-pointer",title:t.name,description:t.description,dropdown:(0,n.jsx)(_i,{task:t}),onClick:()=>{e({type:F,payload:{taskToEdit:t,taskModalSettings:{allowToMarkTaskAsDone:o}}})},children:[(0,n.jsx)("div",{className:"wpqt-mt-2",children:(0,n.jsx)(ya,{task:t})}),(0,n.jsx)(ji,{task:t,allowToMarkTaskAsDone:o})]},t.id)})),(0,n.jsx)(rn,{})]})}const Ui=()=>(0,n.jsx)(Lt,{children:(0,n.jsx)(Li,{})}),Li=()=>{const{state:{view:e}}=(0,a.useContext)(Ut),t=e===Dt.PIPELINE;return(0,n.jsxs)(_t,{children:[(0,n.jsx)(Pi,{}),t?(0,n.jsx)(Si,{}):(0,n.jsxs)(Xn,{children:[(0,n.jsx)(Zn,{}),(0,n.jsx)(Ri,{})]}),(0,n.jsx)(si,{}),(0,n.jsx)(ii,{}),(0,n.jsx)(ei,{})]})};var Mi=s(6197),Fi=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function zi(){return{saveCustomUserPageStyles:(e,t)=>Fi(this,void 0,void 0,(function*(){try{const a=yield(s=e,u()({path:"/wpqt/v1/settings/user-page-custom-styles",method:"PATCH",data:{styles:s},headers:p()}));t&&t(a.data),i.oR.success((0,o.__)("Custom user page styles saved successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to save custom user page styles","quicktasker"))}var s})),saveTaskCompletionDoneSetting:(e,t,s)=>Fi(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/pipelines/${e}/settings/task-completion-done-restriction`,method:"PATCH",data:{allow_task_completion_only_on_last_stage:t},headers:p()})}(e,t),s&&s(t)}catch(e){s&&s(!t),console.error(e),i.oR.error((0,o.__)("Failed to save setting","quicktasker"))}}))}}const Ki=({children:e,title:t,description:s})=>(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-mb-5",children:[(0,n.jsx)("h3",{className:"wpqt-mb-1",children:t}),(0,n.jsx)("p",{children:s}),e]});const $i=()=>{const{state:{userPageCustomStyles:e},appDispatch:t}=(0,a.useContext)(Ts),[s,i]=(0,a.useState)(""),[r,c]=(0,a.useState)(!1),{saveCustomUserPageStyles:l}=zi();return(0,a.useEffect)((()=>{i(e)}),[e]),(0,n.jsxs)(Ki,{title:(0,o.__)("Custom style","quicktasker"),description:(0,o.__)("Add custom CSS rules for QuickTasker user page.","quicktasker"),children:[(0,n.jsx)(Ps,{value:s,onChange:i}),(0,n.jsx)(ps,{text:(0,o.__)("Save","quicktasker"),loading:r,onClick:()=>{return e=void 0,a=void 0,i=function*(){c(!0),yield l(s,(e=>{t({type:fe,payload:e})})),c(!1)},new((n=void 0)||(n=Promise))((function(t,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(e,a||[])).next())}));var e,a,n,i},icon:(0,n.jsx)(Mi.RZ0,{className:"wpqt-icon-blue wpqt-size-4"})})]})},Vi=(e,t)=>{var s,a;switch(t.type){case Le:{const s=t.payload.automations;return Object.assign(Object.assign({},e),{automations:s})}case Me:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case Fe:{const n=t.payload,i=null!==(a=null===(s=e.automations)||void 0===s?void 0:s.filter((e=>e.id!==n)))&&void 0!==a?a:null;return Object.assign(Object.assign({},e),{automations:i})}case ze:{const s=t.payload,a=e.automations?[...e.automations,s]:[s];return Object.assign(Object.assign({},e),{automations:a})}default:return e}};const Gi={automations:null,loading:!0},Hi=(0,a.createContext)({state:Gi,pipelineAutomationsDispatch:()=>{}}),Bi=({children:e,pipelineId:t})=>{const[s,o]=(0,a.useReducer)(Vi,Gi),r=()=>{return e=void 0,s=void 0,n=function*(){try{o({type:Me,payload:!0});const e=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"GET",headers:p()})}(t);o({type:Le,payload:{automations:e.data.automations}})}catch(e){console.error(e),i.oR.error("Failed to load board automations")}finally{o({type:Me,payload:!1})}},new((a=void 0)||(a=Promise))((function(t,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((n=n.apply(e,s||[])).next())}));var e,s,a,n};return(0,a.useEffect)((()=>{r()}),[]),(0,n.jsx)(Hi.Provider,{value:{state:s,pipelineAutomationsDispatch:o},children:e})};var Wi=s(1226),Qi=s(6973);const Yi={automationTarget:null,automationTrigger:null,automationAction:null,automationActionTargetId:null,automationActionTargetType:null,metaData:null};function Xi(e,t){switch(t.type){case"SET_TARGET":return Object.assign(Object.assign({},e),{automationTarget:t.payload,automationTrigger:null,automationAction:null});case"SET_TRIGGER":return Object.assign(Object.assign({},e),{automationTrigger:t.payload,automationAction:null});case"SET_ACTION":return Object.assign(Object.assign({},e),{automationAction:t.payload});case"RESET":return Yi;case $e:return Object.assign(Object.assign({},e),{automationActionTargetId:t.payload.automationActionTargetId,automationActionTargetType:t.payload.automationActionTargetType});case Ke:return Object.assign(Object.assign({},e),{metaData:t.payload});case Ve:return Yi;case Ge:return Object.assign(Object.assign({},Yi),{automationTarget:e.automationTarget});case He:return Object.assign(Object.assign({},Yi),{automationTarget:e.automationTarget,automationTrigger:e.automationTrigger});default:return e}}const Ji={[Je.ARCHIVE_TASK]:(0,o.__)("Archive task","quicktasker"),[Je.ASSIGN_USER]:(0,o.__)("Assign user","quickkasker"),[Je.NEW_ENTITY_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[Je.DELETED_ENTITY_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[Je.TASK_ASSIGNED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[Je.TASK_UNASSIGNED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[Je.TASK_PUBLIC_COMMENT_ADDED_EMAIL]:(0,o.__)("Send email notification","quicktasker"),[Je.TASK_PRIVATE_COMMENT_ADDED_EMAIL]:(0,o.__)("Send email notification","quicktasker")},Zi={[Ye.Task]:(0,o.__)("Task","quicktasker"),[Ye.Stage]:(0,o.__)("Stage","quicktasker"),[Ye.PIPELINE]:(0,o.__)("Board","quicktasker"),[Ye.quicktasker]:"Quicktasker"},eo={[Qe.TASK_DONE]:(0,o.__)("Task marked as done","quicktasker"),[Qe.Task_NOT_DONE]:(0,o.__)("Task marked as not done","quicktasker"),[Qe.TASK_CREATED]:(0,o.__)("Task created","quicktasker"),[Qe.TASK_DELETED]:(0,o.__)("Task deleted","quicktasker"),[Qe.TASK_ASSIGNED]:(0,o.__)("Task assigned","quicktasker"),[Qe.TASK_UNASSIGNED]:(0,o.__)("Task unassigned","quicktasker"),[Qe.TASK_PUBLIC_COMMENT_ADDED]:(0,o.__)("Public comment added","quicktasker"),[Qe.TASK_PRIVATE_COMMENT_ADDED]:(0,o.__)("Private comment added","quicktasker")},to={[Qe.TASK_DONE]:[{id:Je.ARCHIVE_TASK}],[Qe.Task_NOT_DONE]:[{id:Je.ARCHIVE_TASK}],[Qe.TASK_CREATED]:[{id:Je.ASSIGN_USER,requireAutomationTarget:!0,requireAutomationTargetType:!0},{id:Je.NEW_ENTITY_EMAIL,requireMetaData:!0}],[Qe.TASK_DELETED]:[{id:Je.DELETED_ENTITY_EMAIL,requireMetaData:!0}],[Qe.TASK_ASSIGNED]:[{id:Je.TASK_ASSIGNED_EMAIL,requireMetaData:!0}],[Qe.TASK_UNASSIGNED]:[{id:Je.TASK_UNASSIGNED_EMAIL,requireMetaData:!0}],[Qe.TASK_PUBLIC_COMMENT_ADDED]:[{id:Je.TASK_PUBLIC_COMMENT_ADDED_EMAIL,requireMetaData:!0}],[Qe.TASK_PRIVATE_COMMENT_ADDED]:[{id:Je.TASK_PRIVATE_COMMENT_ADDED_EMAIL,requireMetaData:!0}]},so={[Ye.Task]:to};function ao({actionTargetId:e,actionTargetType:t}){if(null===e||null===t)return null;const{getUser:s}=Bn();if(t===Xe.QUICKTASKER||t===Xe.WP_USER||null!==e){const a=st(t);if(a){const t=s(e,a);return(0,n.jsx)("div",{className:"wpqt-text-center",children:(null==t?void 0:t.name)||(0,o.__)("User not found","quicktasker")})}}return null}var no=s(7613);function io({value:e,label:t,onClick:s=()=>{},className:a=""}){return(0,n.jsx)("div",{className:`wpqt-inline-flex wpqt-font-semibold wpqt-rounded-xl wpqt-px-4 wpqt-py-2 wpqt-border wpqt-border-solid wpqt-cursor-pointer wpqt-border-qtBorder ${a}`,onClick:()=>{s(e)},children:t})}function oo({children:e,title:t}){return(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-font-semibold wpqt-text-base wpqt-mb-4 wpqt-text-center",children:t}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-gap-3",children:e})]})}function ro({automationDispatch:e,automation:t}){if(!t.automationTarget||!t.automationTrigger)return null;const s=t.automationTarget,a=t.automationTrigger,i=so[s][a];return(0,n.jsx)(oo,{title:(0,o.__)("Step 3. Select action","quicktasker"),children:i.map((t=>(0,n.jsx)(io,{value:t.id,label:Ji[t.id],onClick:()=>{e({type:"SET_ACTION",payload:t})}},t.id)))})}function co({quickTaskerUsers:e,wpUsers:t,assignUser:s}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,n.jsx)(_a,{sectionTitle:(0,o.__)("Assign a quicktasker","quicktasker"),users:e,onItemSelect:s,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No quicktaskers available to assign","quicktasker")}),(0,n.jsx)(_a,{sectionTitle:(0,o.__)("Assign a WordPress user","quicktasker"),users:t,onItemSelect:s,actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No WordPress users with required permissions available to assign","quicktasker")})]})}function lo({automationAction:e,onUserAdd:t=()=>{},quickTaskerUserTargets:s=[],wpUserTargets:a=[],menuBtnClasses:i=""}){const o=[...s,...a].length>0;return(0,n.jsx)(qa,{menuBtnClasses:`wpqt-inline-flex ${i}`,anchor:"bottom start",menuBtn:()=>(0,n.jsx)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:(0,n.jsx)(wa.A,{className:`wpqt-mr-1 wpqt-size-5 ${o?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`})}),children:e===Je.ASSIGN_USER&&(0,n.jsx)(co,{quickTaskerUsers:s,wpUsers:a,assignUser:t})})}const uo=[Je.ASSIGN_USER];function po({automationDispatch:e,automation:t}){var s;const{state:{users:i,wpUsers:r}}=(0,a.useContext)(Jt),c=null===(s=t.automationAction)||void 0===s?void 0:s.id,l=void 0!==c&&uo.includes(c);return(0,n.jsx)(oo,{title:(0,o.__)("Step 4. Select action target","quicktasker"),children:l&&(0,n.jsx)(lo,{automationAction:c,quickTaskerUserTargets:i,wpUserTargets:r,onUserAdd:t=>{console.log("Assigning automation user"),e({type:$e,payload:{automationActionTargetId:t.id,automationActionTargetType:t.user_type}})}})})}const ho=s(4476).z.string().email({message:"Invalid email address"});function wo({setAutomationMeta:e}){const[t,s]=(0,a.useState)(""),[i,r]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(e=>{try{ho.parse(e),r(!0)}catch(e){r(!1)}})(t)}),[t]),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2 wpqt-justify-center wpqt-items-center",children:[(0,n.jsx)(za,{type:"info",children:(0,o.__)("Make sure your website is configured to send out emails","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)("label",{htmlFor:"automation-meta-email-input",children:(0,o.__)("Email will be sent to","quicktasker")}),(0,n.jsx)(Ns,{inputId:"automation-meta-email-input",value:t,onChange:s,wrapperClassName:"!wpqt-mb-0"}),!i&&(0,n.jsx)("div",{className:"wpqt-text-red-500",children:(0,o.__)("Invalid email address","quicktasker")})]}),(0,n.jsx)(us,{btnText:(0,o.__)("Set email","quicktasker"),onClick:()=>{i&&e(t)}})]})}function mo({automationCreationState:e,automationDispatch:t}){var s;const a=null===(s=null==e?void 0:e.automationAction)||void 0===s?void 0:s.id;return a===Je.NEW_ENTITY_EMAIL||a===Je.DELETED_ENTITY_EMAIL||a===Je.TASK_ASSIGNED_EMAIL||a===Je.TASK_UNASSIGNED_EMAIL||a===Je.TASK_PUBLIC_COMMENT_ADDED_EMAIL||a===Je.TASK_PRIVATE_COMMENT_ADDED_EMAIL?(0,n.jsx)(wo,{setAutomationMeta:e=>{t({type:Ke,payload:e})}}):null}function qo({automationDispatch:e}){const t=Object.keys(so).map((e=>({value:e,label:Zi[e]||e})));return(0,n.jsx)(oo,{title:(0,o.__)("Step 1. Select a target","quicktasker"),children:t.map((({value:t,label:s})=>(0,n.jsx)(io,{value:t,label:s,onClick:()=>{e({type:"SET_TARGET",payload:t})}},t)))})}function vo({automationDispatch:e,automation:t}){if(!t.automationTarget)return null;const s=t.automationTarget,a=Object.keys(so[s]).map((e=>({value:e,label:eo[e]||e})));return(0,n.jsx)(oo,{title:(0,o.__)("Step 2. Select a trigger","quicktasker"),children:a.map((({value:t,label:s})=>(0,n.jsx)(io,{value:t,label:s,onClick:()=>{e({type:"SET_TRIGGER",payload:t})}},t)))})}var xo=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function fo({automation:e,automationDispatch:t,createAutomation:s}){const[i,r]=(0,a.useState)(!1);return null===e.automationTarget?(0,n.jsx)(qo,{automationDispatch:t}):null===e.automationTrigger?(0,n.jsx)(vo,{automationDispatch:t,automation:e}):null===e.automationAction?(0,n.jsx)(ro,{automationDispatch:t,automation:e}):e.automationAction&&e.automationAction.requireAutomationTarget&&e.automationAction.requireAutomationTargetType&&(null===e.automationActionTargetType||null===e.automationActionTargetId)?(0,n.jsx)(po,{automationDispatch:t,automation:e}):e.automationAction.requireMetaData&&!e.metaData?(0,n.jsx)(mo,{automationCreationState:e,automationDispatch:t}):(0,n.jsx)(ps,{text:(0,o.__)("Create automation","quicktasker"),icon:(0,n.jsx)(no.ltU,{className:"wpqt-size-6"}),onClick:()=>xo(this,void 0,void 0,(function*(){r(!0),yield s(),r(!1)})),loading:i})}var go=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function _o({pipelineId:e}){const{pipelineAutomationsDispatch:t}=(0,a.useContext)(Hi),[s,i]=(0,a.useState)(!1),[r,c]=(0,a.useReducer)(Xi,Yi),{createAutomation:l}=zt(),d=null!==r.automationActionTargetId&&null!==r.automationActionTargetType,u=null!==r.metaData,p="wpqt-px-3 wpqt-min-w-[60px] wpqt-cursor-pointer",h="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1",w=()=>{c({type:"RESET"})};return s?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:[(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-3 wpqt-p-4 wpqt-justify-center",children:[(0,n.jsx)(un,{title:(0,o.__)("Target","quicktasker"),className:p,titleClassName:h,onClick:()=>{c({type:Ve})},children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTarget?Zi[r.automationTarget]:(0,n.jsx)(ko,{})})}),(0,n.jsx)(un,{title:(0,o.__)("Trigger","quicktasker"),className:p,titleClassName:h,onClick:()=>{c({type:Ge})},children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTrigger?eo[r.automationTrigger]:(0,n.jsx)(ko,{})})}),(0,n.jsx)(un,{title:(0,o.__)("Action","quicktasker"),className:p,titleClassName:h,onClick:()=>{c({type:He})},children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center wpqt-items-center",children:[r.automationAction?Ji[r.automationAction.id]:(0,n.jsx)(ko,{}),d&&(0,n.jsx)(ao,{actionTargetId:r.automationActionTargetId,actionTargetType:r.automationActionTargetType}),u&&(0,n.jsx)("div",{children:r.metaData})]})})]}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(fo,{automation:r,automationDispatch:c,createAutomation:()=>go(this,void 0,void 0,(function*(){yield l(e,r,((e,s)=>{e&&s&&(w(),t({type:ze,payload:s}))}))}))})}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(ps,{icon:(0,n.jsx)(Qi.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Close automation creator","quicktasker"),onClick:()=>{i(!1),w()}})})]}):(0,n.jsx)("div",{children:(0,n.jsx)(ps,{icon:(0,n.jsx)(Qi.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Create a new automation","quicktasker"),onClick:()=>i(!0)})})}function ko(){return(0,n.jsx)(Wi.A,{className:"wpqt-size-7 wpqt-text-gray-300"})}var jo=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function yo({automation:e}){const{pipelineAutomationsDispatch:t}=(0,a.useContext)(Hi),{deleteAutomation:s}=zt(),[i,r]=(0,a.useState)(!1),c="wpqt-px-3 wpqt-pt-1 wpqt-min-w-[60px] wpqt-cursor-default",l="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1",d=null!==e.automation_action_target_id&&null!==e.automation_action_target_type,u=null!==e.metadata;return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-3 wpqt-p-4",children:[(0,n.jsx)(un,{title:(0,o.__)("Target","quicktasker"),className:c,titleClassName:l,children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:Zi[e.target_type]})}),(0,n.jsx)(un,{title:(0,o.__)("Trigger","quicktasker"),className:c,titleClassName:l,children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:eo[e.automation_trigger]})}),(0,n.jsx)(un,{title:(0,o.__)("Action","quicktasker"),className:c,titleClassName:l,children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-justify-center wpqt-items-center",children:[Ji[e.automation_action],d&&(0,n.jsx)(ao,{actionTargetId:e.automation_action_target_id,actionTargetType:e.automation_action_target_type}),u&&(0,n.jsx)("div",{children:e.metadata})]})}),(0,n.jsx)(un,{title:(0,o.__)("Controls","quicktasker"),className:`${c}`,titleClassName:l,children:(0,n.jsx)("div",{className:"wpqt-flex wpqt-gap-2",children:(0,n.jsx)(ps,{loading:i,text:(0,o.__)("Delete","quicktasker"),icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-5"}),onClick:()=>jo(this,void 0,void 0,(function*(){r(!0),yield s(e.pipeline_id,e.id,(s=>{s&&t({type:Fe,payload:e.id})})),r(!1)}))})})})]})}function bo(){const{state:{automations:e,loading:t}}=(0,a.useContext)(Hi),[s,i]=(0,a.useState)(!1);return t?(0,n.jsx)(gt,{ovalSize:"24"}):e&&0!==e.length?s?(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,n.jsx)(za,{type:"info",className:"wpqt-mx-auto wpqt-mb-2",children:(0,o.__)("Note that automation won't trigger other automations","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3 wpqt-mb-3",children:e.map((e=>(0,n.jsx)(yo,{automation:e},e.id)))}),(0,n.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,n.jsx)(ps,{icon:(0,n.jsx)(Qi.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Hide board automations","quicktasker"),onClick:()=>i(!1)})})]}):(0,n.jsx)("div",{children:(0,n.jsx)(ps,{icon:(0,n.jsx)(Qi.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Show board automations","quicktasker"),onClick:()=>i(!0)})}):(0,n.jsx)(za,{type:"info",children:(0,o.__)("No automations created for this board","quicktasker")})}function To({children:e}){return(0,n.jsx)(Ki,{title:(0,o.__)("Board automations","quicktasker"),description:(0,o.__)("Allows to automate various tasks","quicktasker"),children:e})}function So({pipelineId:e}){return Be?(0,n.jsx)(Bi,{pipelineId:e,children:(0,n.jsxs)(To,{children:[(0,n.jsx)("div",{className:"wpqt-mb-4",children:(0,n.jsx)(bo,{})}),(0,n.jsx)("div",{children:(0,n.jsx)(_o,{pipelineId:e})})]})}):(0,n.jsx)(zs,{title:(0,o.__)("Board automations","quicktasker"),description:(0,o.__)("Premium feature to automate various tasks.","quicktasker")})}var Ao=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Eo({allow_only_last_stage_task_done:e,pipelineId:t}){const[s,i]=(0,a.useState)(e),[r,c]=(0,a.useState)(!1),{saveTaskCompletionDoneSetting:l}=zi();return(0,n.jsx)(Ki,{title:(0,o.__)("Restrict Task Completion","quicktasker"),description:(0,o.__)("Allow to mark task as done only on board last stage. By default, task can be marked as done on any stage. Will apply also to QuickTasker page","quicktasker"),children:(0,n.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,n.jsx)(Rs,{checked:s,handleChange:e=>Ao(this,void 0,void 0,(function*(){i(e),c(!0),yield l(t,e,(e=>{i(e)})),c(!1)}))}),r&&(0,n.jsx)(xt,{width:"20",height:"20"})]})})}var Co=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function No({pipeline:e}){const[t,s]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null);return(0,a.useEffect)((()=>{(()=>{Co(this,void 0,void 0,(function*(){try{s(!0);const a=yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/settings`,method:"GET",headers:p()}));o(jt(a.data.settings))}catch(e){console.error(e)}finally{s(!1)}var t}))})()}),[]),t?(0,n.jsx)(gt,{}):i?(0,n.jsxs)("div",{children:[(0,n.jsx)(Eo,{pipelineId:e.id,allow_only_last_stage_task_done:i.allow_only_last_stage_task_done}),(0,n.jsx)(So,{pipelineId:e.id})]}):null}function Oo(){const{state:{pipelines:e}}=(0,a.useContext)(St),t=e.map((e=>e.name)),s=e.map((e=>(0,n.jsx)(No,{pipeline:e},e.id)));return(0,n.jsx)("div",{children:(0,n.jsx)(Ta,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})})}const Io=()=>(0,n.jsxs)(_t,{children:[(0,n.jsx)(l,{description:(0,o.__)("Manage settings, preferences, and configurations.","quicktasker"),children:(0,o.__)("Settings","quicktasker")}),(0,n.jsx)($i,{}),(0,n.jsx)(Oo,{})]});var Po=s(1548),Do=s(1266),Ro=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Uo(){return{createUser:(e,t,s)=>Ro(this,void 0,void 0,(function*(){try{const r=yield(a=e,n=t,u()({path:"/wpqt/v1/users",method:"POST",data:{name:a,description:n},headers:p()}));s&&s(r.data),i.oR.success((0,o.__)("User created successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User creation failed. Please try again","quicktasker"))}var a,n})),editUser:(e,t)=>Ro(this,void 0,void 0,(function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/users/${e.id}`,method:"PATCH",data:{user:e},headers:p()})}(e);t&&t(s.data),i.oR.success((0,o.__)("User edited successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User edit failed. Please try again","quicktasker"))}})),changeUserStatus:(e,t,s)=>Ro(this,void 0,void 0,(function*(){try{const a=yield function(e,t){return u()({path:`/wpqt/v1/users/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e,t);s&&s(a.data),i.oR.success((0,o.__)("User status changed successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change user status. Please try again","quicktasker"))}})),deleteUser:(e,t)=>Ro(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}`,method:"DELETE",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User deleted successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete user. Please try again","quicktasker"))}})),resetUserPassword:(e,t)=>Ro(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}/password-reset`,method:"PATCH",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User password reset successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to reset user password. Please try again","quicktasker"))}}))}}var Lo=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Mo({data:e,changeStatus:t,changeSetUpStatus:s,changePasswordStatus:i}){const{changeUserStatus:r,deleteUser:c,resetUserPassword:l}=Uo(),{userDispatch:d}=(0,a.useContext)(Jt),{loading1:u,setLoading1:p,loading2:h,setLoading2:w,loading3:m,setLoading3:q}=js(),v=e.is_active,x=e.has_password;return(0,n.jsxs)("div",{className:"wpqt-mt-5 wpqt-flex wpqt-gap-2",children:[(0,n.jsx)(ps,{icon:(0,n.jsx)(Ai.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${e.id}/tasks`}}),!v&&(0,n.jsx)(ps,{icon:(0,n.jsx)(Po.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:h,onClick:()=>Lo(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!0,(e=>{d({type:we,payload:Object.assign({},e)}),t(!0)})),w(!1)}))}),v&&(0,n.jsx)(ps,{icon:(0,n.jsx)(Po.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:h,onClick:()=>Lo(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!1,(e=>{d({type:we,payload:Object.assign({},e)}),t(!1)})),w(!1)}))}),x&&(0,n.jsx)(ps,{icon:(0,n.jsx)(Do.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:u,text:(0,o.__)("Reset password","quicktasker"),onClick:()=>Lo(this,void 0,void 0,(function*(){p(!0),yield l(e.id,(()=>{s(!1),i(!1)})),p(!1)}))}),(0,n.jsx)(ps,{icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:m,text:(0,o.__)("Delete user","quicktasker"),onClick:()=>Lo(this,void 0,void 0,(function*(){q(!0),yield c(e.id,(e=>{d({type:me,payload:e}),window.location.hash="#/users"})),q(!1)}))})]})}var Fo=s(8624),zo=s(3997),Ko=s(5028);function $o(){const{state:{siteURL:e,publicUserPageId:t}}=(0,a.useContext)(Ts);return{userPage:e+`/wpqt?page=${t}&page_id=wpqt`}}function Vo({data:e}){const{userPage:t}=$o(),{convertToWPTimezone:s}=Da(),a=e.is_active,i=t+"&code="+e.page_hash;return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,n.jsx)(Go,{label:(0,o.__)("Name","quicktasker"),value:e.name,icon:(0,n.jsx)(Fo.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(Go,{label:(0,o.__)("Created at","quicktasker"),value:s(e.created_at),icon:(0,n.jsx)(zo.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(Go,{label:(0,o.__)("Assigned tasks count","quicktasker"),value:e.assigned_tasks_count,icon:(0,n.jsx)(Ai.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,n.jsx)(Go,{label:(0,o.__)("Setup completed","quicktasker"),value:e.setup_completed?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,n.jsx)(Ko.A,{className:"wpqt-size-5 wpqt-text-yellow-600"})}),(0,n.jsx)(Go,{label:(0,o.__)("Is active","quicktasker"),value:a?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,n.jsx)(Po.A,{className:"wpqt-size-5 "+(a?"wpqt-icon-green":"wpqt-icon-red")})}),(0,n.jsx)(Go,{label:(0,o.__)("User Page","quicktasker"),value:(0,n.jsx)("a",{href:i,rel:"noreferrer",target:"_blank",children:i}),icon:(0,n.jsx)(Ws.A,{className:"wpqt-size-5 wpqt-icon-blue"})})]})}function Go({label:e,value:t,icon:s}){return(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[s,(0,n.jsxs)("span",{className:"wpqt-font-semibold",children:[e,": "]}),(0,n.jsx)("span",{children:t})]})}var Ho=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Bo({userId:e}){const{loadingDispatch:t}=(0,a.useContext)(pt),[s,r]=(0,a.useState)(null);return(0,a.useEffect)((()=>{(()=>{Ho(this,void 0,void 0,(function*(){try{t({type:ge,payload:!0});const a=yield function(e){return u()({path:`/wpqt/v1/users/${e}/extended`,method:"GET",headers:p()})}(e);r((s=a.data,Object.assign(Object.assign({},s),{is_active:"1"===s.is_active})))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to get user data. Please try again","quicktasker"))}finally{t({type:ge,payload:!1})}var s}))})()}),[]),(0,n.jsx)(_t,{children:s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l,{description:(0,o.__)("User details","quicktasker"),children:s.name}),(0,n.jsx)(Vo,{data:s}),(0,n.jsx)(Mo,{data:s,changeStatus:e=>Ho(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{is_active:e}):t))})),changeSetUpStatus:e=>Ho(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{setup_completed:e}):t))})),changePasswordStatus:e=>Ho(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{has_password:e}):t))}))})]})})}const Wo=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active}),Qo=(e,t)=>{var s;switch(t.type){case _e:return Object.assign(Object.assign({},e),{sessionsSearchValue:null!==(s=t.payload)&&void 0!==s?s:""});case ke:{const s=t.payload.map(Wo);return Object.assign(Object.assign({},e),{userSessions:s})}case je:{const{sessionId:s,status:a}=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_active:a}):e))})}case ye:{const s=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.filter((e=>e.id!==s))})}default:return e}};var Yo=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Xo={loading:!0,sessionsSearchValue:"",userSessions:[]},Jo=(0,a.createContext)({state:Xo,usersSessionDispatch:()=>{},loadUserSessions:()=>Yo(void 0,void 0,void 0,(function*(){}))}),Zo=({children:e})=>{const[t,s]=(0,a.useReducer)(Qo,Xo),{loadingDispatch:r}=(0,a.useContext)(pt);(0,a.useEffect)((()=>{c()}),[]);const c=()=>Yo(void 0,void 0,void 0,(function*(){try{r({type:ge,payload:!0});const e=yield u()({path:"/wpqt/v1/users/sessions",method:"GET",headers:p()});s({type:ke,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user sessions","quicktasker"))}finally{r({type:ge,payload:!1})}}));return(0,n.jsx)(Jo.Provider,{value:{state:t,usersSessionDispatch:s,loadUserSessions:c},children:e})};function er(){const{state:{sessionsSearchValue:e},usersSessionDispatch:t}=(0,a.useContext)(Jo);return(0,n.jsx)(Ot,{title:(0,o.__)("Session filtering","quicktasker"),children:(0,n.jsx)(Ns,{value:e,onChange:e=>{t({type:_e,payload:e})}})})}const tr=()=>{const{state:{sessionsSearchValue:e}}=(0,a.useContext)(Jo);return{filterSessions:t=>t.user_name.toLowerCase().includes(e.toLowerCase())||t.user_description&&t.user_description.toLowerCase().includes(e.toLowerCase())}};var sr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function ar({session:e}){const{usersSessionDispatch:t}=(0,a.useContext)(Jo),{state:{isUserAllowedToDelete:s}}=(0,a.useContext)(Ts),{convertToWPTimezone:r}=Da(),c=e.is_active,l=s=>sr(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/users/sessions/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e.id,s),t({type:je,payload:{sessionId:e.id,status:s}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change session status","quicktasker"))}}));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:e.user_name}),(0,n.jsx)("div",{className:"wpqt-italic",children:e.user_description})]}),(0,n.jsx)("div",{children:r(e.created_at_utc)}),(0,n.jsx)("div",{children:r(e.expires_at_utc)}),(0,n.jsx)("div",{className:c?"wpqt-text-qtTextGreen":"wpqt-text-qtTextRed",children:c?(0,o.__)("On","quicktasker"):(0,o.__)("Off","quicktasker")}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-4",children:[c?(0,n.jsx)(Po.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!1),title:(0,o.__)("Turn session off","quicktasker")}):(0,n.jsx)(Po.A,{className:"wpqt-icon-green wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!0),title:(0,o.__)("Turn session on","quicktasker")}),s&&(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",title:(0,o.__)("Delete session","quicktasker"),onClick:()=>sr(this,void 0,void 0,(function*(){try{yield(s=e.id,u()({path:`/wpqt/v1/users/sessions/${s}`,method:"DELETE",headers:p()})),t({type:ye,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete session","quicktasker"))}var s}))})]})]})}function nr(){const{state:{userSessions:e}}=(0,a.useContext)(Jo),{filterSessions:t}=tr(),s=e.filter(t);return 0===s.length?(0,n.jsx)(cn,{text:(0,o.__)("No sessions found","quicktasker")}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"wpqt-mb-4 wpqt-grid wpqt-grid-cols-5 wpqt-font-bold",children:[(0,n.jsx)("div",{children:(0,o.__)("Session owner","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Created at","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Expires at","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Status","quicktasker")}),(0,n.jsx)("div",{children:(0,o.__)("Actions","quicktasker")})]}),(0,n.jsx)("div",{className:"wpqt-grid wpqt-grid-cols-5 wpqt-items-center wpqt-gap-y-4",children:s.map((e=>(0,n.jsx)(ar,{session:e},e.id)))})]})}function ir(){return(0,n.jsx)(Zo,{children:(0,n.jsxs)(_t,{children:[(0,n.jsx)(l,{children:(0,o.__)("Quicktasker sessions","quicktasker")}),(0,n.jsx)(er,{}),(0,n.jsx)(nr,{})]})})}function or(){const{state:{usersSearchValue:e},userDispatch:t}=(0,a.useContext)(Jt);return(0,n.jsx)(Ot,{title:(0,o.__)("User filtering","quicktasker"),children:(0,n.jsx)(kt.p,{type:"text",value:e,onChange:e=>{t({type:he,payload:e.target.value})}})})}var rr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function cr({userId:e}){return(0,n.jsx)($a,{typeId:e,fetchData:()=>rr(this,void 0,void 0,(function*(){try{return(yield q(e,ot.User)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load log","quicktasker"))}})),renderItem:e=>(0,n.jsx)(Ua,{log:e}),noDataMessage:(0,o.__)("No logs available","quicktasker"),explanation:(0,o.__)("Logs can be seen only by WordPress users (with required permissions)","quicktasker")})}var lr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function dr({userId:e}){return(0,n.jsx)($a,{typeId:e,fetchData:()=>lr(this,void 0,void 0,(function*(){try{return(yield w(e,ot.User,!0)).data.map(Ya)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load private comments","quicktasker"))}})),onAdd:t=>lr(this,void 0,void 0,(function*(){try{const s=yield m(e,ot.User,!0,t);return Ya(s.data.newComment)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add private comment","quicktasker"))}})),renderItem:e=>(0,n.jsx)(Ga,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed only by WordPress users (with required permissions).","quicktasker"),enableAdd:!0})}var ur=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function pr({userId:e}){const{addComment:t}=Qa();return(0,n.jsx)($a,{typeId:e,fetchData:()=>ur(this,void 0,void 0,(function*(){try{return(yield w(e,ot.User,!1)).data.map(Ya)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load comments","quicktasker"))}})),onAdd:s=>ur(this,void 0,void 0,(function*(){const a=yield t(e,ot.User,!1,s);if(a)return Ya(a)})),renderItem:e=>(0,n.jsx)(Ga,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed by WordPress users (with required permissions) and current QuickTasker user (in user page).","quicktasker"),enableAdd:!0})}function hr({user:e}){const t=[(0,o.__)("Private comments","quicktasker"),(0,o.__)("Public comments","quicktasker"),(0,o.__)("Logs","quicktasker")];return(0,n.jsx)(Ta,{tabs:t,tabsContent:[(0,n.jsx)(dr,{userId:e.id},1),(0,n.jsx)(pr,{userId:e.id},2),(0,n.jsx)(cr,{userId:e.id},3)]})}var wr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const mr=(0,a.forwardRef)((function({modalSaving:e,editUser:t},s){const{state:{userToEdit:i},modalDispatch:r}=(0,a.useContext)(Bt),{state:{isUserAllowedToDelete:c}}=(0,a.useContext)(Ts),[l,d]=(0,a.useState)(""),[u,p]=(0,a.useState)(""),[h,w]=(0,a.useState)(!1),[m,q]=(0,a.useState)(!1),{changeUserStatus:v,deleteUser:x,resetUserPassword:f}=Uo(),{userDispatch:g}=(0,a.useContext)(Jt),{loading1:_,setLoading1:k,loading2:j,setLoading2:y,loading3:b,setLoading3:T}=js();(0,a.useEffect)((()=>{i&&(d(i.name),p(i.description),w(i.is_active),q(i.has_password))}),[i]);const S=()=>{d(""),p("")};return(0,a.useImperativeHandle)(s,(()=>({clearContent:S}))),i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,n.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,n.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-3 md:wpqt-grid-cols-[auto_1fr]",children:[(0,n.jsx)("div",{children:(0,n.jsxs)(qs,{children:[(0,n.jsx)(vs,{label:(0,o.__)("Name","quicktasker"),children:(0,n.jsx)(Ns,{isAutoFocus:!0,value:l,onChange:e=>d(e)})}),(0,n.jsx)(vs,{label:(0,o.__)("Description","quicktasker"),children:(0,n.jsx)(Ps,{rowsCount:3,value:u,onChange:e=>p(e)})})]})}),(0,n.jsx)(ha,{entityId:i.id,entityType:Es.User})]}),(0,n.jsx)("div",{className:"wpqt-mt-7",children:(0,n.jsx)(hr,{user:i})})]}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,n.jsx)(ps,{icon:(0,n.jsx)(Fo.A,{className:"wpqt-icon-blue wpqt-size-4"}),text:(0,o.__)("User details","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}`,r({type:W})}}),(0,n.jsx)(ps,{icon:(0,n.jsx)(Ai.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}/tasks`,r({type:W})}}),m&&(0,n.jsx)(ps,{icon:(0,n.jsx)(Do.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Reset password","quicktasker"),loading:_,onClick:()=>wr(this,void 0,void 0,(function*(){k(!0),yield f(i.id,(()=>{g({type:ve,payload:i.id}),q(!1)})),k(!1)}))}),!h&&(0,n.jsx)(ps,{icon:(0,n.jsx)(Po.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:j,onClick:()=>wr(this,void 0,void 0,(function*(){y(!0),yield v(i.id,!0,(e=>{g({type:we,payload:Object.assign({},e)}),w(!0)})),y(!1)}))}),h&&(0,n.jsx)(ps,{icon:(0,n.jsx)(Po.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:j,onClick:()=>wr(this,void 0,void 0,(function*(){y(!0),yield v(i.id,!1,(e=>{g({type:we,payload:Object.assign({},e)}),w(!1)})),y(!1)}))}),c&&(0,n.jsx)(ps,{icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete user","quicktasker"),loading:b,onClick:()=>wr(this,void 0,void 0,(function*(){T(!0),yield x(i.id,(e=>{g({type:me,payload:e}),r({type:W})})),T(!1)}))})]})]}),(0,n.jsx)(xs,{onSave:()=>{i&&t(Object.assign(Object.assign({},i),{name:l,description:u}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));var qr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function vr(){const{state:{userModalOpen:e}}=(0,a.useContext)(Bt),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r}=ts(W),{editUser:c}=Uo();return(0,n.jsx)(ws,{modalOpen:e,closeModal:o,size:"xl",children:(0,n.jsx)(mr,{ref:i,modalSaving:t,editUser:e=>qr(this,void 0,void 0,(function*(){s(!0),yield c(e,(e=>{r(we,e,es.USER)})),s(!1)}))})})}function xr(){const{state:{userSettingsModalOpen:e},modalDispatch:t}=(0,a.useContext)(Bt);return(0,n.jsx)(ws,{modalOpen:e,closeModal:()=>t({type:J,payload:!1}),size:"lg",children:(0,n.jsx)("div",{children:(0,n.jsx)(ha,{entityId:"null",entityType:Es.Users})})})}var fr=s(8316),gr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function _r(){const[e,t]=(0,a.useState)(!1),[s,r]=(0,a.useState)(""),[c,l]=(0,a.useState)(""),{userDispatch:d}=(0,a.useContext)(Jt),{createUser:u}=Uo(),p=()=>{r(""),l(""),t(!1)};return(0,n.jsx)("div",{className:"wpqt-mb-6",children:e?(0,n.jsxs)("div",{className:"wpqt-w-1/4",children:[(0,n.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User name","quicktasker")}),(0,n.jsx)(Ns,{value:s,onChange:r,className:"wpqt-w-full"}),(0,n.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User description","quicktasker")}),(0,n.jsx)(Ps,{value:c,onChange:l,className:"wpqt-w-full"}),(0,n.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,n.jsx)(ps,{text:(0,o.__)("Cancel","quicktasker"),onClick:p,icon:(0,n.jsx)(rs.A,{className:"wpqt-icon-red wpqt-size-5"})}),(0,n.jsx)(ps,{text:(0,o.__)("Add","quicktasker"),onClick:()=>gr(this,void 0,void 0,(function*(){s?yield u(s,c,(e=>{d({type:pe,payload:e}),p()})):i.oR.error("User name is required")})),icon:(0,n.jsx)(fr.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]}):(0,n.jsx)(ps,{text:(0,o.__)("Add QuickTasker","quicktasker"),onClick:()=>t(!0),icon:(0,n.jsx)(fr.A,{className:"wpqt-icon-green wpqt-size-5"})})})}const kr=()=>{const{state:{usersSearchValue:e}}=(0,a.useContext)(Jt);return{filterUsers:t=>t.name.toLowerCase().includes(e.toLowerCase())||t.description&&t.description.toLowerCase().includes(e.toLowerCase())}};var jr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function yr({user:e}){const{modalDispatch:t}=(0,a.useContext)(Bt),{userDispatch:s}=(0,a.useContext)(Jt),{changeUserStatus:i,deleteUser:r,resetUserPassword:c}=Uo(),[l,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1),[h,w]=(0,a.useState)(!1),m=e.is_active,q=t=>jr(this,void 0,void 0,(function*(){w(!0),yield i(e.id,t,(()=>{s({type:qe,payload:{userId:e.id,isActive:t}})})),w(!1)}));return(0,n.jsxs)(qa,{menuBtn:({active:e})=>(0,n.jsx)(va,{isActive:e,IconComponent:mn.A}),children:[(0,n.jsx)(xa,{text:(0,o.__)("User details","quicktasker"),icon:(0,n.jsx)(Fo.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,n.jsx)(xa,{text:(0,o.__)("User tasks","quicktasker"),icon:(0,n.jsx)(Ai.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}/tasks`}}),(0,n.jsx)(xa,{text:(0,o.__)("Edit user","quicktasker"),icon:(0,n.jsx)(Qs.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:Q,payload:e})}}),e.has_password&&(0,n.jsx)(xa,{text:(0,o.__)("Reset password","quicktasker"),loading:l,icon:(0,n.jsx)(Do.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>jr(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield c(e.id,(()=>{s({type:ve,payload:e.id})})),d(!1)}))}),m&&(0,n.jsx)(xa,{text:(0,o.__)("Disable user","quicktasker"),loading:h,icon:(0,n.jsx)(Po.A,{className:"wpqt-icon-red wpqt-size-4"}),className:"!wpqt-mb-0",onClick:e=>{e.stopPropagation(),q(!1)}}),!m&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(xa,{text:(0,o.__)("Activate user","quicktasker"),loading:h,icon:(0,n.jsx)(Po.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:e=>{e.stopPropagation(),q(!0)}}),(0,n.jsx)(xa,{text:(0,o.__)("Delete user","quicktasker"),loading:u,icon:(0,n.jsx)(_s.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>jr(this,void 0,void 0,(function*(){t.stopPropagation(),p(!0),yield r(e.id,(e=>{s({type:me,payload:e})})),p(!1)}))})]})]})}function br({user:e}){const{userPage:t}=$o(),{modalDispatch:s}=(0,a.useContext)(Bt),i=e.is_active,r=t+"&code="+e.page_hash;return(0,n.jsxs)(un,{title:e.name,description:e.description,dropdown:(0,n.jsx)(yr,{user:e}),onClick:()=>{s({type:Q,payload:e})},className:"wpqt-cursor-pointer",children:[(0,n.jsx)(wn,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("Open user page","quicktasker"),icon:(0,n.jsx)(Ws.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:e=>{e.stopPropagation(),window.open(r,"_blank")}}),(0,n.jsx)(wn,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("View user details","quicktasker"),icon:(0,n.jsx)(Ws.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,n.jsx)(wn,{label:(0,o.__)("Status","quicktasker"),value:i?(0,o.__)("Active","quicktasker"):(0,o.__)("Disabled","quicktasker"),valueClassName:i?"wpqt-text-qtTextGreen wpqt-font-bold":"wpqt-text-qtTextRed wpqt-font-bold",icon:(0,n.jsx)(Po.A,{className:"wpqt-size-5 "+(i?"wpqt-icon-green":"wpqt-icon-red")})})]})}function Tr(){const{state:{users:e}}=(0,a.useContext)(Jt),{filterUsers:t}=kr(),s=e.filter(t);return e&&0===e.length?(0,n.jsx)(cn,{text:(0,o.__)("No users found","quicktasker")}):s&&0===s.length?(0,n.jsx)(cn,{}):(0,n.jsx)("div",{className:"wpqt-card-grid",children:s.map((e=>(0,n.jsx)(br,{user:e},e.id)))})}function Sr(){return(0,n.jsxs)("div",{children:[(0,n.jsx)(_r,{}),(0,n.jsx)(or,{}),(0,n.jsx)(Tr,{}),(0,n.jsx)(xr,{}),(0,n.jsx)(vr,{})]})}var Ar=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};var Er=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Cr({user:e}){const[t,s]=(0,a.useState)({quicktasker_admin_role:"quicktasker_admin_role"in e.allcaps,quicktasker_admin_role_allow_delete:"quicktasker_admin_role_allow_delete"in e.allcaps,quicktasker_admin_role_manage_users:"quicktasker_admin_role_manage_users"in e.allcaps,quicktasker_admin_role_manage_settings:"quicktasker_admin_role_manage_settings"in e.allcaps}),[i,r]=(0,a.useState)(!1),{updateWPUserCapabilities:c}=function(){return{updateWPUserCapabilities:(e,t,s,a)=>Ar(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/wp-users/${e}/capabilities`,method:"PATCH",data:{quicktasker_admin_role:t.quicktasker_admin_role,quicktasker_admin_role_allow_delete:t.quicktasker_admin_role_allow_delete,quicktasker_admin_role_manage_users:t.quicktasker_admin_role_manage_users,quicktasker_admin_role_manage_settings:t.quicktasker_admin_role_manage_settings},headers:p()})}(e,t),s&&s()}catch(e){a&&a(e)}}))}}(),l=(a,n)=>Er(this,void 0,void 0,(function*(){if(i)return;r(!0);const o=Object.assign({},t),l=Object.assign(Object.assign({},t),{[n]:a});s(l),yield c(e.id,l,(()=>{}),(()=>{s(o)})),r(!1)}));return(0,n.jsxs)(un,{title:e.name,description:e.description,children:[(0,n.jsx)(wn,{label:(0,o.__)("Role","quicktasker"),value:Array.isArray(e.roles)?e.roles.join(", "):""}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to admin areas","quicktasker")}),(0,n.jsx)(Rs,{checked:t.quicktasker_admin_role,handleChange:e=>{l(e,"quicktasker_admin_role")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to users page","quicktasker")}),(0,n.jsx)(Rs,{checked:t.quicktasker_admin_role_manage_users,handleChange:e=>{l(e,"quicktasker_admin_role_manage_users")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to settings page","quicktasker")}),(0,n.jsx)(Rs,{checked:t.quicktasker_admin_role_manage_settings,handleChange:e=>{l(e,"quicktasker_admin_role_manage_settings")}})]}),(0,n.jsxs)("div",{className:"wpqt-mb-2",children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Allow to delete resources","quicktasker")}),(0,n.jsx)(Rs,{checked:t.quicktasker_admin_role_allow_delete,handleChange:e=>{l(e,"quicktasker_admin_role_allow_delete")}})]}),i&&(0,n.jsx)(gt,{ovalSize:"24"})]})}var Nr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Or(){const[e,t]=(0,a.useState)(null),[s,i]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{(()=>{Nr(this,void 0,void 0,(function*(){try{i(!0);const s=yield(e=lt.Other,u()({path:`/wpqt/v1/wp-users?type=${encodeURIComponent(e)}`,method:"GET",headers:p()}));t(s.data)}catch(e){console.error(e)}finally{i(!1)}var e}))})()}),[]),s||null===e?(0,n.jsx)(gt,{ovalSize:"48"}):0===e.length?(0,n.jsx)(cn,{text:(0,o.__)("No non-admin WordPress users found","quicktasker")}):(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Displaying non-admin WordPress users.","quicktasker")}),(0,n.jsx)("div",{className:"wpqt-card-grid",children:e.map((e=>(0,n.jsx)(Cr,{user:e},e.id)))})]})}function Ir(){const{updateUsers:e}=(0,a.useContext)(Jt),{loadingDispatch:t}=(0,a.useContext)(pt),{modalDispatch:s}=(0,a.useContext)(Bt),i=[(0,n.jsx)(Sr,{},0),(0,n.jsx)(Or,{},1)];return(0,a.useEffect)((()=>{(()=>{var s,a,n,i;s=this,a=void 0,i=function*(){t({type:ge,payload:!0}),yield e(),t({type:ge,payload:!1})},new((n=void 0)||(n=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function r(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((i=i.apply(s,a||[])).next())}))})()}),[]),(0,n.jsxs)(_t,{children:[(0,n.jsx)(l,{description:(0,o.__)("Manage QuickTaskers and WordPress users. This plugin supports three types of users: WordPress admins, other WordPress users, and QuickTaskers. WordPress admins have full access to all admin areas. Other WordPress users do not have any access by default but can be granted if needed. QuickTaskers are separate users who do not have admin access but can manage tasks through a mobile-friendly webpage.","quicktasker"),icon:(0,n.jsx)(pi.A,{className:"wpqt-icon-gray wpqt-size-7 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{s({type:J,payload:!0})}}),children:(0,o.__)("Users","quicktasker")}),(0,n.jsx)(Ta,{tabs:["QuickTaskers","WordPress users"],tabsContent:i,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}const Pr=(e,t)=>{switch(t.type){case be:{const s=t.payload.map(nt);return Object.assign(Object.assign({},e),{tasks:s})}case Se:{const s=t.payload;return Object.assign(Object.assign({},e),{tasks:e.tasks.filter((e=>e.id!==s))})}case Ae:{const s=t.payload,a=e.tasks.map((e=>e.id===s.id?nt(s):e));return Object.assign(Object.assign({},e),{tasks:a})}case Te:{const s=t.payload;return Object.assign(Object.assign({},e),{searchValue:s})}case Ee:{const s=t.payload;return Object.assign(Object.assign({},e),{filteredPipelineId:s})}case Ce:{const{taskId:s,user:a}=t.payload,n=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Ze(a)?[a,...e.assigned_users]:e.assigned_users,assigned_wp_users:et(a)?[a,...e.assigned_wp_users]:e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{tasks:n})}case Ne:{const{taskId:s,user:a}=t.payload,n=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:Ze(a)?e.assigned_users.filter((e=>e.id!==a.id)):e.assigned_users,assigned_wp_users:et(a)?e.assigned_wp_users.filter((e=>e.id!==a.id)):e.assigned_wp_users}):e));return Object.assign(Object.assign({},e),{tasks:n})}case Oe:{const{taskId:s,done:a}=t.payload,n=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:a}):e));return Object.assign(Object.assign({},e),{tasks:n})}default:return e}};var Dr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};const Rr={tasks:[],searchValue:"",filteredPipelineId:""},Ur=(0,a.createContext)({state:Rr,userTasksDispatch:()=>{},fetchAndSetUserTasks:()=>Dr(void 0,void 0,void 0,(function*(){}))}),Lr=({children:e,userId:t})=>{const[s,r]=(0,a.useReducer)(Pr,Rr),{loadingDispatch:c}=(0,a.useContext)(pt);(0,a.useEffect)((()=>{l()}),[]);const l=()=>Dr(void 0,void 0,void 0,(function*(){try{c({type:ge,payload:!0});const e=yield function(e){return u()({path:`/wpqt/v1/users/${e}/tasks`,method:"GET",headers:p()})}(t);r({type:be,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user tasks","quicktasker"))}finally{c({type:ge,payload:!1})}}));return(0,n.jsx)(Ur.Provider,{value:{state:s,userTasksDispatch:r,fetchAndSetUserTasks:l},children:e})};function Mr(){const{state:{searchValue:e,filteredPipelineId:t},userTasksDispatch:s}=(0,a.useContext)(Ur);return(0,n.jsxs)(Ot,{title:(0,o.__)("Filter tasks","quicktasker"),children:[(0,n.jsx)(Ns,{value:e,onChange:e=>{s({type:Te,payload:e})},className:"!wpqt-mb-0"}),(0,n.jsx)(Nt,{selectedOptionValue:t,selectionChange:e=>{s({type:Ee,payload:e})}})]})}var Fr=s(7028),zr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Kr({taskId:e,onUnAssignTask:t}){const[s,i]=(0,a.useState)(!1);return(0,n.jsx)(qa,{menuBtn:({active:e})=>(0,n.jsx)(va,{isActive:e,IconComponent:mn.A}),children:(0,n.jsx)(xa,{text:(0,o.__)("Unassign from task","quicktasker"),loading:s,icon:(0,n.jsx)(Fr.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:s=>zr(this,void 0,void 0,(function*(){s.stopPropagation(),i(!0),yield t(e),i(!1)})),className:"!wpqt-mb-0"})})}const $r=()=>{const{state:{searchValue:e,filteredPipelineId:t}}=(0,a.useContext)(Ur);return{filterTasks:s=>{const a=s.name&&s.name.toLowerCase().includes(e.toLowerCase())||s.description&&s.description.toLowerCase().includes(e.toLowerCase()),n=!t||s.pipeline_id===t;return a&&n}}};var Vr=function(e,t,s,a){return new(s||(s=Promise))((function(n,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};function Gr({userId:e}){var t;const{filterTasks:s}=$r(),{modalDispatch:i}=(0,a.useContext)(Bt),{state:{tasks:r},userTasksDispatch:c}=(0,a.useContext)(Ur),{removeTaskFromUser:l}=$t(),d=null!==(t=null==r?void 0:r.filter(s))&&void 0!==t?t:[],u=t=>Vr(this,void 0,void 0,(function*(){yield l(e,t,(()=>{c({type:Se,payload:t})}))}));return r&&0===r.length?(0,n.jsx)(cn,{text:(0,o.__)("User has no tasks","quicktasker")}):d&&0===d.length?(0,n.jsx)(cn,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"wpqt-card-grid",children:d.map((e=>(0,n.jsxs)(un,{className:"wpqt-cursor-pointer",title:e.name,description:e.description,dropdown:(0,n.jsx)(Kr,{taskId:e.id,onUnAssignTask:u}),onClick:()=>{i({type:F,payload:{taskToEdit:e}})},children:[(0,n.jsx)(ya,{task:e,onUserAdd:t=>{c({type:Ce,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{c({type:Ne,payload:{taskId:e.id,user:t}})}}),(0,n.jsx)(hn,{task:e,onDoneStatusChange:(e,t)=>{c({type:Oe,payload:{taskId:e,done:t}})}})]},e.id)))}),(0,n.jsx)(rn,{editTaskCallback:e=>{c({type:Ae,payload:e})}})]})}function Hr({userId:e}){return(0,n.jsx)(Lr,{userId:e,children:(0,n.jsxs)(_t,{children:[(0,n.jsx)(l,{description:(0,o.__)("Tasks assigned to user","quicktasker"),children:(0,o.__)("User tasks","quicktasker")}),(0,n.jsx)(Mr,{}),(0,n.jsx)(Gr,{userId:e})]})})}const Br=()=>{const{page:e,hash:t}=Wr();if("wp-quick-tasks"===e){const e=t.match(/^#\/users\/(\d+)\/tasks$/);if(e){const t=e[1];return(0,n.jsx)(Hr,{userId:t})}const s=t.match(/^#\/users\/(\d+)$/);if(s){const e=s[1];return(0,n.jsx)(Bo,{userId:e})}switch(t){case"#/users":return(0,n.jsx)(Ir,{});case"#/overview":return(0,n.jsx)(Gn,{});case"#/archive":return(0,n.jsx)(_n,{});case"#/user-sessions":return(0,n.jsx)(ir,{});case"#/logs":return(0,n.jsx)(On,{});case"#/settings":return(0,n.jsx)(Io,{});case"#/guide":return(0,n.jsx)(kn,{});default:return(0,n.jsx)(Ui,{})}}},Wr=()=>({page:new URLSearchParams(window.location.search).get("page"),hash:window.location.hash}),Qr=function(){const e=(()=>{const[e,t]=(0,a.useState)(Br());return(0,a.useEffect)((()=>{const e=()=>{t(Br()),(()=>{const{page:e,hash:t}=Wr();if("wp-quick-tasks"!==e)return;const s=document.querySelectorAll("#toplevel_page_wp-quick-tasks .wp-submenu li");s.forEach((e=>e.classList.remove("wpqt-current")));const a={"#/users":"#/users","#/overview":"#/overview","#/archive":"#/archive","#/user-sessions":"#/user-sessions","#/logs":"#/logs","#/settings":"#/settings","#/guide":"#/guide",default:""};let n=a.default;void 0!==a[t]?n=a[t]:/^#\/users(\/\d+)?(\/tasks)?$/.test(t)&&(n="#/users"),s.forEach((e=>{const t=e.querySelector("a");t&&t.getAttribute("href")&&t.getAttribute("href")===`admin.php?page=wp-quick-tasks${n}`&&e.classList.add("wpqt-current")}))})()};return e(),window.addEventListener("popstate",e),window.addEventListener("hashchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("hashchange",e)}}),[]),e})();return(0,n.jsx)(c,{children:(0,n.jsx)(Ss,{children:(0,n.jsx)(Zt,{children:(0,n.jsx)(Wt,{children:(0,n.jsx)(At,{children:(0,n.jsxs)(ht,{children:[e,(0,n.jsx)(i.N9,{position:"bottom-right"})]})})})})})})};(0,a.render)((0,n.jsx)(Qr,{}),document.getElementById("wpqt-app"))},1609:e=>{e.exports=window.React},5795:e=>{e.exports=window.ReactDOM},790:e=>{e.exports=window.ReactJSXRuntime}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}};return a[e].call(s.exports,s,s.exports,i),s.exports}i.m=a,e=[],i.O=(t,s,a,n)=>{if(!s){var o=1/0;for(d=0;d<e.length;d++){for(var[s,a,n]=e[d],r=!0,c=0;c<s.length;c++)(!1&n||o>=n)&&Object.keys(i.O).every((e=>i.O[e](s[c])))?s.splice(c--,1):(r=!1,n<o&&(o=n));if(r){e.splice(d--,1);var l=a();void 0!==l&&(t=l)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,a,n]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var n=Object.create(null);i.r(n);var o={};t=t||[null,s({}),s([]),s(s)];for(var r=2&a&&e;"object"==typeof r&&!~t.indexOf(r);r=s(r))Object.getOwnPropertyNames(r).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(n,o),n},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=524,(()=>{var e={524:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var a,n,[o,r,c]=s,l=0;if(o.some((t=>0!==e[t]))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(c)var d=c(i)}for(t&&t(s);l<o.length;l++)n=o[l],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(d)},s=globalThis.webpackChunkquicktasker=globalThis.webpackChunkquicktasker||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.nc=void 0;var o=i.O(void 0,[96],(()=>i(7882)));o=i.O(o)})();