(()=>{"use strict";var e,t,s,n={8463:(e,t,s)=>{const n=window.wp.element;var a=s(790),i=s(9571);const o=window.wp.i18n;class r extends n.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){var e;return this.state.hasError?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-h-screen wpqt-items-center wpqt-justify-center wpqt-text-center wpqt-text-lg",children:[(0,o.__)("Something went wrong. Please refresh the page.","quicktasker"),(0,a.jsx)("br",{}),null===(e=this.state.error)||void 0===e?void 0:e.message]}):this.props.children}}const c=r;function l({children:e,description:t=null,icon:s=null}){return(0,a.jsx)("div",{className:"wpqt-mb-6 wpqt-inline-grid wpqt-grid-cols-[auto_auto] wpqt-items-center wpqt-gap-2",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{children:[e,s&&(0,a.jsx)("span",{className:"wpqt-ml-1 wpqt-align-middle",children:s})]}),t&&(0,a.jsx)("div",{children:t})]})})}const d=window.wp.apiFetch;var u=s.n(d);function p(){return{"Content-Type":"application/json","X-WPQT-API-Nonce":window.wpqt.apiNonce}}function h(e,t,s){const n=new URLSearchParams({typeId:e,type:t,isPrivate:s.toString()}).toString();return u()({path:`/wpqt/v1/comments?${n}`,method:"GET",headers:p()})}function w(e,t,s,n){return u()({path:"/wpqt/v1/comments",data:{comment:n,typeId:e,type:t,isPrivate:s},method:"POST",headers:p()})}function v(e,t){const s=new URLSearchParams({typeId:e,type:t});return u()({path:`/wpqt/v1/logs?${s.toString()}`,method:"GET",headers:p()})}function x(e,t){return u()({path:`/wpqt/v1/users/${e}/tasks`,method:"DELETE",data:{task_id:t},headers:p()})}function q(e,t,s){const n=new URLSearchParams({entityId:e,entityType:t,active:String(s)});return u()({path:`/wpqt/v1/custom-fields?${n.toString()}`,method:"GET",headers:p()})}const m="SET_LOADING",f="SET_PIPELINE",g="ADD_TASK",k="ADD_STAGE",j="DELETE_STAGE",_="EDIT_TASK",y="EDIT_STAGE",b="ADD_PIPELINE",C="EDIT_PIPELINE",S="SET_PRIMARY",T="SET_PIPELINES",N="ADD_USER_TO_TASK",O="REMOVE_USER_FROM_TASK",A="CHANGE_TASK_DONE_STATUS",E="REMOVE_PIPELINE",P="REMOVE_ACTIVE_PIPELINE",I="REMOVE_TASK",D="OPEN_EDIT_TASK_MODAL",R="CLOSE_TASK_MODAL",U="OPEN_NEW_STAGE_MODAL",L="CLOSE_STAGE_MODAL",F="OPEN_STAGE_EDIT_MODAL",M="OPEN_NEW_PIPELINE_MODAL",z="OPEN_EDIT_PIPELINE_MODAL",$="CLOSE_PIPELINE_EDIT_MODAL",H="CLOSE_USER_MODAL",V="OPEN_EDIT_USER_MODAL",B="ADD_ASSIGNED_USER_TO_EDITING_TASK",G="REMOVE_ASSIGNED_USER_FROM_EDITING_TASK",K="CHANGE_USER_SETTINGS_MODAL_OPEN",W="SET_ARCHIVE_TASKS",Q="SET_ARCHIVE_SEARCH_VALUE",Y="SET_ARCHIVE_FILTERED_PIPELINE",X="REMOVE_ARCHIVED_TASK",J="ADD_ASSIGNED_USER_TO_ARCHIVED_TASK",Z="REMOVE_ASSINGED_USER_FROM_ARCHIVED_TASK",ee="CHANGE_ARCHIVED_TASK_DONE_STATUS",te="EDIT_ARCHIVED_TASK",se="CHANGE_ARCHIVE_TASK_DONE_FILTER",ne="SET_USERS",ae="ADD_USER",ie="SET_USERS_SEARCH_VALUE",oe="EDIT_USER",re="DELETE_USER",ce="CHANGE_USER_STATUS",le="RESET_PASSWORD",de="INIT_APP_STATE",ue="SET_CUSTOM_USER_PAGE_STYLES",pe="SET_FULL_PAGE_LOADING",he="SET_USER_SESSIONS_SEARCH_VALUE",we="SET_USER_SESSIONS",ve="CHANGE_USER_SESSION_STATUS",xe="DELETE_USER_SESSION",qe="SET_USER_TASKS",me="SET_USER_TASKS_SEARCH_VALUE",fe="REMOVE_USER_TASK",ge="EDIT_USER_TASK",ke="SET_USER_TASKS_FILTERED_PIPELINE",je="ADD_ASSIGNED_USER_TO_USER_TASK",_e="REMOVE_ASSIGNED_USER_FROM_USER_TASK",ye="CHANGE_USER_TASK_DONE_STATUS",be="SET_CUSTOM_FIELDS",Ce="ADD_CUSTOM_FIELD",Se="DELETE_CUSTOM_FIELD",Te="SET_CUSTOM_FIELD_LOADING",Ne="SET_CUSTOM_FIELD_INITIAL_DATA",Oe="SET_PIPELINE_AUTOMATIONS",Ae="SET_PIPELINE_AUTOMATIONS_LOADING",Ee="REMOVE_PIPELINE_AUTOMATION",Pe="ADD_PIPELINE_AUTOMATION",Ie=!1,De=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active,has_password:"1"===e.has_password}),Re=e=>Object.assign(Object.assign({},e),{task_order:Number(e.task_order),free_for_all:"1"===e.free_for_all,is_archived:"1"===e.is_archived,is_done:"1"===e.is_done,assigned_users:e.assigned_users?e.assigned_users.map((e=>Object.assign({},De(e)))):[]}),Ue=(e,t)=>{var s,n,a,i,o;switch(t.type){case W:{const s=t.payload;return Object.assign(Object.assign({},e),{archivedTasks:s.map(Re)})}case Q:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveSearchValue:s})}case Y:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveFilteredPipelineId:s})}case X:{const n=(null!==(s=e.archivedTasks)&&void 0!==s?s:[]).filter((e=>e.id!==t.payload));return Object.assign(Object.assign({},e),{archivedTasks:n})}case J:{const{taskId:s,user:a}=t.payload,i=(null!==(n=e.archivedTasks)&&void 0!==n?n:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:[a,...e.assigned_users]}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case Z:{const{taskId:s,user:n}=t.payload,i=(null!==(a=e.archivedTasks)&&void 0!==a?a:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:e.assigned_users.filter((e=>e.id!==n.id))}):e));return Object.assign(Object.assign({},e),{archivedTasks:i})}case ee:{const{taskId:s,done:n}=t.payload,a=(null!==(i=e.archivedTasks)&&void 0!==i?i:[]).map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{archivedTasks:a})}case te:{const s=t.payload,n=(null!==(o=e.archivedTasks)&&void 0!==o?o:[]).map((e=>e.id===s.id?Re(s):e));return Object.assign(Object.assign({},e),{archivedTasks:n})}case se:{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskDoneFilter:s})}default:return e}};var Le,Fe,Me,ze;!function(e){e.Task="task",e.User="user"}(Le||(Le={})),function(e){e.System="system",e.Admin="admin",e.WPQTUser="quicktasker_user",e.Automation="automation"}(Fe||(Fe={})),function(e){e.All="all",e.Completed="completed",e.NotCompleted="not completed"}(Me||(Me={})),function(e){e.Admin="administrator",e.Other="other"}(ze||(ze={}));const $e=(e,t)=>{if(t.type===pe){const s=t.payload;return Object.assign(Object.assign({},e),{fullPageLoading:s})}return e},He={fullPageLoading:!1},Ve=(0,n.createContext)({state:He,loadingDispatch:()=>{}}),Be=({children:e})=>{const[t,s]=(0,n.useReducer)($e,He);return(0,a.jsx)(Ve.Provider,{value:{state:t,loadingDispatch:s},children:e})};const Ge={archivedTasks:null,archiveLoading:!1,archiveSearchValue:"",archiveFilteredPipelineId:"",archiveTaskDoneFilter:Me.All},Ke=(0,n.createContext)({state:Ge,archiveDispatch:()=>{}}),We=({children:e})=>{const[t,s]=(0,n.useReducer)(Ue,Ge),{loadingDispatch:r}=(0,n.useContext)(Ve);(0,n.useEffect)((()=>{c()}),[]);const c=()=>{return e=void 0,t=void 0,a=function*(){try{r({type:pe,payload:!0});const{data:e}=yield u()({path:"/wpqt/v1/tasks/archived",method:"GET",headers:p()});s({type:W,payload:e})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch archived tasks","quicktasker"))}finally{r({type:pe,payload:!1})}},new((n=void 0)||(n=Promise))((function(s,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}));var e,t,n,a};return(0,a.jsx)(Ke.Provider,{value:{state:t,archiveDispatch:s},children:e})};var Qe=s(6061);function Ye({width:e="80",height:t="80",className:s=""}){return(0,a.jsx)(Qe.BM,{visible:!0,height:t,width:e,color:"#1d4ed8",secondaryColor:"#2563eb",ariaLabel:"oval-loading",wrapperStyle:{},wrapperClass:s})}function Xe(){return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-flex-col wpqt-items-center wpqt-justify-center",children:(0,a.jsx)(Ye,{})})}function Je({className:e,ovalSize:t}){const s=t?{width:t,height:t}:{};return(0,a.jsx)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center ${e}`,children:(0,a.jsx)(Ye,Object.assign({},s))})}function Ze({children:e}){const{state:{fullPageLoading:t}}=(0,n.useContext)(Ve);return(0,a.jsx)("div",{className:"wpqt-pr-4",children:t?(0,a.jsx)(Xe,{}):e})}var et=s(2912);const tt=e=>Object.assign(Object.assign({},e),{allow_only_last_stage_task_done:"1"===e.allow_only_last_stage_task_done}),st=e=>Object.assign(Object.assign({},e),{stage_order:Number(e.stage_order),tasks:(e.tasks||[]).map((e=>Object.assign({},Re(e))))}),nt=(e,t)=>{var s;switch(t.type){case T:{const s=t.payload,n=e=>Object.assign({},st(e)),a=e=>{var t;return Object.assign(Object.assign({},e),{stages:null===(t=e.stages)||void 0===t?void 0:t.map(n),settings:e.settings?tt(e.settings):void 0,is_primary:"1"===e.is_primary})};return Object.assign(Object.assign({},e),{pipelines:s.map(a)})}case b:{const n=t.payload,a=e=>Object.assign({},st(e)),i=Object.assign(Object.assign({},n),{stages:null===(s=n.stages)||void 0===s?void 0:s.map(a),settings:n.settings?tt(n.settings):void 0,is_primary:!1});return Object.assign(Object.assign({},e),{pipelines:[...e.pipelines,i]})}case S:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>Object.assign(Object.assign({},e),{is_primary:e.id===s})))})}case C:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.map((e=>e.id===s.id?s:e))})}case E:{const s=t.payload;return Object.assign(Object.assign({},e),{pipelines:e.pipelines.filter((e=>e.id!==s))})}default:return e}},at={pipelines:[]},it=(0,n.createContext)({state:at,pipelinesDispatch:()=>{}}),ot=({children:e})=>{const[t,s]=(0,n.useReducer)(nt,at);return(0,n.useEffect)((()=>{const e=window.wpqt.initialPipelines;s({type:T,payload:e})}),[]),(0,a.jsx)(it.Provider,{value:{state:t,pipelinesDispatch:s},children:e})};var rt=s(3482);function ct({options:e,selectedOptionValue:t,onSelectionChange:s,allSelector:n=!0,className:i=""}){return(0,a.jsxs)(rt.l,{value:t,onChange:e=>{const t=e.target.value;s(t)},className:`!wpqt-rounded-lg !wpqt-border !wpqt-border-solid !wpqt-border-qtBorder !wpqt-px-2 !wpqt-pr-6 !wpqt-py-1 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`,children:[n&&(0,a.jsx)("option",{value:"",children:"All boards"}),e.map((e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value)))]})}function lt({selectedOptionValue:e,selectionChange:t,extraOptions:s=[]}){const{state:{pipelines:i}}=(0,n.useContext)(it),o=(0,n.useMemo)((()=>i.map((e=>({value:e.id,label:e.name})))),[i]);return(0,a.jsx)(ct,{options:[...o,...s],selectedOptionValue:e,onSelectionChange:t})}function dt({children:e,title:t,childrenClassName:s="",titleClassName:n=""}){return(0,a.jsxs)("div",{className:"wpqt-mb-8",children:[(0,a.jsx)("div",{className:`wpqt-mb-2 wpqt-text-base ${n}`,children:t}),(0,a.jsx)("div",{className:`wpqt-flex wpqt-gap-2 wpqt-items-center ${s}`,children:e})]})}function ut(){const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s},archiveDispatch:i}=(0,n.useContext)(Ke);return(0,a.jsxs)(dt,{title:(0,o.__)("Archive filtering","quicktasker"),children:[(0,a.jsx)(et.p,{type:"text",value:e,onChange:e=>{i({type:Q,payload:e.target.value})}}),(0,a.jsx)(lt,{selectedOptionValue:t,selectionChange:e=>{i({type:Y,payload:e})},extraOptions:[{value:"DELETED",label:(0,o.__)("DELETED","quicktasker")}]}),(0,a.jsx)(ct,{allSelector:!1,selectedOptionValue:s,options:[{label:(0,o.__)("All status","quicktasker"),value:Me.All},{label:(0,o.__)("Completed","quicktasker"),value:Me.Completed},{label:(0,o.__)("Not completed","quicktasker"),value:Me.NotCompleted}],onSelectionChange:e=>{const t=(e=>{switch(e){case Me.All:return Me.All;case Me.Completed:return Me.Completed;case Me.NotCompleted:return Me.NotCompleted;default:throw new Error(`Invalid selection: ${e}`)}})(e);i({type:se,payload:t})}})]})}const pt=(e,t)=>{var s,n,a,i,o,r,c,l,d,u;switch(t.type){case m:return Object.assign(Object.assign({},e),{loading:t.payload});case f:{const s=t.payload,n=(s.stages||[]).map((e=>Object.assign({},st(e)))),a=s.settings?tt(s.settings):void 0;return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},s),{stages:n,settings:a,is_primary:"1"===s.is_primary})})}case"MOVE_TASK":{if(!e.activePipeline||!e.activePipeline.stages)return e;const s=((e,t,s)=>{const n=[...e],a=n.find((e=>e.id===t.droppableId)),i=n.find((e=>e.id===s.droppableId));if((null==a?void 0:a.tasks)&&(null==i?void 0:i.tasks)){const[e]=a.tasks.splice(t.index,1);i.tasks.splice(s.index,0,e)}return n})(e.activePipeline.stages,t.payload.source,t.payload.destination);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:s})})}case"REORDER_TASK":{const{source:a,destination:i}=t.payload,o=i.droppableId,r=i.index;if(!e.activePipeline)return e;const c=null===(s=e.activePipeline.stages)||void 0===s?void 0:s.find((e=>e.id===o));if(!c||!c.tasks)return e;const l=((e,t,s)=>{const n=[...e],[a]=n.splice(t,1);return n.splice(s,0,a),n})(c.tasks,a.index,r),d=null===(n=e.activePipeline.stages)||void 0===n?void 0:n.map((e=>e.id===o?Object.assign(Object.assign({},e),{tasks:l}):e));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:d})})}case g:{const s=Re(t.payload);return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(a=e.activePipeline.stages)||void 0===a?void 0:a.map((e=>e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:[...e.tasks||[],s]}):e))})}):e}case _:{const s=Re(t.payload);if(!e.activePipeline)return e;const n=null===(i=e.activePipeline.stages)||void 0===i?void 0:i.map((e=>{var t;return e.id===s.stage_id?Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s.id?s:e))}):e}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}case k:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:[...e.activePipeline.stages||[],s]})}):e}case y:{const s=t.payload;if(!e.activePipeline)return e;const n=e=>e.id===s.id?Object.assign(Object.assign({},e),{name:s.name,description:s.description}):e,a=null===(o=e.activePipeline.stages)||void 0===o?void 0:o.map(n);return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case j:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:null===(r=e.activePipeline.stages)||void 0===r?void 0:r.filter((e=>e.id!==s))})}):e}case N:{const{taskId:s,user:n}=t.payload;if(!e.activePipeline)return e;const a=null===(c=e.activePipeline.stages)||void 0===c?void 0:c.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:[n,...e.assigned_users||[]]}):e));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case O:{const{taskId:s,userId:n}=t.payload;if(!e.activePipeline)return e;const a=null===(l=e.activePipeline.stages)||void 0===l?void 0:l.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>{var t;return e.id===s?Object.assign(Object.assign({},e),{assigned_users:null===(t=e.assigned_users)||void 0===t?void 0:t.filter((e=>e.id!==n))}):e}));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case C:{const s=t.payload;return e.activePipeline?Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{name:s.name,description:s.description,is_primary:"1"===s.is_primary})}):e}case A:{const{taskId:s,done:n}=t.payload;if(!e.activePipeline)return e;const a=null===(d=e.activePipeline.stages)||void 0===d?void 0:d.map((e=>{var t;const a=null===(t=e.tasks)||void 0===t?void 0:t.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{tasks:a})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:a})})}case P:return Object.assign(Object.assign({},e),{activePipeline:null});case I:{const s=t.payload;if(!e.activePipeline)return e;const n=null===(u=e.activePipeline.stages)||void 0===u?void 0:u.map((e=>{var t;return Object.assign(Object.assign({},e),{tasks:null===(t=e.tasks)||void 0===t?void 0:t.filter((e=>e.id!==s))})}));return Object.assign(Object.assign({},e),{activePipeline:Object.assign(Object.assign({},e.activePipeline),{stages:n})})}default:return e}};const ht={loading:!1,activePipeline:null},wt=(0,n.createContext)({state:ht,dispatch:()=>{},fetchAndSetPipelineData:()=>Promise.resolve()}),vt=({children:e})=>{const[t,s]=(0,n.useReducer)(pt,ht),{loadingDispatch:r}=(0,n.useContext)(Ve);(0,n.useEffect)((()=>{const e=window.wpqt.initialActivePipelineId;e&&l(e,!0)}),[]);const c=(e,t)=>{t?r({type:pe,payload:e}):s({type:m,payload:e})},l=(e,...t)=>{return n=void 0,a=[e,...t],l=function*(e,t=!1){try{c(!0,t);const{data:{pipeline:n}}=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,headers:p()})}(e);s({type:f,payload:n})}catch(e){console.error(e),i.oR.error((0,o.__)("Unable to load the board. Please try again later.","quicktasker"))}finally{c(!1,t)}},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,i)}o((l=l.apply(n,a||[])).next())}));var n,a,r,l};return(0,a.jsx)(wt.Provider,{value:{state:t,dispatch:s,fetchAndSetPipelineData:l},children:e})};var xt,qt,mt;!function(e){e.TASK_DONE="task-done",e.Task_NOT_DONE="task-not-done"}(xt||(xt={})),function(e){e.PIPELINE="pipeline",e.Stage="stage",e.Task="task",e.quicktasker="quicktasker"}(qt||(qt={})),function(e){e.ARCHIVE_TASK="archive-task"}(mt||(mt={}));var ft=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const gt={[mt.ARCHIVE_TASK]:(0,o.__)("Task archived by automation","quicktasker")};function kt(){const{dispatch:e}=(0,n.useContext)(wt),t=e=>{e.forEach((e=>{const t=gt[e.automation_action]||`Automation executed: ${e.automation_action}`;i.oR.info(t)}))},s=(t,s)=>{t.forEach((t=>{t.automation_action===mt.ARCHIVE_TASK&&e({type:I,payload:s})}))};return{displayAutomationMessages:t,handleExecutedAnimationsResults:s,handleExecutedAutomations:(e,n)=>{0!==e.length&&(s(e,n),t(e))},createAutomation:(e,t,s)=>ft(this,void 0,void 0,(function*(){try{const n=yield function(e,t){return u()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"POST",data:{automationTargetId:null,automationTarget:t.automationTarget,automationTrigger:t.automationTrigger,automationAction:t.automationAction},headers:p()})}(e,t);i.oR.success((0,o.__)("Automation created","quicktasker")),s&&s(!0,n.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create automation","quicktasker")),s&&s(!1,null)}})),deleteAutomation:(e,t,s)=>ft(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/pipelines/${e}/automations/${t}`,method:"DELETE",headers:p()})}(e,t),i.oR.success((0,o.__)("Automation deleted","quicktasker")),s&&s(!0)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete automation","quicktasker")),s&&s(!1)}}))}}var jt=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const _t=()=>{const{handleExecutedAutomations:e}=kt(),{displayErrorMessages:t}=function(){return{displayErrorMessages:e=>{return t=this,s=void 0,a=function*(){if(e.messages&&Array.isArray(e.messages)&&e.messages.length>0){const t=e.messages.join(", ");i.oR.error(t)}},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a}}}();return{deleteTask:(e,t)=>jt(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}`,method:"DELETE",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task deleted","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a task","quicktasker"))}})),archiveTask:(e,t)=>jt(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task archived","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to archive a task","quicktasker"))}})),restoreArchivedTask:(e,t)=>jt(void 0,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/tasks/${e}/archive-restore`,method:"PATCH",headers:p()})}(e),t&&t(),i.oR.success((0,o.__)("Task restored","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore a task","quicktasker"))}})),removeTaskFromUser:(e,t,s)=>jt(void 0,void 0,void 0,(function*(){try{yield x(e,t),s&&s(),i.oR.success((0,o.__)("Task has been unassigned","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Task unassignment failed. Try again","quicktasker"))}})),changeTaskDoneStatus:(s,n,a)=>jt(void 0,void 0,void 0,(function*(){try{const t=n?(0,o.__)("Task marked as completed","quicktasker"):(0,o.__)("Task marked as incomplete","quicktasker"),r=yield function(e,t){return u()({path:`/wpqt/v1/tasks/${e}/done`,method:"PATCH",data:{done:t},headers:p()})}(s,n);a&&a(n),i.oR.success(t),e(r.data.executedAutomations,s)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change task status","quicktasker")),t(e)}}))}},yt=()=>Object.assign({},Ct),bt=(e,t)=>{var s,n,a,i;switch(t.type){case D:{const{taskToEdit:s,taskModalSettings:n}=t.payload;return Object.assign(Object.assign({},e),{taskModalOpen:!0,taskToEdit:s,targetStageId:s.stage_id,taskModalSettings:Object.assign(Object.assign({},e.taskModalSettings),n)})}case R:return yt();case B:{const a=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:[a,...null!==(n=null===(s=e.taskToEdit)||void 0===s?void 0:s.assigned_users)&&void 0!==n?n:[]]})})}case G:{const s=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{assigned_users:(null!==(i=null===(a=e.taskToEdit)||void 0===a?void 0:a.assigned_users)&&void 0!==i?i:[]).filter((e=>e.id!==s.id))})})}case U:{const{targetPipelineId:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,targetPipelineId:s})}case F:{const{stageToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{stageModalOpen:!0,stageToEdit:s})}case L:return yt();case M:return Object.assign(Object.assign({},e),{newPipelineModalOpen:!0});case z:{const{pipelineToEdit:s}=t.payload;return Object.assign(Object.assign({},e),{pipelineModalOpen:!0,pipelineToEdit:s})}case $:return yt();case"OPEN_ARCHIVE_TASK_MODAL":{const s=t.payload;return Object.assign(Object.assign({},e),{archiveTaskModalOpen:!0,archiveModalTask:s})}case"CLOSE_ARCHIVE_TASK_MODAL":return yt();case"OPEN_NEW_USER_MODAL":return Object.assign(Object.assign({},e),{userModalOpen:!0});case V:{const s=t.payload;return Object.assign(Object.assign({},e),{userModalOpen:!0,userToEdit:s})}case H:return yt();case K:return t.payload?Object.assign(Object.assign({},e),{userSettingsModalOpen:!0}):yt();case"CHANGE_TASK_DONE_STATUS":{const{done:s}=t.payload;return Object.assign(Object.assign({},e),{taskToEdit:Object.assign(Object.assign({},e.taskToEdit),{is_done:s})})}default:return e}},Ct={taskModalOpen:!1,targetStageId:"",taskToEdit:null,taskModalSettings:{allowToMarkTaskAsDone:!0},stageModalOpen:!1,stageToEdit:null,targetPipelineId:"",pipelineModalOpen:!1,newPipelineModalOpen:!1,pipelineToEdit:null,archiveTaskModalOpen:!1,archiveModalTask:null,userModalOpen:!1,userToEdit:null,userSettingsModalOpen:!1},St=(0,n.createContext)({state:Ct,modalDispatch:()=>{}}),Tt=({children:e})=>{const[t,s]=(0,n.useReducer)(bt,Ct);return(0,a.jsx)(St.Provider,{value:{state:t,modalDispatch:s},children:e})},Nt=(e,t)=>{switch(t.type){case ne:{const s=t.payload.map(De);return Object.assign(Object.assign({},e),{users:s})}case ae:{const s=t.payload,n=De(s);return Object.assign(Object.assign({},e),{users:[...e.users,n]})}case oe:{const s=t.payload,n=De(s),a=e.users.map((e=>e.id===n.id?n:e));return Object.assign(Object.assign({},e),{users:a})}case ce:{const{isActive:s,userId:n}=t.payload,a=e.users.map((e=>e.id===n?Object.assign(Object.assign({},e),{is_active:s}):e));return Object.assign(Object.assign({},e),{users:a})}case le:{const s=t.payload,n=e.users.map((e=>e.id===s?Object.assign(Object.assign({},e),{has_password:!1}):e));return Object.assign(Object.assign({},e),{users:n})}case re:{const s=t.payload,n=e.users.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{users:n})}case ie:{const s=t.payload;return Object.assign(Object.assign({},e),{usersSearchValue:s})}default:return e}};var Ot=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const At={users:[],usersSearchValue:""},Et=(0,n.createContext)({state:At,userDispatch:()=>{},updateUsers:()=>Ot(void 0,void 0,void 0,(function*(){}))}),Pt=({children:e})=>{const[t,s]=(0,n.useReducer)(Nt,At);return(0,n.useEffect)((()=>{const e=window.wpqt.initialUsers;s({type:ne,payload:e})}),[]),(0,a.jsx)(Et.Provider,{value:{state:t,userDispatch:s,updateUsers:()=>Ot(void 0,void 0,void 0,(function*(){try{const e=yield u()({path:"/wpqt/v1/users",method:"GET",headers:p()});s({type:ne,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch users","quicktasker"))}}))},children:e})};var It;!function(e){e.ACTIVE_PIPELINE="ACTIVE_PIPELINE",e.PIPELINES="PIPELINES",e.USER="USER"}(It||(It={}));const Dt=e=>{const[t,s]=(0,n.useState)(!1),a=(0,n.useRef)(null),{modalDispatch:i}=(0,n.useContext)(St),{dispatch:o}=(0,n.useContext)(wt),{pipelinesDispatch:r}=(0,n.useContext)(it),{userDispatch:c}=(0,n.useContext)(Et),l=()=>{i({type:e}),d()},d=()=>{a.current&&a.current.clearContent()};return{modalSaving:t,setModalSaving:s,modalContentRef:a,closeModal:l,handleSuccess:(e,t,n)=>{let a;switch(n){case It.PIPELINES:a=r;break;case It.ACTIVE_PIPELINE:a=o;break;case It.USER:a=c;break;default:a=o}s(!1),a({type:e,payload:t}),l()},handleError:e=>{s(!1),console.error(e)}}};var Rt,Ut=s(2922),Lt=s(6053),Ft=s(9828),Mt=s(540),zt=s(4576),$t=s(6197),Ht=s(7008);function Vt({id:e}){return(0,a.jsx)(Ht.m_,{id:e,className:"wpqt-bg-red-600",children:(0,a.jsx)("span",{children:"Tooltip content"})})}function Bt({icon:e,text:t,onClick:s=()=>{},className:n,tooltipId:i,tooltipText:o,loading:r=!1}){const c=o&&i,l=c?{"data-tooltip-id":i,"data-tooltip-content":o,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-main-border wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-bg-gray-100 wpqt-p-2 hover:wpqt-bg-white ${n}`,onClick:s,children:[e,t||r?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center wpqt-relative",children:[t&&(0,a.jsx)("span",{className:"wpqt-whitespace-nowrap "+(r?"wpqt-invisible":""),children:t}),r&&(0,a.jsx)(Ye,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]}):null,c&&(0,a.jsx)(Vt,{id:i})]}))}function Gt({icon:e,onClick:t=()=>{},className:s,loading:n=!1}){return(0,a.jsxs)("div",{className:`wpqt-main-border wpqt-p-1 wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-bg-gray-100 hover:wpqt-bg-white ${s}`,onClick:t,children:[(0,a.jsx)("div",{className:"wpqt-flex wpqt-items-center "+(n?"wpqt-invisible":""),children:e}),n&&(0,a.jsx)(Ye,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]})}function Kt({modalOpen:e,closeModal:t,children:s,size:n="sm"}){return(0,a.jsxs)(Ut.lG,{open:e,as:"div",className:"wpqt-relative wpqt-z-9999 focus:wpqt-outline-none",onClose:t,children:[(0,a.jsx)(Ut.Xi,{className:"wpqt-fixed wpqt-inset-0 wpqt-bg-black/40"}),(0,a.jsx)("div",{className:"wpqt-fixed wpqt-inset-0 wpqt-z-10 wpqt-w-screen wpqt-overflow-y-auto",children:(0,a.jsx)("div",{className:"wpqt-mt-[8vh] wpqt-flex wpqt-justify-center",children:(0,a.jsxs)(Ut.Lj,{transition:!0,className:`data-[closed]:wpqt-transform-[wpqt-scale(95%)] wpqt-relative wpqt-mt-[20px] wpqt-w-4/5 ${{sm:"wpqt-max-w-sm",md:"wpqt-max-w-lg",lg:"wpqt-max-w-4xl",xl:"wpqt-max-w-6xl"}[n]} wpqt-rounded-xl wpqt-bg-white wpqt-p-8 wpqt-backdrop-blur-2xl wpqt-duration-300 wpqt-ease-out data-[closed]:wpqt-opacity-0`,children:[(0,a.jsx)("div",{className:"wpqt-group wpqt-absolute wpqt-right-[-20px] wpqt-top-[-20px] wpqt-flex wpqt-h-[40px] wpqt-w-[40px] wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-rounded-full wpqt-border wpqt-border-solid wpqt-bg-white wpqt-text-qtBorder",onClick:t,children:(0,a.jsx)(zt.A,{className:"wpqt-icon-blue group-hover:wpqt-icon-red wpqt-size-5"})}),s]})})})]})}function Wt({children:e}){return(0,a.jsx)(Ut.L3,{as:"div",className:"wpqt-text-base/7 wpqt-font-medium wpqt-text-black",children:e})}function Qt({children:e}){return(0,a.jsx)(Lt.L,{children:e})}function Yt({label:e,children:t,tooltipId:s,tooltipText:n}){const i=s&&n,o=i?{"data-tooltip-id":s,"data-tooltip-content":n,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info","data-tooltip-place":"top-end"}:{};return(0,a.jsxs)(Ft.D,{className:"wpqt-mb-3",children:[(0,a.jsx)(Mt.JU,Object.assign({className:"wpqt-mb-2 wpqt-block wpqt-text-sm/6 wpqt-font-medium"},o,{children:e})),t,i&&(0,a.jsx)(Vt,{id:s})]})}function Xt({onSave:e,saveBtnText:t,loading:s=!1}){return(0,a.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-justify-end",children:(0,a.jsx)(Bt,{text:t,loading:s,icon:(0,a.jsx)($t.RZ0,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:e})})}!function(e){e.BUTTON="button",e.SUBMIT="submit",e.RESET="reset"}(Rt||(Rt={}));var Jt=s(1489),Zt=s(8448),es=s(8176),ts=s(1052);function ss(){const[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)(!1),[i,o]=(0,n.useState)(!1);return{loading1:e,loading2:s,setLoading1:t,setLoading2:a,loading3:i,setLoading3:o}}const ns=(e,t)=>{switch(t.type){case"SET_SITE_URL":{const s=t.payload;return Object.assign(Object.assign({},e),{siteURL:s})}case de:{const{siteURL:s,publicUserPageId:n,timezone:a,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r}=t.payload;return Object.assign(Object.assign({},e),{siteURL:s,publicUserPageId:n,timezone:a,isUserAllowedToDelete:i,userPageCustomStyles:o,pluginURL:r})}case ue:{const s=t.payload;return Object.assign(Object.assign({},e),{userPageCustomStyles:s})}default:return e}},as={siteURL:"",pluginURL:"",publicUserPageId:"",is_customFields:!1,timezone:"",isUserAllowedToDelete:!1,userPageCustomStyles:""},is=(0,n.createContext)({state:as,appDispatch:()=>{}}),os=({children:e})=>{const[t,s]=(0,n.useReducer)(ns,as);return(0,n.useEffect)((()=>{const e=window.wpqt.siteURL,t=window.wpqt.publicUserPageId,n=window.wpqt.timezone,a="1"===window.wpqt.isUserAllowedToDelete,i=window.wpqt.userPageCustomStyles,o=window.wpqt.pluginURL;s({type:de,payload:{siteURL:e,publicUserPageId:t,timezone:n,isUserAllowedToDelete:a,userPageCustomStyles:i,pluginURL:o}})}),[]),(0,a.jsx)(is.Provider,{value:{state:t,appDispatch:s},children:e})};var rs,cs,ls;!function(e){e.Text="text",e.Select="select",e.Checkbox="checkbox",e.Radio="radio",e.Datetime="datetime",e.File="file"}(rs||(rs={})),function(e){e.User="user",e.Pipeline="pipeline",e.Users="users",e.Task="task"}(cs||(cs={})),function(e){e.TEXT="text",e.PASSWORD="password"}(ls||(ls={}));const ds=(0,n.forwardRef)((({value:e,onChange:t,isAutoFocus:s,className:n="",wrapperClassName:i="",disabled:o=!1,type:r=ls.TEXT,loading:c=!1},l)=>(0,a.jsxs)("div",{className:`wpqt-inline-block wpqt-relative wpqt-mb-3 ${i}`,children:[(0,a.jsx)(et.p,{ref:l,autoFocus:s,className:`wpqt-block wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${n}`,value:e,disabled:o,onChange:e=>t(e.target.value),type:r}),c&&(0,a.jsx)(Ye,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"})]})));var us=s(1062),ps=s(4164);function hs({value:e,onChange:t,rowsCount:s=3,className:n}){return(0,a.jsx)(us.T,{className:(0,ps.$)("wpqt-border-1 wpqt-mb-3 wpqt-block wpqt-resize-none wpqt-rounded-lg wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6",`focus:wpqt-shadow-none focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${n}`),rows:s,value:e,onChange:e=>t(e.target.value)})}var ws=s(303);function vs({checked:e,handleChange:t}){return(0,a.jsx)(ws.A,{onChange:t,checked:e,uncheckedIcon:!1,checkedIcon:!1,height:20,width:44})}const xs=(e,t)=>{switch(t.type){case Te:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case Ne:{const{entityId:s,entityType:n}=t.payload;return Object.assign(Object.assign({},e),{entityId:s,entityType:n})}case be:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:s})}case Ce:{const s=t.payload;return Object.assign(Object.assign({},e),{customFields:[...e.customFields,s]})}case Se:{const s=t.payload,n=e.customFields.filter((e=>e.id!==s));return Object.assign(Object.assign({},e),{customFields:n})}default:return e}};const qs={customFields:[],loading:!0,entityId:"",entityType:null},ms=(0,n.createContext)({state:qs,customFieldsDispatch:()=>{},fetchCustomFields:()=>{}}),fs=({children:e,entityId:t,entityType:s})=>{const[r,c]=(0,n.useReducer)(xs,qs);(0,n.useEffect)((()=>{l()}),[]),(0,n.useEffect)((()=>{c({type:Ne,payload:{entityType:s,entityId:t}})}),[s,t]);const l=()=>{return e=void 0,n=void 0,r=function*(){try{c({type:Te,payload:!0});const e=yield q(t,s,!0);c({type:be,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch custom fields","quicktasker"))}finally{c({type:Te,payload:!1})}},new((a=void 0)||(a=Promise))((function(t,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}));var e,n,a,r};return(0,a.jsx)(ms.Provider,{value:{state:r,customFieldsDispatch:c,fetchCustomFields:l},children:e})};function gs({title:e,description:t,className:s=""}){return(0,a.jsxs)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center wpqt-h-full ${s}`,children:[(0,a.jsx)("h2",{className:"wpqt-font-semibold",children:e}),(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-4",children:t}),(0,a.jsx)("div",{className:"wpqt-text-blue-500 wpqt-font-semibold",children:(0,a.jsx)("a",{href:"https://payhip.com/b/84TLC",target:"_blank",rel:"noreferrer",children:(0,o.__)("Get the premium version","quicktasker")})})]})}var ks=s(9197),js=s(2767),_s=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ys(){return{addCustomField:(e,t,s,n,a,r)=>_s(this,void 0,void 0,(function*(){try{const i=yield function(e,t,s,n,a){return u()({path:"/wpqt/v1/custom-fields",method:"POST",data:{entityId:e,entityType:t,type:s,name:n,description:a},headers:p()})}(e,t,s,n,a);r&&r(i.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add a custom field","quicktasker"))}})),markCustomFieldAsDeleted:(e,t)=>_s(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/custom-fields/${e}`,method:"DELETE",headers:p()})}(e),t&&t()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to mark custom field as deleted","quicktasker"))}})),restoreCustomField:(e,t)=>_s(this,void 0,void 0,(function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/custom-fields/${e}/restore`,method:"PATCH",headers:p()})}(e);i.oR.success((0,o.__)("Custom field restored","quicktasker")),t&&t(s.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to restore custom field","quicktasker"))}})),updateCustomFieldValue:(e,t,s,n,a)=>_s(this,void 0,void 0,(function*(){try{yield function(e,t,s,n){return u()({path:`/wpqt/v1/custom-fields/${e}/value`,method:"PATCH",data:{value:t,entityId:String(s),entityType:n},headers:p()})}(e,t,s,n),a&&a()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to update custom field value","quicktasker"))}}))}}var bs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Cs({description:e}){const[t,s]=(0,n.useState)(""),[i,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(rs.Text),{addCustomField:p}=ys(),{state:{entityId:h,entityType:w},customFieldsDispatch:v}=(0,n.useContext)(ms),[x,q]=(0,n.useState)(!1),m=[{value:rs.Text,label:"Text"},{value:rs.Checkbox,label:"Checkbox"}];return(0,a.jsxs)("div",{className:"wpqt-mb-6 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)("h2",{children:(0,o.__)("Custom Fields","quicktasker")}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:e}),c&&(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Name","quicktasker")}),(0,a.jsx)(ds,{value:t,onChange:s})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Description","quicktasker")}),(0,a.jsx)(hs,{value:i,onChange:r})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Type","quicktasker")}),(0,a.jsx)(ct,{selectedOptionValue:d,options:m,onSelectionChange:e=>{u(e)},allSelector:!1})]})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,a.jsx)(Bt,{text:c?(0,o.__)("Cancel","quicktasker"):(0,o.__)("Add new custom field","quicktasker"),onClick:()=>l(!c),icon:c?(0,a.jsx)(ks.A,{className:"wpqt-icon-red wpqt-size-5"}):(0,a.jsx)(js.A,{className:"wpqt-icon-green wpqt-size-5"})}),c&&(0,a.jsx)(Bt,{text:(0,o.__)("Add","quicktasker"),onClick:()=>bs(this,void 0,void 0,(function*(){h&&w?(q(!0),yield p(h,w,d,t,i,(e=>{v({type:Ce,payload:e}),s(""),r(""),u(rs.Text),l(!1)})),q(!1)):console.error("Entity ID or Entity Type is missing")})),loading:x,icon:(0,a.jsx)(js.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]})}var Ss=s(72),Ts=s(2601),Ns=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Os({data:e,onSave:t,locationOfCustomFields:s,onDelete:i,actionLoading:r}){const{state:{isUserAllowedToDelete:c}}=(0,n.useContext)(is),l=e.entity_type===s,d=s===cs.Task||s===cs.User,u=e.entity_type===cs.Pipeline?"board":e.entity_type;return r?(0,a.jsx)(Je,{ovalSize:"24"}):(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-center wpqt-gap-2",children:[d&&(0,a.jsx)(Bt,{onClick:t,icon:(0,a.jsx)(Ts.A,{className:"wpqt-icon-green wpqt-size-4"}),tooltipId:`custom-field-${e.id}-update`,tooltipText:(0,o.__)("Edit custom field value","quicktasker")}),c&&(0,a.jsx)(Bt,Object.assign({onClick:()=>Ns(this,void 0,void 0,(function*(){l&&i()})),className:l?"":"!wpqt-cursor-not-allowed",icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-4"})},!l&&{tooltipId:`custom-field-${e.id}-delete`,tooltipText:(0,o.sprintf)((0,o.__)("This custom field is inherited from %s settings and can't be deleted here","quicktasker"),u)}))]})}var As=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Es({data:e}){const[t,s]=(0,n.useState)(""),{state:{entityType:i,entityId:o},customFieldsDispatch:r}=(0,n.useContext)(ms),{updateCustomFieldValue:c,markCustomFieldAsDeleted:l}=ys(),[d,u]=(0,n.useState)(!1);let p;switch((0,n.useEffect)((()=>{e.value&&s(e.value)}),[e.value]),e.type){case rs.Text:p=(0,a.jsx)(Ps,{data:e,value:t,onChange:s});break;case rs.Checkbox:p=(0,a.jsx)(Is,{data:e,value:t,onChange:s})}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{}),p,(0,a.jsx)(Os,{data:e,locationOfCustomFields:i,onSave:()=>As(this,void 0,void 0,(function*(){i===cs.User||i===cs.Task?(u(!0),yield c(e.id,t,o,i),u(!1)):console.error("Invalid entity type for saving custom field value")})),onDelete:()=>As(this,void 0,void 0,(function*(){u(!0),yield l(e.id,(()=>{r({type:Se,payload:e.id})})),u(!1)})),actionLoading:d})]})}function Ps({data:e,value:t,onChange:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center",children:[(0,a.jsx)(Ds,{name:e.name,description:e.description}),(0,a.jsx)(ds,{value:t,onChange:s})]})}function Is({data:e,value:t,onChange:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)(Ds,{name:e.name,description:e.description}),(0,a.jsx)("input",{type:"checkbox",checked:"true"===t,className:"!wpqt-block",onChange:e=>s(e.target.checked?"true":"false")})]})}function Ds({name:e,description:t=""}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-mb-1 wpqt-text-base wpqt-font-semibold",children:e}),t&&(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-italic",children:t})]})}function Rs(){const{state:{loading:e,customFields:t}}=(0,n.useContext)(ms),[s,i]=(0,n.useState)(!1);return e?(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Ye,{width:"36",height:"36"})}):t&&0===t.length?(0,a.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No related custom fields created","quicktasker")}):s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-my-4 wpqt-grid wpqt-grid-cols-[100px_1fr_100px] wpqt-items-center wpqt-gap-3",children:t.map((e=>(0,a.jsx)(Es,{data:e},e.id)))}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Bt,{text:(0,o.__)("Hide custom fields","quicktasker"),onClick:()=>i(!1),icon:(0,a.jsx)(Ss.A,{className:"wpqt-icon-red wpqt-size-5"})})})]}):(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Bt,{text:(0,o.__)("Show custom fields","quicktasker"),onClick:()=>i(!0),icon:(0,a.jsx)(Ss.A,{className:"wpqt-icon-blue wpqt-size-5"})})})}var Us=s(5066);const Ls={[cs.Pipeline]:(0,o.__)("Board","quicktasker"),[cs.Task]:(0,o.__)("Task","quicktasker"),[cs.User]:(0,o.__)("User","quicktasker"),[cs.Users]:(0,o.__)("Global users","quicktasker")};var Fs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ms({customField:e,refreshDeletedFields:t}){const{customFieldsDispatch:s}=(0,n.useContext)(ms),[i,r]=(0,n.useState)(!1),{restoreCustomField:c}=ys();return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Name:","quicktasker")})," ",e.name]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Description:","quicktasker")})," ",e.description]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"wpqt-font-semibold",children:(0,o.__)("Level:","quicktasker")})," ",Ls[e.entity_type]]}),(0,a.jsx)("div",{children:(0,a.jsx)(Gt,{onClick:()=>Fs(this,void 0,void 0,(function*(){r(!0),yield c(e.id,(e=>{s({type:Ce,payload:e}),t()})),r(!1)})),loading:i,icon:(0,a.jsx)(Us.HCd,{className:"wpqt-icon-green wpqt-size-5"})})})]})}var zs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function $s(){const[e,t]=(0,n.useState)(!1),[s,r]=(0,n.useState)(!0),[c,l]=(0,n.useState)(null),{state:{entityId:d,entityType:u}}=(0,n.useContext)(ms);(0,n.useEffect)((()=>{e&&p()}),[e]);const p=()=>zs(this,void 0,void 0,(function*(){if(d&&u)try{r(!0);const e=yield q(d,u,!1);l(e.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load deleted custom fields","quicktasker"))}finally{r(!1)}else console.error("Entity ID or Entity Type is missing")}));return(0,a.jsxs)("div",{className:"wpqt-my-3 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)("h2",{children:(0,o.__)("Custom Field recovery","quicktasker")}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:(0,o.__)("Deleted custom field by accident? No worries! You can recover it here.","quicktasker")}),e&&(0,a.jsx)("div",{className:"wpqt-mb-3",children:s?(0,a.jsx)(Je,{ovalSize:"36"}):c&&0===c.length?(0,a.jsx)("div",{className:"wpqt-text-center wpqt-font-semibold",children:(0,o.__)("No deleted custom fields","quicktasker")}):c&&c.length>0?(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:c.map((e=>(0,a.jsx)(Ms,{customField:e,refreshDeletedFields:p},e.id)))}):null}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:(0,a.jsx)(Bt,{text:e?(0,o.__)("Close recovery","quicktasker"):(0,o.__)("Open recovery","quicktasker"),onClick:()=>t(!e),icon:(0,a.jsx)(Us.HCd,{className:"wpqt-icon-green wpqt-size-5"})})})]})}const Hs={[cs.User]:(0,o.__)("Add user-specific custom fields. If you want to add custom fields to all users, please go to users settings.","quicktasker"),[cs.Users]:(0,o.__)("Add custom fields to all users. If you want to add custom fields to a specific user only, please go to that user settings.","quicktasker"),[cs.Pipeline]:(0,o.__)("Add board level custom fields.","quicktasker"),[cs.Task]:(0,o.__)("Add task-specific custom fields. If you want to add custom fields to all tasks in this board, please go to board settings.","quicktasker")},Vs={[cs.User]:(0,o.__)("Custom fields applied to this user, including both user-specific and global users fields.","quicktasker"),[cs.Users]:(0,o.__)("Global user custom field are applied to all users.","quicktasker"),[cs.Pipeline]:(0,o.__)("Board level fields are applied to all tasks in this board.","quicktasker"),[cs.Task]:(0,o.__)("Custom fields applied to this task, including both task-specific and board-level fields.","quicktasker")},Bs={[cs.User]:(0,o.__)("User custom fields","quicktasker"),[cs.Users]:(0,o.__)("Global users custom fields","quicktasker"),[cs.Pipeline]:(0,o.__)("Board custom fields","quicktasker"),[cs.Task]:(0,o.__)("Task custom fields","quicktasker")};function Gs({entityId:e,entityType:t}){const{state:{is_customFields:s}}=(0,n.useContext)(is),i=Hs[t],r=Bs[t],c=Vs[t];return(0,a.jsx)(a.Fragment,{children:s?(0,a.jsx)("div",{children:(0,a.jsxs)(fs,{entityId:e,entityType:t,children:[(0,a.jsx)(Cs,{description:i}),(0,a.jsx)("h2",{className:"wpqt-text-center",children:r}),(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center",children:c}),(0,a.jsx)(Rs,{}),(0,a.jsx)($s,{})]})}):(0,a.jsx)(gs,{title:(0,o.__)("Custom fields","quicktasker"),description:(0,o.__)("Premium feature to create and manage custom data fields. Allows to add extra data to tasks and users.","quicktasker")})})}var Ks=s(2792),Ws=s(6797),Qs=s(4403),Ys=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Xs({task:e,onUserAdd:t,onUserDelete:s}){const{state:{users:r}}=(0,n.useContext)(Et),{dispatch:c}=(0,n.useContext)(wt),[l,d]=(0,n.useState)(!1),h=r.filter((t=>{var s;return!(null!==(s=e.assigned_users)&&void 0!==s?s:[]).some((e=>e.id===t.id))}));return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-w-[320px] wpqt-flex-col",children:[(0,a.jsx)(Js,{sectionTitle:(0,o.__)("Assigned users","quicktasker"),users:e.assigned_users,onItemSelect:t=>Ys(this,void 0,void 0,(function*(){try{d(!0),yield x(t.id,e.id),c({type:O,payload:{taskId:e.id,userId:t.id}}),s(t)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to remove user","quicktasker"))}finally{d(!1)}})),ActionIcon:Ws.A,actionIconClasses:"wpqt-icon-red",noUsersText:(0,o.__)("No users assigned","quicktasker")}),(0,a.jsx)(Js,{sectionTitle:(0,o.__)("Assign a user","quicktasker"),users:h,onItemSelect:s=>Ys(this,void 0,void 0,(function*(){try{d(!0),yield(n=s.id,a=e.id,u()({path:`/wpqt/v1/users/${n}/tasks`,method:"POST",data:{task_id:a},headers:p()})),c({type:N,payload:{taskId:e.id,user:s}}),t(s)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to assign user","quicktasker"))}finally{d(!1)}var n,a})),actionIconClasses:"wpqt-icon-green",noUsersText:(0,o.__)("No users available to assign","quicktasker")}),l&&(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Ye,{width:"30",height:"30"})})]})}function Js({sectionTitle:e,onItemSelect:t=()=>{},users:s=[],ActionIcon:n=Qs.A,actionIconClasses:i,noUsersText:o}){return(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-text-lg",children:e}),s.map((e=>(0,a.jsxs)("div",{onClick:s=>{s.stopPropagation(),t(e)},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-px-2 wpqt-py-1 hover:wpqt-bg-gray-100",children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,a.jsx)("div",{children:e.name}),(0,a.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,a.jsx)(n,{className:`wpqt-ml-auto wpqt-size-5 ${i}`})]},e.id))),0===s.length&&(0,a.jsx)("div",{children:o})]})}var Zs=s(2185);function en({children:e,menuBtn:t,menuBtnClasses:s="",anchor:n="bottom end"}){return(0,a.jsxs)(Zs.W1,{children:[(0,a.jsx)(Zs.IU,{as:"div",className:`wpqt-cursor-pointer ${s}`,onClick:e=>e.stopPropagation(),children:({active:e})=>(0,a.jsx)(a.Fragment,{children:t({active:e})})}),(0,a.jsx)(Zs.c,{anchor:n,transition:!0,className:"wpqt-z-20 wpqt-origin-top wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-white wpqt-p-4 wpqt-transition wpqt-duration-200 wpqt-ease-out data-[closed]:wpqt-scale-95 data-[closed]:wpqt-opacity-0",children:e})]})}function tn({isActive:e,IconComponent:t}){return(0,a.jsx)(t,{className:"wpqt-size-6 wpqt-text-gray-400 hover:wpqt-text-qtBlueHover "+(e?"wpqt-text-qtBlueHover":"")})}function sn({text:e,onClick:t,icon:s,className:n,disabled:i=!1,id:o="",tooltipText:r="",loading:c=!1}){const l=""!==r&&""!==o?{"data-tooltip-id":o,"data-tooltip-content":r,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsx)(Zs.Dr,{children:(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-relative ${i?"wpqt-cursor-not-allowed wpqt-line-through":"wpqt-cursor-pointer hover:wpqt-underline"} ${n}`,onClick:e=>{!i&&t&&t(e)},children:[s,(0,a.jsx)("span",{className:c?"wpqt-invisible":"",children:e}),c&&(0,a.jsx)(Ye,{width:"16",height:"16",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-y-center wpqt-transform-x-center"}),(0,a.jsx)(Vt,{id:o})]}))})}function nn({task:e,onUserAdd:t=()=>{},onUserDelete:s=()=>{},menuBtnClasses:n=""}){const i=e.assigned_users&&e.assigned_users.length>0;return(0,a.jsx)(en,{menuBtnClasses:`wpqt-inline-flex ${n}`,anchor:"bottom start",menuBtn:()=>(0,a.jsxs)("div",{className:"wpqt-group wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1",children:[(0,a.jsx)(Ks.A,{className:`wpqt-mr-1 wpqt-size-5 ${i?"wpqt-text-blue-400":"wpqt-text-gray-300"} group-hover:wpqt-text-blue-600`}),e.assigned_users&&(0,a.jsx)("div",{children:e.assigned_users.map(((t,s)=>(0,a.jsxs)("span",{children:[t.name,s<e.assigned_users.length-1&&", "]},t.id)))})]}),children:(0,a.jsx)(Xs,{task:e,onUserAdd:t,onUserDelete:s})})}var an=s(1848);function on({tabs:e,tabsContent:t,tabClassName:s="",tabListClassName:n=""}){return(0,a.jsxs)(an.fu,{children:[(0,a.jsx)(an.wb,{className:`wpqt-mb-6 wpqt-flex wpqt-border-0 wpqt-border-b wpqt-border-solid wpqt-border-b-gray-300 ${n}`,children:e.map((e=>(0,a.jsx)(rn,{className:s,children:e},e)))}),(0,a.jsx)(an.T2,{children:t.map(((e,t)=>(0,a.jsx)(cn,{children:e},t)))})]})}function rn({children:e,className:t}){return(0,a.jsx)(an.oz,{as:"div",className:`wpqt-flex-1 wpqt-cursor-pointer wpqt-p-1 wpqt-pb-[10px] wpqt-text-center wpqt-text-lg data-[selected]:wpqt-border-b-2 data-[selected]:wpqt-border-l-0 data-[selected]:wpqt-border-r-0 data-[selected]:wpqt-border-t-0 data-[selected]:wpqt-border-solid data-[selected]:wpqt-border-b-blue-500 ${t}`,children:e})}function cn({children:e}){return(0,a.jsx)(an.Kp,{children:e})}var ln=s(4353),dn=s.n(ln),un=s(8569),pn=s.n(un),hn=s(3826),wn=s.n(hn);dn().extend(wn()),dn().extend(pn());const vn=()=>{const{state:{timezone:e}}=(0,n.useContext)(is);return{convertToWPTimezone:t=>((e,t)=>{try{return dn().utc(e).tz(t).format("MMMM D, YYYY HH:mm")}catch(t){return console.error("Error: ",t),e+" (UTC)"}})(t,e)}},xn={[Fe.Admin]:(0,o.__)("Admin","quicktasker"),[Fe.Automation]:(0,o.__)("Automation","quicktasker"),[Fe.System]:(0,o.__)("System","quicktasker"),[Fe.WPQTUser]:"Quicktasker"},qn=({log:e})=>{const{convertToWPTimezone:t}=vn(),s=xn[e.created_by];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,a.jsx)("div",{className:"wpqt-text-center",children:s})]}),(0,a.jsx)("div",{children:e.text}),(0,a.jsx)("div",{children:t(e.created_at)})]})};var mn=s(3338),fn=s(3211),gn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function kn({typeId:e,fetchData:t,renderItem:s,noDataMessage:i,explanation:o,onAdd:r=()=>gn(this,void 0,void 0,(function*(){})),enableAdd:c=!1}){const[l,d]=(0,n.useState)(null),[u,p]=(0,n.useState)(""),[h,w]=(0,n.useState)(!0),[v,x]=(0,n.useState)(!1);(0,n.useEffect)((()=>{q()}),[e]);const q=()=>gn(this,void 0,void 0,(function*(){w(!0);const e=yield t();e&&d(e),w(!1)}));return null===l?(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Ye,{width:"30",height:"30"})}):(0,a.jsxs)("div",{children:[o&&(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center wpqt-font-semibold",children:o}),0===l.length&&(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-text-center",children:i}),l.length>0&&(0,a.jsx)("div",{className:"wpqt-mb-[28px] wpqt-mt-[56px] wpqt-logs-grid",children:l.map((e=>s(e)))}),(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-justify-center",children:(0,a.jsx)(jn,{isLoading:h,refreshComemnts:q})}),c&&(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsxs)("div",{className:"wpqt-w-2/3",children:[(0,a.jsx)(hs,{rowsCount:3,value:u,onChange:e=>p(e),className:"wpqt-mb-4 wpqt-w-full"}),(0,a.jsx)(Bt,{text:"Add comment",loading:v,onClick:()=>gn(this,void 0,void 0,(function*(){x(!0);const e=yield r(u);e&&(d((t=>t?[...t,e]:[e])),p("")),x(!1)})),className:"wpqt-float-right",icon:(0,a.jsx)(mn.A,{className:"wpqt-icon-blue wpqt-size-5"})})]})})]})}function jn({isLoading:e,refreshComemnts:t}){return(0,a.jsx)(a.Fragment,{children:e?(0,a.jsx)(Ye,{width:"32",height:"32"}):(0,a.jsx)(fn.A,{className:"wpqt-icon-blue wpqt-size-8 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:t})})}function _n({item:e}){const{convertToWPTimezone:t}=vn();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-text-center wpqt-mb-1",children:e.author_name}),(0,a.jsx)("div",{className:"wpqt-text-center",children:e.is_admin_comment?(0,o.__)("Admin","quicktasker"):(0,o.__)("QuickTasker","quicktasker")})]}),(0,a.jsx)("div",{children:e.text}),(0,a.jsx)("div",{children:t(e.created_at)})]})}var yn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function bn({taskId:e}){return(0,a.jsx)(kn,{typeId:e,fetchData:()=>yn(this,void 0,void 0,(function*(){try{return(yield v(e,Le.Task)).data}catch(e){console.error(e),i.oR.error("Failed to get log")}})),renderItem:e=>(0,a.jsx)(qn,{log:e}),noDataMessage:"No logs available",explanation:"Logs can be seen only by WordPress users (with required permissions)"})}var Cn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Sn(){return{addComment:(e,t,s,n)=>Cn(this,void 0,void 0,(function*(){try{const a=yield w(e,t,s,n);return i.oR.success((0,o.__)("Comment added","quicktasker")),a.data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add comment","quicktasker"))}}))}}const Tn=e=>Object.assign(Object.assign({},e),{is_admin_comment:"1"===e.is_admin_comment});var Nn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function On({taskId:e}){const{addComment:t}=Sn();return(0,a.jsx)(kn,{typeId:e,fetchData:()=>Nn(this,void 0,void 0,(function*(){try{return(yield h(e,Le.Task,!0)).data.map(Tn)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>Nn(this,void 0,void 0,(function*(){const n=yield t(e,Le.Task,!0,s);if(n)return Tn(n)})),renderItem:e=>(0,a.jsx)(_n,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed only by WordPress users (with required permissions).",enableAdd:!0})}var An=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function En({taskId:e}){const{addComment:t}=Sn();return(0,a.jsx)(kn,{typeId:e,fetchData:()=>An(this,void 0,void 0,(function*(){try{return(yield h(e,Le.Task,!1)).data.map(Tn)}catch(e){console.error(e),i.oR.error("Failed to load comments")}})),onAdd:s=>An(this,void 0,void 0,(function*(){const n=yield t(e,Le.Task,!1,s);if(n)return Tn(n)})),renderItem:e=>(0,a.jsx)(_n,{item:e}),noDataMessage:"No comments available",explanation:"Comments that can be added and viewed by WordPress users (with required permissions) and QuickTasker users who have been assigned to the task.",enableAdd:!0})}function Pn({task:e}){return(0,a.jsx)(on,{tabs:["Private comments","Public comments","Logs"],tabsContent:[(0,a.jsx)(On,{taskId:e.id},1),(0,a.jsx)(En,{taskId:e.id},2),(0,a.jsx)(bn,{taskId:e.id},3)]})}var In=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Dn=(0,n.forwardRef)((({taskModalSaving:e,editTask:t,deleteTask:s},i)=>{const{state:{taskToEdit:r,taskModalSettings:c},modalDispatch:l}=(0,n.useContext)(St),{state:{isUserAllowedToDelete:d}}=(0,n.useContext)(is),{state:{activePipeline:u},fetchAndSetPipelineData:p}=(0,n.useContext)(wt),{archiveDispatch:h}=(0,n.useContext)(Ke),[w,v]=(0,n.useState)(""),[x,q]=(0,n.useState)(""),[m,f]=(0,n.useState)(!1),{archiveTask:g,restoreArchivedTask:k}=_t(),{loading1:j,setLoading1:_,loading2:y,setLoading2:b}=ss(),C=null==r?void 0:r.is_archived,S=null!==(null==r?void 0:r.pipeline_name);(0,n.useEffect)((()=>{r&&(v(r.name),q(r.description),f(r.free_for_all))}),[r]);const T=()=>{v(""),q("")};return(0,n.useImperativeHandle)(i,(()=>({clearContent:T}))),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,a.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsxs)(Qt,{children:[(0,a.jsx)(Yt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(ds,{isAutoFocus:!0,value:w,onChange:e=>v(e)})}),(0,a.jsx)(Yt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(hs,{rowsCount:3,value:x,onChange:e=>q(e)})}),(0,a.jsx)(Yt,{label:(0,o.__)("Assigned users","quicktasker"),children:(0,a.jsx)(nn,{task:r,onUserAdd:e=>{l({type:B,payload:e})},onUserDelete:e=>{l({type:G,payload:e})}})}),(0,a.jsx)(Yt,{label:(0,o.__)("Free for all task","quicktasker"),tooltipId:`free-for-all-${r.id}-tooltip`,tooltipText:(0,o.__)("When enabled, all QuickTasker users have the ability to self-assign or unassign this task.","quicktasker"),children:(0,a.jsx)(vs,{checked:m,handleChange:f})}),c.allowToMarkTaskAsDone&&(0,a.jsx)(Rn,{taskId:r.id,isCompleted:r.is_done})]}),(0,a.jsx)("div",{children:(0,a.jsx)(Gs,{entityId:r.id,entityType:cs.Task})})]}),(0,a.jsx)("div",{className:"wpqt-mt-7 md:wpqt-pr-3",children:(0,a.jsx)(Pn,{task:r})})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[C&&S&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(Jt.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Restore task","quicktasker"),onClick:()=>{k(r.id,(()=>{l({type:R}),h({type:X,payload:r.id})}))}}),!C&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(Zt.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("Archive task","quicktasker"),loading:y,onClick:()=>{b(!0),g(r.id,(()=>{l({type:R}),p(u.id),b(!1)}))}}),d&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete task","quicktasker"),loading:j,onClick:()=>In(void 0,void 0,void 0,(function*(){_(!0),yield s(r),l({type:R}),_(!1)}))})]})]}),(0,a.jsx)(Xt,{onSave:()=>{r&&t(Object.assign(Object.assign({},r),{name:w,description:x,free_for_all:m}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));function Rn({isCompleted:e,taskId:t}){const{modalDispatch:s}=(0,n.useContext)(St),{dispatch:i}=(0,n.useContext)(wt),[r,c]=(0,n.useState)(!1),{changeTaskDoneStatus:l}=_t();return(0,a.jsx)(Yt,{label:e?(0,o.__)("Task completed","quicktasker"):(0,o.__)("Task not completed","quicktasker"),children:r?(0,a.jsx)(Ye,{width:"24",height:"24"}):(0,a.jsx)(ts.A,{onClick:()=>In(this,void 0,void 0,(function*(){c(!0),yield l(t,!e,(e=>{s({type:A,payload:{done:e}}),i({type:A,payload:{taskId:t,done:e}})})),c(!1)})),className:`wpqt-size-6 ${e?"wpqt-icon-green":"wpqt-text-gray-300"} wpqt-cursor-pointer`})})}var Un=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ln({editTaskCallback:e,deleteTaskCallback:t}){const{state:{taskModalOpen:s}}=(0,n.useContext)(St),{deleteTask:i}=_t(),{modalSaving:o,setModalSaving:r,modalContentRef:c,closeModal:l,handleSuccess:d,handleError:h}=Dt(R);return(0,a.jsx)(Kt,{modalOpen:s,closeModal:l,size:"xl",children:(0,a.jsx)(Dn,{ref:c,editTask:t=>Un(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e){return u()({path:`/wpqt/v1/tasks/${e.id}`,method:"PATCH",data:{id:e.id,name:e.name,description:e.description,freeForAll:e.free_for_all},headers:p()})}(t);d(_,s.data,It.ACTIVE_PIPELINE),e&&e(s.data)}catch(e){h(e)}})),deleteTask:e=>Un(this,void 0,void 0,(function*(){i(e.id,(()=>{t&&t(e)}))})),taskModalSaving:o})})}function Fn({text:e=(0,o.__)("No results found","quicktasker")}){return(0,a.jsx)("div",{className:"wpqt-font-semibold wpqt-text-center wpqt-text-xl",children:e})}const Mn=()=>{const{state:{archiveSearchValue:e,archiveFilteredPipelineId:t,archiveTaskDoneFilter:s}}=(0,n.useContext)(Ke);return{filterArchive:n=>{const a=n.name.toLowerCase().includes(e.toLowerCase())||n.description&&n.description.toLowerCase().includes(e.toLowerCase()),i=!t||("DELETED"===t?null===n.pipeline_name:n.pipeline_id===t),o=s===Me.All||s===Me.Completed&&n.is_done||s===Me.NotCompleted&&!n.is_done;return a&&i&&o}}};var zn=s(3033);function $n({className:e,onClick:t,title:s,description:n,children:i,dropdown:o,titleClassName:r=""}){const c=void 0!==o;return(0,a.jsxs)("div",{className:(0,ps.$)("wpqt-relative wpqt-flex wpqt-flex-col wpqt-rounded wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-4",c&&"wpqt-pr-[24px]",e),onClick:t,children:[(0,a.jsxs)("div",{className:"wpqt-mb-3",children:[(0,a.jsx)("div",{className:`wpqt-text-lg ${r}`,children:s}),n&&(0,a.jsx)("div",{className:"wpqt-italic wpqt-text-gray-500",children:n})]}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-h-full",children:i}),c&&(0,a.jsx)("div",{className:"wpqt-absolute wpqt-right-2 wpqt-top-1 wpqt-z-10",children:o})]})}function Hn({label:e,value:t,valueClassName:s="",valueLink:n,icon:i,onClick:o=()=>{},className:r="",labelClassName:c=""}){return(0,a.jsxs)("div",{className:`wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center ${r}`,onClick:o,children:[i&&i,(0,a.jsx)("div",{className:c,children:t?`${e}:`:e}),(0,a.jsx)("div",{className:`${s}`,children:n?(0,a.jsx)("a",{href:n,target:"_blank",className:"wpqt-text-qtTextBlue wpqt-no-underline",rel:"noreferrer",onClick:e=>e.stopPropagation(),children:t}):t})]})}var Vn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Bn({task:e,onDoneStatusChange:t,className:s=""}){const{changeTaskDoneStatus:i}=_t(),[o,r]=(0,n.useState)(!1),c=e.is_done,l=s=>Vn(this,void 0,void 0,(function*(){r(!0),yield i(e.id,s,(s=>{t(e.id,s)})),r(!1)}));return o?(0,a.jsx)(Je,{ovalSize:"24",className:"wpqt-mt-auto"}):(0,a.jsx)("div",{className:`wpqt-flex wpqt-justify-center wpqt-mt-auto ${s}`,children:c?(0,a.jsx)(ts.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,a.jsx)(ts.A,{className:"wpqt-size-6 wpqt-text-gray-300",onClick:e=>{e.stopPropagation(),l(!0)}})})}var Gn=s(6436),Kn=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Wn({task:e}){const{state:{isUserAllowedToDelete:t}}=(0,n.useContext)(is),{archiveDispatch:s}=(0,n.useContext)(Ke),{deleteTask:i,restoreArchivedTask:o}=_t(),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),u=null!==e.pipeline_name;return(0,a.jsxs)(en,{menuBtn:({active:e})=>(0,a.jsx)(tn,{isActive:e,IconComponent:Gn.A}),children:[(0,a.jsx)(sn,{text:"View task",icon:(0,a.jsx)(Ss.A,{className:"wpqt-icon-blue wpqt-size-4"})}),(0,a.jsx)(sn,{text:"Restore task",loading:r,icon:(0,a.jsx)(Jt.A,{className:"wpqt-icon-green wpqt-size-4"}),disabled:!u,id:`restore-task-${e.id}-dropdown-item`,tooltipText:"Task cannot be restored because the board has been deleted.",onClick:t=>Kn(this,void 0,void 0,(function*(){t.stopPropagation(),c(!0),yield o(e.id,(()=>{s({type:X,payload:e.id})})),c(!1)}))}),t&&(0,a.jsx)(sn,{text:"Delete",loading:l,icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Kn(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield i(e.id,(()=>{s({type:X,payload:e.id})})),d(!1)})),className:"!wpqt-mb-0"})]})}function Qn({task:e}){const{modalDispatch:t}=(0,n.useContext)(St),{archiveDispatch:s}=(0,n.useContext)(Ke);return(0,a.jsxs)($n,{title:e.name,description:e.description,dropdown:(0,a.jsx)(Wn,{task:e}),className:"wpqt-cursor-pointer",onClick:()=>{t({type:D,payload:{taskToEdit:e}})},children:[(0,a.jsx)(Hn,{label:(0,o.__)("Board","quicktasker"),value:e.pipeline_name?e.pipeline_name:(0,o.__)("Board is deleted!","quicktasker"),icon:(0,a.jsx)(zn.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(nn,{menuBtnClasses:"wpqt-self-start",task:e,onUserAdd:t=>{s({type:J,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{s({type:Z,payload:{taskId:e.id,user:t}})}}),(0,a.jsx)(Bn,{task:e,onDoneStatusChange:(e,t)=>{s({type:ee,payload:{taskId:e,done:t}})}})]})}function Yn(){var e;const{state:{archivedTasks:t=[]}}=(0,n.useContext)(Ke),{filterArchive:s}=Mn(),i=null!==(e=null==t?void 0:t.filter(s))&&void 0!==e?e:[];return t&&0===t.length?(0,a.jsx)(Fn,{text:(0,o.__)("No tasks archived","quicktasker")}):i&&0===i.length?(0,a.jsx)(Fn,{}):(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"wpqt-card-grid",children:i.map((e=>(0,a.jsx)(Qn,{task:e},e.id)))})})}function Xn(){const{state:{archivedTasks:e},archiveDispatch:t}=(0,n.useContext)(Ke);return e?(0,a.jsxs)("div",{children:[(0,a.jsx)(ut,{}),(0,a.jsx)(Yn,{}),(0,a.jsx)(Ln,{editTaskCallback:e=>{t({type:te,payload:e})},deleteTaskCallback:e=>{t({type:X,payload:e.id})}})]}):(0,a.jsx)(Je,{className:"wpqt-h-[200px]"})}function Jn(){return(0,a.jsx)(We,{children:(0,a.jsxs)(Ze,{children:[(0,a.jsx)(l,{description:(0,o.__)("Archived tasks management page.","quicktasker"),children:(0,o.__)("Archive","quicktasker")}),(0,a.jsx)(Xn,{})]})})}const Zn=()=>{const{state:{pluginURL:e}}=(0,n.useContext)(is);return(0,a.jsxs)(Ze,{children:[(0,a.jsx)(l,{description:(0,o.__)("Reading material about QuickTasker features and usage.","quicktasker"),children:(0,o.__)("Guide","quicktasker")}),(0,a.jsx)("div",{children:(0,a.jsx)("a",{target:"_blank",rel:"noreferrer",href:e+"help/index.html",children:(0,o.__)("View Guide","quicktasker")})})]})};var ea=s(4175);const ta=({filterSettings:e,setFilterSettings:t})=>{const{state:{pipelines:s}}=(0,n.useContext)(it),[i,r]=(0,n.useState)(e);return(0,a.jsxs)(dt,{title:(0,o.__)("Logs filtering","quicktasker"),children:[(0,a.jsx)(ct,{allSelector:!1,selectedOptionValue:i.type,options:[{label:(0,o.__)("All types","quicktasker"),value:na.All},{label:(0,o.__)("Board","quicktasker"),value:na.Pipeline},{label:(0,o.__)("Stage","quicktasker"),value:na.Stage},{label:(0,o.__)("Task","quicktasker"),value:na.Task}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{type:e,typeId:""}))}}),i.type===na.Pipeline&&(0,a.jsx)(ct,{allSelector:!0,selectedOptionValue:i.typeId,options:s.map((e=>({label:e.name,value:e.id}))),onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{typeId:e}))}}),(0,a.jsx)(ct,{allSelector:!1,selectedOptionValue:i.createdBy,options:[{label:(0,o.__)("Everyone","quicktasker"),value:aa.All},{label:(0,o.__)("Admin","quicktasker"),value:aa.Admin},{label:"QuickTasker",value:aa.Quicktasker}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{createdBy:e}))}}),(0,a.jsx)(ct,{allSelector:!1,selectedOptionValue:i.numberOfLogs,options:[{label:(0,o.__)("Show 100","quicktasker"),value:oa.Hundred},{label:(0,o.__)("Show 200","quicktasker"),value:oa.TwoHundred},{label:"Show 500",value:oa.FiveHundred},{label:"Show all",value:oa.All}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{numberOfLogs:e}))}}),(0,a.jsx)(ct,{allSelector:!1,selectedOptionValue:i.order,options:[{label:(0,o.__)("ASC","quicktasker"),value:ia.Asc},{label:(0,o.__)("DESC","quicktasker"),value:ia.Desc}],onSelectionChange:e=>{r(Object.assign(Object.assign({},i),{order:e}))}}),(0,a.jsx)(Bt,{text:(0,o.__)("Apply filter","quicktasker"),icon:(0,a.jsx)(ea.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:()=>t(i)})]})},sa=({logs:e,loading:t})=>t?(0,a.jsx)(Je,{ovalSize:"64",className:"wpqt-mt-12"}):0===e.length?(0,a.jsx)(Fn,{text:(0,o.__)("No logs found","quicktasker")}):(0,a.jsx)("div",{className:"wpqt-logs-grid",children:e.map((e=>(0,a.jsx)(qn,{log:e},e.id)))});var na,aa,ia,oa,ra=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};!function(e){e.Pipeline="pipeline",e.Stage="stage",e.Task="task",e.All="all"}(na||(na={})),function(e){e.Admin="admin",e.Quicktasker="quicktasker_user",e.All="all"}(aa||(aa={})),function(e){e.Asc="asc",e.Desc="desc"}(ia||(ia={})),function(e){e.Hundred="100",e.TwoHundred="200",e.FiveHundred="500",e.All="all"}(oa||(oa={}));const ca=()=>{const[e,t]=(0,n.useState)([]),[s,o]=(0,n.useState)({numberOfLogs:oa.Hundred,type:na.All,typeId:"",createdBy:aa.All,order:ia.Desc}),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!0);(0,n.useEffect)((()=>{l&&(h(),d(!1))}),[s,l]);const h=()=>ra(void 0,void 0,void 0,(function*(){try{c(!0);const e=Object.assign({},s);e.numberOfLogs===oa.All&&delete e.numberOfLogs,e.type===na.All&&delete e.type,""===e.typeId&&delete e.typeId,e.createdBy===aa.All&&delete e.createdBy;const n=yield function(e){const t=new URLSearchParams(Object.entries(e).reduce(((e,[t,s])=>(e[t]=String(s),e)),{}));return u()({path:`/wpqt/v1/global-logs?${t.toString()}`,method:"GET",headers:p()})}(e);t(n.data)}catch(e){console.error(e),i.oR.error("Failed to fetch logs")}finally{c(!1)}}));return(0,a.jsxs)("div",{children:[(0,a.jsx)(ta,{filterSettings:s,setFilterSettings:e=>ra(void 0,void 0,void 0,(function*(){o(e),d(!0)}))}),(0,a.jsx)(sa,{logs:e,loading:r})]})},la=()=>(0,a.jsxs)(Ze,{children:[(0,a.jsx)(l,{description:(0,o.__)("The logs page where you can see all logs and filter them.","quicktasker"),children:(0,o.__)("Logs","quicktasker")}),(0,a.jsx)(ca,{})]});var da=s(6708);function ua({overviewFilter:e,onCreationDateChange:t,onDoneDateChange:s}){const n=e=>e instanceof Date?dn()(e).format("YYYY-MM-DD"):"";return(0,a.jsx)("div",{children:(0,a.jsxs)(dt,{title:(0,o.__)("Statistics filtering","quicktasker"),titleClassName:"wpqt-text-center",childrenClassName:"wpqt-gap-6 wpqt-justify-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task creation date","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("(Filter tasks that have creation date equal or bigger than)","quicktasker")})]}),(0,a.jsx)(da.A,{onChange:e=>{const s=n(e);t(s)},value:e.taskCreationDate,format:"y-MM-dd",id:"taskCreationDate"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-font-semibold",children:(0,o.__)("Task done date","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("(Filter tasks that have done date equal or smaller than)","quicktasker")})]}),(0,a.jsx)(da.A,{onChange:e=>{const t=n(e);s(t)},value:e.taskDoneDate,format:"y-MM-dd",id:"taskCreationDate"})]})]})})}var pa=s(2298);function ha(e){const t=e.slice(1).some((e=>e[1]>0));return e.length>1&&t}function wa({text:e}){return(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-items-center wpqt-h-[400px] wpqt-w-[500px] wpqt-font-semibold",children:e})}function va({pipelineOverviewData:e,options:t,width:s}){var n,i;const r=[["Archived tasks","Task Count"],["Archived tasks",parseInt(null!==(n=null==e?void 0:e.archivedTasksCount)&&void 0!==n?n:"0")||0],["Not archived tasks",parseInt(null!==(i=null==e?void 0:e.notArchivedTasksCount)&&void 0!==i?i:"0")||0]];return ha(r)?(0,a.jsx)(pa.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Archived tasks"}),width:s,height:"400px"}):(0,a.jsx)(wa,{text:(0,o.__)("Not enough data to display archived tasks chart","quicktasker")})}function xa({pipelineOverviewData:e,options:t,width:s}){var n;const i=[["Stage","Task Count"],...null!==(n=null==e?void 0:e.stages.map((e=>[e.name,parseInt(e.tasksCount)||0])))&&void 0!==n?n:[]];return ha(i)?(0,a.jsx)(pa.t1,{chartType:"PieChart",data:i,options:Object.assign(Object.assign({},t),{title:"Task distribution by stages"}),width:s,height:"400px"}):(0,a.jsx)(wa,{text:(0,o.__)("Not enough data to display task distribution by stages chart","quicktasker")})}function qa({pipelineOverviewData:e,options:t,width:s}){var n,i;const r=[["Task status","Task Count"],["Done",parseInt(null!==(n=null==e?void 0:e.doneTasksCount)&&void 0!==n?n:"0")||0],["Not Done",parseInt(null!==(i=null==e?void 0:e.notDoneTasksCount)&&void 0!==i?i:"0")||0]];return ha(r)?(0,a.jsx)(pa.t1,{chartType:"PieChart",data:r,options:Object.assign(Object.assign({},t),{title:"Task status"}),width:s,height:"400px"}):(0,a.jsx)(wa,{text:(0,o.__)("Not enough data to display task status chart","quicktasker")})}var ma=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const fa={legend:{position:"left",alignment:"center",textStyle:{color:"#233238",fontSize:14}}};function ga({pipeline:e,overviewFilter:t}){const[s,i]=(0,n.useState)(null),[o,r]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{(()=>{ma(this,void 0,void 0,(function*(){try{r(!0);const s=yield function(e,t){const s=new URLSearchParams({taskStartDate:t.taskCreationDate||"",taskDoneDate:t.taskDoneDate||"",taskAssignees:t.taskAssignees.join(",")});return u()({path:`/wpqt/v1/pipelines/${e}/overview?${s.toString()}`,method:"GET",headers:p()})}(e.id,t);i(s.data)}catch(e){console.error(e)}finally{r(!1)}}))})()}),[e.id,t]),o||!s?(0,a.jsx)(Je,{ovalSize:"48"}):(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-wrap wpqt-justify-center xl:wpqt-justify-start",children:[(0,a.jsx)(xa,{pipelineOverviewData:s,options:fa,width:"500px"}),(0,a.jsx)(qa,{pipelineOverviewData:s,options:fa,width:"500px"}),(0,a.jsx)(va,{pipelineOverviewData:s,options:fa,width:"500px"})]})}function ka({pipeline:e}){const[t,s]=(0,n.useState)({taskCreationDate:null,taskDoneDate:null,taskAssignees:[]});return(0,a.jsxs)("div",{children:[(0,a.jsx)(ua,{overviewFilter:t,onCreationDateChange:e=>{s(Object.assign(Object.assign({},t),{taskCreationDate:e}))},onDoneDateChange:e=>{s(Object.assign(Object.assign({},t),{taskDoneDate:e}))}}),(0,a.jsx)(ga,{pipeline:e,overviewFilter:t})]})}function ja(){const{state:{pipelines:e}}=(0,n.useContext)(it),t=e.map((e=>e.name)),s=e.map((e=>(0,a.jsx)(ka,{pipeline:e},e.id)));return(0,a.jsxs)(Ze,{children:[(0,a.jsx)(l,{description:(0,o.__)("Get overview of the tasks.","quicktasker"),children:(0,o.__)("Overview","quicktasker")}),(0,a.jsx)(on,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}const _a=(0,n.forwardRef)((({addPipeline:e,modalSaving:t},s)=>{const[i,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(""),d=()=>{r(""),l("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:d}))),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(Qt,{children:[(0,a.jsx)(Yt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(ds,{isAutoFocus:!0,value:i,onChange:e=>r(e)})}),(0,a.jsx)(Yt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(hs,{rowsCount:3,value:c,onChange:e=>l(e)})})]}),(0,a.jsx)(Xt,{onSave:()=>{e(i,c)},loading:t,saveBtnText:(0,o.__)("Add board","quicktasker")})]})}));function ya(){const{state:{newPipelineModalOpen:e}}=(0,n.useContext)(St),{fetchAndSetPipelineData:t}=(0,n.useContext)(wt),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=Dt($);return(0,a.jsx)(Kt,{modalOpen:e,closeModal:r,children:(0,a.jsx)(_a,{ref:o,addPipeline:(e,s)=>{return n=this,a=void 0,r=function*(){try{i(!0);const o=yield(n=e,a=s,u()({path:"/wpqt/v1/pipelines",method:"POST",data:{name:n,description:a},headers:p()}));c(b,o.data,It.PIPELINES),t(o.data.id)}catch(e){l(e)}var n,a},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{c(r.next(e))}catch(e){t(e)}}function i(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,i)}c((r=r.apply(n,a||[])).next())}));var n,a,o,r},modalSaving:s,setModalSaving:i})})}function ba(){return{deletePipeline:(e,t)=>{return s=this,n=void 0,r=function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}`,method:"DELETE",headers:p()})}(e);t&&t(s.data.deletedPipelineId,s.data.pipelineIdToLoad)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete board","quicktasker"))}},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{c(r.next(e))}catch(e){t(e)}}function o(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(i,o)}c((r=r.apply(s,n||[])).next())}));var s,n,a,r}}}const Ca=(0,n.forwardRef)((({editPipeline:e,modalSaving:t},s)=>{const{state:{pipelineToEdit:r},modalDispatch:c}=(0,n.useContext)(St),{fetchAndSetPipelineData:l,dispatch:d}=(0,n.useContext)(wt),{pipelinesDispatch:u}=(0,n.useContext)(it),{deletePipeline:p}=ba(),[h,w]=(0,n.useState)(""),[v,x]=(0,n.useState)(""),{loading1:q,setLoading1:m}=ss();(0,n.useEffect)((()=>{r&&(w(r.name),x(r.description||""))}),[r]);const f=()=>{w(""),x("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:f}))),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsx)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:(0,a.jsxs)("div",{className:"wpqt-mb-5 wpqt-grid wpqt-grid-cols-1 wpqt-gap-4 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsxs)(Qt,{children:[(0,a.jsx)(Yt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(ds,{isAutoFocus:!0,value:h,onChange:e=>w(e)})}),(0,a.jsx)(Yt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(hs,{rowsCount:3,value:v,onChange:e=>x(e)})})]}),(0,a.jsx)(Gs,{entityId:r.id,entityType:cs.Pipeline})]})}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:(0,a.jsx)(Bt,{icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:q,text:(0,o.__)("Delete board","quicktasker"),onClick:()=>{r&&(m(!0),p(r.id,((e,t)=>{c({type:$}),m(!1),i.oR.success((0,o.__)("Board deleted","quicktasker")),u({type:E,payload:e}),null!==t?(u({type:S,payload:t}),l(t)):d({type:P})})))}})})]}),(0,a.jsx)(Xt,{onSave:()=>{r&&e(Object.assign(Object.assign({},r),{name:h,description:v}))},loading:t,saveBtnText:(0,o.__)("Save","quicktasker")})]}):null}));function Sa(){const{state:{pipelineModalOpen:e}}=(0,n.useContext)(St),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r,handleError:c}=Dt($);return(0,a.jsx)(Kt,{modalOpen:e,closeModal:o,size:"xl",children:(0,a.jsx)(Ca,{ref:i,editPipeline:e=>{return t=this,n=void 0,i=function*(){try{s(!0);const t=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description,is_primary:e.is_primary},headers:p()})}(e);r(C,t.data,It.ACTIVE_PIPELINE)}catch(e){c(e)}},new((a=void 0)||(a=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,n||[])).next())}));var t,n,a,i},modalSaving:t,setModalSaving:s})})}var Ta=s(9919);const Na=(0,n.forwardRef)((({editStage:e,addStage:t,stageModalSaving:s},i)=>{const{state:{stageToEdit:r}}=(0,n.useContext)(St),[c,l]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),p=!!r;(0,n.useEffect)((()=>{r&&(l(r.name),u(r.description))}),[r]);const h=()=>{l(""),u("")};return(0,n.useImperativeHandle)(i,(()=>({clearContent:h}))),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Wt,{children:p?(0,o.__)("Edit Stage","quicktasker"):(0,o.__)("Add Stage","quicktasker")}),(0,a.jsxs)(Qt,{children:[(0,a.jsx)(Yt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(ds,{isAutoFocus:!0,value:c,onChange:e=>l(e)})}),(0,a.jsx)(Yt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(hs,{rowsCount:3,value:d,onChange:e=>u(e)})})]}),(0,a.jsx)(Xt,{onSave:()=>{p?e(Object.assign(Object.assign({},r),{name:c,description:d})):t(c,d)},loading:s,saveBtnText:p?(0,o.__)("Save","quicktasker"):(0,o.__)("Add stage","quicktasker")})]})}));var Oa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Aa(){const{state:{stageModalOpen:e,targetPipelineId:t}}=(0,n.useContext)(St),{modalSaving:s,setModalSaving:i,modalContentRef:o,closeModal:r,handleSuccess:c,handleError:l}=Dt(L);return(0,a.jsx)(Kt,{modalOpen:e,closeModal:r,children:(0,a.jsx)(Na,{ref:o,editStage:e=>Oa(this,void 0,void 0,(function*(){try{i(!0);const t=yield function(e){return u()({path:`/wpqt/v1/stages/${e.id}`,method:"PATCH",data:{name:e.name,description:e.description},headers:p()})}(e);c(y,t.data,It.ACTIVE_PIPELINE)}catch(e){l(e)}})),addStage:(e,s)=>Oa(this,void 0,void 0,(function*(){try{i(!0);const r=yield(n=t,a=e,o=s,u()({path:"/wpqt/v1/stages",method:"POST",data:{pipelineId:n,name:a,description:o},headers:p()}));c(k,Object.assign(Object.assign({},r.data),{tasks:[]}),It.ACTIVE_PIPELINE)}catch(e){l(e)}var n,a,o})),stageModalSaving:s,stageTaskModalSaving:i})})}function Ea({pipelineId:e,stagesLength:t=0}){const{modalDispatch:s}=(0,n.useContext)(St),i=()=>{return t=this,n=void 0,i=function*(){s({type:U,payload:{targetPipelineId:e}})},new((a=void 0)||(a=Promise))((function(e,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(t,n||[])).next())}));var t,n,a,i};return 0===t?(0,a.jsx)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-w-full wpqt-items-center wpqt-justify-center",children:(0,a.jsxs)("div",{className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-gap-y-1 wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,a.jsx)(js.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,a.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add first stage","quicktasker")})]})}):(0,a.jsxs)("div",{className:"wpqt-main-border wpqt-mb-3 wpqt-flex wpqt-cursor-pointer wpqt-flex-col wpqt-items-center wpqt-justify-start wpqt-self-start wpqt-p-3 hover:wpqt-bg-gray-100",onClick:i,children:[(0,a.jsx)(js.A,{className:"wpqt-size-6 wpqt-text-green-600"}),(0,a.jsx)("div",{className:"wpqt-whitespace-nowrap",children:(0,o.__)("Add stage","quicktasker")})]})}function Pa(){const{modalDispatch:e}=(0,n.useContext)(St);return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-items-center wpqt-justify-center",children:(0,a.jsxs)("div",{onClick:()=>{return t=this,s=void 0,a=function*(){e({type:M})},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a},className:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:[(0,a.jsx)(js.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer"}),(0,a.jsx)("span",{children:(0,o.__)("Add your first Board","quicktasker")})]})})}var Ia=s(12),Da=s(5575),Ra=s(6304),Ua=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function La({stage:e}){var t,s,r,c;const{dispatch:l,state:{activePipeline:d},fetchAndSetPipelineData:h}=(0,n.useContext)(wt),{modalDispatch:w}=(0,n.useContext)(St),{state:{isUserAllowedToDelete:v}}=(0,n.useContext)(is),[x,q]=(0,n.useState)(!1),[m,f]=(0,n.useState)(!1),[g,k]=(0,n.useState)(!1),_=null!==(s=null===(t=null==d?void 0:d.stages)||void 0===t?void 0:t.length)&&void 0!==s?s:0,y=null!==(c=null===(r=e.tasks)||void 0===r?void 0:r.length)&&void 0!==c?c:0,b=+e.stage_order,C=b>0&&b<_,S=b!==_-1,T=t=>Ua(this,void 0,void 0,(function*(){try{q(!0),yield function(e,t){return u()({path:`/wpqt/v1/stages/${e}/move`,method:"PATCH",data:{direction:t},headers:p()})}(e.id,t),yield h(d.id)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to move a stage","quicktasker"))}finally{q(!1)}}));return(0,a.jsxs)(en,{menuBtn:({active:e})=>(0,a.jsx)(tn,{isActive:e,IconComponent:Ia.A}),children:[C&&(0,a.jsx)(sn,{text:(0,o.__)("Move left","quicktasker"),loading:x,icon:(0,a.jsx)(Da.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>T("left")}),S&&(0,a.jsx)(sn,{text:(0,o.__)("Move right","quicktasker"),loading:x,icon:(0,a.jsx)(Ra.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>T("right")}),(0,a.jsx)(sn,{text:(0,o.__)("Edit stage","quicktasker"),icon:(0,a.jsx)(Ts.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:()=>{w({type:F,payload:{stageToEdit:e}})}}),(0,a.jsx)(sn,{text:(0,o.__)("Archive all stage tasks","quicktasker"),icon:(0,a.jsx)(Zt.A,{className:"wpqt-icon-blue wpqt-size-4"}),loading:m,onClick:()=>Ua(this,void 0,void 0,(function*(){try{f(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}/archive-tasks`,method:"PATCH",headers:p()})),yield h(d.id),i.oR.success((0,o.sprintf)((0,o.__)("Archived all %s tasks","quicktasker"),e.name))}catch(t){console.error(t),i.oR.error((0,o.sprintf)((0,o.__)("Failed to archive stage %s tasks","quicktasker"),e.name))}finally{f(!1)}var t})),disabled:0===y,id:`item-dropdown-${e.id}-archive`,tooltipText:0===y?(0,o.__)("No tasks to archive on the stage","quicktasker"):void 0}),v&&(0,a.jsx)(sn,{text:(0,o.__)("Delete stage","quicktasker"),icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:g,onClick:()=>Ua(this,void 0,void 0,(function*(){try{k(!0),yield(t=e.id,u()({path:`/wpqt/v1/stages/${t}`,method:"DELETE",data:{stageId:t},headers:p()})),l({type:j,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete a stage","quicktasker"))}finally{k(!1)}var t})),disabled:y>0,className:"!wpqt-mb-0",id:`item-dropdown-${e.id}`,tooltipText:(0,o.__)("Stage can be deleted when there are no tasks on it","quicktasker")})]})}var Fa=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ma({stageId:e}){const[t,s]=(0,n.useState)(""),[r,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(!1),h=(0,n.useRef)(null),w=(0,n.useRef)(null),{state:{activePipeline:v},dispatch:x}=(0,n.useContext)(wt);(0,n.useEffect)((()=>{const e=e=>{"Enter"===e.key&&document.activeElement===w.current&&q()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),(0,n.useEffect)((()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&m()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,n.useEffect)((()=>{var e;r&&(null===(e=w.current)||void 0===e||e.focus())}),[r]);const q=()=>Fa(this,void 0,void 0,(function*(){if(t)try{d(!0);const s=yield function(e,t,s){return u()({path:"/wpqt/v1/tasks",method:"POST",data:{stageId:e,name:s,pipelineId:t},headers:p()})}(e,v.id,t);x({type:g,payload:s.data}),m()}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to create task","quicktasker"))}finally{d(!1)}else i.oR.error((0,o.__)("Task name is required","quicktasker"))})),m=()=>{c(!1),s("")};return(0,a.jsx)("div",{ref:h,className:"wpqt-sticky wpqt-bottom-0 wpqt-z-10 wpqt-order-1 wpqt-mt-2 wpqt-flex wpqt-justify-center wpqt-bg-gray-100 wpqt-py-2",children:r?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-3",children:[(0,a.jsx)(ds,{ref:w,value:t,onChange:e=>s(e),wrapperClassName:"!wpqt-mb-0",className:"!wpqt-mb-0"}),l?(0,a.jsx)(Ye,{width:"24",height:"24"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ks.A,{className:"wpqt-icon-red wpqt-size-6 wpqt-cursor-pointer",onClick:m}),(0,a.jsx)(js.A,{className:"wpqt-icon-green wpqt-size-6 wpqt-cursor-pointer",onClick:q})]})]}):(0,a.jsxs)("div",{onClick:()=>c(!0),className:"wpqt-main-border wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-p-2 hover:wpqt-bg-white",children:[(0,o.__)("Add task","quicktasker"),(0,a.jsx)(js.A,{className:"wpqt-size-6 wpqt-text-green-600"})]})})}var za=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function $a({task:e}){const{modalDispatch:t}=(0,n.useContext)(St),{state:{activePipeline:s},fetchAndSetPipelineData:i}=(0,n.useContext)(wt),{state:{isUserAllowedToDelete:r}}=(0,n.useContext)(is),{deleteTask:c,archiveTask:l}=_t(),[d,u]=(0,n.useState)(!1);return(0,a.jsxs)(en,{menuBtn:({active:e})=>(0,a.jsx)(tn,{isActive:e,IconComponent:Gn.A}),children:[(0,a.jsx)(sn,{text:(0,o.__)("Archive task","quicktasker"),icon:(0,a.jsx)(Zt.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),l(e.id,(()=>{i(s.id)}))}}),(0,a.jsx)(sn,{text:(0,o.__)("Edit task","quicktasker"),icon:(0,a.jsx)(Ts.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:D,payload:{taskToEdit:e}})}}),r&&(0,a.jsx)(sn,{text:(0,o.__)("Delete task","quicktasker"),icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-4"}),loading:d,onClick:t=>za(this,void 0,void 0,(function*(){t.stopPropagation(),u(!0),yield c(e.id,(()=>{i(s.id)})),u(!1)})),className:"!wpqt-mb-0"})]})}var Ha=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Va({task:e,index:t,onLastStage:s}){const{modalDispatch:i}=(0,n.useContext)(St),{state:{activePipeline:o}}=(0,n.useContext)(wt),r=!(null==o?void 0:o.settings).allow_only_last_stage_task_done||s,c=()=>{i({type:D,payload:{taskToEdit:e,taskModalSettings:{allowToMarkTaskAsDone:r}}})};return(0,a.jsx)(Ta.sx,{draggableId:e.id,index:t,children:t=>(0,a.jsxs)("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:"wpqt-relative wpqt-mx-4 wpqt-mb-2 wpqt-flex !wpqt-cursor-pointer wpqt-flex-col wpqt-gap-1 wpqt-rounded wpqt-border wpqt-border-gray-200 wpqt-bg-white wpqt-p-3 wpqt-shadow hover:wpqt-shadow-md",onClick:c,children:[(0,a.jsx)("div",{className:"wpqt-absolute wpqt-right-[12px] wpqt-top-[12px]",children:(0,a.jsx)($a,{task:e})}),(0,a.jsx)("div",{className:"wpqt-text-base",children:e.name}),e.description&&(0,a.jsx)("div",{className:"wpqt-text-sm wpqt-italic",children:e.description}),(0,a.jsx)("div",{className:"wpqt-mt-2",children:(0,a.jsx)(nn,{task:e})}),(0,a.jsx)(Ba,{task:e,allowToMarkTaskAsDone:r})]}))},e.id)}function Ba({task:e,allowToMarkTaskAsDone:t}){const{dispatch:s}=(0,n.useContext)(wt),{changeTaskDoneStatus:i}=_t(),[o,r]=(0,n.useState)(!1),c=e.is_done,l=t=>Ha(this,void 0,void 0,(function*(){r(!0),yield i(e.id,t,(t=>{s({type:A,payload:{taskId:e.id,done:t}})})),r(!1)}));return t?o?(0,a.jsx)(Je,{ovalSize:"24"}):(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:c?(0,a.jsx)(ts.A,{className:"wpqt-size-6 wpqt-icon-green",onClick:e=>{e.stopPropagation(),l(!1)}}):(0,a.jsx)(ts.A,{className:"wpqt-size-6 wpqt-icon-gray",onClick:e=>{e.stopPropagation(),l(!0)}})}):null}function Ga({tasks:e}){const t=e.length;return(0,a.jsx)("span",{className:"wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-1 wpqt-text-xs",children:t})}function Ka({stage:e,isLastStage:t}){return(0,a.jsxs)("div",{"data-stage-id":e.id,className:"wpqt-relative wpqt-mb-3 wpqt-flex wpqt-max-h-full wpqt-w-[360px] wpqt-flex-none wpqt-flex-col wpqt-overflow-hidden wpqt-rounded-md wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-gray-100",children:[(0,a.jsxs)("div",{className:"wpqt-mb-4 wpqt-flex wpqt-flex-wrap wpqt-items-center wpqt-gap-1 wpqt-px-4 wpqt-pt-3",children:[(0,a.jsxs)("div",{className:"wpqt-mr-auto wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-text-base wpqt-leading-none",children:[e.name," ",(0,a.jsx)(Ga,{tasks:e.tasks})]}),(0,a.jsx)(La,{stage:e}),e.description&&(0,a.jsx)("div",{className:"wpqt-w-full wpqt-flex-shrink-0 wpqt-flex-grow-0 wpqt-text-sm",children:e.description})]}),(0,a.jsx)(Ta.gL,{droppableId:e.id,children:s=>{var n;return(0,a.jsxs)("div",{ref:s.innerRef,className:"wpqt-flex wpqt-h-full wpqt-flex-col wpqt-overflow-y-auto wpqt-overflow-x-hidden",children:[null===(n=e.tasks)||void 0===n?void 0:n.map(((e,s)=>(0,a.jsx)(Va,{task:e,index:s,onLastStage:t},e.id))),s.placeholder,(0,a.jsx)(Ma,{stageId:e.id})]})}})]})}const Wa=()=>{var e,t;const{state:{activePipeline:s},dispatch:r,fetchAndSetPipelineData:c}=(0,n.useContext)(wt);(0,n.useEffect)((()=>{const e=setInterval((()=>{s&&c(s.id)}),3e4);return()=>clearInterval(e)}),[s]);const l=(e,t)=>{e.droppableId===t.droppableId?r({type:"REORDER_TASK",payload:{source:e,destination:t}}):r({type:"MOVE_TASK",payload:{source:e,destination:t}})},d=(0,n.useCallback)((e=>{return t=void 0,s=void 0,a=function*(){const{source:t,destination:s,draggableId:n}=e;if(s){l(t,s);try{yield(a=n,r=s.droppableId,c=s.index,u()({path:`/wpqt/v1/tasks/${a}/move`,method:"PATCH",data:{stageId:r,order:c},headers:p()}))}catch(e){console.error(e),l(s,t),i.oR.error((0,o.__)("Failed to move a task","quicktasker"))}var a,r,c}},new((n=void 0)||(n=Promise))((function(e,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(t,s||[])).next())}));var t,s,n,a}),[s]);return s?(0,a.jsxs)("div",{className:"wpqt-pipeline-height wpqt-flex wpqt-gap-[24px] wpqt-overflow-x-auto wpqt-overflow-y-hidden",children:[(0,a.jsx)(Ta.JY,{onDragEnd:d,children:null===(e=s.stages)||void 0===e?void 0:e.map(((e,t)=>{const n=t===s.stages.length-1;return(0,a.jsx)(Ka,{stage:e,isLastStage:n},e.id)}))}),(0,a.jsx)(Ea,{pipelineId:s.id,stagesLength:null===(t=s.stages)||void 0===t?void 0:t.length}),(0,a.jsx)(Ln,{deleteTaskCallback:()=>{s&&c(s.id)}}),(0,a.jsx)(Aa,{})]}):(0,a.jsx)(Pa,{})};var Qa=s(247),Ya=s(1203),Xa=s(2496),Ja=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Za(){const{state:{activePipeline:e},fetchAndSetPipelineData:t}=(0,n.useContext)(wt),{state:{pipelines:s},pipelinesDispatch:r}=(0,n.useContext)(it),{modalDispatch:c}=(0,n.useContext)(St),l=e=>Ja(this,void 0,void 0,(function*(){try{yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/set-primary`,method:"PATCH",headers:p()})),r({type:S,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to set primary board","quicktasker"))}var t}));return(0,a.jsxs)(en,{menuBtnClasses:"wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-1 wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-3",menuBtn:({active:t})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-leading-none",children:null==e?void 0:e.name}),(0,a.jsx)(Ya.A,{className:"wpqt-size-4 "+(t?"wpqt-text-qtBlueHover":"")})]}),children:[(0,a.jsx)("div",{className:"wpqt-mb-4 wpqt-text-center wpqt-font-bold",children:(0,o.__)("Change board","quicktasker")}),s.map((s=>{const n=s.is_primary,i=(null==e?void 0:e.id)===s.id;return(0,a.jsx)(Zs.Dr,{children:(0,a.jsxs)("div",{className:"wpqt-mb-3 wpqt-flex wpqt-gap-2",children:[(0,a.jsx)("div",{className:(0,ps.$)("wpqt-cursor-pointer wpqt-text-center",{"wpqt-font-bold":i}),onClick:()=>t(s.id),children:s.name}),(0,a.jsx)("div",{className:"wpqt-ml-auto",children:n?(0,a.jsx)(Xa.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-blue-500"}):(0,a.jsx)(Qa.A,{className:"wpqt-size-4 wpqt-cursor-pointer wpqt-text-gray-400",onClick:e=>{e.stopPropagation(),l(s)}})})]})},s.id)})),(0,a.jsx)(Zs.Dr,{children:(0,a.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-cursor-pointer wpqt-items-center wpqt-gap-2",children:(0,a.jsx)(Bt,{text:(0,o.__)("Add new board","quicktasker"),onClick:()=>Ja(this,void 0,void 0,(function*(){c({type:M})})),icon:(0,a.jsx)(js.A,{className:"wpqt-size-6 wpqt-icon-green"}),className:"wpqt-bg-white hover:!wpqt-bg-gray-100"})})},"new-pipeline")]})}function ei(){const{state:{activePipeline:e,loading:t},fetchAndSetPipelineData:s}=(0,n.useContext)(wt),{modalDispatch:i}=(0,n.useContext)(St);return e?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-py-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,a.jsx)("div",{className:"wpqt-text-lg",children:e.name}),(0,a.jsx)(Ia.A,{className:"wpqt-text-gray-400 wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{e&&i({type:z,payload:{pipelineToEdit:e}})}})]}),e.description&&(0,a.jsx)("div",{className:"wpqt-italic",children:e.description})]}),(0,a.jsxs)("div",{className:"wpqt-ml-auto wpqt-flex wpqt-items-center wpqt-gap-3",children:[t?(0,a.jsx)(Ye,{width:"24",height:"24"}):(0,a.jsx)(fn.A,{className:"wpqt-size-6 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>s(e.id)}),(0,a.jsx)(Za,{})]})]}):null}const ti=()=>(0,a.jsx)(vt,{children:(0,a.jsxs)(Ze,{children:[(0,a.jsx)(ei,{}),(0,a.jsx)(Wa,{}),(0,a.jsx)(ya,{}),(0,a.jsx)(Sa,{})]})});var si=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ni(){return{saveCustomUserPageStyles:(e,t)=>si(this,void 0,void 0,(function*(){try{const n=yield(s=e,u()({path:"/wpqt/v1/settings/user-page-custom-styles",method:"PATCH",data:{styles:s},headers:p()}));t&&t(n.data),i.oR.success((0,o.__)("Custom user page styles saved successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to save custom user page styles","quicktasker"))}var s})),saveTaskCompletionDoneSetting:(e,t,s)=>si(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/pipelines/${e}/settings/task-completion-done-restriction`,method:"PATCH",data:{allow_task_completion_only_on_last_stage:t},headers:p()})}(e,t),s&&s(t)}catch(e){s&&s(!t),console.error(e),i.oR.error((0,o.__)("Failed to save setting","quicktasker"))}}))}}const ai=({children:e,title:t,description:s})=>(0,a.jsxs)("div",{className:"wpqt-mb-3",children:[(0,a.jsx)("h3",{children:t}),(0,a.jsx)("p",{children:s}),e]});const ii=()=>{const{state:{userPageCustomStyles:e},appDispatch:t}=(0,n.useContext)(is),[s,i]=(0,n.useState)(""),[r,c]=(0,n.useState)(!1),{saveCustomUserPageStyles:l}=ni();return(0,n.useEffect)((()=>{i(e)}),[e]),(0,a.jsxs)(ai,{title:(0,o.__)("Custom style","quicktasker"),description:(0,o.__)("Add custom CSS rules for QuickTasker user page.","quicktasker"),children:[(0,a.jsx)(hs,{value:s,onChange:i}),(0,a.jsx)(Bt,{text:(0,o.__)("Save","quicktasker"),loading:r,onClick:()=>{return e=void 0,n=void 0,i=function*(){c(!0),yield l(s,(e=>{t({type:ue,payload:e})})),c(!1)},new((a=void 0)||(a=Promise))((function(t,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(e,n||[])).next())}));var e,n,a,i},icon:(0,a.jsx)($t.RZ0,{className:"wpqt-icon-blue wpqt-size-4"})})]})},oi=(e,t)=>{var s,n;switch(t.type){case Oe:{const s=t.payload.automations;return Object.assign(Object.assign({},e),{automations:s})}case Ae:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case Ee:{const a=t.payload,i=null!==(n=null===(s=e.automations)||void 0===s?void 0:s.filter((e=>e.id!==a)))&&void 0!==n?n:null;return Object.assign(Object.assign({},e),{automations:i})}case Pe:{const s=t.payload,n=e.automations?[...e.automations,s]:[s];return Object.assign(Object.assign({},e),{automations:n})}default:return e}};const ri={automations:null,loading:!0},ci=(0,n.createContext)({state:ri,pipelineAutomationsDispatch:()=>{}}),li=({children:e,pipelineId:t})=>{const[s,o]=(0,n.useReducer)(oi,ri),r=()=>{return e=void 0,s=void 0,a=function*(){try{o({type:Ae,payload:!0});const e=yield function(e){return u()({path:`/wpqt/v1/pipelines/${e}/automations`,method:"GET",headers:p()})}(t);o({type:Oe,payload:{automations:e.data.automations}})}catch(e){console.error(e),i.oR.error("Failed to load board automations")}finally{o({type:Ae,payload:!1})}},new((n=void 0)||(n=Promise))((function(t,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(o,r)}c((a=a.apply(e,s||[])).next())}));var e,s,n,a};return(0,n.useEffect)((()=>{r()}),[]),(0,a.jsx)(ci.Provider,{value:{state:s,pipelineAutomationsDispatch:o},children:e})};var di=s(1226),ui=s(6973);const pi={automationTarget:null,automationTrigger:null,automationAction:null};function hi(e,t){switch(t.type){case"SET_TARGET":return Object.assign(Object.assign({},e),{automationTarget:t.payload,automationTrigger:null,automationAction:null});case"SET_TRIGGER":return Object.assign(Object.assign({},e),{automationTrigger:t.payload,automationAction:null});case"SET_ACTION":return Object.assign(Object.assign({},e),{automationAction:t.payload});case"RESET":return pi;default:return e}}const wi={[mt.ARCHIVE_TASK]:(0,o.__)("Archive task","quicktasker")},vi={[qt.Task]:(0,o.__)("Task","quicktasker"),[qt.Stage]:(0,o.__)("Stage","quicktasker"),[qt.PIPELINE]:(0,o.__)("Board","quicktasker"),[qt.quicktasker]:"Quicktasker"},xi={[xt.TASK_DONE]:(0,o.__)("Task marked as done","quicktasker"),[xt.Task_NOT_DONE]:(0,o.__)("Task marked as not done","quicktasker")},qi={[xt.TASK_DONE]:[mt.ARCHIVE_TASK],[xt.Task_NOT_DONE]:[mt.ARCHIVE_TASK]},mi={[qt.Task]:qi};function fi({value:e,label:t,onClick:s=()=>{},className:n=""}){return(0,a.jsx)("div",{className:`wpqt-inline-flex wpqt-rounded-xl wpqt-px-4 wpqt-py-1 wpqt-border wpqt-border-solid wpqt-cursor-pointer wpqt-border-qtBorder ${n}`,onClick:()=>{s(e)},children:t})}function gi({children:e,title:t}){return(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-font-semibold wpqt-text-base wpqt-mb-4 wpqt-text-center",children:t}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center wpqt-gap-3",children:e})]})}function ki({automationDispatch:e,automation:t}){if(!t.automationTarget||!t.automationTrigger)return null;const s=t.automationTarget,n=t.automationTrigger,i=mi[s][n].map((e=>({value:e,label:wi[e]})));return(0,a.jsx)(gi,{title:(0,o.__)("Step 3. Select action","quicktasker"),children:i.map((({value:t,label:s})=>(0,a.jsx)(fi,{value:t,label:s,onClick:()=>{e({type:"SET_ACTION",payload:t})}},t)))})}function ji({automationDispatch:e}){const t=Object.keys(mi).map((e=>({value:e,label:vi[e]||e})));return(0,a.jsx)(gi,{title:(0,o.__)("Step 1. Select a target","quicktasker"),children:t.map((({value:t,label:s})=>(0,a.jsx)(fi,{value:t,label:s,onClick:()=>{e({type:"SET_TARGET",payload:t})}},t)))})}function _i({automationDispatch:e,automation:t}){if(!t.automationTarget)return null;const s=t.automationTarget,n=Object.keys(mi[s]).map((e=>({value:e,label:xi[e]||e})));return(0,a.jsx)(gi,{title:(0,o.__)("Step 2. Select a trigger","quicktasker"),children:n.map((({value:t,label:s})=>(0,a.jsx)(fi,{value:t,label:s,onClick:()=>{e({type:"SET_TRIGGER",payload:t})}},t)))})}var yi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function bi({automation:e,automationDispatch:t,createAutomation:s}){const[i,r]=(0,n.useState)(!1);return null===e.automationTarget?(0,a.jsx)(ji,{automationDispatch:t}):null===e.automationTrigger&&e.automationTarget?(0,a.jsx)(_i,{automationDispatch:t,automation:e}):null===e.automationAction&&e.automationTrigger&&e.automationTarget?(0,a.jsx)(ki,{automationDispatch:t,automation:e}):(0,a.jsx)(Bt,{text:(0,o.__)("Create automation","quicktasker"),icon:(0,a.jsx)($t.RZ0,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:()=>yi(this,void 0,void 0,(function*(){r(!0),yield s(),r(!1)})),loading:i})}var Ci=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Si({pipelineId:e}){const{pipelineAutomationsDispatch:t}=(0,n.useContext)(ci),[s,i]=(0,n.useState)(!1),[r,c]=(0,n.useReducer)(hi,pi),{createAutomation:l}=kt(),d="wpqt-px-3 wpqt-min-w-[60px] wpqt-cursor-pointer",u="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1",p=()=>{c({type:"RESET"})};return s?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3",children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-3 wpqt-main-border wpqt-p-4 wpqt-justify-center",children:[(0,a.jsx)($n,{title:(0,o.__)("Target","quicktasker"),className:d,titleClassName:u,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTarget?vi[r.automationTarget]:(0,a.jsx)(Ti,{})})}),(0,a.jsx)($n,{title:(0,o.__)("Trigger","quicktasker"),className:d,titleClassName:u,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationTrigger?xi[r.automationTrigger]:(0,a.jsx)(Ti,{})})}),(0,a.jsx)($n,{title:(0,o.__)("Action","quicktasker"),className:d,titleClassName:u,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:r.automationAction?wi[r.automationAction]:(0,a.jsx)(Ti,{})})})]}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(bi,{automation:r,automationDispatch:c,createAutomation:()=>Ci(this,void 0,void 0,(function*(){yield l(e,r,((e,s)=>{e&&s&&(p(),t({type:Pe,payload:s}))}))}))})}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Bt,{icon:(0,a.jsx)(ui.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Close automation creator","quicktasker"),onClick:()=>{i(!1),p()}})})]}):(0,a.jsx)("div",{children:(0,a.jsx)(Bt,{icon:(0,a.jsx)(ui.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Create a new automation","quicktasker"),onClick:()=>i(!0)})})}function Ti(){return(0,a.jsx)(di.A,{className:"wpqt-size-7 wpqt-text-gray-300"})}const Ni={success:"wpqt-bg-green-100 wpqt-border-green-400 wpqt-text-green-700",error:"wpqt-bg-red-100 wpqt-border-red-400 wpqt-text-red-700",warning:"wpqt-bg-yellow-100 wpqt-border-yellow-400 wpqt-text-yellow-700",info:"wpqt-bg-blue-100 wpqt-border-blue-400 wpqt-text-blue-700",primary:"wpqt-bg-gray-100 wpqt-border-gray-400 wpqt-text-gray-700"};function Oi({type:e="primary",className:t="",children:s}){const n=Ni[e];return(0,a.jsx)("div",{className:`wpqt-inline-flex wpqt-p-2 wpqt-border wpqt-border-solid wpqt-rounded-md ${n} ${t}`,children:s})}var Ai=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ei({automation:e}){const{pipelineAutomationsDispatch:t}=(0,n.useContext)(ci),{deleteAutomation:s}=kt(),[i,r]=(0,n.useState)(!1),c="wpqt-px-3 wpqt-pt-1 wpqt-min-w-[60px]",l="wpqt-absolute wpqt-top-0 wpqt-left-[50%] wpqt-transform-center wpqt-bg-[#fff] wpqt-text-[1rem] wpqt-leading-none wpqt-font-semibold wpqt-p-1";return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-3 wpqt-main-border wpqt-p-4",children:[(0,a.jsx)($n,{title:(0,o.__)("Target","quicktasker"),className:c,titleClassName:l,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:vi[e.target_type]})}),(0,a.jsx)($n,{title:(0,o.__)("Trigger","quicktasker"),className:c,titleClassName:l,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:xi[e.automation_trigger]})}),(0,a.jsx)($n,{title:(0,o.__)("Action","quicktasker"),className:c,titleClassName:l,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:wi[e.automation_action]})}),(0,a.jsx)($n,{title:(0,o.__)("Controls","quicktasker"),className:`${c} wpqt-ml-auto`,titleClassName:l,children:(0,a.jsx)("div",{className:"wpqt-flex wpqt-gap-2",children:(0,a.jsx)(Bt,{loading:i,text:(0,o.__)("Delete","quicktasker"),icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-5"}),onClick:()=>Ai(this,void 0,void 0,(function*(){r(!0),yield s(e.pipeline_id,e.id,(s=>{s&&t({type:Ee,payload:e.id})})),r(!1)}))})})})]})}function Pi(){const{state:{automations:e,loading:t}}=(0,n.useContext)(ci),[s,i]=(0,n.useState)(!1);return t?(0,a.jsx)(Je,{}):e&&0!==e.length?s?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-3 wpqt-mb-2",children:e.map((e=>(0,a.jsx)(Ei,{automation:e},e.id)))}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-justify-center",children:(0,a.jsx)(Bt,{icon:(0,a.jsx)(ui.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Hide board automations","quicktasker"),onClick:()=>i(!1)})})]}):(0,a.jsx)("div",{children:(0,a.jsx)(Bt,{icon:(0,a.jsx)(ui.QK_,{className:"wpqt-size-5"}),text:(0,o.__)("Show board automations","quicktasker"),onClick:()=>i(!0)})}):(0,a.jsx)(Oi,{type:"info",children:(0,o.__)("No automations created for this board","quicktasker")})}function Ii({children:e}){return(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:(0,o.__)("Board automations","quicktasker")}),(0,a.jsx)("p",{children:(0,o.__)("Allows to automate various tasks","quicktasker")}),(0,a.jsx)("div",{children:e})]})}function Di({pipelineId:e}){return Ie?(0,a.jsx)(li,{pipelineId:e,children:(0,a.jsxs)(Ii,{children:[(0,a.jsx)("div",{className:"wpqt-mb-3",children:(0,a.jsx)(Pi,{})}),(0,a.jsx)("div",{children:(0,a.jsx)(Si,{pipelineId:e})})]})}):(0,a.jsx)(gs,{title:(0,o.__)("Board automations","quicktasker"),description:(0,o.__)("Premium feature to automate various tasks.","quicktasker")})}var Ri=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ui({allow_only_last_stage_task_done:e,pipelineId:t}){const[s,i]=(0,n.useState)(e),[r,c]=(0,n.useState)(!1),{saveTaskCompletionDoneSetting:l}=ni();return(0,a.jsx)(ai,{title:(0,o.__)("Restrict Task Completion","quicktasker"),description:(0,o.__)("Allow to mark task as done only on board last stage. By default, task can be marked as done on any stage. Will apply also to QuickTasker page","quicktasker"),children:(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center",children:[(0,a.jsx)(vs,{checked:s,handleChange:e=>Ri(this,void 0,void 0,(function*(){i(e),c(!0),yield l(t,e,(e=>{i(e)})),c(!1)}))}),r&&(0,a.jsx)(Ye,{width:"20",height:"20"})]})})}var Li=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Fi({pipeline:e}){const[t,s]=(0,n.useState)(!0),[i,o]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(()=>{Li(this,void 0,void 0,(function*(){try{s(!0);const n=yield(t=e.id,u()({path:`/wpqt/v1/pipelines/${t}/settings`,method:"GET",headers:p()}));o(tt(n.data.settings))}catch(e){console.error(e)}finally{s(!1)}var t}))})()}),[]),t?(0,a.jsx)(Je,{}):i?(0,a.jsxs)("div",{children:[(0,a.jsx)(Ui,{pipelineId:e.id,allow_only_last_stage_task_done:i.allow_only_last_stage_task_done}),(0,a.jsx)(Di,{pipelineId:e.id})]}):null}function Mi(){const{state:{pipelines:e}}=(0,n.useContext)(it),t=e.map((e=>e.name)),s=e.map((e=>(0,a.jsx)(Fi,{pipeline:e},e.id)));return(0,a.jsx)("div",{children:(0,a.jsx)(on,{tabs:t,tabsContent:s,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})})}const zi=()=>(0,a.jsxs)(Ze,{children:[(0,a.jsx)(l,{description:(0,o.__)("Manage settings, preferences, and configurations.","quicktasker"),children:(0,o.__)("Settings","quicktasker")}),(0,a.jsx)(ii,{}),(0,a.jsx)(Mi,{})]});var $i=s(8932),Hi=s(1548),Vi=s(1266),Bi=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Gi(){return{createUser:(e,t,s)=>Bi(this,void 0,void 0,(function*(){try{const r=yield(n=e,a=t,u()({path:"/wpqt/v1/users",method:"POST",data:{name:n,description:a},headers:p()}));s&&s(r.data),i.oR.success((0,o.__)("User created successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User creation failed. Please try again","quicktasker"))}var n,a})),editUser:(e,t)=>Bi(this,void 0,void 0,(function*(){try{const s=yield function(e){return u()({path:`/wpqt/v1/users/${e.id}`,method:"PATCH",data:{user:e},headers:p()})}(e);t&&t(s.data),i.oR.success((0,o.__)("User edited successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("User edit failed. Please try again","quicktasker"))}})),changeUserStatus:(e,t,s)=>Bi(this,void 0,void 0,(function*(){try{const n=yield function(e,t){return u()({path:`/wpqt/v1/users/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e,t);s&&s(n.data),i.oR.success((0,o.__)("User status changed successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change user status. Please try again","quicktasker"))}})),deleteUser:(e,t)=>Bi(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}`,method:"DELETE",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User deleted successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete user. Please try again","quicktasker"))}})),resetUserPassword:(e,t)=>Bi(this,void 0,void 0,(function*(){try{yield function(e){return u()({path:`/wpqt/v1/users/${e}/password-reset`,method:"PATCH",headers:p()})}(e),t&&t(e),i.oR.success((0,o.__)("User password reset successfully","quicktasker"))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to reset user password. Please try again","quicktasker"))}}))}}var Ki=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Wi({data:e,changeStatus:t,changeSetUpStatus:s,changePasswordStatus:i}){const{changeUserStatus:r,deleteUser:c,resetUserPassword:l}=Gi(),{userDispatch:d}=(0,n.useContext)(Et),{loading1:u,setLoading1:p,loading2:h,setLoading2:w,loading3:v,setLoading3:x}=ss(),q=e.is_active,m=e.has_password;return(0,a.jsxs)("div",{className:"wpqt-mt-5 wpqt-flex wpqt-gap-2",children:[(0,a.jsx)(Bt,{icon:(0,a.jsx)($i.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${e.id}/tasks`}}),!q&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(Hi.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:h,onClick:()=>Ki(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!0,(e=>{d({type:oe,payload:Object.assign({},e)}),t(!0)})),w(!1)}))}),q&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(Hi.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:h,onClick:()=>Ki(this,void 0,void 0,(function*(){w(!0),yield r(e.id,!1,(e=>{d({type:oe,payload:Object.assign({},e)}),t(!1)})),w(!1)}))}),m&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(Vi.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:u,text:(0,o.__)("Reset password","quicktasker"),onClick:()=>Ki(this,void 0,void 0,(function*(){p(!0),yield l(e.id,(()=>{s(!1),i(!1)})),p(!1)}))}),(0,a.jsx)(Bt,{icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-5"}),loading:v,text:(0,o.__)("Delete user","quicktasker"),onClick:()=>Ki(this,void 0,void 0,(function*(){x(!0),yield c(e.id,(e=>{d({type:re,payload:e}),window.location.hash="#/users"})),x(!1)}))})]})}var Qi=s(8624),Yi=s(3997),Xi=s(5028);function Ji(){const{state:{siteURL:e,publicUserPageId:t}}=(0,n.useContext)(is);return{userPage:e+`/wpqt?page=${t}&page_id=wpqt`}}function Zi({data:e}){const{userPage:t}=Ji(),{convertToWPTimezone:s}=vn(),n=e.is_active,i=t+"&code="+e.page_hash;return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,a.jsx)(eo,{label:(0,o.__)("Name","quicktasker"),value:e.name,icon:(0,a.jsx)(Qi.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(eo,{label:(0,o.__)("Created at","quicktasker"),value:s(e.created_at),icon:(0,a.jsx)(Yi.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(eo,{label:(0,o.__)("Assigned tasks count","quicktasker"),value:e.assigned_tasks_count,icon:(0,a.jsx)($i.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(eo,{label:(0,o.__)("Setup completed","quicktasker"),value:e.setup_completed?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,a.jsx)(Xi.A,{className:"wpqt-size-5 wpqt-text-yellow-600"})}),(0,a.jsx)(eo,{label:(0,o.__)("Is active","quicktasker"),value:n?(0,o.__)("Yes","quicktasker"):(0,o.__)("No","quicktasker"),icon:(0,a.jsx)(Hi.A,{className:"wpqt-size-5 "+(n?"wpqt-icon-green":"wpqt-icon-red")})}),(0,a.jsx)(eo,{label:(0,o.__)("User Page","quicktasker"),value:(0,a.jsx)("a",{href:i,rel:"noreferrer",target:"_blank",children:i}),icon:(0,a.jsx)(Ss.A,{className:"wpqt-size-5 wpqt-icon-blue"})})]})}function eo({label:e,value:t,icon:s}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[s,(0,a.jsxs)("span",{className:"wpqt-font-semibold",children:[e,": "]}),(0,a.jsx)("span",{children:t})]})}var to=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function so({userId:e}){const{loadingDispatch:t}=(0,n.useContext)(Ve),[s,r]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(()=>{to(this,void 0,void 0,(function*(){try{t({type:pe,payload:!0});const n=yield function(e){return u()({path:`/wpqt/v1/users/${e}/extended`,method:"GET",headers:p()})}(e);r((s=n.data,Object.assign(Object.assign({},s),{is_active:"1"===s.is_active})))}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to get user data. Please try again","quicktasker"))}finally{t({type:pe,payload:!1})}var s}))})()}),[]),(0,a.jsx)(Ze,{children:s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l,{description:(0,o.__)("User details","quicktasker"),children:s.name}),(0,a.jsx)(Zi,{data:s}),(0,a.jsx)(Wi,{data:s,changeStatus:e=>to(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{is_active:e}):t))})),changeSetUpStatus:e=>to(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{setup_completed:e}):t))})),changePasswordStatus:e=>to(this,void 0,void 0,(function*(){r((t=>t?Object.assign(Object.assign({},t),{has_password:e}):t))}))})]})})}const no=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active}),ao=(e,t)=>{var s;switch(t.type){case he:return Object.assign(Object.assign({},e),{sessionsSearchValue:null!==(s=t.payload)&&void 0!==s?s:""});case we:{const s=t.payload.map(no);return Object.assign(Object.assign({},e),{userSessions:s})}case ve:{const{sessionId:s,status:n}=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_active:n}):e))})}case xe:{const s=t.payload;return Object.assign(Object.assign({},e),{userSessions:e.userSessions.filter((e=>e.id!==s))})}default:return e}};var io=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const oo={loading:!0,sessionsSearchValue:"",userSessions:[]},ro=(0,n.createContext)({state:oo,usersSessionDispatch:()=>{},loadUserSessions:()=>io(void 0,void 0,void 0,(function*(){}))}),co=({children:e})=>{const[t,s]=(0,n.useReducer)(ao,oo),{loadingDispatch:r}=(0,n.useContext)(Ve);(0,n.useEffect)((()=>{c()}),[]);const c=()=>io(void 0,void 0,void 0,(function*(){try{r({type:pe,payload:!0});const e=yield u()({path:"/wpqt/v1/users/sessions",method:"GET",headers:p()});s({type:we,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user sessions","quicktasker"))}finally{r({type:pe,payload:!1})}}));return(0,a.jsx)(ro.Provider,{value:{state:t,usersSessionDispatch:s,loadUserSessions:c},children:e})};function lo(){const{state:{sessionsSearchValue:e},usersSessionDispatch:t}=(0,n.useContext)(ro);return(0,a.jsx)(dt,{title:(0,o.__)("Session filtering","quicktasker"),children:(0,a.jsx)(ds,{value:e,onChange:e=>{t({type:he,payload:e})}})})}const uo=()=>{const{state:{sessionsSearchValue:e}}=(0,n.useContext)(ro);return{filterSessions:t=>t.user_name.toLowerCase().includes(e.toLowerCase())||t.user_description&&t.user_description.toLowerCase().includes(e.toLowerCase())}};var po=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function ho({session:e}){const{usersSessionDispatch:t}=(0,n.useContext)(ro),{state:{isUserAllowedToDelete:s}}=(0,n.useContext)(is),{convertToWPTimezone:r}=vn(),c=e.is_active,l=s=>po(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/users/sessions/${e}/status`,method:"PATCH",data:{status:t},headers:p()})}(e.id,s),t({type:ve,payload:{sessionId:e.id,status:s}})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to change session status","quicktasker"))}}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:e.user_name}),(0,a.jsx)("div",{className:"wpqt-italic",children:e.user_description})]}),(0,a.jsx)("div",{children:r(e.created_at_utc)}),(0,a.jsx)("div",{children:r(e.expires_at_utc)}),(0,a.jsx)("div",{className:c?"wpqt-text-qtTextGreen":"wpqt-text-qtTextRed",children:c?(0,o.__)("On","quicktasker"):(0,o.__)("Off","quicktasker")}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-gap-4",children:[c?(0,a.jsx)(Hi.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!1),title:(0,o.__)("Turn session off","quicktasker")}):(0,a.jsx)(Hi.A,{className:"wpqt-icon-green wpqt-size-5 wpqt-cursor-pointer",onClick:()=>l(!0),title:(0,o.__)("Turn session on","quicktasker")}),s&&(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-5 wpqt-cursor-pointer",title:(0,o.__)("Delete session","quicktasker"),onClick:()=>po(this,void 0,void 0,(function*(){try{yield(s=e.id,u()({path:`/wpqt/v1/users/sessions/${s}`,method:"DELETE",headers:p()})),t({type:xe,payload:e.id})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to delete session","quicktasker"))}var s}))})]})]})}function wo(){const{state:{userSessions:e}}=(0,n.useContext)(ro),{filterSessions:t}=uo(),s=e.filter(t);return 0===s.length?(0,a.jsx)(Fn,{text:(0,o.__)("No sessions found","quicktasker")}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"wpqt-mb-4 wpqt-grid wpqt-grid-cols-5 wpqt-font-bold",children:[(0,a.jsx)("div",{children:(0,o.__)("Session owner","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Created at","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Expires at","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Status","quicktasker")}),(0,a.jsx)("div",{children:(0,o.__)("Actions","quicktasker")})]}),(0,a.jsx)("div",{className:"wpqt-grid wpqt-grid-cols-5 wpqt-items-center wpqt-gap-y-4",children:s.map((e=>(0,a.jsx)(ho,{session:e},e.id)))})]})}function vo(){return(0,a.jsx)(co,{children:(0,a.jsxs)(Ze,{children:[(0,a.jsx)(l,{children:(0,o.__)("Quicktasker sessions","quicktasker")}),(0,a.jsx)(lo,{}),(0,a.jsx)(wo,{})]})})}function xo(){const{state:{usersSearchValue:e},userDispatch:t}=(0,n.useContext)(Et);return(0,a.jsx)(dt,{title:(0,o.__)("User filtering","quicktasker"),children:(0,a.jsx)(et.p,{type:"text",value:e,onChange:e=>{t({type:ie,payload:e.target.value})}})})}var qo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function mo({userId:e}){return(0,a.jsx)(kn,{typeId:e,fetchData:()=>qo(this,void 0,void 0,(function*(){try{return(yield v(e,Le.User)).data}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load log","quicktasker"))}})),renderItem:e=>(0,a.jsx)(qn,{log:e}),noDataMessage:(0,o.__)("No logs available","quicktasker"),explanation:(0,o.__)("Logs can be seen only by WordPress users (with required permissions)","quicktasker")})}var fo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function go({userId:e}){return(0,a.jsx)(kn,{typeId:e,fetchData:()=>fo(this,void 0,void 0,(function*(){try{return(yield h(e,Le.User,!0)).data.map(Tn)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load private comments","quicktasker"))}})),onAdd:t=>fo(this,void 0,void 0,(function*(){try{const s=yield w(e,Le.User,!0,t);return Tn(s.data)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to add private comment","quicktasker"))}})),renderItem:e=>(0,a.jsx)(_n,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed only by WordPress users (with required permissions).","quicktasker"),enableAdd:!0})}var ko=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function jo({userId:e}){const{addComment:t}=Sn();return(0,a.jsx)(kn,{typeId:e,fetchData:()=>ko(this,void 0,void 0,(function*(){try{return(yield h(e,Le.User,!1)).data.map(Tn)}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to load comments","quicktasker"))}})),onAdd:s=>ko(this,void 0,void 0,(function*(){const n=yield t(e,Le.User,!1,s);if(n)return Tn(n)})),renderItem:e=>(0,a.jsx)(_n,{item:e}),noDataMessage:(0,o.__)("No comments available","quicktasker"),explanation:(0,o.__)("Comments that can be added and viewed by WordPress users (with required permissions) and current QuickTasker user (in user page).","quicktasker"),enableAdd:!0})}function _o({user:e}){const t=[(0,o.__)("Private comments","quicktasker"),(0,o.__)("Public comments","quicktasker"),(0,o.__)("Logs","quicktasker")];return(0,a.jsx)(on,{tabs:t,tabsContent:[(0,a.jsx)(go,{userId:e.id},1),(0,a.jsx)(jo,{userId:e.id},2),(0,a.jsx)(mo,{userId:e.id},3)]})}var yo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const bo=(0,n.forwardRef)((function({modalSaving:e,editUser:t},s){const{state:{userToEdit:i},modalDispatch:r}=(0,n.useContext)(St),{state:{isUserAllowedToDelete:c}}=(0,n.useContext)(is),[l,d]=(0,n.useState)(""),[u,p]=(0,n.useState)(""),[h,w]=(0,n.useState)(!1),[v,x]=(0,n.useState)(!1),{changeUserStatus:q,deleteUser:m,resetUserPassword:f}=Gi(),{userDispatch:g}=(0,n.useContext)(Et),{loading1:k,setLoading1:j,loading2:_,setLoading2:y,loading3:b,setLoading3:C}=ss();(0,n.useEffect)((()=>{i&&(d(i.name),p(i.description),w(i.is_active),x(i.has_password))}),[i]);const S=()=>{d(""),p("")};return(0,n.useImperativeHandle)(s,(()=>({clearContent:S}))),i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-7 md:wpqt-grid-cols-[1fr_auto]",children:[(0,a.jsxs)("div",{className:"wpqt-border-0 wpqt-border-r wpqt-border-solid wpqt-border-r-gray-300 md:wpqt-pr-3",children:[(0,a.jsxs)("div",{className:"wpqt-grid wpqt-grid-cols-1 wpqt-gap-3 md:wpqt-grid-cols-[auto_1fr]",children:[(0,a.jsx)("div",{children:(0,a.jsxs)(Qt,{children:[(0,a.jsx)(Yt,{label:(0,o.__)("Name","quicktasker"),children:(0,a.jsx)(ds,{isAutoFocus:!0,value:l,onChange:e=>d(e)})}),(0,a.jsx)(Yt,{label:(0,o.__)("Description","quicktasker"),children:(0,a.jsx)(hs,{rowsCount:3,value:u,onChange:e=>p(e)})})]})}),(0,a.jsx)(Gs,{entityId:i.id,entityType:cs.User})]}),(0,a.jsx)("div",{className:"wpqt-mt-7",children:(0,a.jsx)(_o,{user:i})})]}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-2",children:[(0,a.jsx)(Bt,{icon:(0,a.jsx)(Qi.A,{className:"wpqt-icon-blue wpqt-size-4"}),text:(0,o.__)("User details","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}`,r({type:H})}}),(0,a.jsx)(Bt,{icon:(0,a.jsx)($i.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,o.__)("User tasks","quicktasker"),onClick:()=>{window.location.hash=`#/users/${i.id}/tasks`,r({type:H})}}),v&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(Vi.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Reset password","quicktasker"),loading:k,onClick:()=>yo(this,void 0,void 0,(function*(){j(!0),yield f(i.id,(()=>{g({type:le,payload:i.id}),x(!1)})),j(!1)}))}),!h&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(Hi.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,o.__)("Activate user","quicktasker"),loading:_,onClick:()=>yo(this,void 0,void 0,(function*(){y(!0),yield q(i.id,!0,(e=>{g({type:oe,payload:Object.assign({},e)}),w(!0)})),y(!1)}))}),h&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(Hi.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Disable user","quicktasker"),loading:_,onClick:()=>yo(this,void 0,void 0,(function*(){y(!0),yield q(i.id,!1,(e=>{g({type:oe,payload:Object.assign({},e)}),w(!1)})),y(!1)}))}),c&&(0,a.jsx)(Bt,{icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,o.__)("Delete user","quicktasker"),loading:b,onClick:()=>yo(this,void 0,void 0,(function*(){C(!0),yield m(i.id,(e=>{g({type:re,payload:e}),r({type:H})})),C(!1)}))})]})]}),(0,a.jsx)(Xt,{onSave:()=>{i&&t(Object.assign(Object.assign({},i),{name:l,description:u}))},saveBtnText:e?(0,o.__)("Saving...","quicktasker"):(0,o.__)("Save","quicktasker")})]}):null}));var Co=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function So(){const{state:{userModalOpen:e}}=(0,n.useContext)(St),{modalSaving:t,setModalSaving:s,modalContentRef:i,closeModal:o,handleSuccess:r}=Dt(H),{editUser:c}=Gi();return(0,a.jsx)(Kt,{modalOpen:e,closeModal:o,size:"xl",children:(0,a.jsx)(bo,{ref:i,modalSaving:t,editUser:e=>Co(this,void 0,void 0,(function*(){s(!0),yield c(e,(e=>{r(oe,e,It.USER)})),s(!1)}))})})}function To(){const{state:{userSettingsModalOpen:e},modalDispatch:t}=(0,n.useContext)(St);return(0,a.jsx)(Kt,{modalOpen:e,closeModal:()=>t({type:K,payload:!1}),size:"lg",children:(0,a.jsx)("div",{children:(0,a.jsx)(Gs,{entityId:"null",entityType:cs.Users})})})}var No=s(8316),Oo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Ao(){const[e,t]=(0,n.useState)(!1),[s,r]=(0,n.useState)(""),[c,l]=(0,n.useState)(""),{userDispatch:d}=(0,n.useContext)(Et),{createUser:u}=Gi(),p=()=>{r(""),l(""),t(!1)};return(0,a.jsx)("div",{className:"wpqt-mb-6",children:e?(0,a.jsxs)("div",{className:"wpqt-w-1/4",children:[(0,a.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User name","quicktasker")}),(0,a.jsx)(ds,{value:s,onChange:r,className:"wpqt-w-full"}),(0,a.jsx)("label",{className:"wpqt-mb-2 wpqt-block wpqt-font-semibold",children:(0,o.__)("User description","quicktasker")}),(0,a.jsx)(hs,{value:c,onChange:l,className:"wpqt-w-full"}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-justify-end wpqt-gap-3",children:[(0,a.jsx)(Bt,{text:(0,o.__)("Cancel","quicktasker"),onClick:p,icon:(0,a.jsx)(zt.A,{className:"wpqt-icon-red wpqt-size-5"})}),(0,a.jsx)(Bt,{text:(0,o.__)("Add","quicktasker"),onClick:()=>Oo(this,void 0,void 0,(function*(){s?yield u(s,c,(e=>{d({type:ae,payload:e}),p()})):i.oR.error("User name is required")})),icon:(0,a.jsx)(No.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]}):(0,a.jsx)(Bt,{text:(0,o.__)("Add QuickTasker","quicktasker"),onClick:()=>t(!0),icon:(0,a.jsx)(No.A,{className:"wpqt-icon-green wpqt-size-5"})})})}const Eo=()=>{const{state:{usersSearchValue:e}}=(0,n.useContext)(Et);return{filterUsers:t=>t.name.toLowerCase().includes(e.toLowerCase())||t.description&&t.description.toLowerCase().includes(e.toLowerCase())}};var Po=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Io({user:e}){const{modalDispatch:t}=(0,n.useContext)(St),{userDispatch:s}=(0,n.useContext)(Et),{changeUserStatus:i,deleteUser:r,resetUserPassword:c}=Gi(),[l,d]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),[h,w]=(0,n.useState)(!1),v=e.is_active,x=t=>Po(this,void 0,void 0,(function*(){w(!0),yield i(e.id,t,(()=>{s({type:ce,payload:{userId:e.id,isActive:t}})})),w(!1)}));return(0,a.jsxs)(en,{menuBtn:({active:e})=>(0,a.jsx)(tn,{isActive:e,IconComponent:Gn.A}),children:[(0,a.jsx)(sn,{text:(0,o.__)("User details","quicktasker"),icon:(0,a.jsx)(Qi.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,a.jsx)(sn,{text:(0,o.__)("User tasks","quicktasker"),icon:(0,a.jsx)($i.A,{className:"wpqt-icon-blue wpqt-size-4"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}/tasks`}}),(0,a.jsx)(sn,{text:(0,o.__)("Edit user","quicktasker"),icon:(0,a.jsx)(Ts.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:s=>{s.stopPropagation(),t({type:V,payload:e})}}),e.has_password&&(0,a.jsx)(sn,{text:(0,o.__)("Reset password","quicktasker"),loading:l,icon:(0,a.jsx)(Vi.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Po(this,void 0,void 0,(function*(){t.stopPropagation(),d(!0),yield c(e.id,(()=>{s({type:le,payload:e.id})})),d(!1)}))}),v&&(0,a.jsx)(sn,{text:(0,o.__)("Disable user","quicktasker"),loading:h,icon:(0,a.jsx)(Hi.A,{className:"wpqt-icon-red wpqt-size-4"}),className:"!wpqt-mb-0",onClick:e=>{e.stopPropagation(),x(!1)}}),!v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sn,{text:(0,o.__)("Activate user","quicktasker"),loading:h,icon:(0,a.jsx)(Hi.A,{className:"wpqt-icon-green wpqt-size-4"}),onClick:e=>{e.stopPropagation(),x(!0)}}),(0,a.jsx)(sn,{text:(0,o.__)("Delete user","quicktasker"),loading:u,icon:(0,a.jsx)(es.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:t=>Po(this,void 0,void 0,(function*(){t.stopPropagation(),p(!0),yield r(e.id,(e=>{s({type:re,payload:e})})),p(!1)}))})]})]})}function Do({user:e}){const{userPage:t}=Ji(),{modalDispatch:s}=(0,n.useContext)(St),i=e.is_active,r=t+"&code="+e.page_hash;return(0,a.jsxs)($n,{title:e.name,description:e.description,dropdown:(0,a.jsx)(Io,{user:e}),onClick:()=>{s({type:V,payload:e})},className:"wpqt-cursor-pointer",children:[(0,a.jsx)(Hn,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("Open user page","quicktasker"),icon:(0,a.jsx)(Ss.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:e=>{e.stopPropagation(),window.open(r,"_blank")}}),(0,a.jsx)(Hn,{className:"hover:wpqt-underline wpqt-self-start",label:(0,o.__)("View user details","quicktasker"),icon:(0,a.jsx)(Ss.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:t=>{t.stopPropagation(),window.location.hash=`#/users/${e.id}`}}),(0,a.jsx)(Hn,{label:(0,o.__)("Status","quicktasker"),value:i?(0,o.__)("Active","quicktasker"):(0,o.__)("Disabled","quicktasker"),valueClassName:i?"wpqt-text-qtTextGreen wpqt-font-bold":"wpqt-text-qtTextRed wpqt-font-bold",icon:(0,a.jsx)(Hi.A,{className:"wpqt-size-5 "+(i?"wpqt-icon-green":"wpqt-icon-red")})})]})}function Ro(){const{state:{users:e}}=(0,n.useContext)(Et),{filterUsers:t}=Eo(),s=e.filter(t);return e&&0===e.length?(0,a.jsx)(Fn,{text:(0,o.__)("No users found","quicktasker")}):s&&0===s.length?(0,a.jsx)(Fn,{}):(0,a.jsx)("div",{className:"wpqt-card-grid",children:s.map((e=>(0,a.jsx)(Do,{user:e},e.id)))})}function Uo(){return(0,a.jsxs)("div",{children:[(0,a.jsx)(Ao,{}),(0,a.jsx)(xo,{}),(0,a.jsx)(Ro,{}),(0,a.jsx)(To,{}),(0,a.jsx)(So,{})]})}var Lo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};var Fo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Mo({user:e}){const[t,s]=(0,n.useState)({quicktasker_admin_role:"quicktasker_admin_role"in e.allcaps,quicktasker_admin_role_allow_delete:"quicktasker_admin_role_allow_delete"in e.allcaps,quicktasker_admin_role_manage_users:"quicktasker_admin_role_manage_users"in e.allcaps,quicktasker_admin_role_manage_settings:"quicktasker_admin_role_manage_settings"in e.allcaps}),[i,r]=(0,n.useState)(!1),{updateWPUserCapabilities:c}=function(){return{updateWPUserCapabilities:(e,t,s,n)=>Lo(this,void 0,void 0,(function*(){try{yield function(e,t){return u()({path:`/wpqt/v1/wp-users/${e}/capabilities`,method:"PATCH",data:{quicktasker_admin_role:t.quicktasker_admin_role,quicktasker_admin_role_allow_delete:t.quicktasker_admin_role_allow_delete,quicktasker_admin_role_manage_users:t.quicktasker_admin_role_manage_users,quicktasker_admin_role_manage_settings:t.quicktasker_admin_role_manage_settings},headers:p()})}(e,t),s&&s()}catch(e){n&&n(e)}}))}}(),l=(n,a)=>Fo(this,void 0,void 0,(function*(){if(i)return;r(!0);const o=Object.assign({},t),l=Object.assign(Object.assign({},t),{[a]:n});s(l),yield c(e.id,l,(()=>{}),(()=>{s(o)})),r(!1)}));return(0,a.jsxs)($n,{title:e.name,description:e.description,children:[(0,a.jsx)(Hn,{label:(0,o.__)("Role","quicktasker"),value:Array.isArray(e.roles)?e.roles.join(", "):""}),(0,a.jsx)(Hn,{label:(0,o.__)("Email","quicktasker"),value:e.email}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to admin areas","quicktasker")}),(0,a.jsx)(vs,{checked:t.quicktasker_admin_role,handleChange:e=>{l(e,"quicktasker_admin_role")}})]}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to users page","quicktasker")}),(0,a.jsx)(vs,{checked:t.quicktasker_admin_role_manage_users,handleChange:e=>{l(e,"quicktasker_admin_role_manage_users")}})]}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Access to settings page","quicktasker")}),(0,a.jsx)(vs,{checked:t.quicktasker_admin_role_manage_settings,handleChange:e=>{l(e,"quicktasker_admin_role_manage_settings")}})]}),(0,a.jsxs)("div",{className:"wpqt-mb-2",children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Allow to delete resources","quicktasker")}),(0,a.jsx)(vs,{checked:t.quicktasker_admin_role_allow_delete,handleChange:e=>{l(e,"quicktasker_admin_role_allow_delete")}})]}),i&&(0,a.jsx)(Je,{ovalSize:"24"})]})}var zo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function $o(){const[e,t]=(0,n.useState)(null),[s,i]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{(()=>{zo(this,void 0,void 0,(function*(){try{i(!0);const s=yield(e=ze.Other,u()({path:`/wpqt/v1/wp-users?type=${encodeURIComponent(e)}`,method:"GET",headers:p()}));t(s.data)}catch(e){console.error(e)}finally{i(!1)}var e}))})()}),[]),s||null===e?(0,a.jsx)(Je,{ovalSize:"48"}):0===e.length?(0,a.jsx)(Fn,{text:(0,o.__)("No non-admin WordPress users found","quicktasker")}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,o.__)("Displaying non-admin WordPress users.","quicktasker")}),(0,a.jsx)("div",{className:"wpqt-card-grid",children:e.map((e=>(0,a.jsx)(Mo,{user:e},e.id)))})]})}function Ho(){const{updateUsers:e}=(0,n.useContext)(Et),{loadingDispatch:t}=(0,n.useContext)(Ve),{modalDispatch:s}=(0,n.useContext)(St),i=[(0,a.jsx)(Uo,{},0),(0,a.jsx)($o,{},1)];return(0,n.useEffect)((()=>{(()=>{var s,n,a,i;s=this,n=void 0,i=function*(){t({type:pe,payload:!0}),yield e(),t({type:pe,payload:!1})},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function r(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(o,r)}c((i=i.apply(s,n||[])).next())}))})()}),[]),(0,a.jsxs)(Ze,{children:[(0,a.jsx)(l,{description:(0,o.__)("Manage QuickTaskers and WordPress users. This plugin supports three types of users: WordPress admins, other WordPress users, and QuickTaskers. WordPress admins have full access to all admin areas. Other WordPress users do not have any access by default but can be granted if needed. QuickTaskers are separate users who do not have admin access but can manage tasks through a mobile-friendly webpage.","quicktasker"),icon:(0,a.jsx)(Ia.A,{className:"wpqt-icon-gray wpqt-size-7 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{s({type:K,payload:!0})}}),children:(0,o.__)("Users","quicktasker")}),(0,a.jsx)(on,{tabs:["QuickTaskers","WordPress users"],tabsContent:i,tabListClassName:"wpqt-gap-5",tabClassName:"wpqt-flex-none"})]})}const Vo=(e,t)=>{switch(t.type){case qe:{const s=t.payload.map(Re);return Object.assign(Object.assign({},e),{tasks:s})}case fe:{const s=t.payload;return Object.assign(Object.assign({},e),{tasks:e.tasks.filter((e=>e.id!==s))})}case ge:{const s=t.payload,n=e.tasks.map((e=>e.id===s.id?Re(s):e));return Object.assign(Object.assign({},e),{tasks:n})}case me:{const s=t.payload;return Object.assign(Object.assign({},e),{searchValue:s})}case ke:{const s=t.payload;return Object.assign(Object.assign({},e),{filteredPipelineId:s})}case je:{const{taskId:s,user:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:[n,...e.assigned_users]}):e));return Object.assign(Object.assign({},e),{tasks:a})}case _e:{const{taskId:s,user:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{assigned_users:e.assigned_users.filter((e=>e.id!==n.id))}):e));return Object.assign(Object.assign({},e),{tasks:a})}case ye:{const{taskId:s,done:n}=t.payload,a=e.tasks.map((e=>e.id===s?Object.assign(Object.assign({},e),{is_done:n}):e));return Object.assign(Object.assign({},e),{tasks:a})}default:return e}};var Bo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};const Go={tasks:[],searchValue:"",filteredPipelineId:""},Ko=(0,n.createContext)({state:Go,userTasksDispatch:()=>{},fetchAndSetUserTasks:()=>Bo(void 0,void 0,void 0,(function*(){}))}),Wo=({children:e,userId:t})=>{const[s,r]=(0,n.useReducer)(Vo,Go),{loadingDispatch:c}=(0,n.useContext)(Ve);(0,n.useEffect)((()=>{l()}),[]);const l=()=>Bo(void 0,void 0,void 0,(function*(){try{c({type:pe,payload:!0});const e=yield function(e){return u()({path:`/wpqt/v1/users/${e}/tasks`,method:"GET",headers:p()})}(t);r({type:qe,payload:e.data})}catch(e){console.error(e),i.oR.error((0,o.__)("Failed to fetch user tasks","quicktasker"))}finally{c({type:pe,payload:!1})}}));return(0,a.jsx)(Ko.Provider,{value:{state:s,userTasksDispatch:r,fetchAndSetUserTasks:l},children:e})};function Qo(){const{state:{searchValue:e,filteredPipelineId:t},userTasksDispatch:s}=(0,n.useContext)(Ko);return(0,a.jsxs)(dt,{title:(0,o.__)("Filter tasks","quicktasker"),children:[(0,a.jsx)(ds,{value:e,onChange:e=>{s({type:me,payload:e})},className:"!wpqt-mb-0"}),(0,a.jsx)(lt,{selectedOptionValue:t,selectionChange:e=>{s({type:ke,payload:e})}})]})}var Yo=s(7028),Xo=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function Jo({taskId:e,onUnAssignTask:t}){const[s,i]=(0,n.useState)(!1);return(0,a.jsx)(en,{menuBtn:({active:e})=>(0,a.jsx)(tn,{isActive:e,IconComponent:Gn.A}),children:(0,a.jsx)(sn,{text:(0,o.__)("Unassign from task","quicktasker"),loading:s,icon:(0,a.jsx)(Yo.A,{className:"wpqt-icon-red wpqt-size-4"}),onClick:s=>Xo(this,void 0,void 0,(function*(){s.stopPropagation(),i(!0),yield t(e),i(!1)})),className:"!wpqt-mb-0"})})}const Zo=()=>{const{state:{searchValue:e,filteredPipelineId:t}}=(0,n.useContext)(Ko);return{filterTasks:s=>{const n=s.name&&s.name.toLowerCase().includes(e.toLowerCase())||s.description&&s.description.toLowerCase().includes(e.toLowerCase()),a=!t||s.pipeline_id===t;return n&&a}}};var er=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((n=n.apply(e,t||[])).next())}))};function tr({userId:e}){var t;const{filterTasks:s}=Zo(),{modalDispatch:i}=(0,n.useContext)(St),{state:{tasks:r},userTasksDispatch:c}=(0,n.useContext)(Ko),{removeTaskFromUser:l}=_t(),d=null!==(t=null==r?void 0:r.filter(s))&&void 0!==t?t:[],u=t=>er(this,void 0,void 0,(function*(){yield l(e,t,(()=>{c({type:fe,payload:t})}))}));return r&&0===r.length?(0,a.jsx)(Fn,{text:(0,o.__)("User has no tasks","quicktasker")}):d&&0===d.length?(0,a.jsx)(Fn,{}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-card-grid",children:d.map((e=>(0,a.jsxs)($n,{className:"wpqt-cursor-pointer",title:e.name,description:e.description,dropdown:(0,a.jsx)(Jo,{taskId:e.id,onUnAssignTask:u}),onClick:()=>{i({type:D,payload:{taskToEdit:e}})},children:[(0,a.jsx)(nn,{task:e,onUserAdd:t=>{c({type:je,payload:{taskId:e.id,user:t}})},onUserDelete:t=>{c({type:_e,payload:{taskId:e.id,user:t}})}}),(0,a.jsx)(Bn,{task:e,onDoneStatusChange:(e,t)=>{c({type:ye,payload:{taskId:e,done:t}})}})]},e.id)))}),(0,a.jsx)(Ln,{editTaskCallback:e=>{c({type:ge,payload:e})}})]})}function sr({userId:e}){return(0,a.jsx)(Wo,{userId:e,children:(0,a.jsxs)(Ze,{children:[(0,a.jsx)(l,{description:(0,o.__)("Tasks assigned to user","quicktasker"),children:(0,o.__)("User tasks","quicktasker")}),(0,a.jsx)(Qo,{}),(0,a.jsx)(tr,{userId:e})]})})}const nr=()=>{const{page:e,hash:t}=ar();if("wp-quick-tasks"===e){const e=t.match(/^#\/users\/(\d+)\/tasks$/);if(e){const t=e[1];return(0,a.jsx)(sr,{userId:t})}const s=t.match(/^#\/users\/(\d+)$/);if(s){const e=s[1];return(0,a.jsx)(so,{userId:e})}switch(t){case"#/users":return(0,a.jsx)(Ho,{});case"#/overview":return(0,a.jsx)(ja,{});case"#/archive":return(0,a.jsx)(Jn,{});case"#/user-sessions":return(0,a.jsx)(vo,{});case"#/logs":return(0,a.jsx)(la,{});case"#/settings":return(0,a.jsx)(zi,{});case"#/guide":return(0,a.jsx)(Zn,{});default:return(0,a.jsx)(ti,{})}}},ar=()=>({page:new URLSearchParams(window.location.search).get("page"),hash:window.location.hash}),ir=function(){const e=(()=>{const[e,t]=(0,n.useState)(nr());return(0,n.useEffect)((()=>{const e=()=>{t(nr()),(()=>{const{page:e,hash:t}=ar();if("wp-quick-tasks"!==e)return;const s=document.querySelectorAll("#toplevel_page_wp-quick-tasks .wp-submenu li");s.forEach((e=>e.classList.remove("wpqt-current")));const n={"#/users":"#/users","#/overview":"#/overview","#/archive":"#/archive","#/user-sessions":"#/user-sessions","#/logs":"#/logs","#/settings":"#/settings","#/guide":"#/guide",default:""};let a=n.default;void 0!==n[t]?a=n[t]:/^#\/users(\/\d+)?(\/tasks)?$/.test(t)&&(a="#/users"),s.forEach((e=>{const t=e.querySelector("a");t&&t.getAttribute("href")&&t.getAttribute("href")===`admin.php?page=wp-quick-tasks${a}`&&e.classList.add("wpqt-current")}))})()};return e(),window.addEventListener("popstate",e),window.addEventListener("hashchange",e),()=>{window.removeEventListener("popstate",e),window.removeEventListener("hashchange",e)}}),[]),e})();return(0,a.jsx)(c,{children:(0,a.jsx)(os,{children:(0,a.jsx)(Pt,{children:(0,a.jsx)(Tt,{children:(0,a.jsx)(ot,{children:(0,a.jsxs)(Be,{children:[e,(0,a.jsx)(i.N9,{position:"bottom-right"})]})})})})})})};(0,n.render)((0,a.jsx)(ir,{}),document.getElementById("wpqt-app"))},1609:e=>{e.exports=window.React},5795:e=>{e.exports=window.ReactDOM},790:e=>{e.exports=window.ReactJSXRuntime}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var s=a[e]={exports:{}};return n[e].call(s.exports,s,s.exports,i),s.exports}i.m=n,e=[],i.O=(t,s,n,a)=>{if(!s){var o=1/0;for(d=0;d<e.length;d++){for(var[s,n,a]=e[d],r=!0,c=0;c<s.length;c++)(!1&a||o>=a)&&Object.keys(i.O).every((e=>i.O[e](s[c])))?s.splice(c--,1):(r=!1,a<o&&(o=a));if(r){e.splice(d--,1);var l=n();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[s,n,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);i.r(a);var o={};t=t||[null,s({}),s([]),s(s)];for(var r=2&n&&e;"object"==typeof r&&!~t.indexOf(r);r=s(r))Object.getOwnPropertyNames(r).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(a,o),a},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=524,(()=>{var e={524:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var n,a,[o,r,c]=s,l=0;if(o.some((t=>0!==e[t]))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(c)var d=c(i)}for(t&&t(s);l<o.length;l++)a=o[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(d)},s=globalThis.webpackChunkquicktasker=globalThis.webpackChunkquicktasker||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.nc=void 0;var o=i.O(void 0,[96],(()=>i(8463)));o=i.O(o)})();