(()=>{"use strict";var e,t,s,n={3503:(e,t,s)=>{const n=window.wp.element;var a=s(790);const i=window.wp.i18n;var r=s(4976),o=s(7767),c=s(9571);class l extends n.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){var e;return this.state.hasError?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-h-screen wpqt-items-center wpqt-justify-center wpqt-text-center wpqt-text-lg",children:[(0,i.__)("Something went wrong. Please refresh the page.","quicktasker"),(0,a.jsx)("br",{}),null===(e=this.state.error)||void 0===e?void 0:e.message]}):this.props.children}}const d=l,u="SET_USER_PAGE_STATUS",p="SET_USER_LOGGED_IN",w="SET_INIT_DATA",h="SET_ASSIGNED_TASKS",m="SET_ASSIGNED_TASKS_LOADING",q="SET_ASSIGNED_TASKS_SEARCH_TEXT",f="SET_ASSIGNABLE_TASKS",x="SET_ASSIGNABLE_TASKS_LOADING",g="SET_ASSIGNABLE_TASKS_SEARCH_TEXT",v="SET_USER_PAGE_TASK_DATA",k="SET_USER_PAGE_TASK_LOADING",_="UPDATE_USER_PAGE_TASK_DATA",j="UPDATE_USER_PAGE_TASK_STAGE",y="UPDATE_USER_PAGE_TASK_DONE",b="SET_USER_PAGE_NOTIFICATIONS_NEW_COMMENTS",N="CHANGE_USER_PAGE_NOTIFICATIONS_LOADING",T="SET_USER_PAGE_USER_DATA",E="SET_USER_PAGE_USER_LOADING",S=()=>new URLSearchParams(window.location.search).get("code");var C=s(8987);const A=window.wp.apiFetch;var O=s.n(A);function P(){const e=S();let t={"Content-Type":"application/json","X-WPQT-USER-API-Nonce":window.wpqt_user.userApiNonce};return e&&(t=Object.assign(Object.assign({},t),{"X-WPQT-USER-PAGE-CODE":e})),t}function D(e){return O()({method:"GET",path:`/wpqt/v1/user-page/tasks/${e}`,headers:P()})}const I="Invalid session token";var R=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function U(){const{state:{pageHash:e}}=(0,n.useContext)(K);return{setSessionCookie:t=>R(this,void 0,void 0,(function*(){const s=new Date(`${t.expiresAtUTC}Z`);localStorage.setItem(`wpqt-session-expiration-${e}`,s.toISOString()),C.A.set(`wpqt-session-token-${e}`,t.sessionToken,{expires:s,path:"/",sameSite:"strict"})})),getSessionCookieValue:()=>C.A.get(`wpqt-session-token-${e}`),deleteSessionCookie:()=>R(this,void 0,void 0,(function*(){localStorage.removeItem(`wpqt-session-expiration-${e}`),C.A.remove(`wpqt-session-token-${e}`)})),getSessionTimeLeft:e=>{if(!e)return null;const t=localStorage.getItem(`wpqt-session-expiration-${e}`);if(!t)return null;const s=new Date(t).getTime()-(new Date).getTime();return s>0?Math.floor(s/1e3/60):0}}}var G=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function z(){const{loadUserPageStatus:e}=(0,n.useContext)(K),{deleteSessionCookie:t}=U();return{handleError:s=>G(this,void 0,void 0,(function*(){if(console.error(s),s.messages&&Array.isArray(s.messages)&&s.messages.length>0){const n=s.messages.join(", ");n.includes(I)?(c.oR.info((0,i.__)("Your session has expired. Please log in to continue.","quicktasker")),yield t(),e()):c.oR.error(n)}}))}}const L=(e,t)=>{switch(t.type){case u:{const{isActiveUser:s,setupCompleted:n,userId:a,userName:i,isQuicktaskerUser:r,isWordPressUser:o,userType:c,profilePictureUrl:l}=t.payload;return Object.assign(Object.assign({},e),{isActiveUser:Boolean(s),setupCompleted:n,initialLoading:!1,userId:a,userName:i,isQuicktaskerUser:r,isWordPressUser:o,userType:c,profilePictureUrl:l})}case p:{const s=t.payload;return Object.assign(Object.assign({},e),{isLoggedIn:s})}case w:{const{timezone:s}=t.payload;return Object.assign(Object.assign({},e),{timezone:s})}case"RESET_USER_PAGE_STATUS":return Object.assign({},$);default:return e}};const $={initialLoading:!0,isActiveUser:!1,setupCompleted:!1,isLoggedIn:!1,pageHash:S(),userId:null,userName:null,cf:!0,timezone:"",isQuicktaskerUser:!1,isWordPressUser:!1,userType:null,profilePictureUrl:null},K=(0,n.createContext)({state:$,userPageAppDispatch:()=>{},loadUserPageStatus:()=>{}}),M=({children:e})=>{const[t,s]=(0,n.useReducer)(L,$),{handleError:i}=z();(0,n.useEffect)((()=>{const e=window.wpqt_user.timezone;s({type:w,payload:{timezone:e}})}),[]),(0,n.useEffect)((()=>{r()}),[]),(0,n.useEffect)((()=>{if(!t.initialLoading){const e=(e=>e.isQuicktaskerUser&&e.pageHash?!!C.A.get(`wpqt-session-token-${e.pageHash}`):!(!e.isWordPressUser||!e.userId)&&!!e.userId)(t);s({type:p,payload:e})}}),[t.initialLoading,t.userId,t.isWordPressUser,t.isQuicktaskerUser,t.pageHash]);const r=()=>{return e=void 0,t=void 0,a=function*(){try{const{data:e}=yield O()({path:"/wpqt/v1/user-page/status",method:"GET",headers:P()});s({type:u,payload:Object.assign({},e)})}catch(e){i(e)}},new((n=void 0)||(n=Promise))((function(s,i){function r(e){try{c(a.next(e))}catch(e){i(e)}}function o(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((a=a.apply(e,t||[])).next())}));var e,t,n,a};return(0,a.jsx)(K.Provider,{value:{state:t,userPageAppDispatch:s,loadUserPageStatus:r},children:e})};var F,B,H,W,Y,V,Q,Z,X;!function(e){e.TASK_DONE="task-done",e.Task_NOT_DONE="task-not-done",e.TASK_CREATED="task-created",e.TASK_DELETED="task-deleted",e.TASK_ASSIGNED="task-assigned",e.TASK_UNASSIGNED="task-unassigned",e.TASK_PUBLIC_COMMENT_ADDED="task-public-comment-added",e.TASK_PRIVATE_COMMENT_ADDED="task-private-comment-added",e.TASK_FILE_UPLOADED="task-attachment-added",e.TASK_FILE_DELETED="task-attachment-deleted"}(F||(F={})),function(e){e.WOOCOMMERCE_ORDER_ADDED="woocommerce-order-added"}(B||(B={})),function(e){e.SEATREG_BOOKING_CREATED="seatreg-booking-created",e.SEATREG_BOOKING_APPROVED="seatreg-booking-approved",e.SEATREG_BOOKING_APPROVED_VIA_MANAGER="seatreg-booking-approved-via-manager",e.SEATREG_BOOKING_PENDING="seatreg-booking-pending",e.SEATREG_BOOKING_PENDING_VIA_MANAGER="seatreg-booking-pending-via-manager"}(H||(H={})),function(e){e.PIPELINE="pipeline",e.Stage="stage",e.Task="task",e.quicktasker="quicktasker",e.WOOCOMMERCE_ORDER="woocommerce-order",e.SEATREG_BOOKING="seatreg-booking"}(W||(W={})),(X=Y||(Y={})).PIPELINE="pipeline",X.STAGE="stage",X.TASK="task",X.QUICKTASKER="quicktasker",X.WP_USER="wp-user",function(e){e.ARCHIVE_TASK="archive-task",e.ASSIGN_USER="assign-user",e.NEW_ENTITY_EMAIL="new-entity-email",e.DELETED_ENTITY_EMAIL="deleted-entity-email",e.TASK_ASSIGNED_EMAIL="task-assigned-email",e.TASK_UNASSIGNED_EMAIL="task-unassigned-email",e.TASK_PUBLIC_COMMENT_ADDED_EMAIL="task-public-comment-added-email",e.TASK_PRIVATE_COMMENT_ADDED_EMAIL="task-private-comment-added-email",e.TASK_FILE_UPLOADED_EMAIL="task-attachment-added-email",e.TASK_FILE_DELETED_EMAIL="task-attachment-deleted-email",e.CREATE_TASK="create-task",e.SEND_SLACK_MESSAGE="send-slack-message"}(V||(V={})),(Z=Q||(Q={})).QUICKTASKER="quicktasker",Z.WP_USER="wp-user";const J=e=>Object.assign(Object.assign({},e),{is_active:"1"===e.is_active,has_password:"1"===e.has_password}),ee=e=>e.user_type===Q.WP_USER?e:J(e),te=(Q.QUICKTASKER,Q.WP_USER,e=>Object.assign(Object.assign({},e),{task_order:Number(e.task_order),free_for_all:"1"===e.free_for_all,is_archived:"1"===e.is_archived,is_done:"1"===e.is_done,assigned_users:e.assigned_users?e.assigned_users.map((e=>Object.assign({},J(e)))):[]})),se=(e,t)=>{switch(t.type){case x:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case f:{const s=t.payload;return Object.assign(Object.assign({},e),{assignableTasks:s.map(te)})}case"REMOVE_ASSIGNABLE_TASK":{const s=t.payload;return Object.assign(Object.assign({},e),{assignableTasks:e.assignableTasks.filter((e=>e.id!==s))})}case g:{const s=t.payload;return Object.assign(Object.assign({},e),{searchText:s})}default:return e}};const ne={loading:!0,assignableTasks:[],searchText:""},ae=(0,n.createContext)({state:ne,userAssignableTasksDispatch:()=>{},loadAssignableTasks:()=>{}}),ie=({children:e})=>{const[t,s]=(0,n.useReducer)(se,ne),{state:{pageHash:i}}=(0,n.useContext)(K),{handleError:r}=z();(0,n.useEffect)((()=>{o()}),[i]);const o=()=>{return e=void 0,t=void 0,a=function*(){try{s({type:x,payload:!0});const e=yield O()({method:"GET",path:"/wpqt/v1/user-page/assignable-tasks",headers:P()});s({type:f,payload:e.data})}catch(e){r(e)}finally{s({type:x,payload:!1})}},new((n=void 0)||(n=Promise))((function(s,i){function r(e){try{c(a.next(e))}catch(e){i(e)}}function o(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((a=a.apply(e,t||[])).next())}));var e,t,n,a};return(0,a.jsx)(ae.Provider,{value:{state:t,userAssignableTasksDispatch:s,loadAssignableTasks:o},children:e})};var re=s(2912),oe=s(6061);function ce({width:e="80",height:t="80",className:s="",color:n="#1d4ed8",secondaryColor:i="#2563eb"}){return(0,a.jsx)(oe.BM,{visible:!0,height:t,width:e,color:n,secondaryColor:i,ariaLabel:"oval-loading",wrapperStyle:{},wrapperClass:s})}function le(){return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen-minus-top-bar wpqt-flex-col wpqt-items-center wpqt-justify-center",children:(0,a.jsx)(ce,{})})}function de({className:e="",ovalSize:t}){const s=t?{width:t,height:t}:{};return(0,a.jsx)("div",{className:`wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center ${e}`,"data-testid":"loading-oval",children:(0,a.jsx)(ce,Object.assign({},s))})}function ue({errorText:e}){return e?(0,a.jsx)("div",{className:"wpqt-text-qtTextRed wpqt-mt-1",children:e}):null}var pe;!function(e){e.TEXT="text",e.PASSWORD="password"}(pe||(pe={}));const we=(0,n.forwardRef)(((e,t)=>{var{value:s,onChange:n,isAutoFocus:i,className:r="",wrapperClassName:o="",disabled:c=!1,type:l=pe.TEXT,loading:d=!1,inputId:u,name:p,errorText:w}=e,h=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]])}return s}(e,["value","onChange","isAutoFocus","className","wrapperClassName","disabled","type","loading","inputId","name","errorText"]);return(0,a.jsxs)("div",{className:`wpqt-inline-block wpqt-relative wpqt-mb-3 ${o}`,children:[(0,a.jsx)(re.p,Object.assign({ref:t,autoFocus:i,className:`wpqt-block !wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6 focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${r}`,value:s,disabled:c,onChange:e=>n(e.target.value),type:l,id:u,name:p},h)),d&&(0,a.jsx)(ce,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"}),w&&(0,a.jsx)(ue,{errorText:w})]})}));function he({title:e,searchValue:t,onSearchChange:s=()=>{}}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-1 wpqt-mb-3",children:[(0,a.jsx)("div",{children:e}),(0,a.jsx)(we,{value:t,onChange:s})]})}var me=s(4180),qe=s(3211),fe=s(4748),xe=s(8054),ge=s(4353),ve=s.n(ge);const ke=(e,t)=>e.filter((e=>!t.find((t=>t.id===e.id)))),_e=e=>{const t=ve()().utc().format("YYYY-MM-DD HH:mm:ss");return e.filter((e=>{try{return!!e.created_at&&function(e,t){const s=new Date(e),n=new Date(t).getTime()-s.getTime(),a=Math.floor(n/1e3),i=Math.floor(a/60),r=Math.floor(i/60);return{milliseconds:n,seconds:a,minutes:i,hours:r,days:Math.floor(r/24)}}(e.created_at,t).days<=5}catch(e){return console.error("Error filtering old comment: ",e),!1}}))};var je=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};const ye="wpqt-stored-comments";function be(){const{state:{pageHash:e,userId:t,userType:s}}=(0,n.useContext)(K),a=s===Q.QUICKTASKER?e:t,i=()=>je(this,void 0,void 0,(function*(){try{const e=localStorage.getItem(`${ye}-${a}`);return e?JSON.parse(e):[]}catch(e){return console.error("Error retrieving stored comments:",e),[]}}));return{getStoredComments:i,storeComments:e=>je(this,void 0,void 0,(function*(){try{const t=yield i(),s=_e(t),n=ke(e,s),r=[...s,...n];localStorage.setItem(`${ye}-${a}`,JSON.stringify(r))}catch(e){console.error("Error storing comments:",e)}}))}}const Ne=(e,t)=>{switch(t.type){case b:{const s=t.payload;return Object.assign(Object.assign({},e),{newComments:s})}case N:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}default:return e}};var Te=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};const Ee={newComments:[],loading:!0},Se=(0,n.createContext)({state:Ee,userPageNotificationsDispatch:()=>{},checkNewComments:()=>Te(void 0,void 0,void 0,(function*(){}))}),Ce=({children:e})=>{const[t,s]=(0,n.useReducer)(Ne,Ee),{state:{pageHash:r,isLoggedIn:o,isQuicktaskerUser:l}}=(0,n.useContext)(K),{handleError:d}=z(),{getStoredComments:u}=be(),{getSessionTimeLeft:p}=U();(0,n.useEffect)((()=>{const e=setInterval((()=>{m()}),6e4);return m(),()=>{clearInterval(e)}}),[o]),(0,n.useEffect)((()=>{if(!l)return;const e=setInterval((()=>{h()}),6e5);return()=>{clearInterval(e)}}),[l]);const w=e=>{s({type:N,payload:e})},h=()=>{if(!o)return;const e=p(r);e&&e<=30&&c.oR.info((0,i.sprintf)((0,i.__)("Your session is about to expire in %s minutes","quicktasker"),e))},m=()=>Te(void 0,void 0,void 0,(function*(){if(o)try{w(!0);const e=yield u(),t=yield O()({method:"GET",path:"/wpqt/v1/user-page/comments",headers:P()}),n=ke(t.data,e);s({type:b,payload:n})}catch(e){d(e)}finally{w(!1)}}));return(0,a.jsx)(Se.Provider,{value:{state:t,userPageNotificationsDispatch:s,checkNewComments:m},children:e})};var Ae=s(8624),Oe=s(7656),Pe=s(1111),De=s(2185),Ie=s(7008);function Re({id:e}){return(0,a.jsx)(Ie.m_,{id:e,className:"wpqt-bg-red-600 wpqt-z-9999",children:(0,a.jsx)("span",{children:"Tooltip content"})})}function Ue({children:e,menuBtn:t,menuBtnClasses:s="",anchor:n="bottom end"}){return(0,a.jsxs)(De.W1,{children:[(0,a.jsx)(De.IU,{as:"div",className:`wpqt-cursor-pointer ${s}`,onClick:e=>e.stopPropagation(),children:({active:e})=>(0,a.jsx)(a.Fragment,{children:t({active:e})})}),(0,a.jsx)(De.c,{anchor:n,transition:!0,className:"wpqt-z-20 wpqt-origin-top wpqt-rounded-xl wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-bg-white wpqt-p-4 wpqt-transition wpqt-duration-200 wpqt-ease-out data-[closed]:wpqt-scale-95 data-[closed]:wpqt-opacity-0",children:e})]})}function Ge({text:e,onClick:t,icon:s,className:n,disabled:i=!1,id:r="",tooltipText:o="",loading:c=!1}){const l=""!==o&&""!==r?{"data-tooltip-id":r,"data-tooltip-content":o,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsx)(De.Dr,{children:(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-mb-3 wpqt-flex wpqt-items-center wpqt-gap-2 wpqt-relative ${i?"wpqt-cursor-not-allowed wpqt-line-through":"wpqt-cursor-pointer hover:wpqt-underline"} ${n}`,onClick:e=>{!i&&t&&t(e)},children:[s,(0,a.jsx)("span",{className:c?"wpqt-invisible":"",children:e}),c&&(0,a.jsx)(ce,{width:"16",height:"16",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"}),(0,a.jsx)(Re,{id:r})]}))})}var ze=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Le(){const{loadUserPageStatus:e,state:{profilePictureUrl:t}}=(0,n.useContext)(K),[s,r]=(0,n.useState)(!1),{handleError:c}=z(),{deleteSessionCookie:l}=U(),d=(0,o.Zp)();return(0,a.jsxs)(Ue,{anchor:"bottom end",menuBtn:({active:e})=>(0,a.jsx)("div",{children:t?(0,a.jsx)("img",{className:"wpqt-size-11 wpqt-rounded-full wpqt-cursor-pointer",src:t}):(0,a.jsx)(Pe.A,{className:`wpqt-icon-blue wpqt-size-11 ${e?"wpqt-text-blue-900":""} hover:wpqt-text-blue-900`})}),children:[(0,a.jsx)(Ge,{text:(0,i.__)("View profile","quicktasker"),icon:(0,a.jsx)(Ae.A,{className:"wpqt-icon-blue wpqt-size-4"}),className:"wpqt-mb-4",onClick:()=>{d("/user/profile")}}),(0,a.jsx)(Ge,{text:(0,i.__)("Log out","quicktasker"),icon:(0,a.jsx)(Oe.A,{className:"wpqt-icon-red wpqt-size-4"}),className:"!wpqt-mb-0",onClick:t=>ze(this,void 0,void 0,(function*(){t.preventDefault();try{r(!0),yield O()({method:"POST",path:"/wpqt/v1/user-page/logout",headers:P()}),yield l(),window.location.reload()}catch(t){r(!1),c(t),e()}})),loading:s})]})}function $e({loading:e,onRefresh:t=()=>{}}){const s=(0,o.Zp)(),{checkNewComments:i}=(0,n.useContext)(Se);return(0,a.jsxs)("div",{className:"wpqt-grid wpqt-h-[60px] wpqt-grid-cols-[1fr_auto_1fr] wpqt-items-center wpqt-border-0 wpqt-border-t wpqt-border-solid wpqt-border-y-gray-300 wpqt-px-4 wpqt-py-2 lg:wpqt-border-b lg:wpqt-border-t-0",children:[(0,a.jsx)("div",{className:"wpqt-flex wpqt-gap-2",children:(0,a.jsx)(me.A,{onClick:()=>s("/"),className:"wpqt-size-8 wpqt-cursor-pointer"})}),(0,a.jsx)("div",{className:"wpqt-text-center",children:e?(0,a.jsx)(ce,{width:"30",height:"30"}):(0,a.jsx)(qe.A,{className:"wpqt-icon-blue wpqt-size-9 wpqt-cursor-pointer hover:wpqt-text-qtBlueHover",onClick:()=>{t(),i()}})}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-items-center wpqt-justify-end wpqt-gap-3",children:[(0,a.jsx)(Ke,{}),(0,a.jsx)(Le,{})]})]})}function Ke(){const e=(0,o.Zp)(),{state:{newComments:t}}=(0,n.useContext)(Se);return(0,a.jsx)(a.Fragment,{children:t.length>0?(0,a.jsx)(fe.A,{className:"wpqt-icon-red wpqt-size-7 wpqt-animate-bellShake wpqt-cursor-pointer",onClick:()=>{e("/notifications")}}):(0,a.jsx)(xe.A,{className:"wpqt-icon-gray wpqt-size-7 wpqt-cursor-pointer",onClick:()=>{e("/notifications")}})})}function Me({children:e,loading:t=!1,onRefresh:s,className:n}){return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col",children:[(0,a.jsx)("div",{className:`wpqt-user-app-content-height wpqt-order-1 wpqt-overflow-y-auto lg:wpqt-order-2 ${n}`,children:e}),(0,a.jsx)("div",{className:"wpqt-order-2 lg:wpqt-order-1",children:(0,a.jsx)($e,{loading:t,onRefresh:s})})]})}function Fe({children:e}){return(0,a.jsx)("div",{className:"wpqt-p-4",children:e})}function Be({children:e}){return(0,a.jsx)("div",{className:"wpqt-flex wpqt-h-screen wpqt-flex-col wpqt-items-center wpqt-justify-center",children:e})}function He({children:e,description:t,titleClassName:s="",className:n=""}){return(0,a.jsxs)("div",{className:`wpqt-mb-6 ${n}`,children:[(0,a.jsx)("h1",{className:`wpqt-m-0 wpqt-text-center wpqt-text-2xl wpqt-font-normal ${s}`,children:e}),t&&(0,a.jsx)("div",{className:"wpqt-mt-1 wpqt-text-center wpqt-text-gray-600",children:t})]})}var We=s(3997),Ye=s(3033),Ve=s(587),Qe=s(1052),Ze=s(4164);function Xe({className:e,onClick:t,title:s,description:n,children:i,dropdown:r,titleClassName:o="",style:c={}}){const l=void 0!==r;return(0,a.jsxs)("div",{className:(0,Ze.$)("wpqt-relative wpqt-flex wpqt-flex-col wpqt-rounded wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-p-4",l&&"wpqt-pr-[24px]",e),style:c,onClick:t,children:[(0,a.jsxs)("div",{className:"wpqt-mb-3",children:[(0,a.jsx)("div",{className:`wpqt-text-lg ${o}`,children:s}),n&&(0,a.jsx)("div",{className:"wpqt-italic wpqt-text-gray-500",children:n})]}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-h-full",children:i}),l&&(0,a.jsx)("div",{className:"wpqt-absolute wpqt-right-2 wpqt-top-1 wpqt-z-10",children:r})]})}function Je({label:e,value:t,valueClassName:s="",valueLink:n,icon:i,onClick:r=()=>{},className:o="",labelClassName:c=""}){return(0,a.jsxs)("div",{className:`wpqt-mb-2 wpqt-flex wpqt-gap-2 wpqt-items-center ${o}`,onClick:r,children:[i&&i,(0,a.jsx)("div",{className:c,children:t?`${e}:`:e}),(0,a.jsx)("div",{className:`${s}`,children:n?(0,a.jsx)("a",{href:n,target:"_blank",className:"wpqt-text-qtTextBlue wpqt-no-underline",rel:"noreferrer",onClick:e=>e.stopPropagation(),children:t}):t})]})}var et=s(8569),tt=s.n(et),st=s(3826),nt=s.n(st);ve().extend(nt()),ve().extend(tt());const at=()=>{const{state:{timezone:e}}=(0,n.useContext)(K);return{convertToWPTimezone:t=>((e,t)=>{try{return ve().utc(e).tz(t).format("MMMM D, YYYY HH:mm")}catch(t){return console.error("Error: ",t),e+" (UTC)"}})(t,e)}};function it(e,t){var s,n;if(!t)return!0;const a=t.toLowerCase(),i=e.name.toLowerCase(),r=(null===(s=e.description)||void 0===s?void 0:s.toLowerCase())||"",o=(null===(n=e.pipeline_name)||void 0===n?void 0:n.toLowerCase())||"";return i.includes(a)||r.includes(a)||o.includes(a)}function rt(){const{state:{loading:e,assignableTasks:t,searchText:s}}=(0,n.useContext)(ae),r=(0,o.Zp)(),{convertToWPTimezone:c}=at(),l=t.filter((e=>it(e,s)));return e?null:0===l.length?(0,a.jsx)("div",{className:"wpqt-text-center wpqt-text-gray-500",children:s?(0,i.__)("No tasks match your search filter","quicktasker"):(0,i.__)("No tasks assignable to you","quicktasker")}):(0,a.jsx)("div",{className:"wpqt-user-page-card-flex",children:t.map((e=>{const t=e.due_date?c(e.due_date):null;return(0,a.jsxs)(Xe,{className:"wpqt-cursor-pointer wpqt-min-w-[340px]",title:e.name,description:e.description,onClick:()=>r(`/tasks/${e.task_hash}`),children:[(0,a.jsx)(Je,{label:(0,i.__)("Created","quicktasker"),value:c(e.created_at),icon:(0,a.jsx)(We.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(Je,{label:(0,i.__)("Board","quicktasker"),value:e.pipeline_name?e.pipeline_name:(0,i.__)("Board is deleted!","quicktasker"),icon:(0,a.jsx)(Ye.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),t&&(0,a.jsx)(Je,{label:(0,i.__)("Due date","quicktasker"),value:t,icon:(0,a.jsx)(Ve.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(Je,{label:e.is_done?(0,i.__)("Task completed","quicktasker"):(0,i.__)("Task not completed","quicktasker"),value:e.stage_id,icon:e.is_done?(0,a.jsx)(Qe.A,{className:"wpqt-size-5 wpqt-icon-green"}):(0,a.jsx)(Qe.A,{className:"wpqt-size-5 wpqt-icon-gray"})})]},e.task_hash)}))})}function ot(){return(0,a.jsx)(ie,{children:(0,a.jsx)(ct,{})})}function ct(){const{state:{loading:e,searchText:t},loadAssignableTasks:s,userAssignableTasksDispatch:r}=(0,n.useContext)(ae);return(0,a.jsx)(Me,{loading:e,onRefresh:s,children:(0,a.jsxs)(Fe,{children:[(0,a.jsx)(He,{description:(0,i.__)("Tasks available for self-assignment","quicktasker"),children:(0,i.__)("Assignable tasks","quicktasker")}),(0,a.jsx)(he,{title:(0,i.__)("Filter tasks","quicktasker"),searchValue:t,onSearchChange:e=>{r({type:g,payload:e})}}),(0,a.jsx)(rt,{})]})})}function lt({errorTitle:e,errorDescription:t}){return(0,a.jsxs)(Be,{children:[(0,a.jsx)("h2",{children:e}),t&&(0,a.jsx)("p",{children:t})]})}var dt=s(72);function ut({icon:e,text:t,onClick:s,className:n,tooltipId:i,tooltipText:r,loading:o=!1}){const c=r&&i,l=c?{"data-tooltip-id":i,"data-tooltip-content":r,"data-tooltip-position-strategy":"fixed","data-tooltip-variant":"info"}:{};return(0,a.jsxs)("div",Object.assign({},l,{className:`wpqt-main-border wpqt-relative wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-gap-2 wpqt-bg-gray-100 wpqt-p-2 hover:wpqt-bg-white ${n}`,onClick:s,children:[e,t||o?(0,a.jsxs)("div",{className:"wpqt-flex wpqt-gap-2 wpqt-items-center wpqt-relative",children:[t&&(0,a.jsx)("span",{className:"wpqt-whitespace-nowrap "+(o?"wpqt-invisible":""),children:t}),o&&(0,a.jsx)(ce,{width:"20",height:"20",className:"wpqt-absolute wpqt-top-1/2 wpqt-left-1/2 wpqt-transform-center"})]}):null,c&&(0,a.jsx)(Re,{id:i})]}))}var pt=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function wt(){const[e,t]=(0,n.useState)(!0),[s,r]=(0,n.useState)(null),c=(0,o.Zp)(),{handleError:l}=z();(0,n.useEffect)((()=>{d()}),[]);const d=()=>pt(this,void 0,void 0,(function*(){try{t(!0);const e=yield O()({method:"GET",path:"/wpqt/v1/user-page/overview",headers:P()});r(e.data)}catch(e){l(e)}finally{t(!1)}}));return(0,a.jsx)(Me,{loading:e,onRefresh:d,className:"wpqt-flex wpqt-items-center wpqt-justify-center",children:(0,a.jsx)(Fe,{children:(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-justify-center wpqt-gap-2",children:[(0,a.jsxs)("div",{children:[(0,i.__)("Assigned tasks:","quicktasker")," ",null==s?void 0:s.assignedTasksCount]}),(0,a.jsx)(ut,{icon:(0,a.jsx)(dt.A,{className:"wpqt-size-5 wpqt-icon-blue"}),text:(0,i.__)("View assigned tasks","quicktasker"),className:"wpqt-mb-5",onClick:()=>c("/user-tasks")}),(0,a.jsxs)("div",{children:[(0,i.__)("Assignable tasks:","quicktasker")," ",null==s?void 0:s.assignableTaskCount]}),(0,a.jsx)(ut,{icon:(0,a.jsx)(dt.A,{className:"wpqt-size-5 wpqt-icon-green"}),text:(0,i.__)("View assignable tasks","quicktasker"),onClick:()=>c("/assignable-tasks")})]})})})}function ht(){return(0,a.jsx)(le,{})}var mt,qt,ft=s(5138);function xt({onClick:e=()=>{},btnText:t,className:s,type:n=mt.BUTTON,disabled:i=!1,loading:r=!1,buttonStyleType:o=qt.PRIMARY}){const c=o===qt.PRIMARY?"wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-transparent wpqt-bg-blue-500 wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-text-white wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 focus:wpqt-ring-blue-800 enabled:hover:wpqt-bg-blue-600":o===qt.SECONDARY?"wpqt-inline-flex wpqt-cursor-pointer wpqt-bg-gray-100 wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-solid wpqt-border-qtBorder wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 enabled:hover:wpqt-bg-gray-200":"wpqt-inline-flex wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-whitespace-nowrap wpqt-rounded-lg wpqt-border wpqt-border-transparent wpqt-bg-red-500 wpqt-px-3 wpqt-py-1 wpqt-text-sm/6 wpqt-text-white wpqt-transition-[color,background-color,border-color,text-decoration-color,fill,stroke,box-shadow] focus:wpqt-outline-none focus:wpqt-ring-4 focus:wpqt-ring-red-800 enabled:hover:wpqt-bg-red-600";return(0,a.jsx)(ft.$,{disabled:i||r,className:`${c} ${s}`,onClick:e,type:n,children:r?(0,a.jsx)(ce,{width:"24",height:"24",color:"#ffffff",secondaryColor:"#ffffff"}):t})}!function(e){e.BUTTON="button",e.SUBMIT="submit",e.RESET="reset"}(mt||(mt={})),function(e){e.PRIMARY="primary",e.SECONDARY="secondary",e.DANGER="danger"}(qt||(qt={}));var gt=s(9828);function vt({children:e,className:t}){return(0,a.jsx)(gt.D,{className:t,children:e})}var kt=s(6053);function _t({children:e,className:t}){return(0,a.jsx)(kt.L,{className:`wpqt-border-none ${t}`,children:e})}function jt(){const[e,t]=(0,n.useState)(!1);return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap3 wpqt-items-center wpqt-mt-2 wpqt-text-sm wpqt-cursor-pointer wpqt-relative wpqt-min-w-[300px] wpqt-text-blue-500",onClick:()=>t(!e),children:[(0,a.jsx)("div",{className:"wpqt-mb-2",children:(0,i.__)("Forgot the password?","quicktasker")}),(0,a.jsx)("div",{className:`wpqt-text-center wpqt-absolute wpqt-top-full wpqt-left-0 wpqt-w-full ${e?"wpqt-animate-fadeIn":"wpqt-animate-fadeOut"} ${!e&&"wpqt-hidden"}`,children:(0,i.__)("Please contact the site admin to reset your password","quicktasker")})]})}var yt,bt,Nt=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Tt(){const{state:{userName:e},userPageAppDispatch:t}=(0,n.useContext)(K),[s,r]=(0,n.useState)(""),[o,l]=(0,n.useState)(!1),{setSessionCookie:d}=U(),{handleError:u}=z();return(0,a.jsxs)(Be,{children:[(0,a.jsx)(He,{titleClassName:"wpqt-font-normal",className:"wpqt-mb-2",description:(0,i.__)("Please log in to continue","quicktasker"),children:(0,i.sprintf)((0,i.__)("Hello %s","quicktasker"),e)}),(0,a.jsx)("form",{onSubmit:e=>Nt(this,void 0,void 0,(function*(){if(e.preventDefault(),s)try{l(!0);const e=yield function(e){return O()({path:"/wpqt/v1/user-page/login",method:"POST",data:{password:e},headers:P()})}(s);yield d(e.data),t({type:p,payload:!0})}catch(e){l(!1),u(e)}else c.oR.error((0,i.__)("Please enter a password","quicktasker"))})),children:(0,a.jsxs)(_t,{children:[(0,a.jsx)(vt,{children:(0,a.jsx)(we,{value:s,onChange:r,type:pe.PASSWORD,"data-testid":"password-input"})}),(0,a.jsx)(vt,{className:"wpqt-flex wpqt-justify-center",children:o?(0,a.jsx)(de,{ovalSize:"32"}):(0,a.jsx)(xt,{btnText:(0,i.__)("Login","quicktasker"),type:mt.SUBMIT})})]})}),(0,a.jsx)(jt,{})]})}function Et(){const{state:{isQuicktaskerUser:e,isWordPressUser:t}}=(0,n.useContext)(K);return e?(0,a.jsx)(Tt,{}):t?(0,a.jsxs)(Be,{children:[(0,a.jsx)(He,{titleClassName:"wpqt-font-normal",className:"wpqt-mb-2",description:(0,i.__)("Your session has expired","quicktasker"),children:(0,i.__)("Hello","quicktasker")}),(0,a.jsx)("p",{children:(0,i.__)("Please log in to WordPress","quicktasker")})]}):null}function St({notification:e}){const t=(0,o.Zp)();return(0,a.jsx)(Xe,{title:e.subjectName,onClick:()=>{"task"===e.type?t(`/tasks/${e.subjectHash}/comments`):t("/user/comments")},className:"wpqt-cursor-pointer",children:(0,a.jsxs)("div",{children:[e.numberOfComments," new comments"]})})}function Ct(){const{state:{newComments:e,loading:t},checkNewComments:s}=(0,n.useContext)(Se);(0,n.useEffect)((()=>{s()}),[]);const r=e.reduce(((e,t)=>{const s=`${t.type_id}-${t.type}`;return e[s]||(e[s]={typeId:t.type_id,type:t.type,numberOfComments:0,subjectName:t.subject_name||"",subjectHash:t.subject_hash||""}),e[s].numberOfComments+=1,e}),{});return(0,a.jsx)(Me,{loading:t,onRefresh:s,children:(0,a.jsxs)(Fe,{children:[(0,a.jsx)("p",{className:"wpqt-text-center",children:(0,i.sprintf)((0,i.__)("You have %d new %s","quicktasker"),e.length,1===e.length?(0,i.__)("comment","quicktasker"):(0,i.__)("comments","quicktasker"))}),(0,a.jsx)("div",{className:"wpqt-grid wpqt-grid-cols-1  sm:wpqt-grid-cols-2 wpqt-gap-2 lg:wpqt-grid-cols-4",children:Object.values(r).map((e=>(0,a.jsx)(St,{notification:e},e.typeId)))})]})})}!function(e){e.Text="text",e.Select="select",e.Checkbox="checkbox",e.Radio="radio",e.Datetime="datetime",e.File="file"}(yt||(yt={})),function(e){e.QUICKTASKER="quicktasker",e.WP_USER="wp-user",e.Pipeline="pipeline",e.Users="users",e.Task="task"}(bt||(bt={}));const At=(e,t)=>{switch(t.type){case T:{const{user:s,customFields:n}=t.payload;return Object.assign(Object.assign({},e),{user:ee(s),customFields:n})}case E:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}default:return e}};const Ot={user:null,customFields:[],loading:!0},Pt=(0,n.createContext)({state:Ot,useUserPageUserDispatch:()=>{},loadUserData:()=>{}}),Dt=({children:e})=>{const[t,s]=(0,n.useReducer)(At,Ot),{handleError:i}=z();(0,n.useEffect)((()=>{r()}),[]);const r=()=>{return e=void 0,t=void 0,a=function*(){try{s({type:E,payload:!0});const e=yield O()({method:"GET",path:"/wpqt/v1/user-page/user",headers:P()});s({type:T,payload:e.data})}catch(e){i(e)}finally{s({type:E,payload:!1})}},new((n=void 0)||(n=Promise))((function(s,i){function r(e){try{c(a.next(e))}catch(e){i(e)}}function o(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((a=a.apply(e,t||[])).next())}));var e,t,n,a};return(0,a.jsx)(Pt.Provider,{value:{state:t,useUserPageUserDispatch:s,loadUserData:r},children:e})};var It=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Rt({name:e,description:t=""}){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"wpqt-mb-1 wpqt-text-base wpqt-font-semibold",children:e}),t&&(0,a.jsx)("div",{className:"wpqt-mb-2 wpqt-italic",children:t})]})}var Ut=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Gt({data:e,saveCustomFieldValueChange:t,valueChangeEnabled:s=!0}){const n=s=>Ut(this,void 0,void 0,(function*(){yield t(e.id,s)}));switch(e.type){case yt.Text:return(0,a.jsx)(zt,{data:e,onHandleChange:n,valueChangeEnabled:s});case yt.Checkbox:return(0,a.jsx)(Lt,{data:e,onHandleChange:n,valueChangeEnabled:s})}}function zt({data:e,onHandleChange:t,valueChangeEnabled:s}){const[i,r]=(0,n.useState)(""),[o,c]=(0,n.useState)(!1);(0,n.useEffect)((()=>{r(e.value||e.default_value||"")}),[e.value,e.default_value]);const l=(0,n.useCallback)(function(e){let t;return(...s)=>{void 0!==t&&clearTimeout(t),t=setTimeout((()=>e(...s)),600)}}((e=>Ut(this,void 0,void 0,(function*(){c(!0),yield t(e),c(!1)})))),[t]);return(0,a.jsxs)("div",{className:"wpqt-text-center",children:[(0,a.jsx)(Rt,{name:e.name,description:e.description}),(0,a.jsx)(we,{value:i,onChange:e=>{r(e),l(e)},disabled:!s,loading:o})]})}function Lt({data:e,onHandleChange:t,valueChangeEnabled:s}){const[i,r]=(0,n.useState)("true"===e.value),[o,c]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{r("true"===e.value)}),[e.value]),(0,a.jsxs)("div",{className:"wpqt-text-center",children:[(0,a.jsx)(Rt,{name:e.name,description:e.description}),o?(0,a.jsx)(de,{ovalSize:"24"}):(0,a.jsx)("input",{type:"checkbox",checked:i,onChange:e=>Ut(this,void 0,void 0,(function*(){r(e.target.checked),c(!0),yield t(e.target.checked?"true":"false"),c(!1)})),disabled:!s})]})}var $t=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Kt({entityId:e,entityType:t,entity:s,customFields:i}){const{state:{cf:r,userId:o}}=(0,n.useContext)(K),{updateCustomFieldValue:c}=function(){const{handleError:e}=z();return{updateCustomFieldValue:(t,s,n,a,i)=>It(this,void 0,void 0,(function*(){try{yield function(e,t,s,n){return O()({method:"PATCH",path:`/wpqt/v1/user-page/custom-fields/${s}`,data:{entityId:e,entityType:t,customFieldId:s,value:n},headers:P()})}(t,s,n,a),i&&i()}catch(t){e(t)}}))}}(),l=t===bt.QUICKTASKER||t===bt.WP_USER||t===bt.Task&&"assigned_users"in s&&s.assigned_users.some((e=>e.id===o)),d=(s,n)=>$t(this,void 0,void 0,(function*(){yield c(e,t,s,n)}));return r&&i?(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3",children:i.map((e=>(0,a.jsx)(Gt,{data:e,valueChangeEnabled:l,saveCustomFieldValueChange:d},e.id)))}):null}var Mt=s(3338);function Ft(){const e=(0,o.Zp)();return(0,a.jsx)("div",{className:"wpqt-mt-4 wpqt-flex wpqt-gap-3",children:(0,a.jsx)(ut,{icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,i.__)("Manage user comments","quicktasker"),onClick:()=>{e("/user/comments")}})})}function Bt({children:e}){return(0,a.jsx)("div",{children:e})}function Ht({children:e,label:t,className:s=""}){return(0,a.jsxs)("div",{className:`wpqt-mb-1 ${s}`,"data-testid":"display-row",children:[t&&(0,a.jsx)("span",{className:"wpqt-font-semibold","data-testid":"row-label",children:t}),(0,a.jsx)("span",{className:"wpqt-text-base",children:e})]})}function Wt({user:e}){if(!e)return null;const t="wpqt-flex wpqt-flex-col wpqt-items-center wpqt-mb-4 wpqt-gap-1 wpqt-text-xl";return(0,a.jsx)("div",{className:"wpqt-mb-4",children:(0,a.jsxs)(Bt,{children:[(0,a.jsx)(Ht,{className:t,children:e.user_type===Q.WP_USER?(0,a.jsx)("img",{className:"wpqt-size-11 wpqt-rounded-full",src:e.profile_picture}):(0,a.jsx)(Pe.A,{className:"wpqt-icon-blue wpqt-size-11 wpqt-text-blue-900"})}),(0,a.jsx)(Ht,{label:(0,i.__)("Name","quicktasker"),className:t,children:e.name}),e.description&&(0,a.jsx)(Ht,{label:(0,i.__)("Description","quicktasker"),className:t,children:e.description})]})})}function Yt(){return(0,a.jsx)(Dt,{children:(0,a.jsx)(Vt,{})})}function Vt(){const{state:{loading:e,user:t,customFields:s},loadUserData:r}=(0,n.useContext)(Pt);return(0,a.jsx)(Me,{loading:e,onRefresh:r,children:(0,a.jsxs)(Fe,{children:[(0,a.jsx)(He,{children:(0,i.__)("User details","quicktasker")}),(0,a.jsx)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3",children:t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Wt,{user:t}),(0,a.jsx)(Kt,{entityId:t.id,entityType:(e=>{switch(e){case Q.QUICKTASKER:return bt.QUICKTASKER;case Q.WP_USER:return bt.WP_USER;default:throw new Error(`Unsupported user type: ${e}`)}})(t.user_type),entity:t,customFields:s}),(0,a.jsx)(Ft,{})]})})]})})}var Qt=s(540);function Zt({children:e,className:t}){return(0,a.jsx)(Qt.JU,{className:`wpqt-mb-2 wpqt-block ${t}`,children:e})}var Xt=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Jt(){const{state:{userName:e}}=(0,n.useContext)(K),{handleError:t}=z(),[s,r]=(0,n.useState)(""),[o,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)(""),[u,p]=(0,n.useState)("");return(0,n.useEffect)((()=>{p(s!==l?(0,i.__)("Passwords do not match","quicktasker"):"")}),[s,l]),(0,a.jsxs)(Be,{children:[(0,a.jsx)(He,{titleClassName:"wpqt-font-normal",description:(0,i.__)("Please complete the setup","quicktasker"),children:(0,i.sprintf)((0,i.__)("Hello %s","quicktasker"),e)}),(0,a.jsx)("form",{onSubmit:e=>Xt(this,void 0,void 0,(function*(){if(e.preventDefault(),!s||!l)return void p((0,i.__)("Please enter a password","quicktasker"));if(u)return;const n={password:s};try{c(!0),yield function(e){return O()({path:"/wpqt/v1/user-page/setup",data:e,method:"POST",headers:P()})}(n),window.location.reload()}catch(e){t(e),c(!1)}})),children:(0,a.jsxs)(_t,{children:[(0,a.jsxs)(vt,{children:[(0,a.jsx)(Zt,{className:"wpqt-text-center",children:(0,i.__)("Enter your new password","quicktasker")}),(0,a.jsx)(we,{value:s,onChange:r,type:pe.PASSWORD})]}),(0,a.jsxs)(vt,{children:[(0,a.jsx)(Zt,{className:"wpqt-text-center",children:(0,i.__)("Repeat your new password","quicktasker")}),(0,a.jsx)(we,{value:l,onChange:d,type:pe.PASSWORD})]}),u&&(0,a.jsx)("div",{className:"wpqt-text-qtTextRed wpqt-mb-3",children:u}),(0,a.jsx)(vt,{className:"wpqt-text-center",children:o?(0,a.jsx)(de,{ovalSize:"32"}):(0,a.jsx)(xt,{btnText:(0,i.__)("Setup","quicktasker"),type:mt.SUBMIT})})]})})]})}var es=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function ts(){const{handleError:e}=z();return{loadTaskComments:(t,s)=>es(this,void 0,void 0,(function*(){try{const e=yield function(e){return O()({method:"GET",path:`/wpqt/v1/user-page/tasks/${e}/comments`,headers:P()})}(t);s&&s(e.data)}catch(t){e(t)}})),addTaskComment:(t,s,n)=>es(this,void 0,void 0,(function*(){try{const e=yield function(e,t){return O()({method:"POST",path:`/wpqt/v1/user-page/tasks/${e}/comments`,data:{comment:t},headers:P()})}(t,s);n&&n(e.data)}catch(t){e(t)}})),loadUserComments:t=>es(this,void 0,void 0,(function*(){try{const e=yield O()({method:"GET",path:"/wpqt/v1/user-page/user/comments",headers:P()});t(e.data)}catch(t){e(t)}})),addUserComment:(t,s)=>es(this,void 0,void 0,(function*(){try{const e=yield(n=t,O()({method:"POST",path:"/wpqt/v1/user-page/user/comments",data:{comment:n},headers:P()}));s(e.data)}catch(t){e(t)}var n}))}}var ss=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function ns(){const{handleError:e}=z();return{getTask:(t,s)=>ss(this,void 0,void 0,(function*(){try{const e=yield D(t);s&&s(e.data)}catch(t){e(t)}})),assignToTask:(t,s)=>ss(this,void 0,void 0,(function*(){try{const e=yield function(e){return O()({method:"POST",path:`/wpqt/v1/user-page/tasks/${e}/users`,headers:P()})}(t);c.oR.success((0,i.__)("Task assigned successfully","quicktasker")),s&&s(e.data.task)}catch(t){e(t)}})),changeTaskStage:(t,s,n)=>ss(this,void 0,void 0,(function*(){try{yield function(e,t){return O()({method:"PATCH",path:`/wpqt/v1/user-page/tasks/${e}/stage`,data:{stageId:t},headers:P()})}(t,s),c.oR.success((0,i.__)("Task stage changed successfully","quicktasker")),n&&n()}catch(t){e(t)}})),unAssignFromTask:(t,s)=>ss(this,void 0,void 0,(function*(){try{const e=yield function(e){return O()({method:"DELETE",path:`/wpqt/v1/user-page/tasks/${e}/users`,headers:P()})}(t);c.oR.success((0,i.__)("Task unassigned successfully","quicktasker")),s&&s(e.data)}catch(t){e(t)}})),changeTaskDoneStatus:(t,s,n)=>ss(this,void 0,void 0,(function*(){try{const e=s?(0,i.__)("Task marked as completed","quicktasker"):(0,i.__)("Task marked as incomplete","quicktasker");yield function(e,t){return O()({method:"PATCH",path:`/wpqt/v1/user-page/tasks/${e}/done`,data:{done:t},headers:P()})}(t,s),c.oR.success(e),n&&n(s)}catch(t){e(t)}}))}}var as=s(1062);function is({value:e,onChange:t,rowsCount:s=3,colsCount:n,className:i="",disabled:r=!1,loading:o=!1}){return(0,a.jsxs)("div",{className:"wpqt-relative wpqt-mb-3",children:[(0,a.jsx)(as.T,{className:(0,Ze.$)("wpqt-border-1 wpqt-mb-3 wpqt-block wpqt-w-auto wpqt-resize-none wpqt-rounded-lg wpqt-border-qtBorder wpqt-px-3 wpqt-py-1.5 wpqt-text-sm/6",`focus:wpqt-shadow-none focus:wpqt-outline-none data-[focus]:wpqt-outline-2 data-[focus]:wpqt--outline-offset-2 data-[focus]:wpqt-outline-gray-300 ${i}`),rows:s,cols:n,value:e,onChange:e=>t(e.target.value),disabled:r}),o&&(0,a.jsx)(ce,{width:"24",height:"24",className:"wpqt-absolute wpqt-right-[-32px] wpqt-top-1/2 wpqt-transform-y-center"})]})}function rs({comment:e}){const t="wp-user"===e.author_type;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)("div",{className:t?"wpqt-font-semibold wpqt-text-lg":"wpqt-font-normal",children:e.author_name}),(0,a.jsx)("div",{className:"wpqt-text-sm",children:t?(0,i.__)("Admin","quicktasker"):(0,i.__)("QuickTasker","quicktasker")})]}),(0,a.jsx)("div",{className:"wpqt-break-all wpqt-text-center wpqt-leading-normal wpqt-mb-4 md:wpqt-mb-0",children:e.text})]})}var os=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function cs({comments:e,addComments:t}){const{checkNewComments:s}=(0,n.useContext)(Se),[r,o]=(0,n.useState)(""),l=(0,n.useRef)(null),[d,u]=(0,n.useState)(!1),{storeComments:p}=be();(0,n.useEffect)((()=>{l.current&&l.current.scrollTo({top:l.current.scrollHeight,behavior:"smooth"})}),[e]),(0,n.useEffect)((()=>{e&&e.length>0&&w()}),[e]);const w=()=>os(this,void 0,void 0,(function*(){yield p(e),yield s()}));return(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-7",children:[(0,a.jsx)("div",{ref:l,className:"wpqt-comments-app-height wpqt-overflow-y-auto",children:e&&0===e.length?(0,a.jsx)("div",{className:"wpqt-text-center",children:(0,i.__)("No comments found","quicktasker")}):(0,a.jsx)("div",{className:"wpqt-grid wpqt-grid-cols-1 md:wpqt-grid-cols-[auto_1fr] wpqt-gap-3 md:wpqt-gap-8 wpqt-items-center wpqt-px-2",children:e.map((e=>(0,a.jsx)(rs,{comment:e},e.id)))})}),(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-gap-4 wpqt-w-full md:wpqt-w-2/4 wpqt-mx-auto",children:[(0,a.jsx)(is,{value:r,onChange:o}),(0,a.jsx)(ut,{loading:d,text:(0,i.__)("Add comment","quicktasker"),onClick:()=>os(this,void 0,void 0,(function*(){r?(u(!0),yield t(r),o(""),u(!1)):c.oR.error((0,i.__)("Comment cant be empty","quicktasker"))})),icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-green wpqt-size-5"})})]})]})}var ls=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function ds(){const{taskHash:e}=(0,o.g)(),[t,s]=(0,n.useState)(!0),[r,c]=(0,n.useState)(null),[l,d]=(0,n.useState)(null),{loadTaskComments:u,addTaskComment:p}=ts(),{getTask:w}=ns();(0,n.useEffect)((()=>{h(),m()}),[]);const h=()=>ls(this,void 0,void 0,(function*(){yield w(e,(e=>{c(te(e.task))}))})),m=()=>ls(this,void 0,void 0,(function*(){s(!0),yield u(e,(e=>{d(e)})),s(!1)}));return(0,a.jsx)(Me,{loading:t,onRefresh:m,children:(0,a.jsxs)(Fe,{children:[r&&(0,a.jsx)(He,{description:(0,i.__)("Comments related to the task","quicktasker"),children:(0,i.sprintf)((0,i.__)("%s comments","quicktasker"),r.name)}),l&&(0,a.jsx)(cs,{comments:l,addComments:e=>ls(this,void 0,void 0,(function*(){yield p(r.task_hash,e,(e=>{d(e)}))}))})]})})}const us=e=>Object.assign(Object.assign({},e),{stage_order:Number(e.stage_order),tasks:(e.tasks||[]).map((e=>Object.assign({},te(e))))}),ps=(e,t)=>{switch(t.type){case v:{const n=t.payload;return Object.assign(Object.assign({},e),{task:te(n.task),taskStages:n.stages.map(us),customFields:n.customFields,pipelineSettings:(s=n.pipelineSettings,Object.assign(Object.assign({},s),{allow_only_last_stage_task_done:"1"===s.allow_only_last_stage_task_done}))})}case _:{const s=t.payload;return Object.assign(Object.assign({},e),{task:te(s)})}case k:return Object.assign(Object.assign({},e),{loading:t.payload});case j:{const s=t.payload;return Object.assign(Object.assign({},e),{task:e.task?Object.assign(Object.assign({},e.task),{stage_id:s}):null})}case y:{const{done:s}=t.payload;return Object.assign(Object.assign({},e),{task:e.task?Object.assign(Object.assign({},e.task),{is_done:s}):null})}default:return e}var s};const ws={task:null,taskStages:[],customFields:[],pipelineSettings:{allow_only_last_stage_task_done:!1},loading:!0},hs=(0,n.createContext)({state:ws,userTaskDispatch:()=>{},loadTask:()=>{}}),ms=({children:e,taskHash:t})=>{const[s,i]=(0,n.useReducer)(ps,ws),{handleError:r}=z();(0,n.useEffect)((()=>{o()}),[]);const o=()=>{return e=void 0,s=void 0,a=function*(){if(t)try{i({type:k,payload:!0});const e=yield D(t);i({type:v,payload:e.data})}catch(e){r(e)}finally{i({type:k,payload:!1})}},new((n=void 0)||(n=Promise))((function(t,i){function r(e){try{c(a.next(e))}catch(e){i(e)}}function o(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var s;e.done?t(e.value):(s=e.value,s instanceof n?s:new n((function(e){e(s)}))).then(r,o)}c((a=a.apply(e,s||[])).next())}));var e,s,n,a};return(0,a.jsx)(hs.Provider,{value:{state:s,userTaskDispatch:i,loadTask:o},children:e})};var qs=s(7028),fs=s(8316),xs=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function gs({task:e}){var t,s;const{state:{userId:r,userType:c}}=(0,n.useContext)(K),{userTaskDispatch:l}=(0,n.useContext)(hs),{assignToTask:d,unAssignFromTask:u}=ns(),[p,w]=(0,n.useState)(!1),h=(0,o.Zp)(),m=(null===(t=null==e?void 0:e.assigned_users)||void 0===t?void 0:t.some((e=>e.id===r&&e.user_type===c)))||(null===(s=null==e?void 0:e.assigned_wp_users)||void 0===s?void 0:s.some((e=>e.id===r&&e.user_type===c)));return null===e?null:(0,a.jsxs)("div",{className:"wpqt-mt-5 wpqt-flex wpqt-flex-wrap wpqt-justify-center wpqt-gap-4",children:[m&&(0,a.jsx)(ut,{loading:p,icon:(0,a.jsx)(qs.A,{className:"wpqt-icon-red wpqt-size-5"}),text:(0,i.__)("Unassign from task","quicktasker"),onClick:()=>xs(this,void 0,void 0,(function*(){w(!0),yield u(e.task_hash,(()=>{h("/")})),w(!1)}))}),m&&(0,a.jsx)(ut,{icon:(0,a.jsx)(Mt.A,{className:"wpqt-icon-blue wpqt-size-5"}),text:(0,i.__)("Manage task comments","quicktasker"),onClick:()=>{h(`/tasks/${e.task_hash}/comments`)}}),!m&&(0,a.jsx)(ut,{loading:p,icon:(0,a.jsx)(fs.A,{className:"wpqt-icon-green wpqt-size-5"}),text:(0,i.__)("Assing to task","quicktasker"),onClick:()=>xs(this,void 0,void 0,(function*(){w(!0),yield d(e.task_hash,(e=>{l({type:_,payload:e})})),w(!1)}))})]})}function vs({task:e}){const{convertToWPTimezone:t}=at();if(!e)return null;const s="wpqt-flex wpqt-flex-col wpqt-items-center wpqt-mb-4 wpqt-gap-1",n=[...e.assigned_users||[],...e.assigned_wp_users||[]],r=n.length>0,o=e.due_date?t(e.due_date):null;return(0,a.jsx)("div",{children:(0,a.jsxs)(Bt,{children:[(0,a.jsx)(Ht,{label:(0,i.__)("Name","quicktasker"),className:s,children:e.name}),e.description&&(0,a.jsx)(Ht,{label:(0,i.__)("Description","quicktasker"),className:s,children:e.description}),(0,a.jsx)(Ht,{label:(0,i.__)("Board","quicktasker"),className:s,children:e.pipeline_name}),(0,a.jsx)(Ht,{label:(0,i.__)("Created at","quicktasker"),className:s,children:t(e.created_at)}),o&&(0,a.jsx)(Ht,{label:(0,i.__)("Due date","quicktasker"),className:s,children:o}),(0,a.jsx)(Ht,{label:(0,i.__)("Free for all","quicktasker"),className:s,children:e.free_for_all?(0,i.__)("Yes","quicktasker"):(0,i.__)("No","quicktasker")}),r&&(0,a.jsx)(Ht,{label:(0,i.__)("Assigned users","quicktasker"),className:s,children:n.map((e=>e.name)).join(", ")})]})})}var ks=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function _s({task:e}){const{changeTaskDoneStatus:t}=ns(),[s,r]=(0,n.useState)(!1),{state:{pipelineSettings:o,taskStages:c},userTaskDispatch:l}=(0,n.useContext)(hs),{state:{userId:d,userType:u}}=(0,n.useContext)(K),p=(null==e?void 0:e.assigned_users.some((e=>e.id===d&&e.user_type===u)))||(null==e?void 0:e.assigned_wp_users.some((e=>e.id===d&&e.user_type===u))),w=e.is_done,h=w?(0,i.__)("Task is completed","quicktasker"):(0,i.__)("Task is incomplete","quicktasker"),m=c.reduce(((e,t)=>Number(e.stage_order)>Number(t.stage_order)?e:t)),q=e.stage_id===m.id,f=!o.allow_only_last_stage_task_done||q,x=s=>ks(this,void 0,void 0,(function*(){r(!0),yield t(e.task_hash,s,(()=>{l({type:y,payload:{done:s}})})),r(!1)}));return p&&f?(0,a.jsxs)("div",{className:"wpqt-mt-2 wpqt-mb-2 wpqt-flex wpqt-flex-col wpqt-items-center",children:[(0,a.jsx)("div",{className:"wpqt-font-medium",children:h}),(0,a.jsx)("div",{className:"wpqt-text-gray-400 wpqt-text-sm wpqt-mb-2",children:(0,i.__)("Click to change","quicktasker")}),s?(0,a.jsx)(de,{ovalSize:"36"}):w?(0,a.jsx)(Qe.A,{className:"wpqt-size-9 wpqt-icon-green wpqt-cursor-pointer",onClick:()=>{x(!1)}}):(0,a.jsx)(Qe.A,{className:"wpqt-size-9 wpqt-text-gray-300 wpqt-cursor-pointer",onClick:()=>{x(!0)}})]}):null}var js=s(8337),ys=s(8865),bs=s(2601),Ns=s(2922),Ts=s(4576);function Es({modalOpen:e,closeModal:t,children:s,size:n="sm"}){return(0,a.jsxs)(Ns.lG,{open:e,as:"div",className:"wpqt-relative wpqt-z-9999 focus:wpqt-outline-none",onClose:t,children:[(0,a.jsx)(Ns.Xi,{className:"wpqt-fixed wpqt-inset-0 wpqt-bg-black/40"}),(0,a.jsx)("div",{className:"wpqt-fixed wpqt-inset-0 wpqt-z-10 wpqt-w-screen wpqt-overflow-y-auto",children:(0,a.jsx)("div",{className:"wpqt-mt-[8vh] wpqt-flex wpqt-justify-center",children:(0,a.jsxs)(Ns.Lj,{transition:!0,className:`data-[closed]:wpqt-transform-[wpqt-scale(95%)] wpqt-relative wpqt-mt-[20px] wpqt-w-4/5 ${{sm:"wpqt-max-w-sm",md:"wpqt-max-w-lg",lg:"wpqt-max-w-4xl",xl:"wpqt-max-w-6xl"}[n]} wpqt-rounded-xl wpqt-bg-white wpqt-p-8 wpqt-backdrop-blur-2xl wpqt-duration-300 wpqt-ease-out data-[closed]:wpqt-opacity-0`,children:[(0,a.jsx)("div",{className:"wpqt-group wpqt-absolute wpqt-right-[-20px] wpqt-top-[-20px] wpqt-flex wpqt-h-[40px] wpqt-w-[40px] wpqt-cursor-pointer wpqt-items-center wpqt-justify-center wpqt-rounded-full wpqt-border wpqt-border-solid wpqt-bg-white wpqt-text-qtBorder",onClick:t,"data-testid":"wpqt-modal-close-button",children:(0,a.jsx)(Ts.A,{className:"wpqt-icon-blue group-hover:wpqt-icon-red wpqt-size-5"})}),s]})})})]})}var Ss=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Cs({task:e,stages:t,open:s,onClose:r}){const{userTaskDispatch:o}=(0,n.useContext)(hs),[c,l]=(0,n.useState)(e.stage_id),[d,u]=(0,n.useState)(!1),{changeTaskStage:p}=ns();return(0,a.jsxs)(Es,{modalOpen:s,closeModal:r,size:"sm",children:[(0,a.jsx)("h3",{className:"wpqt-text-center",children:(0,i.__)("Task stage selection","quicktasker")}),(0,a.jsx)(ys.z6,{value:c,onChange:l,className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-5",children:t.map((e=>(0,a.jsxs)(gt.D,{className:"wpqt-flex wpqt-items-center wpqt-gap-2",children:[(0,a.jsx)(ys.sx,{value:e.id,className:"wpqt-group wpqt-flex wpqt-size-5 wpqt-items-center wpqt-justify-center wpqt-rounded-full wpqt-border data-[checked]:wpqt-bg-blue-400",children:(0,a.jsx)("span",{className:"wpqt-invisible wpqt-size-2 wpqt-rounded-full wpqt-bg-white group-data-[checked]:wpqt-visible"})}),(0,a.jsx)(Qt.JU,{children:e.name})]},e.id)))}),(0,a.jsx)("div",{className:"wpqt-mt-5 wpqt-flex wpqt-justify-center",children:d?(0,a.jsx)(ce,{width:"32",height:"32"}):(0,a.jsx)(ut,{text:(0,i.__)("Save","quicktasker"),icon:(0,a.jsx)(bs.A,{className:"wpqt-icon-green wpqt-size-5"}),onClick:()=>Ss(this,void 0,void 0,(function*(){u(!0),yield p(e.task_hash,c,(()=>{o({type:j,payload:c})})),u(!1),r()}))})})]})}function As({task:e}){const{state:{taskStages:t}}=(0,n.useContext)(hs),{state:{userId:s,userType:r}}=(0,n.useContext)(K),[o,c]=(0,n.useState)(!1),l=(null==e?void 0:e.assigned_users.some((e=>e.id===s&&e.user_type===r)))||(null==e?void 0:e.assigned_wp_users.some((e=>e.id===s&&e.user_type===r))),d=t.find((t=>t.id===(null==e?void 0:e.stage_id)));return null===e?null:(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-mb-3",children:[(0,a.jsx)("div",{className:"wpqt-mb-3 wpqt-font-medium",children:(0,i.sprintf)((0,i.__)("Task is on stage %s","quicktasker"),null==d?void 0:d.name)}),l&&(0,a.jsx)(ut,{text:(0,i.__)("Change stage","quicktasker"),icon:(0,a.jsx)(js.A,{className:"wpqt-size-5 wpqt-icon-blue"}),onClick:()=>c(!0)}),(0,a.jsx)(Cs,{stages:t,task:e,open:o,onClose:()=>c(!1)})]})}function Os(){const{taskHash:e}=(0,o.g)();return(0,a.jsx)(ms,{taskHash:e,children:(0,a.jsx)(Ps,{})})}function Ps(){const{state:{loading:e,task:t,customFields:s},loadTask:r}=(0,n.useContext)(hs);return(0,a.jsx)(Me,{loading:e,onRefresh:r,children:(0,a.jsxs)(Fe,{children:[(0,a.jsxs)(He,{children:[" ",(0,i.__)("Task details","quicktasker")]}),t&&(0,a.jsxs)("div",{className:"wpqt-flex wpqt-flex-col wpqt-items-center wpqt-gap-3",children:[(0,a.jsx)(vs,{task:t}),(0,a.jsx)(As,{task:t}),(0,a.jsx)(_s,{task:t}),(0,a.jsx)(Kt,{entityId:t.id,entityType:bt.Task,entity:t,customFields:s}),(0,a.jsx)(gs,{task:t})]})]})})}var Ds=function(e,t,s,n){return new(s||(s=Promise))((function(a,i){function r(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}c((n=n.apply(e,t||[])).next())}))};function Is(){const[e,t]=(0,n.useState)(null),[s,r]=(0,n.useState)(!0),{loadUserComments:o,addUserComment:c}=ts();(0,n.useEffect)((()=>{l()}),[]);const l=()=>Ds(this,void 0,void 0,(function*(){r(!0),yield o((e=>{t(e)})),r(!1)}));return(0,a.jsx)(Me,{loading:s,onRefresh:l,children:(0,a.jsxs)(Fe,{children:[(0,a.jsx)(He,{description:(0,i.__)("Comments related to your user","quicktasker"),children:(0,i.__)("User comments","quicktasker")}),e&&(0,a.jsx)(cs,{comments:e,addComments:e=>Ds(this,void 0,void 0,(function*(){yield c(e,(e=>{t(e)}))}))})]})})}const Rs=(e,t)=>{switch(t.type){case h:{const s=t.payload.map(te);return Object.assign(Object.assign({},e),{assignedTasks:s,loading:!1})}case m:{const s=t.payload;return Object.assign(Object.assign({},e),{loading:s})}case q:{const s=t.payload;return Object.assign(Object.assign({},e),{searchText:s})}default:return e}};const Us={loading:!0,assignedTasks:[],searchText:""},Gs=(0,n.createContext)({state:Us,userAssignedTasksDispatch:()=>{},loadAssignedTasks:()=>{}}),zs=({children:e})=>{const[t,s]=(0,n.useReducer)(Rs,Us),{state:{pageHash:i}}=(0,n.useContext)(K),{handleError:r}=z();(0,n.useEffect)((()=>{o()}),[i]);const o=()=>{return e=void 0,t=void 0,a=function*(){try{s({type:m,payload:!0});const e=yield O()({method:"GET",path:"/wpqt/v1/user-page/assigned-tasks",headers:P()});s({type:h,payload:e.data})}catch(e){r(e)}finally{s({type:m,payload:!1})}},new((n=void 0)||(n=Promise))((function(s,i){function r(e){try{c(a.next(e))}catch(e){i(e)}}function o(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}c((a=a.apply(e,t||[])).next())}));var e,t,n,a};return(0,a.jsx)(Gs.Provider,{value:{state:t,userAssignedTasksDispatch:s,loadAssignedTasks:o},children:e})};function Ls(){const{state:{assignedTasks:e,searchText:t,loading:s}}=(0,n.useContext)(Gs),r=(0,o.Zp)(),{convertToWPTimezone:c}=at(),l=e.filter((e=>it(e,t)));return s?null:0===l.length?(0,a.jsx)("div",{className:"wpqt-text-center wpqt-text-gray-500",children:t?(0,i.__)("No tasks match your search filter","quicktasker"):(0,i.__)("No tasks assigned to you","quicktasker")}):(0,a.jsx)("div",{className:"wpqt-user-page-card-flex",children:l.map((e=>{const t=e.is_done,s=e.due_date?c(e.due_date):null;return(0,a.jsxs)(Xe,{className:"wpqt-cursor-pointer wpqt-min-w-[340px]",title:e.name,description:e.description,onClick:()=>r(`/tasks/${e.task_hash}`),children:[(0,a.jsx)(Je,{label:(0,i.__)("Created","quicktasker"),value:c(e.created_at),icon:(0,a.jsx)(We.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(Je,{label:(0,i.__)("Board","quicktasker"),value:e.pipeline_name?e.pipeline_name:(0,i.__)("Board is deleted!","quicktasker"),icon:(0,a.jsx)(Ye.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),s&&(0,a.jsx)(Je,{label:(0,i.__)("Due date","quicktasker"),value:s,icon:(0,a.jsx)(Ve.A,{className:"wpqt-size-5 wpqt-icon-blue"})}),(0,a.jsx)(Je,{label:t?(0,i.__)("Task completed","quicktasker"):(0,i.__)("Task not completed","quicktasker"),value:e.stage_id,icon:t?(0,a.jsx)(Qe.A,{className:"wpqt-size-5 wpqt-icon-green"}):(0,a.jsx)(Qe.A,{className:"wpqt-size-5 wpqt-icon-gray"})})]},e.id)}))})}function $s(){return(0,a.jsx)(zs,{children:(0,a.jsx)(Ks,{})})}function Ks(){const{state:{loading:e,searchText:t},loadAssignedTasks:s,userAssignedTasksDispatch:r}=(0,n.useContext)(Gs);return(0,a.jsx)(Me,{loading:e,onRefresh:s,children:(0,a.jsxs)(Fe,{children:[(0,a.jsx)(He,{description:(0,i.__)("Tasks that are assigned to you","quicktasker"),children:(0,i.__)("Assigned tasks","quicktasker")}),(0,a.jsx)(he,{title:(0,i.__)("Filter tasks","quicktasker"),searchValue:t,onSearchChange:e=>{r({type:q,payload:e})}}),(0,a.jsx)(Ls,{})]})})}function Ms(){const{state:{initialLoading:e,isActiveUser:t,setupCompleted:s,isLoggedIn:c}}=(0,n.useContext)(K);return e?(0,a.jsx)(ht,{}):t?s?c?(0,a.jsx)(r.I9,{children:(0,a.jsxs)(o.BV,{children:[(0,a.jsx)(o.qh,{path:"/",element:(0,a.jsx)(wt,{})}),(0,a.jsx)(o.qh,{path:"/user/profile",element:(0,a.jsx)(Yt,{})}),(0,a.jsx)(o.qh,{path:"/user-tasks",element:(0,a.jsx)($s,{})}),(0,a.jsx)(o.qh,{path:"/assignable-tasks",element:(0,a.jsx)(ot,{})}),(0,a.jsx)(o.qh,{path:"/tasks/:taskHash",element:(0,a.jsx)(Os,{})}),(0,a.jsx)(o.qh,{path:"/notifications",element:(0,a.jsx)(Ct,{})}),(0,a.jsx)(o.qh,{path:"/tasks/:taskHash/comments",element:(0,a.jsx)(ds,{})}),(0,a.jsx)(o.qh,{path:"/user/comments",element:(0,a.jsx)(Is,{})})]})}):(0,a.jsx)(Et,{}):(0,a.jsx)(Jt,{}):(0,a.jsx)(lt,{errorTitle:(0,i.__)("User is not active","quicktasker"),errorDescription:(0,i.__)("Your user is not active. Please contact site administrator.","quicktasker")})}const Fs=function(){return(0,a.jsx)(d,{children:(0,a.jsx)(M,{children:(0,a.jsxs)(Ce,{children:[(0,a.jsx)(Ms,{}),(0,a.jsx)(c.N9,{closeOnClick:!0,position:"bottom-center",toastClassName:"wpqt-bottom-[80px] lg:wpqt-bottom-[20px]",autoClose:2e3})]})})})};(0,n.render)((0,a.jsx)(Fs,{}),document.getElementById("wpqt-public-user-app"))},1609:e=>{e.exports=window.React},5795:e=>{e.exports=window.ReactDOM},790:e=>{e.exports=window.ReactJSXRuntime}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var s=a[e]={exports:{}};return n[e].call(s.exports,s,s.exports,i),s.exports}i.m=n,e=[],i.O=(t,s,n,a)=>{if(!s){var r=1/0;for(d=0;d<e.length;d++){for(var[s,n,a]=e[d],o=!0,c=0;c<s.length;c++)(!1&a||r>=a)&&Object.keys(i.O).every((e=>i.O[e](s[c])))?s.splice(c--,1):(o=!1,a<r&&(r=a));if(o){e.splice(d--,1);var l=n();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[s,n,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);i.r(a);var r={};t=t||[null,s({}),s([]),s(s)];for(var o=2&n&&e;"object"==typeof o&&!~t.indexOf(o);o=s(o))Object.getOwnPropertyNames(o).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,i.d(a,r),a},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=795,(()=>{var e={795:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var n,a,[r,o,c]=s,l=0;if(r.some((t=>0!==e[t]))){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);if(c)var d=c(i)}for(t&&t(s);l<r.length;l++)a=r[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(d)},s=globalThis.webpackChunkquicktasker=globalThis.webpackChunkquicktasker||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.nc=void 0;var r=i.O(void 0,[96],(()=>i(3503)));r=i.O(r)})();